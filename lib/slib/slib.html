<html lang="en">
<head>
<title>slib</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="slib">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual is for SLIB (version 3b5, January 2015),
the portable Scheme library.

Copyright (C) 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover Texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled "GNU Free Documentation License."
-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<h1 class="settitle">slib</h1>
  <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">SLIB</a>
<li><a name="toc_The-Library-System" href="#The-Library-System">1 The Library System</a>
<ul>
<li><a href="#Feature">1.1 Feature</a>
<li><a href="#Require">1.2 Require</a>
<li><a href="#Library-Catalogs">1.3 Library Catalogs</a>
<li><a href="#Catalog-Creation">1.4 Catalog Creation</a>
<li><a href="#Catalog-Vicinities">1.5 Catalog Vicinities</a>
<li><a href="#Compiling-Scheme">1.6 Compiling Scheme</a>
<ul>
<li><a href="#Module-Conventions">1.6.1 Module Conventions</a>
<li><a href="#Module-Manifests">1.6.2 Module Manifests</a>
<li><a href="#Module-Semantics">1.6.3 Module Semantics</a>
<li><a href="#Top_002dlevel-Variable-References">1.6.4 Top-level Variable References</a>
<li><a href="#Module-Analysis">1.6.5 Module Analysis</a>
</li></ul>
</li></ul>
<li><a name="toc_Universal-SLIB-Procedures" href="#Universal-SLIB-Procedures">2 Universal SLIB Procedures</a>
<ul>
<li><a href="#Vicinity">2.1 Vicinity</a>
<li><a href="#Configuration">2.2 Configuration</a>
<li><a href="#Input_002fOutput">2.3 Input/Output</a>
<li><a href="#System">2.4 System</a>
<li><a href="#Miscellany">2.5 Miscellany</a>
<ul>
<li><a href="#Miscellany">2.5.1 Mutual Exclusion</a>
<li><a href="#Miscellany">2.5.2 Legacy</a>
</li></ul>
</li></ul>
<li><a name="toc_Scheme-Syntax-Extension-Packages" href="#Scheme-Syntax-Extension-Packages">3 Scheme Syntax Extension Packages</a>
<ul>
<li><a href="#Defmacro">3.1 Defmacro</a>
<ul>
<li><a href="#Defmacro">3.1.1 Defmacroexpand</a>
</li></ul>
<li><a href="#R4RS-Macros">3.2 R4RS Macros</a>
<li><a href="#Macro-by-Example">3.3 Macro by Example</a>
<ul>
<li><a href="#Macro-by-Example">3.3.1 Caveat</a>
</li></ul>
<li><a href="#Macros-That-Work">3.4 Macros That Work</a>
<ul>
<li><a href="#Macros-That-Work">3.4.1 Definitions</a>
<li><a href="#Macros-That-Work">3.4.2 Restrictions</a>
</li></ul>
<li><a href="#Syntactic-Closures">3.5 Syntactic Closures</a>
<ul>
<li><a href="#Syntactic-Closures">3.5.1 Syntactic Closure Macro Facility</a>
<ul>
<li><a href="#Syntactic-Closures">3.5.1.1 Terminology</a>
<li><a href="#Syntactic-Closures">3.5.1.2 Transformer Definition</a>
<li><a href="#Syntactic-Closures">3.5.1.3 Identifiers</a>
<li><a href="#Syntactic-Closures">3.5.1.4 Acknowledgements</a>
</li></ul>
</li></ul>
<li><a href="#Syntax_002dCase-Macros">3.6 Syntax-Case Macros</a>
<ul>
<li><a href="#Syntax_002dCase-Macros">3.6.1 Notes</a>
</li></ul>
<li><a href="#Define_002dStructure">3.7 Define-Structure</a>
<li><a href="#Define_002dRecord_002dType">3.8 Define-Record-Type</a>
<li><a href="#Fluid_002dLet">3.9 Fluid-Let</a>
<li><a href="#Parameter-Objects">3.10 Parameter Objects</a>
<li><a href="#Binding-to-multiple-values">3.11 Binding to multiple values</a>
<li><a href="#Guarded-LET_002a-special-form">3.12 Guarded LET* special form</a>
<li><a href="#Guarded-COND-Clause">3.13 Guarded COND Clause</a>
<li><a href="#Yasos">3.14 Yasos</a>
<ul>
<li><a href="#Yasos-terms">3.14.1 Terms</a>
<li><a href="#Yasos-interface">3.14.2 Interface</a>
<li><a href="#Setters">3.14.3 Setters</a>
<li><a href="#Yasos-examples">3.14.4 Examples</a>
</li></ul>
</li></ul>
<li><a name="toc_Textual-Conversion-Packages" href="#Textual-Conversion-Packages">4 Textual Conversion Packages</a>
<ul>
<li><a href="#Precedence-Parsing">4.1 Precedence Parsing</a>
<ul>
<li><a href="#Precedence-Parsing-Overview">4.1.1 Precedence Parsing Overview</a>
<li><a href="#Rule-Types">4.1.2 Rule Types</a>
<li><a href="#Ruleset-Definition-and-Use">4.1.3 Ruleset Definition and Use</a>
<li><a href="#Token-definition">4.1.4 Token definition</a>
<li><a href="#Nud-and-Led-Definition">4.1.5 Nud and Led Definition</a>
<li><a href="#Grammar-Rule-Definition">4.1.6 Grammar Rule Definition</a>
</li></ul>
<li><a href="#Format">4.2 Format (version 3.1)</a>
<ul>
<li><a href="#Format-Interface">4.2.1 Format Interface</a>
<li><a href="#Format-Specification">4.2.2 Format Specification (Format version 3.1)</a>
<ul>
<li><a href="#Format-Specification">4.2.2.1 Implemented CL Format Control Directives</a>
<li><a href="#Format-Specification">4.2.2.2 Not Implemented CL Format Control Directives</a>
<li><a href="#Format-Specification">4.2.2.3 Extended, Replaced and Additional Control Directives</a>
<li><a href="#Format-Specification">4.2.2.4 Configuration Variables</a>
<li><a href="#Format-Specification">4.2.2.5 Compatibility With Other Format Implementations</a>
</li></ul>
</li></ul>
<li><a href="#Standard-Formatted-I_002fO">4.3 Standard Formatted I/O</a>
<ul>
<li><a href="#Standard-Formatted-I_002fO">4.3.1 stdio</a>
<li><a href="#Standard-Formatted-Output">4.3.2 Standard Formatted Output</a>
<li><a href="#Standard-Formatted-Input">4.3.3 Standard Formatted Input</a>
</li></ul>
<li><a href="#Programs-and-Arguments">4.4 Program and Arguments</a>
<ul>
<li><a href="#Getopt">4.4.1 Getopt</a>
<li><a href="#Getopt">4.4.2 Getopt&mdash;</a>
<li><a href="#Command-Line">4.4.3 Command Line</a>
<li><a href="#Parameter-lists">4.4.4 Parameter lists</a>
<li><a href="#Getopt-Parameter-lists">4.4.5 Getopt Parameter lists</a>
<li><a href="#Filenames">4.4.6 Filenames</a>
<li><a href="#Batch">4.4.7 Batch</a>
</li></ul>
<li><a href="#HTML">4.5 HTML</a>
<li><a href="#HTML">4.6 HTML Forms</a>
<li><a href="#HTML-Tables">4.7 HTML Tables</a>
<ul>
<li><a href="#HTML-Tables">4.7.1 HTML editing tables</a>
<li><a href="#HTML-Tables">4.7.2 HTML databases</a>
</li></ul>
<li><a href="#HTTP-and-CGI">4.8 HTTP and CGI</a>
<li><a href="#Parsing-HTML">4.9 Parsing HTML</a>
<li><a href="#URI">4.10 URI</a>
<li><a href="#Parsing-XML">4.11 Parsing XML</a>
<ul>
<li><a href="#Parsing-XML">4.11.1 String Glue</a>
<li><a href="#Parsing-XML">4.11.2 Character and Token Functions</a>
<li><a href="#Parsing-XML">4.11.3 Data Types</a>
<li><a href="#Parsing-XML">4.11.4 Low-Level Parsers and Scanners</a>
<li><a href="#Parsing-XML">4.11.5 Mid-Level Parsers and Scanners</a>
<li><a href="#Parsing-XML">4.11.6 High-level Parsers</a>
<li><a href="#Parsing-XML">4.11.7 Parsing XML to SXML</a>
</li></ul>
<li><a href="#Printing-Scheme">4.12 Printing Scheme</a>
<ul>
<li><a href="#Generic_002dWrite">4.12.1 Generic-Write</a>
<li><a href="#Object_002dTo_002dString">4.12.2 Object-To-String</a>
<li><a href="#Pretty_002dPrint">4.12.3 Pretty-Print</a>
</li></ul>
<li><a href="#Time-and-Date">4.13 Time and Date</a>
<ul>
<li><a href="#Time-Zone">4.13.1 Time Zone</a>
<li><a href="#Posix-Time">4.13.2 Posix Time</a>
<li><a href="#Common_002dLisp-Time">4.13.3 Common-Lisp Time</a>
<li><a href="#Time-Infrastructure">4.13.4 Time Infrastructure</a>
</li></ul>
<li><a href="#NCBI_002dDNA">4.14 NCBI-DNA</a>
<li><a href="#Schmooz">4.15 Schmooz</a>
</li></ul>
<li><a name="toc_Mathematical-Packages" href="#Mathematical-Packages">5 Mathematical Packages</a>
<ul>
<li><a href="#Bit_002dTwiddling">5.1 Bit-Twiddling</a>
<ul>
<li><a href="#Bit_002dTwiddling">5.1.1 Bitwise Operations</a>
<li><a href="#Bit_002dTwiddling">5.1.2 Integer Properties</a>
<li><a href="#Bit_002dTwiddling">5.1.3 Bit Within Word</a>
<li><a href="#Bit_002dTwiddling">5.1.4 Field of Bits</a>
<li><a href="#Bit_002dTwiddling">5.1.5 Bits as Booleans</a>
</li></ul>
<li><a href="#Modular-Arithmetic">5.2 Modular Arithmetic</a>
<li><a href="#Irrational-Integer-Functions">5.3 Irrational Integer Functions</a>
<li><a href="#Irrational-Real-Functions">5.4 Irrational Real Functions</a>
<li><a href="#Prime-Numbers">5.5 Prime Numbers</a>
<li><a href="#Random-Numbers">5.6 Random Numbers</a>
<ul>
<li><a href="#Exact-Random-Numbers">5.6.1 Exact Random Numbers</a>
<li><a href="#Inexact-Random-Numbers">5.6.2 Inexact Random Numbers</a>
</li></ul>
<li><a href="#Discrete-Fourier-Transform">5.7 Discrete Fourier Transform</a>
<li><a href="#Cyclic-Checksum">5.8 Cyclic Checksum</a>
<li><a href="#Graphing">5.9 Graphing</a>
<ul>
<li><a href="#Character-Plotting">5.9.1 Character Plotting</a>
<li><a href="#PostScript-Graphing">5.9.2 PostScript Graphing</a>
<ul>
<li><a href="#Column-Ranges">5.9.2.1 Column Ranges</a>
<li><a href="#Drawing-the-Graph">5.9.2.2 Drawing the Graph</a>
<li><a href="#Graphics-Context">5.9.2.3 Graphics Context</a>
<li><a href="#Rectangles">5.9.2.4 Rectangles</a>
<li><a href="#Legending">5.9.2.5 Legending</a>
<li><a href="#Legacy-Plotting">5.9.2.6 Legacy Plotting</a>
<li><a href="#Example-Graph">5.9.2.7 Example Graph</a>
</li></ul>
</li></ul>
<li><a href="#Solid-Modeling">5.10 Solid Modeling</a>
<li><a href="#Color">5.11 Color</a>
<ul>
<li><a href="#Color-Data_002dType">5.11.1 Color Data-Type</a>
<ul>
<li><a href="#Color-Data_002dType">5.11.1.1 External Representation</a>
<li><a href="#Color-Data_002dType">5.11.1.2 White</a>
</li></ul>
<li><a href="#Color-Spaces">5.11.2 Color Spaces</a>
<li><a href="#Spectra">5.11.3 Spectra</a>
<li><a href="#Color-Difference-Metrics">5.11.4 Color Difference Metrics</a>
<li><a href="#Color-Conversions">5.11.5 Color Conversions</a>
<li><a href="#Color-Names">5.11.6 Color Names</a>
<li><a href="#Daylight">5.11.7 Daylight</a>
</li></ul>
<li><a href="#Root-Finding">5.12 Root Finding</a>
<li><a href="#Minimizing">5.13 Minimizing</a>
<li><a href="#The-Limit">5.14 The Limit</a>
<li><a href="#Commutative-Rings">5.15 Commutative Rings</a>
<li><a href="#Commutative-Rings">5.16 Rules and Rulesets</a>
<li><a href="#Commutative-Rings">5.17 How to Create a Commutative Ring</a>
<li><a href="#Matrix-Algebra">5.18 Matrix Algebra</a>
</li></ul>
<li><a name="toc_Database-Packages" href="#Database-Packages">6 Database Packages</a>
<ul>
<li><a href="#Relational-Database">6.1 Relational Database</a>
<ul>
<li><a href="#Using-Databases">6.1.1 Using Databases</a>
<li><a href="#Table-Operations">6.1.2 Table Operations</a>
<ul>
<li><a href="#Single-Row-Operations">6.1.2.1 Single Row Operations</a>
<li><a href="#Match_002dKeys">6.1.2.2 Match-Keys</a>
<li><a href="#Multi_002dRow-Operations">6.1.2.3 Multi-Row Operations</a>
<li><a href="#Indexed-Sequential-Access-Methods">6.1.2.4 Indexed Sequential Access Methods</a>
<li><a href="#Sequential-Index-Operations">6.1.2.5 Sequential Index Operations</a>
<li><a href="#Table-Administration">6.1.2.6 Table Administration</a>
</li></ul>
<li><a href="#Database-Interpolation">6.1.3 Database Interpolation</a>
<li><a href="#Embedded-Commands">6.1.4 Embedded Commands</a>
<ul>
<li><a href="#Database-Extension">6.1.4.1 Database Extension</a>
<li><a href="#Command-Intrinsics">6.1.4.2 Command Intrinsics</a>
<li><a href="#Define_002dtables-Example">6.1.4.3 Define-tables Example</a>
<li><a href="#The-_002acommands_002a-Table">6.1.4.4 The *commands* Table</a>
<li><a href="#Command-Service">6.1.4.5 Command Service</a>
<li><a href="#Command-Example">6.1.4.6 Command Example</a>
</li></ul>
<li><a href="#Database-Macros">6.1.5 Database Macros</a>
<ul>
<li><a href="#Within_002ddatabase">6.1.5.1 Within-database</a>
<li><a href="#Within_002ddatabase-Example">6.1.5.2 Within-database Example</a>
</li></ul>
<li><a href="#Database-Browser">6.1.6 Database Browser</a>
</li></ul>
<li><a href="#Relational-Infrastructure">6.2 Relational Infrastructure</a>
<ul>
<li><a href="#Base-Table">6.2.1 Base Table</a>
<ul>
<li><a href="#The-Base">6.2.1.1 The Base</a>
<li><a href="#Base-Tables">6.2.1.2 Base Tables</a>
<li><a href="#Base-Field-Types">6.2.1.3 Base Field Types</a>
<li><a href="#Composite-Keys">6.2.1.4 Composite Keys</a>
<li><a href="#Base-Record-Operations">6.2.1.5 Base Record Operations</a>
<li><a href="#Match-Keys">6.2.1.6 Match Keys</a>
<li><a href="#Aggregate-Base-Operations">6.2.1.7 Aggregate Base Operations</a>
<li><a href="#Base-ISAM-Operations">6.2.1.8 Base ISAM Operations</a>
</li></ul>
<li><a href="#Catalog-Representation">6.2.2 Catalog Representation</a>
<li><a href="#Relational-Database-Objects">6.2.3 Relational Database Objects</a>
<li><a href="#Database-Operations">6.2.4 Database Operations</a>
</li></ul>
<li><a href="#Weight_002dBalanced-Trees">6.3 Weight-Balanced Trees</a>
<ul>
<li><a href="#Construction-of-Weight_002dBalanced-Trees">6.3.1 Construction of Weight-Balanced Trees</a>
<li><a href="#Basic-Operations-on-Weight_002dBalanced-Trees">6.3.2 Basic Operations on Weight-Balanced Trees</a>
<li><a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">6.3.3 Advanced Operations on Weight-Balanced Trees</a>
<li><a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">6.3.4 Indexing Operations on Weight-Balanced Trees</a>
</li></ul>
</li></ul>
<li><a name="toc_Other-Packages" href="#Other-Packages">7 Other Packages</a>
<ul>
<li><a href="#Data-Structures">7.1 Data Structures</a>
<ul>
<li><a href="#Arrays">7.1.1 Arrays</a>
<li><a href="#Subarrays">7.1.2 Subarrays</a>
<li><a href="#Array-Mapping">7.1.3 Array Mapping</a>
<li><a href="#Array-Interpolation">7.1.4 Array Interpolation</a>
<li><a href="#Association-Lists">7.1.5 Association Lists</a>
<li><a href="#Byte">7.1.6 Byte</a>
<li><a href="#Byte_002fNumber-Conversions">7.1.7 Byte/Number Conversions</a>
<li><a href="#MAT_002dFile-Format">7.1.8 MAT-File Format</a>
<li><a href="#Portable-Image-Files">7.1.9 Portable Image Files</a>
<li><a href="#Collections">7.1.10 Collections</a>
<li><a href="#Dynamic-Data-Type">7.1.11 Dynamic Data Type</a>
<li><a href="#Hash-Tables">7.1.12 Hash Tables</a>
<li><a href="#Object">7.1.13 Macroless Object System</a>
<li><a href="#Object">7.1.14 Concepts</a>
<li><a href="#Object">7.1.15 Procedures</a>
<li><a href="#Object">7.1.16 Examples</a>
<ul>
<li><a href="#Object">7.1.16.1 Inverter Documentation</a>
<li><a href="#Object">7.1.16.2 Number Documention</a>
<li><a href="#Object">7.1.16.3 Inverter code</a>
</li></ul>
<li><a href="#Priority-Queues">7.1.17 Priority Queues</a>
<li><a href="#Queues">7.1.18 Queues</a>
<li><a href="#Records">7.1.19 Records</a>
</li></ul>
<li><a href="#Sorting-and-Searching">7.2 Sorting and Searching</a>
<ul>
<li><a href="#Common-List-Functions">7.2.1 Common List Functions</a>
<ul>
<li><a href="#List-construction">7.2.1.1 List construction</a>
<li><a href="#Lists-as-sets">7.2.1.2 Lists as sets</a>
<li><a href="#Lists-as-sequences">7.2.1.3 Lists as sequences</a>
<li><a href="#Destructive-list-operations">7.2.1.4 Destructive list operations</a>
<li><a href="#Non_002dList-functions">7.2.1.5 Non-List functions</a>
</li></ul>
<li><a href="#Tree-Operations">7.2.2 Tree operations</a>
<li><a href="#Chapter-Ordering">7.2.3 Chapter Ordering</a>
<li><a href="#Sorting">7.2.4 Sorting</a>
<li><a href="#Topological-Sort">7.2.5 Topological Sort</a>
<li><a href="#Hashing">7.2.6 Hashing</a>
<li><a href="#Space_002dFilling-Curves">7.2.7 Space-Filling Curves</a>
<ul>
<li><a href="#Multidimensional-Space_002dFilling-Curves">7.2.7.1 Multidimensional Space-Filling Curves</a>
<li><a href="#Hilbert-Space_002dFilling-Curve">7.2.7.2 Hilbert Space-Filling Curve</a>
<li><a href="#Hilbert-Space_002dFilling-Curve">7.2.7.3 Gray code</a>
<li><a href="#Hilbert-Space_002dFilling-Curve">7.2.7.4 Bitwise Lamination</a>
<li><a href="#Peano-Space_002dFilling-Curve">7.2.7.5 Peano Space-Filling Curve</a>
<li><a href="#Sierpinski-Curve">7.2.7.6 Sierpinski Curve</a>
</li></ul>
<li><a href="#Soundex">7.2.8 Soundex</a>
<li><a href="#String-Search">7.2.9 String Search</a>
<li><a href="#Sequence-Comparison">7.2.10 Sequence Comparison</a>
</li></ul>
<li><a href="#Procedures">7.3 Procedures</a>
<ul>
<li><a href="#Type-Coercion">7.3.1 Type Coercion</a>
<li><a href="#String_002dCase">7.3.2 String-Case</a>
<li><a href="#String-Ports">7.3.3 String Ports</a>
<li><a href="#Line-I_002fO">7.3.4 Line I/O</a>
<li><a href="#Multi_002dProcessing">7.3.5 Multi-Processing</a>
<li><a href="#Metric-Units">7.3.6 Metric Units</a>
<ul>
<li><a href="#Metric-Units">7.3.6.1 SI Prefixes</a>
<li><a href="#Metric-Units">7.3.6.2 Binary Prefixes</a>
<li><a href="#Metric-Units">7.3.6.3 Unit Symbols</a>
</li></ul>
</li></ul>
<li><a href="#Standards-Support">7.4 Standards Support</a>
<ul>
<li><a href="#RnRS">7.4.1 RnRS</a>
<li><a href="#With_002dFile">7.4.2 With-File</a>
<li><a href="#Transcripts">7.4.3 Transcripts</a>
<li><a href="#Rev2-Procedures">7.4.4 Rev2 Procedures</a>
<li><a href="#Rev4-Optional-Procedures">7.4.5 Rev4 Optional Procedures</a>
<li><a href="#Multi_002dargument-_002f-and-_002d">7.4.6 Multi-argument / and -</a>
<li><a href="#Multi_002dargument-Apply">7.4.7 Multi-argument Apply</a>
<li><a href="#Rationalize">7.4.8 Rationalize</a>
<li><a href="#Promises">7.4.9 Promises</a>
<li><a href="#Dynamic_002dWind">7.4.10 Dynamic-Wind</a>
<li><a href="#Eval">7.4.11 Eval</a>
<li><a href="#Values">7.4.12 Values</a>
<li><a href="#SRFI">7.4.13 SRFI</a>
<ul>
<li><a href="#SRFI_002d1">7.4.13.1 SRFI-1</a>
</li></ul>
</li></ul>
<li><a href="#Session-Support">7.5 Session Support</a>
<ul>
<li><a href="#Repl">7.5.1 Repl</a>
<li><a href="#Quick-Print">7.5.2 Quick Print</a>
<li><a href="#Debug">7.5.3 Debug</a>
<li><a href="#Breakpoints">7.5.4 Breakpoints</a>
<li><a href="#Trace">7.5.5 Tracing</a>
</li></ul>
<li><a href="#System-Interface">7.6 System Interface</a>
<ul>
<li><a href="#Directories">7.6.1 Directories</a>
<li><a href="#Transactions">7.6.2 Transactions</a>
<li><a href="#CVS">7.6.3 CVS</a>
</li></ul>
<li><a href="#Extra_002dSLIB-Packages">7.7 Extra-SLIB Packages</a>
</li></ul>
<li><a name="toc_About-SLIB" href="#About-SLIB">8 About SLIB</a>
<ul>
<li><a href="#Installation">8.1 Installation</a>
<ul>
<li><a href="#Installation">8.1.1 Unpacking the SLIB Distribution</a>
<li><a href="#Installation">8.1.2 Install documentation and slib script</a>
<li><a href="#Installation">8.1.3 Configure Scheme Implementation to Locate SLIB</a>
<li><a href="#Installation">8.1.4 Configure Scheme Implementation to Locate and Implementation Directory</a>
<li><a href="#Installation">8.1.5 Loading SLIB Initialization File</a>
<li><a href="#Installation">8.1.6 Build New SLIB Catalog for the Implementation</a>
<li><a href="#Installation">8.1.7 Implementation-specific Instructions</a>
</li></ul>
<li><a href="#The-SLIB-script">8.2 The SLIB script</a>
<li><a href="#Porting">8.3 Porting</a>
<li><a href="#Compiled-and-Implementation_002dSpecific-Features">8.4 Compiled and Implementation-Specific Features</a>
<li><a href="#Coding-Guidelines">8.5 Coding Guidelines</a>
<ul>
<li><a href="#Coding-Guidelines">8.5.1 Modifications</a>
</li></ul>
<li><a href="#Copyrights">8.6 Copyrights</a>
<ul>
<li><a href="#Copyrights">8.6.1 Putting code into the Public Domain</a>
<li><a href="#Copyrights">8.6.2 Explicit copying terms</a>
<li><a href="#Copyrights">8.6.3 Example: Company Copyright Disclaimer</a>
</li></ul>
<li><a href="#About-this-manual">8.7 About this manual</a>
<ul>
<li><a href="#GNU-Free-Documentation-License">8.7.1 GNU Free Documentation License</a>
</li></ul>
</li></ul>
<li><a name="toc_Index" href="#Index">Index</a>
<li><a name="toc_Procedure-and-Macro-Index" href="#Procedure-and-Macro-Index">Procedure and Macro Index</a>
<li><a name="toc_Variable-Index" href="#Variable-Index">Variable Index</a>
<li><a name="toc_Concept-and-Feature-Index" href="#Concept-and-Feature-Index">Concept and Feature Index</a>
</li></ul>
</div>



<div class="node">
<a name="Top"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-Library-System">The Library System</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dir">(dir)</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h2 class="unnumbered">SLIB</h2>

<p class="noindent">This manual is for SLIB (version 3b5, January 2015),
the portable Scheme library.

<p class="noindent"><!-- Copyright (C) 1993 Todd R. Eigenschink@* -->
Copyright &copy; 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.

  <blockquote>
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled &ldquo;GNU Free
Documentation License.&rdquo;
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#The-Library-System">The Library System</a>:           How to use and customize. 
<li><a accesskey="2" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>:    Provided for all implementations. 
<li><a accesskey="3" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>
<li><a accesskey="4" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>
<li><a accesskey="5" href="#Mathematical-Packages">Mathematical Packages</a>
<li><a accesskey="6" href="#Database-Packages">Database Packages</a>
<li><a accesskey="7" href="#Other-Packages">Other Packages</a>
<li><a accesskey="8" href="#About-SLIB">About SLIB</a>:                   Install, etc. 
<li><a accesskey="9" href="#Index">Index</a>
</ul>

<div class="node">
<a name="The-Library-System"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 The Library System</h2>

<p class="noindent"><dfn>SLIB</dfn> is a portable library for the programming language
<dfn>Scheme</dfn>.  It provides a platform independent framework for using
<dfn>packages</dfn> of Scheme procedures and syntax.  As distributed, SLIB
contains useful packages for all Scheme implementations.  Its catalog
can be transparently extended to accomodate packages specific to a site,
implementation, user, or directory.

<ul class="menu">
<li><a accesskey="1" href="#Feature">Feature</a>:                      SLIB names. 
<li><a accesskey="2" href="#Require">Require</a>
<li><a accesskey="3" href="#Library-Catalogs">Library Catalogs</a>
<li><a accesskey="4" href="#Catalog-Creation">Catalog Creation</a>
<li><a accesskey="5" href="#Catalog-Vicinities">Catalog Vicinities</a>
<li><a accesskey="6" href="#Compiling-Scheme">Compiling Scheme</a>
</ul>

<div class="node">
<a name="Feature"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Require">Require</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-Library-System">The Library System</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library-System">The Library System</a>

</div>

<h3 class="section">1.1 Feature</h3>

<p class="noindent"><a name="index-feature-1"></a>SLIB denotes <dfn>features</dfn> by symbols.  SLIB maintains a list of
features supported by a Scheme <dfn>session</dfn>.  The set of features
<a name="index-session-2"></a>provided by a session may change during that session.  Some features
are properties of the Scheme implementation being used.  The following
<a name="index-intrinsic-feature-3"></a><dfn>intrinsic feature</dfn>s detail what sort of numbers are available
from an implementation:

  <p><a name="index-inexact-4"></a><a name="index-rational-5"></a><a name="index-real-6"></a><a name="index-complex-7"></a><a name="index-bignum-8"></a>
     <ul>
<li>'inexact
<li>'rational
<li>'real
<li>'complex
<li>'bignum
</ul>

<p class="noindent">SLIB initialization (in <samp><span class="file">require.scm</span></samp>) tests and <dfn>provide</dfn>s
any of these numeric features which are appropriate.

<p class="noindent">Other features correspond to the presence of packages of Scheme
procedures or syntax (macros).

<div class="defun">
&mdash; Function: <b>provided?</b><var> feature<a name="index-provided_003f-9"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>feature</var> is present in the current Scheme
session; otherwise <code>#f</code>.  More specifically, <code>provided?</code>
returns <code>#t</code> if the symbol <var>feature</var> is the
<code>software-type</code>, the <code>scheme-implementation-type</code>
<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>, or if <var>feature</var> has been provided by a module
already loaded; and <code>#f</code> otherwise.

       <p>In some implementations <code>provided?</code> tests whether a module has
been <code>require</code>d by any module or in any thread; other
implementations will have <code>provided?</code> reflect only the modules
<code>require</code>d by that particular session or thread.

       <p>To work portably in both scenarios, use <code>provided?</code> only to test
whether intrinsic properties (like those above) are present.

       <p>The <var>feature</var> argument can also be an expression calling
<code>and</code>, <code>or</code>, and <code>not</code> of features.  The boolean result
of the logical question asked by <var>feature</var> is returned. 
</p></blockquote></div>

<p class="noindent">The generalization of <code>provided?</code> for arbitrary features and catalog
is <code>feature-eval</code>:

<div class="defun">
&mdash; Function: <b>feature-eval</b><var> expression provided?<a name="index-feature_002deval-10"></a></var><br>
<blockquote><p>Evaluates <code>and</code>, <code>or</code>, and <code>not</code> forms in
<var>expression</var>, using the values returned by calling <var>provided?</var>
on the leaf symbols.  <code>feature-eval</code> returns the boolean result
of the logical combinations. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>provide</b><var> feature<a name="index-provide-11"></a></var><br>
<blockquote><p>Informs SLIB that <var>feature</var> is supported in this session. 
</p></blockquote></div>

<pre class="example">     (provided? 'foo)    &rArr; #f
     (provide 'foo)
     (provided? 'foo)    &rArr; #t
</pre>
  <!-- @defvar slib:features -->
<!-- Is a list of symbols denoting features present in this implementation. -->
<!-- @var{slib:features} can grow as modules are @code{require}d. -->
<!-- @footnote{The variables @var{*modules*} and @var{slib:features} were -->
<!-- originally modeled on variables of the same names in common-lisp.  But -->
<!-- the distinction between features native to an implementation versus -->
<!-- those provided by loading files was not useful.  The symbols in -->
<!-- @var{slib:features} now indicate the presence of a capability regardless -->
<!-- of how it was provided.} -->
<!-- @end defvar -->
<div class="node">
<a name="Require"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Library-Catalogs">Library Catalogs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Feature">Feature</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library-System">The Library System</a>

</div>

<h3 class="section">1.2 Require</h3>

<p class="noindent"><a name="index-catalog-12"></a>SLIB creates and maintains a <dfn>catalog</dfn> mapping features to locations
of files introducing procedures and syntax denoted by those features.

<div class="defun">
&mdash; Variable: <b>*catalog*</b><var><a name="index-g_t_002acatalog_002a-13"></a></var><br>
<blockquote><p>Is an association list of features (symbols) and pathnames which will
supply those features.  The pathname can be either a string or a pair. 
If pathname is a pair then the first element should be a macro feature
symbol, <code>source</code>, <code>compiled</code>, or one of the other cases
described in <a href="#Library-Catalogs">Library Catalogs</a>.  The cdr of the pathname should
be either a string or a list. 
</p></blockquote></div>

<p class="noindent">At the beginning of each section of this manual, there is a line like
<code>(require '</code><var>feature</var><code>)</code>. 
<a name="index-feature-14"></a>The Scheme files comprising SLIB are cataloged so that these feature
names map to the corresponding files.

<p class="noindent">SLIB provides a form, <code>require</code>, which loads the files providing
the requested feature.

<div class="defun">
&mdash; Procedure: <b>require</b><var> feature<a name="index-require-15"></a></var><br>
<blockquote><ul>
<li>If <code>(provided? </code><var>feature</var><code>)</code> is true,
then <code>require</code> just returns. 
<li>Otherwise, if <var>feature</var> is found in the catalog, then the
corresponding files will be loaded and <code>(provided? 
</code><var>feature</var><code>)</code> will henceforth return <code>#t</code>.  That <var>feature</var>
is thereafter <code>provided</code>. 
<li>Otherwise (<var>feature</var> not found in the catalog), an error is
signaled. 
</ul>
       </p></blockquote></div>

<p class="noindent">There is a related form <code>require-if</code>, used primarily for enabling
compilers to statically include modules which would be dynamically
loaded by interpreters.

<div class="defun">
&mdash; Procedure: <b>require-if</b><var> condition feature<a name="index-require_002dif-16"></a></var><br>
<blockquote>
       <p>Requires <var>feature</var> if <var>condition</var> is true. 
</p></blockquote></div>

<p class="noindent">The <code>random</code> module uses <code>require-if</code> to flag
<code>object-&gt;string</code> as a (dynamic) required module.

<pre class="example">     (require 'byte)
     (require 'logical)
     (require-if 'compiling 'object-&gt;string)
</pre>
  <p class="noindent">The <code>batch</code> module uses <code>require-if</code> to flag
<code>posix-time</code> as a module to load if the implementation supports
large precision exact integers.

<pre class="example">     (require-if '(and bignum compiling) 'posix-time)
</pre>
  <p class="noindent">The catalog can also be queried using <code>slib:in-catalog?</code>.

<div class="defun">
&mdash; Function: <b>slib:in-catalog?</b><var> feature<a name="index-slib_003ain_002dcatalog_003f-17"></a></var><br>
<blockquote><p>Returns a <code>CDR</code> of the catalog entry if one was found for the
symbol <var>feature</var> in the alist <code>*catalog*</code> (and transitively
through any symbol aliases encountered).  Otherwise, returns
<code>#f</code>.  The format of catalog entries is explained in
<a href="#Library-Catalogs">Library Catalogs</a>. 
</p></blockquote></div>

<div class="node">
<a name="Library-Catalogs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Catalog-Creation">Catalog Creation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Require">Require</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library-System">The Library System</a>

</div>

<h3 class="section">1.3 Library Catalogs</h3>

<p class="noindent">Catalog files consist of one or more <dfn>association list</dfn>s. 
<a name="index-Catalog-File-18"></a>In the circumstance where a feature symbol appears in more than one
list, the latter list's association is retrieved.  Here are the
supported formats for elements of catalog lists:

     <dl>
<dt><code>(</code><var>feature</var><code> . </code><i>&lt;symbol&gt;</i><code>)</code><dd>Redirects to the feature named <i>&lt;symbol&gt;</i>. 
<br><dt><code>(</code><var>feature</var><code> . "</code><i>&lt;path&gt;</i><code>")</code><dd>Loads file <i>&lt;path&gt;</i>. 
<br><dt><code>(</code><var>feature</var><code> source "</code><i>&lt;path&gt;"</i><code>)</code><dd><a name="index-source-19"></a><code>slib:load</code>s the Scheme source file <i>&lt;path&gt;</i>. 
<br><dt><code>(</code><var>feature</var><code> compiled "</code><i>&lt;path&gt;"</i><code> ...)</code><dd><a name="index-compiled-20"></a><code>slib:load-compiled</code>s the files <i>&lt;path&gt;</i> <small class="dots">...</small>. 
<br><dt><code>(</code><var>feature</var><code> aggregate </code><i>&lt;symbol&gt;</i><code> ...)</code><dd><a name="index-aggregate-21"></a><code>require</code>s the features <i>&lt;symbol&gt;</i> <small class="dots">...</small>. 
</dl>

<p class="noindent">The various macro styles first <code>require</code> the named macro package,
then just load <i>&lt;path&gt;</i> or load-and-macro-expand <i>&lt;path&gt;</i> as
appropriate for the implementation.

     <dl>
<dt><code>(</code><var>feature</var><code> defmacro "</code><i>&lt;path&gt;"</i><code>)</code><dd><a name="index-defmacro-22"></a><code>defmacro:load</code>s the Scheme source file <i>&lt;path&gt;</i>. 
<br><dt><code>(</code><var>feature</var><code> macro-by-example "</code><i>&lt;path&gt;"</i><code>)</code><dd><a name="index-macro_002dby_002dexample-23"></a><code>defmacro:load</code>s the Scheme source file <i>&lt;path&gt;</i>. 
</dl>

     <dl>
<dt><code>(</code><var>feature</var><code> macro "</code><i>&lt;path&gt;"</i><code>)</code><dd><a name="index-macro-24"></a><code>macro:load</code>s the Scheme source file <i>&lt;path&gt;</i>. 
<br><dt><code>(</code><var>feature</var><code> macros-that-work "</code><i>&lt;path&gt;"</i><code>)</code><dd><a name="index-macros_002dthat_002dwork-25"></a><code>macro:load</code>s the Scheme source file <i>&lt;path&gt;</i>. 
<br><dt><code>(</code><var>feature</var><code> syntax-case "</code><i>&lt;path&gt;"</i><code>)</code><dd><a name="index-syntax_002dcase-26"></a><code>macro:load</code>s the Scheme source file <i>&lt;path&gt;</i>. 
<br><dt><code>(</code><var>feature</var><code> syntactic-closures "</code><i>&lt;path&gt;"</i><code>)</code><dd><a name="index-syntactic_002dclosures-27"></a><code>macro:load</code>s the Scheme source file <i>&lt;path&gt;</i>. 
</dl>

<div class="node">
<a name="Catalog-Creation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Catalog-Vicinities">Catalog Vicinities</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Library-Catalogs">Library Catalogs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library-System">The Library System</a>

</div>

<h3 class="section">1.4 Catalog Creation</h3>

<p class="noindent">At the start of an interactive session no catalog is present, but is
created with the first catalog inquiry (such as <code>(require
'random)</code>).  Several sources of catalog information are combined to
produce the catalog:

     <ul>
<li>standard SLIB packages. 
<li>additional packages of interest to this site. 
<li>packages specifically for the variety of Scheme which this session is
running.  This catalog, if it exists, is the file <samp><span class="file">implcat</span></samp> in
<code>implementation-invicinity</code>, which is created by loading
<samp><span class="file">mkimpcat.scm</span></samp> in <code>implementation-invicinity</code> if it exists. 
<li>packages this user wants to always have available.  This catalog is the
file <samp><span class="file">homecat</span></samp> in the user's <dfn>HOME</dfn> directory. 
<a name="index-HOME-28"></a><li>packages germane to working in this (current working) directory.  This
catalog is the file <samp><span class="file">usercat</span></samp> in the directory to which it applies. 
One would typically <code>cd</code> to this directory before starting the
Scheme session. 
<li>packages which are part of an application program. 
</ul>

<p class="noindent">SLIB combines the catalog information which doesn't vary per user into
the file <samp><span class="file">slibcat</span></samp> in the implementation-vicinity.  Therefore
<samp><span class="file">slibcat</span></samp> needs change only when new software is installed or
compiled.  Because the actual pathnames of files can differ from
installation to installation, SLIB builds a separate catalog for each
implementation it is used with.

<p class="noindent">The definition of <code>*slib-version*</code> in SLIB file
<samp><span class="file">require.scm</span></samp> is checked against the catalog association of
<code>*slib-version*</code> to ascertain when versions have changed.  It is
a reasonable practice to change the definition of
<code>*slib-version*</code> whenever the library is changed.  If multiple
implementations of Scheme use SLIB, remember that recompiling one
<samp><span class="file">slibcat</span></samp> will update only that implementation's catalog.

<p class="noindent">The compilation scripts of Scheme implementations which work with SLIB
can automatically trigger catalog compilation by deleting
<samp><span class="file">slibcat</span></samp> or by invoking <code>require</code> of a special feature:

<div class="defun">
&mdash; Procedure: <b>require</b> <span class="roman">'new-catalog</span><var><a name="index-require-29"></a></var><br>
<blockquote><p><a name="index-new_002dcatalog-30"></a>This will load <samp><span class="file">mklibcat</span></samp>, which compiles and writes a new
<samp><span class="file">slibcat</span></samp>. 
</p></blockquote></div>

<p class="noindent">Another special feature of <code>require</code> erases SLIB's catalog,
forcing it to be reloaded the next time the catalog is queried.

<div class="defun">
&mdash; Procedure: <b>require</b> <span class="roman">#f</span><var><a name="index-require-31"></a></var><br>
<blockquote><p>Removes SLIB's catalog information.  This should be done before saving
an executable image so that, when restored, its catalog will be loaded
afresh. 
</p></blockquote></div>

<div class="node">
<a name="Catalog-Vicinities"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Compiling-Scheme">Compiling Scheme</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Catalog-Creation">Catalog Creation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library-System">The Library System</a>

</div>

<h3 class="section">1.5 Catalog Vicinities</h3>

<p class="noindent">Each file in the table below is descibed in terms of its
file-system independent <dfn>vicinity</dfn> (see <a href="#Vicinity">Vicinity</a>).  The entries
of a catalog in the table override those of catalogs above it in the
table.

     <dl>
<dt><code>implementation-vicinity</code> <samp><span class="file">slibcat</span></samp><dd><a name="index-slibcat-32"></a>This file contains the associations for the packages comprising SLIB,
the <samp><span class="file">implcat</span></samp> and the <samp><span class="file">sitecat</span></samp>s.  The associations in the
other catalogs override those of the standard catalog.

     <br><dt><code>library-vicinity</code> <samp><span class="file">mklibcat.scm</span></samp><dd><a name="index-mklibcat_002escm-33"></a>creates <samp><span class="file">slibcat</span></samp>.

     <br><dt><code>library-vicinity</code> <samp><span class="file">sitecat</span></samp><dd><a name="index-sitecat-34"></a>This file contains the associations specific to an SLIB installation.

     <br><dt><code>implementation-vicinity</code> <samp><span class="file">implcat</span></samp><dd><a name="index-implcat-35"></a>This file contains the associations specific to an implementation of
Scheme.  Different implementations of Scheme should have different
<code>implementation-vicinity</code>.

     <br><dt><code>implementation-vicinity</code> <samp><span class="file">mkimpcat.scm</span></samp><dd><a name="index-mkimpcat_002escm-36"></a>if present, creates <samp><span class="file">implcat</span></samp>.

     <br><dt><code>implementation-vicinity</code> <samp><span class="file">sitecat</span></samp><dd><a name="index-sitecat-37"></a>This file contains the associations specific to a Scheme implementation
installation.

     <br><dt><code>home-vicinity</code> <samp><span class="file">homecat</span></samp><dd><a name="index-homecat-38"></a>This file contains the associations specific to an SLIB user.

     <br><dt><code>user-vicinity</code> <samp><span class="file">usercat</span></samp><dd><a name="index-usercat-39"></a>This file contains associations affecting only those sessions whose
<dfn>working directory</dfn> is <code>user-vicinity</code>.

  </dl>

<p class="noindent">Here is an example of a <samp><span class="file">usercat</span></samp> catalog.  A program in this
directory can invoke the &lsquo;<samp><span class="samp">run</span></samp>&rsquo; feature with <code>(require 'run)</code>.

<pre class="example">     ;;; "usercat": SLIB catalog additions for SIMSYNCH.     -*-scheme-*-
     (
      (simsynch      . "../synch/simsynch.scm")
      (run           . "../synch/run.scm")
      (schlep        . "schlep.scm")
     )
</pre>
  <p class="noindent">Copying <samp><span class="file">usercat</span></samp> to many directories is inconvenient. 
Application programs which aren't always run in specially prepared
directories can nonetheless register their features during
initialization.

<div class="defun">
&mdash; Procedure: <b>catalog:read</b><var> vicinity catalog<a name="index-catalog_003aread-40"></a></var><br>
<blockquote><p>Reads file named by string <var>catalog</var> in <var>vicinity</var>, resolving
all paths relative to <var>vicinity</var>, and adds those feature
associations to <var>*catalog*</var>.

       <p><code>catalog:read</code> would typically be used by an application program
having dynamically loadable modules.  For instance, to register
factoring and other modules in <var>*catalog*</var>, JACAL does:

     <pre class="example">          (catalog:read (program-vicinity) "jacalcat")
</pre>
       </blockquote></div>

<p class="noindent">For an application program there are three appropriate venues for
registering its catalog associations:

     <ul>
<li>in a <samp><span class="file">usercat</span></samp> file in the directory where the program runs; or
<li>in an <samp><span class="file">implcat</span></samp> file in the <code>implementation-vicinity</code>; or
<li>in an application program directory; loaded by calling
<code>catalog:read</code>. 
</ul>

<div class="node">
<a name="Compiling-Scheme"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Catalog-Vicinities">Catalog Vicinities</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library-System">The Library System</a>

</div>

<h3 class="section">1.6 Compiling Scheme</h3>

<p>To use Scheme compilers effectively with SLIB the compiler needs to
know which SLIB modules are to be compiled and which symbols are
exported from those modules.

  <p>The procedures in this section automate the extraction of this
information from SLIB modules.  They are guaranteed to work on SLIB
modules; to use them on other sources, those sources should follow
SLIB conventions.

<ul class="menu">
<li><a accesskey="1" href="#Module-Conventions">Module Conventions</a>
<li><a accesskey="2" href="#Module-Manifests">Module Manifests</a>
<li><a accesskey="3" href="#Module-Semantics">Module Semantics</a>
<li><a accesskey="4" href="#Top_002dlevel-Variable-References">Top-level Variable References</a>
<li><a accesskey="5" href="#Module-Analysis">Module Analysis</a>
</ul>

<div class="node">
<a name="Module-Conventions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Module-Manifests">Module Manifests</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Compiling-Scheme">Compiling Scheme</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Compiling-Scheme">Compiling Scheme</a>

</div>

<h4 class="subsection">1.6.1 Module Conventions</h4>

     <ul>
<li>All the top-level <code>require</code> commands have one quoted argument and
are positioned before other Scheme definitions and expressions in the
file. 
<li>Any conditionally <code>require</code>d SLIB modules
<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a>
also appear at the beginning of their files conditioned on the feature
<a name="index-compiling-41"></a><code>compiling</code> using <code>require-if</code>
(see <a href="#Require">require-if</a>).

     <pre class="example">          (require 'logical)
          (require 'multiarg/and-)
          (require-if 'compiling 'sort)
          (require-if 'compiling 'ciexyz)
</pre>
     <li>Schmooz-style comments preceding a definition, identify that
definition as an exported identifier (see <a href="#Schmooz">Schmooz</a>).  For
non-schmooz files, putting &lsquo;<samp><span class="samp">;@</span></samp>&rsquo; at the beginning of the line
immediately preceding the definition (<code>define</code>,
<code>define-syntax</code>, or <code>defmacro</code>) suffices.

     <pre class="example">          ;@
          (define (identity &lt;obj&gt;) &lt;obj&gt;)
</pre>
     <li>Syntax (macro) definitions are grouped at the end of a module file.

     <li>Modules defining macros do not invoke those macros.  SLIB macro
implementations are exempt from this rule.

     <p>An example of how to expand macro invocations is:

     <pre class="example">          (require 'macros-that-work)
          (require 'yasos)
          (require 'pprint-file)
          (pprint-filter-file "collect.scm" macwork:expand)
</pre>
     </ul>

<div class="node">
<a name="Module-Manifests"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Module-Semantics">Module Semantics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Module-Conventions">Module Conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Compiling-Scheme">Compiling Scheme</a>

</div>

<h4 class="subsection">1.6.2 Module Manifests</h4>

<p><code>(require 'manifest)</code>
<a name="index-manifest-42"></a>
In some of these examples, <var>slib:catalog</var> is the SLIB part of
the catalog; it is free of compiled and implementation-specific
entries.  It would be defined by:

<pre class="example">     (define slib:catalog (cdr (member (assq 'null *catalog*) *catalog*)))
</pre>
  <div class="defun">
&mdash; Function: <b>file-&gt;requires</b><var> file provided? catalog<a name="index-file_002d_003erequires-43"></a></var><br>
<blockquote>
       <p>Returns a list of the features <code>require</code>d by <var>file</var> assuming the
predicate <var>provided?</var> and association-list <var>catalog</var>. 
</p></blockquote></div>

<pre class="example">     (define (provided+? . features)
       (lambda (feature)
         (or (memq feature features) (provided? feature))))
     
     (file-&gt;requires "obj2str.scm" (provided+? 'compiling) '())
             &rArr; (string-port generic-write)
     
     (file-&gt;requires "obj2str.scm" provided? '())
             &rArr; (string-port)
</pre>
  <div class="defun">
&mdash; Function: <b>feature-&gt;requires</b><var> feature provided? catalog<a name="index-feature_002d_003erequires-44"></a></var><br>
<blockquote>
       <p>Returns a list of the features <code>require</code>d by <var>feature</var> assuming the
predicate <var>provided?</var> and association-list <var>catalog</var>. 
</p></blockquote></div>

<pre class="example">     (feature-&gt;requires 'batch (provided+? 'compiling) *catalog*)
             &rArr; (tree line-i/o databases parameters string-port
                        pretty-print common-list-functions posix-time)
     
     (feature-&gt;requires 'batch provided? *catalog*)
             &rArr; (tree line-i/o databases parameters string-port
                        pretty-print common-list-functions)
     
     (feature-&gt;requires 'batch provided? '((batch . "batch")))
             &rArr; (tree line-i/o databases parameters string-port
                        pretty-print common-list-functions)
</pre>
  <div class="defun">
&mdash; Function: <b>feature-&gt;requires*</b><var> feature provided? catalog<a name="index-feature_002d_003erequires_002a-45"></a></var><br>
<blockquote>
       <p>Returns a list of the features transitively <code>require</code>d by <var>feature</var>
assuming the predicate <var>provided?</var> and association-list <var>catalog</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-&gt;requires*</b><var> file provided? catalog<a name="index-file_002d_003erequires_002a-46"></a></var><br>
<blockquote>
       <p>Returns a list of the features transitively <code>require</code>d by <var>file</var>
assuming the predicate <var>provided?</var> and association-list <var>catalog</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-&gt;loads</b><var> file<a name="index-file_002d_003eloads-47"></a></var><br>
<blockquote>
       <p>Returns a list of strings naming existing files loaded (load
slib:load slib:load-source macro:load defmacro:load syncase:load
synclo:load macwork:load) by <var>file</var> or any of the files it loads. 
</p></blockquote></div>

<pre class="example">     (file-&gt;loads (in-vicinity (library-vicinity) "scainit.scm"))
             &rArr; ("/usr/local/lib/slib/scaexpp.scm"
                 "/usr/local/lib/slib/scaglob.scm"
                 "/usr/local/lib/slib/scaoutp.scm")
</pre>
  <div class="defun">
&mdash; Function: <b>load-&gt;path</b><var> exp<a name="index-load_002d_003epath-48"></a></var><br>
<blockquote>
       <p>Given a <code>(load '&lt;expr&gt;)</code>, where &lt;expr&gt; is a string or vicinity
stuff), <code>(load-&gt;path &lt;expr&gt;)</code> figures a path to the file. 
<code>load-&gt;path</code> returns that path if it names an existing file; otherwise #f. 
</p></blockquote></div>

<pre class="example">     (load-&gt;path '(in-vicinity (library-vicinity) "mklibcat"))
             &rArr; "/usr/local/lib/slib/mklibcat.scm"
</pre>
  <div class="defun">
&mdash; Function: <b>file-&gt;definitions</b><var> file definer <small class="dots">...</small><a name="index-file_002d_003edefinitions-49"></a></var><br>
<blockquote>
       <p>Returns a list of the identifier symbols defined by SLIB (or
SLIB-style) file <var>file</var>.  The optional arguments <var>definers</var> should be symbols
signifying a defining form.  If none are supplied, then the symbols
<code>define-operation</code>, <code>define</code>, <code>define-syntax</code>, and
<code>defmacro</code> are captured. 
</p></blockquote></div>

<pre class="example">     (file-&gt;definitions "random.scm")
             &rArr; (*random-state* make-random-state
                seed-&gt;random-state copy-random-state random
                random:chunk)
</pre>
  <div class="defun">
&mdash; Function: <b>file-&gt;exports</b><var> file definer <small class="dots">...</small><a name="index-file_002d_003eexports-50"></a></var><br>
<blockquote>
       <p>Returns a list of the identifier symbols exported (advertised) by
SLIB (or SLIB-style) file <var>file</var>.  The optional arguments <var>definers</var> should be
symbols signifying a defining form.  If none are supplied, then the
symbols <code>define-operation</code>, <code>define</code>,
<code>define-syntax</code>, and <code>defmacro</code> are captured. 
</p></blockquote></div>

<pre class="example">     (file-&gt;exports "random.scm")
             &rArr; (make-random-state seed-&gt;random-state
                 copy-random-state random)
     
     (file-&gt;exports "randinex.scm")
             &rArr; (random:solid-sphere! random:hollow-sphere!
                 random:normal-vector! random:normal
                 random:exp random:uniform)
</pre>
  <div class="defun">
&mdash; Function: <b>feature-&gt;export-alist</b><var> feature catalog<a name="index-feature_002d_003eexport_002dalist-51"></a></var><br>
<blockquote>
       <p>Returns a list of lists; each sublist holding the name of the file
implementing <var>feature</var>, and the identifier symbols exported (advertised) by
SLIB (or SLIB-style) feature <var>feature</var>, in <var>catalog</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>feature-&gt;exports</b><var> feature catalog<a name="index-feature_002d_003eexports-52"></a></var><br>
<blockquote>
       <p>Returns a list of all exports of <var>feature</var>. 
</p></blockquote></div>

<p class="noindent">In the case of <code>aggregate</code> features, more than one file may
have export lists to report:

<pre class="example">     (feature-&gt;export-alist 'r5rs slib:catalog))
             &rArr; (("/usr/local/lib/slib/values.scm"
                  call-with-values values)
                 ("/usr/local/lib/slib/mbe.scm"
                  define-syntax macro:expand
                  macro:load macro:eval)
                 ("/usr/local/lib/slib/eval.scm"
                  eval scheme-report-environment
                  null-environment interaction-environment))
     
     (feature-&gt;export-alist 'stdio *catalog*)
             &rArr; (("/usr/local/lib/slib/scanf.scm"
                  fscanf sscanf scanf scanf-read-list)
                 ("/usr/local/lib/slib/printf.scm"
                  sprintf printf fprintf)
                 ("/usr/local/lib/slib/stdio.scm"
                  stderr stdout stdin))
     
     (feature-&gt;exports 'stdio slib:catalog)
             &rArr; (fscanf sscanf scanf scanf-read-list
                  sprintf printf fprintf stderr stdout stdin)
</pre>
  <div class="node">
<a name="Module-Semantics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Top_002dlevel-Variable-References">Top-level Variable References</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Module-Manifests">Module Manifests</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Compiling-Scheme">Compiling Scheme</a>

</div>

<h4 class="subsection">1.6.3 Module Semantics</h4>

<p>For the purpose of compiling Scheme code, each top-level
<code>require</code> makes the identifiers exported by its feature's module
<code>defined</code> (or defmacroed or defined-syntaxed) within the file
(being compiled) headed with those requires.

  <p>Top-level occurrences of <code>require-if</code> make defined the exports
from the module named by the second argument <em>if</em> the
<var>feature-expression</var> first argument is true in the target
environment.  The target feature <code>compiling</code> should be provided
during this phase of compilation.

  <p>Non-top-level SLIB occurences of <code>require</code> and <code>require-if</code>
of quoted features can be ignored by compilers.  The SLIB modules will
all have top-level constructs for those features.

  <p><a name="index-aggregate-53"></a>Note that aggregate catalog entries import more than one module. 
Implementations of <code>require</code> may or may <em>not</em> be transitive;
code which uses module exports without requiring the providing module
is in error.

  <p>In the SLIB modules <code>modular</code>, <code>batch</code>, <code>hash</code>,
<code>common-lisp-time</code>, <code>commutative-ring</code>, <code>charplot</code>,
<code>logical</code>, <code>common-list-functions</code>, <code>coerce</code> and
<code>break</code> there is code conditional on features being
<code>provided?</code>.  Most are testing for the presence of features which
are intrinsic to implementations (inexacts, bignums, ...).

  <p>In all cases these <code>provided?</code> tests can be evaluated at
compile-time using <code>feature-eval</code>
(see <a href="#Feature">feature-eval</a>).  The simplest way to compile these
constructs may be to treat <code>provided?</code> as a macro.

<div class="node">
<a name="Top-level-Variable-References"></a>
<a name="Top_002dlevel-Variable-References"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Module-Analysis">Module Analysis</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Module-Semantics">Module Semantics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Compiling-Scheme">Compiling Scheme</a>

</div>

<h4 class="subsection">1.6.4 Top-level Variable References</h4>

<p><code>(require 'top-refs)</code>
<a name="index-top_002drefs-54"></a><a name="index-top_002dlevel-variable-references-55"></a><a name="index-variable-references-56"></a>
These procedures complement those in <a href="#Module-Manifests">Module Manifests</a> by
finding the top-level variable references in Scheme source code. 
They work by traversing expressions and definitions, keeping track
of bindings encountered.  It is certainly possible to foil these
functions, but they return useful information about SLIB source
code.

<div class="defun">
&mdash; Function: <b>top-refs</b><var> obj<a name="index-top_002drefs-57"></a></var><br>
<blockquote>
       <p>Returns a list of the top-level variables referenced by the Scheme
expression <var>obj</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>top-refs&lt;-file</b><var> filename<a name="index-top_002drefs_003c_002dfile-58"></a></var><br>
<blockquote>
       <p><var>filename</var> should be a string naming an existing file containing Scheme
source code.  <code>top-refs&lt;-file</code> returns a list of the top-level variable references
made by expressions in the file named by <var>filename</var>.

       <p>Code in modules which <var>filename</var> <code>require</code>s is not traversed.  Code in
files loaded from top-level <em>is</em> traversed if the expression
argument to <code>load</code>, <code>slib:load</code>, <code>slib:load-source</code>,
<code>macro:load</code>, <code>defmacro:load</code>, <code>synclo:load</code>,
<code>syncase:load</code>, or <code>macwork:load</code> is a literal string
constant or composed of combinations of vicinity functions and
string literal constants; and the resulting file exists (possibly
with ".scm" appended). 
</p></blockquote></div>

<p class="noindent">The following function parses an <dfn>Info</dfn> Index. 
<a name="index-Info-59"></a><a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>

<div class="defun">
&mdash; Function: <b>exports&lt;-info-index</b><var> file n <small class="dots">...</small><a name="index-exports_003c_002dinfo_002dindex-60"></a></var><br>
<blockquote>
       <p><var>n</var> <small class="dots">...</small> must be an increasing series of positive integers. 
<code>exports&lt;-info-index</code> returns a list of all the identifiers appearing in the <var>n</var>th
<small class="dots">...</small> (info) indexes of <var>file</var>.  The identifiers have the case that
the implementation's <code>read</code> uses for symbols.  Identifiers
containing spaces (eg. <code>close-base on base-table</code>) are
<em>not</em> included.  #f is returned if the index is not found.

       <p>Each info index is headed by a &lsquo;<samp><span class="samp">* Menu:</span></samp>&rsquo; line.  To list the
symbols in the first and third info indexes do:

     <pre class="example">          (exports&lt;-info-index "slib.info" 1 3)
</pre>
       </blockquote></div>

<div class="node">
<a name="Module-Analysis"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top_002dlevel-Variable-References">Top-level Variable References</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Compiling-Scheme">Compiling Scheme</a>

</div>

<h4 class="subsection">1.6.5 Module Analysis</h4>

<p><code>(require 'vet)</code>
<a name="index-vet-61"></a>

<div class="defun">
&mdash; Function: <b>vet-slib</b><var> file1 <small class="dots">...</small><a name="index-vet_002dslib-62"></a></var><br>
<blockquote>
       <p>Using the procedures in the <code>top-refs</code> and <code>manifest</code>
modules, <code>vet-slib</code> analyzes each SLIB module and <var>file1</var>, <small class="dots">...</small>, reporting
about any procedure or macro defined whether it is:

          <dl>
<dt>orphaned<dd>defined, not called, not exported;
<br><dt>missing<dd>called, not defined, and not exported by its <code>require</code>d modules;
<br><dt>undocumented-export<dd>Exported by module, but no index entry in <samp><span class="file">slib.info</span></samp>;

       </dl>

       <p>And for the library as a whole:

          <dl>
<dt>documented-unexport<dd>Index entry in <samp><span class="file">slib.info</span></samp>, but no module exports it.

       </dl>

       <p>This straightforward analysis caught three full days worth of
never-executed branches, transitive require assumptions, spelling
errors, undocumented procedures, missing procedures, and cyclic
dependencies in SLIB.

       <p>The optional arguments <var>file1</var>, <small class="dots">...</small> provide a simple way to vet
prospective SLIB modules. 
</p></blockquote></div>

<div class="node">
<a name="Universal-SLIB-Procedures"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-Library-System">The Library System</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 Universal SLIB Procedures</h2>

<p class="noindent">The procedures described in these sections are supported by all
implementations as part of the &lsquo;<samp><span class="samp">*.init</span></samp>&rsquo; files or by
<samp><span class="file">require.scm</span></samp>.

<ul class="menu">
<li><a accesskey="1" href="#Vicinity">Vicinity</a>:                     Pathname Management
<li><a accesskey="2" href="#Configuration">Configuration</a>:                Characteristics of Scheme Implementation
<li><a accesskey="3" href="#Input_002fOutput">Input/Output</a>:                 Things not provided by the Scheme specs. 
<li><a accesskey="4" href="#System">System</a>:                       LOADing, EVALing, ERRORing, and EXITing
<li><a accesskey="5" href="#Miscellany">Miscellany</a>
</ul>

<div class="node">
<a name="Vicinity"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Configuration">Configuration</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>

</div>

<h3 class="section">2.1 Vicinity</h3>

<p class="noindent">A vicinity is a descriptor for a place in the file system.  Vicinities
hide from the programmer the concepts of host, volume, directory, and
version.  Vicinities express only the concept of a file environment
where a file name can be resolved to a file in a system independent
manner.  Vicinities can even be used on <dfn>flat</dfn> file systems (which
have no directory structure) by having the vicinity express constraints
on the file name.

  <p>All of these procedures are file-system dependent.  Use of these
vicinity procedures can make programs file-system <em>in</em>dependent.

<p class="noindent">These procedures are provided by all implementations. 
On most systems a vicinity is a string.

<div class="defun">
&mdash; Function: <b>make-vicinity</b><var> dirpath<a name="index-make_002dvicinity-63"></a></var><br>
<blockquote><p>Returns <var>dirpath</var> as a vicinity for use as first argument to
<code>in-vicinity</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pathname-&gt;vicinity</b><var> path<a name="index-pathname_002d_003evicinity-64"></a></var><br>
<blockquote><p>Returns the vicinity containing <var>path</var>.
     <pre class="example">          (pathname-&gt;vicinity "/usr/local/lib/scm/Link.scm")
                              &rArr; "/usr/local/lib/scm/"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>program-vicinity</b><var><a name="index-program_002dvicinity-65"></a></var><br>
<blockquote><p>Returns the vicinity of the currently loading Scheme code.  For an
interpreter this would be the directory containing source code.  For a
compiled system (with multiple files) this would be the directory
where the object or executable files are.  If no file is currently
loading, then the result is undefined.  <strong>Warning:</strong>
<code>program-vicinity</code> can return incorrect values if your program
escapes back into a <code>load</code> continuation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>library-vicinity</b><var><a name="index-library_002dvicinity-66"></a></var><br>
<blockquote><p>Returns the vicinity of the shared Scheme library. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>implementation-vicinity</b><var><a name="index-implementation_002dvicinity-67"></a></var><br>
<blockquote><p>Returns the vicinity of the underlying Scheme implementation.  This
vicinity will likely contain startup code and messages and a compiler. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>user-vicinity</b><var><a name="index-user_002dvicinity-68"></a></var><br>
<blockquote><p>Returns the vicinity of the current directory of the user.  On most
systems this is <samp><span class="file">""</span></samp> (the empty string). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>home-vicinity</b><var><a name="index-home_002dvicinity-69"></a></var><br>
<blockquote><p>Returns the vicinity of the user's <dfn>HOME</dfn> directory, the directory
<a name="index-HOME-70"></a>which typically contains files which customize a computer environment
for a user.  If scheme is running without a user (eg. a daemon) or if
this concept is meaningless for the platform, then <code>home-vicinity</code>
returns <code>#f</code>. 
</p></blockquote></div>

<!-- @defun scheme-file-suffix -->
<!-- Returns the default filename suffix for scheme source files.  On most -->
<!-- systems this is @samp{.scm}. -->
<!-- @end defun -->
<div class="defun">
&mdash; Function: <b>vicinity:suffix?</b><var> chr<a name="index-vicinity_003asuffix_003f-71"></a></var><br>
<blockquote><p>Returns the &lsquo;<samp><span class="samp">#t</span></samp>&rsquo; if <var>chr</var> is a vicinity suffix character; and
<code>#f</code> otherwise.  Typical vicinity suffixes are &lsquo;<samp><span class="samp">/</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">:</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">\</span></samp>&rsquo;,
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>in-vicinity</b><var> vicinity filename<a name="index-in_002dvicinity-72"></a></var><br>
<blockquote><p>Returns a filename suitable for use by <code>slib:load</code>,
<code>slib:load-source</code>, <code>slib:load-compiled</code>,
<code>open-input-file</code>, <code>open-output-file</code>, etc.  The returned
filename is <var>filename</var> in <var>vicinity</var>.  <code>in-vicinity</code> should
allow <var>filename</var> to override <var>vicinity</var> when <var>filename</var> is
an absolute pathname and <var>vicinity</var> is equal to the value of
<code>(user-vicinity)</code>.  The behavior of <code>in-vicinity</code> when
<var>filename</var> is absolute and <var>vicinity</var> is not equal to the value
of <code>(user-vicinity)</code> is unspecified.  For most systems
<code>in-vicinity</code> can be <code>string-append</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sub-vicinity</b><var> vicinity name<a name="index-sub_002dvicinity-73"></a></var><br>
<blockquote><p>Returns the vicinity of <var>vicinity</var> restricted to <var>name</var>.  This
is used for large systems where names of files in subsystems could
conflict.  On systems with directory structure <code>sub-vicinity</code> will
return a pathname of the subdirectory <var>name</var> of
<var>vicinity</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>with-load-pathname</b><var> path thunk<a name="index-with_002dload_002dpathname-74"></a></var><br>
<blockquote><p><var>path</var> should be a string naming a file being read or loaded. 
<code>with-load-pathname</code> evaluates <var>thunk</var> in a dynamic scope
where an internal variable is bound to <var>path</var>; the internal
variable is used for messages and <code>program-vicinity</code>. 
<code>with-load-pathname</code> returns the value returned by <var>thunk</var>. 
</p></blockquote></div>

<div class="node">
<a name="Configuration"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Input_002fOutput">Input/Output</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Vicinity">Vicinity</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>

</div>

<h3 class="section">2.2 Configuration</h3>

<p class="noindent">These constants and procedures describe characteristics of the Scheme
and underlying operating system.  They are provided by all
implementations.

<div class="defun">
&mdash; Constant: <b>char-code-limit</b><var><a name="index-char_002dcode_002dlimit-75"></a></var><br>
<blockquote><p>An integer 1 larger that the largest value which can be returned by
<code>char-&gt;integer</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>most-positive-fixnum</b><var><a name="index-most_002dpositive_002dfixnum-76"></a></var><br>
<blockquote><p>In implementations which support integers of practically unlimited size,
<var>most-positive-fixnum</var> is a large exact integer within the range of
exact integers that may result from computing the length of a list,
vector, or string.

       <p>In implementations which do not support integers of practically
unlimited size, <var>most-positive-fixnum</var> is the largest exact integer
that may result from computing the length of a list, vector, or string. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>slib:tab</b><var><a name="index-slib_003atab-77"></a></var><br>
<blockquote><p>The tab character. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>slib:form-feed</b><var><a name="index-slib_003aform_002dfeed-78"></a></var><br>
<blockquote><p>The form-feed character. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>software-type</b><var><a name="index-software_002dtype-79"></a></var><br>
<blockquote><p>Returns a symbol denoting the generic operating system type.  For
instance, <code>unix</code>, <code>vms</code>, <code>macos</code>, <code>amiga</code>, or
<code>ms-dos</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>slib:report-version</b><var><a name="index-slib_003areport_002dversion-80"></a></var><br>
<blockquote><p>Displays the versions of SLIB and the underlying Scheme implementation
and the name of the operating system.  An unspecified value is returned.

     <pre class="example">          (slib:report-version) &rArr; slib "3b5" on scm "5b1" on unix
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>slib:report</b><var><a name="index-slib_003areport-81"></a></var><br>
<blockquote><p>Displays the information of <code>(slib:report-version)</code> followed by
almost all the information neccessary for submitting a problem report. 
An unspecified value is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>slib:report</b><var> #t<a name="index-slib_003areport-82"></a></var><br>
<blockquote><p>provides a more verbose listing. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>slib:report</b><var> filename<a name="index-slib_003areport-83"></a></var><br>
<blockquote><p>Writes the verbose report to file <samp><span class="file">filename</span></samp>.

     <pre class="example">          (slib:report)
          &rArr;
          slib "3b5" on scm "5b1" on unix
          (implementation-vicinity) is "/usr/local/lib/scm/"
          (library-vicinity) is "/usr/local/lib/slib/"
          (scheme-file-suffix) is ".scm"
          loaded slib:features :
                  trace alist qp sort
                  common-list-functions macro values getopt
                  compiled
          implementation slib:features :
                  bignum complex real rational
                  inexact vicinity ed getenv
                  tmpnam abort transcript with-file
                  ieee-p1178 r4rs rev4-optional-procedures hash
                  object-hash delay eval dynamic-wind
                  multiarg-apply multiarg/and- logical defmacro
                  string-port source current-time record
                  rev3-procedures rev2-procedures sun-dl string-case
                  array dump char-ready? full-continuation
                  system
          implementation *catalog* :
                  (i/o-extensions compiled "/usr/local/lib/scm/ioext.so")
                  ...
</pre>
       </blockquote></div>

<div class="node">
<a name="Input%2fOutput"></a>
<a name="Input_002fOutput"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#System">System</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuration">Configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>

</div>

<h3 class="section">2.3 Input/Output</h3>

<p class="noindent">These procedures are provided by all implementations.

<div class="defun">
&mdash; Function: <b>file-exists?</b><var> filename<a name="index-file_002dexists_003f-84"></a></var><br>
<blockquote><p>Returns <code>#t</code> if the specified file exists.  Otherwise, returns
<code>#f</code>.  If the underlying implementation does not support this
feature then <code>#f</code> is always returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>delete-file</b><var> filename<a name="index-delete_002dfile-85"></a></var><br>
<blockquote><p>Deletes the file specified by <var>filename</var>.  If <var>filename</var> can not
be deleted, <code>#f</code> is returned.  Otherwise, <code>#t</code> is
returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-file</b><var> filename modes<a name="index-open_002dfile-86"></a></var><br>
<blockquote><p><var>filename</var> should be a string naming a file.  <code>open-file</code>
returns a port depending on the symbol <var>modes</var>:

          <dl>
<dt><span class="roman">r</span><dd>an input port capable of delivering characters from the file. 
<br><dt><span class="roman">rb</span><dd>a <em>binary</em> input port capable of delivering characters from the file. 
<br><dt><span class="roman">w</span><dd>an output port capable of writing characters to a new file by that name. 
<br><dt><span class="roman">wb</span><dd>a <em>binary</em> output port capable of writing characters to a new file
by that name. 
</dl>

       <p>If an implementation does not distinguish between binary and non-binary
files, then it must treat <span class="roman">rb</span> as <span class="roman">r</span> and <span class="roman">wb</span> as <span class="roman">w</span>.

       <p>If the file cannot be opened, either #f is returned or an error is
signalled.  For output, if a file with the given name already exists,
the effect is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>port?</b><var> obj<a name="index-port_003f-87"></a></var><br>
<blockquote><p>Returns <tt>#t</tt> if <var>obj</var> is an input or output port, otherwise
returns <tt>#f</tt>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>close-port</b><var> port<a name="index-close_002dport-88"></a></var><br>
<blockquote><p>Closes the file associated with <var>port</var>, rendering the <var>port</var>
incapable of delivering or accepting characters.

       <p><code>close-file</code> has no effect if the file has already been closed. 
The value returned is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>call-with-open-ports</b><var> proc ports <small class="dots">...</small><a name="index-call_002dwith_002dopen_002dports-89"></a></var><br>
&mdash; Function: <b>call-with-open-ports</b><var> ports <small class="dots">...</small> proc<a name="index-call_002dwith_002dopen_002dports-90"></a></var><br>
<blockquote><p><var>Proc</var> should be a procedure that accepts as many arguments as there
are <var>ports</var> passed to <code>call-with-open-ports</code>. 
<code>call-with-open-ports</code> calls <var>proc</var> with <var>ports</var> <small class="dots">...</small>. 
If <var>proc</var> returns, then the ports are closed automatically and the
value yielded by the <var>proc</var> is returned.  If <var>proc</var> does not
return, then the ports will not be closed automatically unless it is
possible to prove that the ports will never again be used for a read or
write operation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>tmpnam</b><var><a name="index-tmpnam-91"></a></var><br>
<blockquote><p>Returns a pathname for a file which will likely not be used by any other
process.  Successive calls to <code>(tmpnam)</code> will return different
pathnames. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>current-error-port</b><var><a name="index-current_002derror_002dport-92"></a></var><br>
<blockquote><p>Returns the current port to which diagnostic and error output is
directed. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>force-output</b><var><a name="index-force_002doutput-93"></a></var><br>
&mdash; Procedure: <b>force-output</b><var> port<a name="index-force_002doutput-94"></a></var><br>
<blockquote><p>Forces any pending output on <var>port</var> to be delivered to the output
device and returns an unspecified value.  The <var>port</var> argument may be
omitted, in which case it defaults to the value returned by
<code>(current-output-port)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-position</b><var> port<a name="index-file_002dposition-95"></a></var><br>
&mdash; Function: <b>file-position</b><var> port #f<a name="index-file_002dposition-96"></a></var><br>
<blockquote><p><var>port</var> must be open to a file.  <code>file-position</code> returns the
current position of the character in <var>port</var> which will next be
read or written.  If the implementation does not support
file-position, then <code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-position</b><var> port k<a name="index-file_002dposition-97"></a></var><br>
<blockquote><p><var>port</var> must be open to a file.  <code>file-position</code> sets the
current position in <var>port</var> which will next be read or written.  If
successful, <code>#t</code> is returned; otherwise <code>file-position</code>
returns <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>output-port-width</b><var><a name="index-output_002dport_002dwidth-98"></a></var><br>
&mdash; Function: <b>output-port-width</b><var> port<a name="index-output_002dport_002dwidth-99"></a></var><br>
<blockquote>
       <p>Returns the width of <var>port</var>, which defaults to
<code>(current-output-port)</code> if absent.  If the width cannot be
determined 79 is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>output-port-height</b><var><a name="index-output_002dport_002dheight-100"></a></var><br>
&mdash; Function: <b>output-port-height</b><var> port<a name="index-output_002dport_002dheight-101"></a></var><br>
<blockquote>
       <p>Returns the height of <var>port</var>, which defaults to
<code>(current-output-port)</code> if absent.  If the height cannot be
determined 24 is returned. 
</p></blockquote></div>

<div class="node">
<a name="System"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Miscellany">Miscellany</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Input_002fOutput">Input/Output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>

</div>

<h3 class="section">2.4 System</h3>

<p class="noindent">These procedures are provided by all implementations.

<div class="defun">
&mdash; Procedure: <b>slib:load-source</b><var> name<a name="index-slib_003aload_002dsource-102"></a></var><br>
<blockquote><p>Loads a file of Scheme source code from <var>name</var> with the default
filename extension used in SLIB.  For instance if the filename extension
used in SLIB is <samp><span class="file">.scm</span></samp> then <code>(slib:load-source "foo")</code> will
load from file <samp><span class="file">foo.scm</span></samp>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>slib:load-compiled</b><var> name<a name="index-slib_003aload_002dcompiled-103"></a></var><br>
<blockquote><p>On implementations which support separtely loadable compiled modules,
loads a file of compiled code from <var>name</var> with the implementation's
filename extension for compiled code appended. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>slib:load</b><var> name<a name="index-slib_003aload-104"></a></var><br>
<blockquote><p>Loads a file of Scheme source or compiled code from <var>name</var> with the
appropriate suffixes appended.  If both source and compiled code are
present with the appropriate names then the implementation will load
just one.  It is up to the implementation to choose which one will be
loaded.

       <p>If an implementation does not support compiled code then
<code>slib:load</code> will be identical to <code>slib:load-source</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>slib:eval</b><var> obj<a name="index-slib_003aeval-105"></a></var><br>
<blockquote><p><code>eval</code> returns the value of <var>obj</var> evaluated in the current top
level environment.  <a href="#Eval">Eval</a> provides a more general evaluation
facility. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>slib:eval-load</b><var> filename eval<a name="index-slib_003aeval_002dload-106"></a></var><br>
<blockquote><p><var>filename</var> should be a string.  If filename names an existing
file, the Scheme source code expressions and definitions are read from
the file and <var>eval</var> called with them sequentially.  The
<code>slib:eval-load</code> procedure does not affect the values returned by
<code>current-input-port</code>, <code>current-error-port</code>, and
<code>current-output-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>slib:warn</b><var> arg1 arg2 <small class="dots">...</small><a name="index-slib_003awarn-107"></a></var><br>
<blockquote><p>Outputs a warning message containing the arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>slib:error</b><var> arg1 arg2 <small class="dots">...</small><a name="index-slib_003aerror-108"></a></var><br>
<blockquote><p>Outputs an error message containing the arguments, aborts evaluation of
the current form and responds in a system dependent way to the error. 
Typical responses are to abort the program or to enter a read-eval-print
loop. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>slib:exit</b><var> n<a name="index-slib_003aexit-109"></a></var><br>
&mdash; Procedure: <b>slib:exit</b><var><a name="index-slib_003aexit-110"></a></var><br>
<blockquote><p>Exits from the Scheme session returning status <var>n</var> to the system. 
If <var>n</var> is omitted or <code>#t</code>, a success status is returned to
the system (if possible).  If <var>n</var> is <code>#f</code> a failure is
returned to the system (if possible).  If <var>n</var> is an integer, then
<var>n</var> is returned to the system (if possible).  If the Scheme
session cannot exit, then an unspecified value is returned from
<code>slib:exit</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>browse-url</b><var> url<a name="index-browse_002durl-111"></a></var><br>
<blockquote><p>Web browsers have become so ubiquitous that programming languagues
should support a uniform interface to them.

       <p>If a browser is running, <code>browse-url</code> causes the browser to
display the page specified by string <var>url</var> and returns <code>#t</code>.

       <p>If the browser is not running, <code>browse-url</code> starts a browser
displaying the argument <var>url</var>.  If the browser starts as a
background job, <code>browse-url</code> returns <code>#t</code> immediately; if
the browser starts as a foreground job, then <code>browse-url</code> returns
<code>#t</code> when the browser exits; otherwise (if no browser) it returns
<code>#f</code>. 
</p></blockquote></div>

<div class="node">
<a name="Miscellany"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#System">System</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>

</div>

<h3 class="section">2.5 Miscellany</h3>

<p>These procedures are provided by all implementations.

<div class="defun">
&mdash; Function: <b>identity</b><var> x<a name="index-identity-112"></a></var><br>
<blockquote><p><var>identity</var> returns its argument.

       <p>Example:
     <pre class="lisp">          (identity 3)
             &rArr; 3
          (identity '(foo bar))
             &rArr; (foo bar)
          (map identity <var>lst</var>)
             == (copy-list <var>lst</var>)
</pre>
       </blockquote></div>

<h4 class="subsection">2.5.1 Mutual Exclusion</h4>

<p class="noindent">An <dfn>exchanger</dfn> is a procedure of one argument regulating mutually
<a name="index-exchanger-113"></a>exclusive access to a resource.  When a exchanger is called, its current
content is returned, while being replaced by its argument in an atomic
operation.

<div class="defun">
&mdash; Function: <b>make-exchanger</b><var> obj<a name="index-make_002dexchanger-114"></a></var><br>
<blockquote>
       <p>Returns a new exchanger with the argument <var>obj</var> as its initial
content.

     <pre class="example">          (define queue (make-exchanger (list a)))
</pre>
       <p>A queue implemented as an exchanger holding a list can be protected from
reentrant execution thus:

     <pre class="example">          (define (pop queue)
            (let ((lst #f))
              (dynamic-wind
                  (lambda () (set! lst (queue #f)))
                  (lambda () (and lst (not (null? lst))
                                  (let ((ret (car lst)))
                                    (set! lst (cdr lst))
                                    ret)))
                  (lambda () (and lst (queue lst))))))
          
          (pop queue)         &rArr; a
          
          (pop queue)         &rArr; #f
</pre>
       </blockquote></div>

<h4 class="subsection">2.5.2 Legacy</h4>

<p class="noindent">The following procedures were present in Scheme until R4RS
(see <a href="r4rs.html#Notes">Language changes</a>). 
They are provided by all SLIB implementations.

<div class="defun">
&mdash; Constant: <b>t</b><var><a name="index-t-115"></a></var><br>
<blockquote><p>Defined as <code>#t</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>nil</b><var><a name="index-nil-116"></a></var><br>
<blockquote><p>Defined as <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>last-pair</b><var> l<a name="index-last_002dpair-117"></a></var><br>
<blockquote><p>Returns the last pair in the list <var>l</var>.  Example:
     <pre class="lisp">          (last-pair (cons 1 2))
             &rArr; (1 . 2)
          (last-pair '(1 2))
             &rArr; (2)
              == (cons 2 '())
</pre>
       </blockquote></div>

<div class="node">
<a name="Scheme-Syntax-Extension-Packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 Scheme Syntax Extension Packages</h2>

<ul class="menu">
<li><a accesskey="1" href="#Defmacro">Defmacro</a>:                     Supported by all implementations

<li><a accesskey="2" href="#R4RS-Macros">R4RS Macros</a>:                  'macro
<li><a accesskey="3" href="#Macro-by-Example">Macro by Example</a>:             'macro-by-example
<li><a accesskey="4" href="#Macros-That-Work">Macros That Work</a>:             'macros-that-work
<li><a accesskey="5" href="#Syntactic-Closures">Syntactic Closures</a>:           'syntactic-closures
<li><a accesskey="6" href="#Syntax_002dCase-Macros">Syntax-Case Macros</a>:           'syntax-case

</li></ul>
<p>Syntax extensions (macros) included with SLIB.

</p>
<ul class="menu">
<li><a accesskey="7" href="#Define_002dStructure">Define-Structure</a>:             'structure
<li><a accesskey="8" href="#Define_002dRecord_002dType">Define-Record-Type</a>:           'define-record-type, 'srfi-9
<li><a accesskey="9" href="#Fluid_002dLet">Fluid-Let</a>:                    'fluid-let
<li><a href="#Parameter-Objects">Parameter Objects</a>:            'srfi-39
<li><a href="#Binding-to-multiple-values">Binding to multiple values</a>:   'receive, 'srfi-8
<li><a href="#Guarded-LET_002a-special-form">Guarded LET* special form</a>:    'and-let*, 'srfi-2
<li><a href="#Guarded-COND-Clause">Guarded COND Clause</a>:          'guarded-cond-clause, 'srfi-61
<li><a href="#Yasos">Yasos</a>:                        'yasos, 'oop, 'collect
</ul>

<div class="node">
<a name="Defmacro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#R4RS-Macros">R4RS Macros</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.1 Defmacro</h3>

<p>Defmacros are supported by all implementations. 
<!-- See also @code{gentemp}, in @ref{Macros}. -->

<div class="defun">
&mdash; Function: <b>gentemp</b><var><a name="index-gentemp-118"></a></var><br>
<blockquote><p>Returns a new (interned) symbol each time it is called.  The symbol
names are implementation-dependent
     <pre class="lisp">          (gentemp) &rArr; scm:G0
          (gentemp) &rArr; scm:G1
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>defmacro:eval</b><var> e<a name="index-defmacro_003aeval-119"></a></var><br>
<blockquote><p>Returns the <code>slib:eval</code> of expanding all defmacros in scheme
expression <var>e</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>defmacro:load</b><var> filename<a name="index-defmacro_003aload-120"></a></var><br>
<blockquote><p><var>filename</var> should be a string.  If filename names an existing
file, the <code>defmacro:load</code> procedure reads Scheme source code
expressions and definitions from the file and evaluates them
sequentially.  These source code expressions and definitions may
contain defmacro definitions.  The <code>defmacro:load</code> procedure does
not affect the values returned by <code>current-input-port</code>,
<code>current-error-port</code>, and <code>current-output-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>defmacro?</b><var> sym<a name="index-defmacro_003f-121"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>sym</var> has been defined by <code>defmacro</code>,
<code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>macroexpand-1</b><var> form<a name="index-macroexpand_002d1-122"></a></var><br>
&mdash; Function: <b>macroexpand</b><var> form<a name="index-macroexpand-123"></a></var><br>
<blockquote><p>If <var>form</var> is a macro call, <code>macroexpand-1</code> will expand the
macro call once and return it.  A <var>form</var> is considered to be a macro
call only if it is a cons whose <code>car</code> is a symbol for which a
<code>defmacro</code> has been defined.

       <p><code>macroexpand</code> is similar to <code>macroexpand-1</code>, but repeatedly
expands <var>form</var> until it is no longer a macro call. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>defmacro</b><var> name lambda-list form <small class="dots">...</small><a name="index-defmacro-124"></a></var><br>
<blockquote><p>When encountered by <code>defmacro:eval</code>, <code>defmacro:macroexpand*</code>,
or <code>defmacro:load</code> defines a new macro which will henceforth be
expanded when encountered by <code>defmacro:eval</code>,
<code>defmacro:macroexpand*</code>, or <code>defmacro:load</code>. 
</p></blockquote></div>

<h4 class="subsection">3.1.1 Defmacroexpand</h4>

<p><code>(require 'defmacroexpand)</code>
<a name="index-defmacroexpand-125"></a>

<div class="defun">
&mdash; Function: <b>defmacro:expand*</b><var> e<a name="index-defmacro_003aexpand_002a-126"></a></var><br>
<blockquote><p>Returns the result of expanding all defmacros in scheme expression
<var>e</var>. 
</p></blockquote></div>

<div class="node">
<a name="R4RS-Macros"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Macro-by-Example">Macro by Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Defmacro">Defmacro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.2 R4RS Macros</h3>

<p><code>(require 'macro)</code> is the appropriate call if you want R4RS
<a name="index-macro-127"></a>high-level macros but don't care about the low level implementation.  If
an SLIB R4RS macro implementation is already loaded it will be used. 
Otherwise, one of the R4RS macros implemetations is loaded.

  <p>The SLIB R4RS macro implementations support the following uniform
interface:

<div class="defun">
&mdash; Function: <b>macro:expand</b><var> sexpression<a name="index-macro_003aexpand-128"></a></var><br>
<blockquote><p>Takes an R4RS expression, macro-expands it, and returns the result of
the macro expansion. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>macro:eval</b><var> sexpression<a name="index-macro_003aeval-129"></a></var><br>
<blockquote><p>Takes an R4RS expression, macro-expands it, evals the result of the
macro expansion, and returns the result of the evaluation. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>macro:load</b><var> filename<a name="index-macro_003aload-130"></a></var><br>
<blockquote><p><var>filename</var> should be a string.  If filename names an existing
file, the <code>macro:load</code> procedure reads Scheme source code
expressions and definitions from the file and evaluates them
sequentially.  These source code expressions and definitions may
contain macro definitions.  The <code>macro:load</code> procedure does not
affect the values returned by <code>current-input-port</code>,
<code>current-error-port</code>, and <code>current-output-port</code>. 
</p></blockquote></div>

<div class="node">
<a name="Macro-by-Example"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Macros-That-Work">Macros That Work</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#R4RS-Macros">R4RS Macros</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.3 Macro by Example</h3>

<p><code>(require 'macro-by-example)</code>
<a name="index-macro_002dby_002dexample-131"></a>
A vanilla implementation of <cite>Macro by Example</cite> (Eugene Kohlbecker,
R4RS) by Dorai Sitaram, (dorai @ cs.rice.edu) using <code>defmacro</code>.

     <ul>
<li>generating hygienic global <code>define-syntax</code> Macro-by-Example macros
<strong>cheaply</strong>.

     <li>can define macros which use <code>...</code>.

     <li>needn't worry about a lexical variable in a macro definition
clashing with a variable from the macro use context

     <li>don't suffer the overhead of redefining the repl if <code>defmacro</code>
natively supported (most implementations)

  </ul>

<h4 class="subsection">3.3.1 Caveat</h4>

<p>These macros are not referentially transparent
(see <a href="r4rs.html#Macros">Macros</a>).  Lexically scoped macros
(i.e., <code>let-syntax</code> and <code>letrec-syntax</code>) are not supported. 
In any case, the problem
of referential transparency gains poignancy only when <code>let-syntax</code>
and <code>letrec-syntax</code> are used.  So you will not be courting
large-scale disaster unless you're using system-function names as local
variables with unintuitive bindings that the macro can't use.  However,
if you must have the full <cite>r4rs</cite> macro functionality, look to the
more featureful (but also more expensive) versions of syntax-rules
available in slib <a href="#Macros-That-Work">Macros That Work</a>, <a href="#Syntactic-Closures">Syntactic Closures</a>, and
<a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a>.

<div class="defun">
&mdash; Macro: <b>define-syntax</b><var> keyword transformer-spec<a name="index-define_002dsyntax-132"></a></var><br>
<blockquote><p>The <var>keyword</var> is an identifier, and the <var>transformer-spec</var>
should be an instance of <code>syntax-rules</code>.

       <p>The top-level syntactic environment is extended by binding the
<var>keyword</var> to the specified transformer.

     <pre class="example">          (define-syntax let*
            (syntax-rules ()
              ((let* () body1 body2 ...)
               (let () body1 body2 ...))
              ((let* ((name1 val1) (name2 val2) ...)
                 body1 body2 ...)
               (let ((name1 val1))
                 (let* (( name2 val2) ...)
                   body1 body2 ...)))))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Macro: <b>syntax-rules</b><var> literals syntax-rule <small class="dots">...</small><a name="index-syntax_002drules-133"></a></var><br>
<blockquote><p><var>literals</var> is a list of identifiers, and each <var>syntax-rule</var>
should be of the form

       <p><code>(</code><var>pattern</var> <var>template</var><code>)</code>

       <p>where the <var>pattern</var> and  <var>template</var> are as in the grammar above.

       <p>An instance of <code>syntax-rules</code> produces a new macro transformer by
specifying a sequence of hygienic rewrite rules.  A use of a macro whose
keyword is associated with a transformer specified by
<code>syntax-rules</code> is matched against the patterns contained in the
<var>syntax-rule</var>s, beginning with the leftmost <var>syntax-rule</var>. 
When a match is found, the macro use is trancribed hygienically
according to the template.

       <p>Each pattern begins with the keyword for the macro.  This keyword is not
involved in the matching and is not considered a pattern variable or
literal identifier. 
</p></blockquote></div>

<div class="node">
<a name="Macros-That-Work"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Syntactic-Closures">Syntactic Closures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Macro-by-Example">Macro by Example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.4 Macros That Work</h3>

<p><code>(require 'macros-that-work)</code>
<a name="index-macros_002dthat_002dwork-134"></a>
<cite>Macros That Work</cite> differs from the other R4RS macro
implementations in that it does not expand derived expression types to
primitive expression types.

<div class="defun">
&mdash; Function: <b>macro:expand</b><var> expression<a name="index-macro_003aexpand-135"></a></var><br>
&mdash; Function: <b>macwork:expand</b><var> expression<a name="index-macwork_003aexpand-136"></a></var><br>
<blockquote><p>Takes an R4RS expression, macro-expands it, and returns the result of
the macro expansion. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>macro:eval</b><var> expression<a name="index-macro_003aeval-137"></a></var><br>
&mdash; Function: <b>macwork:eval</b><var> expression<a name="index-macwork_003aeval-138"></a></var><br>
<blockquote><p><code>macro:eval</code> returns the value of <var>expression</var> in the current
top level environment.  <var>expression</var> can contain macro definitions. 
Side effects of <var>expression</var> will affect the top level
environment. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>macro:load</b><var> filename<a name="index-macro_003aload-139"></a></var><br>
&mdash; Procedure: <b>macwork:load</b><var> filename<a name="index-macwork_003aload-140"></a></var><br>
<blockquote><p><var>filename</var> should be a string.  If filename names an existing
file, the <code>macro:load</code> procedure reads Scheme source code
expressions and definitions from the file and evaluates them
sequentially.  These source code expressions and definitions may
contain macro definitions.  The <code>macro:load</code> procedure does not
affect the values returned by <code>current-input-port</code>,
<code>current-error-port</code>, and <code>current-output-port</code>. 
</p></blockquote></div>

  <p>References:

  <p>The <cite>Revised^4 Report on the Algorithmic Language Scheme</cite> Clinger
and Rees [editors].  To appear in LISP Pointers.  Also available as a
technical report from the University of Oregon, MIT AI Lab, and
Cornell.

<div align="center">Macros That Work.  Clinger and Rees.  POPL '91.</div>

  <p>The supported syntax differs from the R4RS in that vectors are allowed
as patterns and as templates and are not allowed as pattern or template
data.

<pre class="example">     transformer spec  ==&gt;  (syntax-rules literals rules)
     
     rules  ==&gt;  ()
              |  (rule . rules)
     
     rule  ==&gt;  (pattern template)
     
     pattern  ==&gt;  pattern_var      ; a symbol not in literals
                |  symbol           ; a symbol in literals
                |  ()
                |  (pattern . pattern)
                |  (ellipsis_pattern)
                |  #(pattern*)                     ; extends R4RS
                |  #(pattern* ellipsis_pattern)    ; extends R4RS
                |  pattern_datum
     
     template  ==&gt;  pattern_var
                 |  symbol
                 |  ()
                 |  (template2 . template2)
                 |  #(template*)                   ; extends R4RS
                 |  pattern_datum
     
     template2  ==&gt;  template
                  |  ellipsis_template
     
     pattern_datum  ==&gt;  string                    ; no vector
                      |  character
                      |  boolean
                      |  number
     
     ellipsis_pattern  ==&gt; pattern ...
     
     ellipsis_template  ==&gt;  template ...
     
     pattern_var  ==&gt;  symbol   ; not in literals
     
     literals  ==&gt;  ()
                 |  (symbol . literals)
</pre>
  <h4 class="subsection">3.4.1 Definitions</h4>

     <dl>
<dt>Scope of an ellipsis<dd>Within a pattern or template, the scope of an ellipsis (<code>...</code>) is
the pattern or template that appears to its left.

     <br><dt>Rank of a pattern variable<dd>The rank of a pattern variable is the number of ellipses within whose
scope it appears in the pattern.

     <br><dt>Rank of a subtemplate<dd>The rank of a subtemplate is the number of ellipses within whose scope
it appears in the template.

     <br><dt>Template rank of an occurrence of a pattern variable<dd>The template rank of an occurrence of a pattern variable within a
template is the rank of that occurrence, viewed as a subtemplate.

     <br><dt>Variables bound by a pattern<dd>The variables bound by a pattern are the pattern variables that appear
within it.

     <br><dt>Referenced variables of a subtemplate<dd>The referenced variables of a subtemplate are the pattern variables that
appear within it.

     <br><dt>Variables opened by an ellipsis template<dd>The variables opened by an ellipsis template are the referenced pattern
variables whose rank is greater than the rank of the ellipsis template.

</dl>

<h4 class="subsection">3.4.2 Restrictions</h4>

<p>No pattern variable appears more than once within a pattern.

  <p>For every occurrence of a pattern variable within a template, the
template rank of the occurrence must be greater than or equal to the
pattern variable's rank.

  <p>Every ellipsis template must open at least one variable.

  <p>For every ellipsis template, the variables opened by an ellipsis
template must all be bound to sequences of the same length.

  <p>The compiled form of a <var>rule</var> is

<pre class="example">     rule  ==&gt;  (pattern template inserted)
     
     pattern  ==&gt;  pattern_var
                |  symbol
                |  ()
                |  (pattern . pattern)
                |  ellipsis_pattern
                |  #(pattern)
                |  pattern_datum
     
     template  ==&gt;  pattern_var
                 |  symbol
                 |  ()
                 |  (template2 . template2)
                 |  #(pattern)
                 |  pattern_datum
     
     template2  ==&gt;  template
                  |  ellipsis_template
     
     pattern_datum  ==&gt;  string
                      |  character
                      |  boolean
                      |  number
     
     pattern_var  ==&gt;  #(V symbol rank)
     
     ellipsis_pattern  ==&gt;  #(E pattern pattern_vars)
     
     ellipsis_template  ==&gt;  #(E template pattern_vars)
     
     inserted  ==&gt;  ()
                 |  (symbol . inserted)
     
     pattern_vars  ==&gt;  ()
                     |  (pattern_var . pattern_vars)
     
     rank  ==&gt;  exact non-negative integer
</pre>
  <p>where V and E are unforgeable values.

  <p>The pattern variables associated with an ellipsis pattern are the
variables bound by the pattern, and the pattern variables associated
with an ellipsis template are the variables opened by the ellipsis
template.

  <p>If the template contains a big chunk that contains no pattern variables
or inserted identifiers, then the big chunk will be copied
unnecessarily.  That shouldn't matter very often.

<div class="node">
<a name="Syntactic-Closures"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Syntax_002dCase-Macros">Syntax-Case Macros</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Macros-That-Work">Macros That Work</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.5 Syntactic Closures</h3>

<p><code>(require 'syntactic-closures)</code>
<a name="index-syntactic_002dclosures-141"></a>

<div class="defun">
&mdash; Function: <b>macro:expand</b><var> expression<a name="index-macro_003aexpand-142"></a></var><br>
&mdash; Function: <b>synclo:expand</b><var> expression<a name="index-synclo_003aexpand-143"></a></var><br>
<blockquote><p>Returns scheme code with the macros and derived expression types of
<var>expression</var> expanded to primitive expression types. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>macro:eval</b><var> expression<a name="index-macro_003aeval-144"></a></var><br>
&mdash; Function: <b>synclo:eval</b><var> expression<a name="index-synclo_003aeval-145"></a></var><br>
<blockquote><p><code>macro:eval</code> returns the value of <var>expression</var> in the current
top level environment.  <var>expression</var> can contain macro definitions. 
Side effects of <var>expression</var> will affect the top level
environment. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>macro:load</b><var> filename<a name="index-macro_003aload-146"></a></var><br>
&mdash; Procedure: <b>synclo:load</b><var> filename<a name="index-synclo_003aload-147"></a></var><br>
<blockquote><p><var>filename</var> should be a string.  If filename names an existing
file, the <code>macro:load</code> procedure reads Scheme source code
expressions and definitions from the file and evaluates them
sequentially.  These source code expressions and definitions may
contain macro definitions.  The <code>macro:load</code> procedure does not
affect the values returned by <code>current-input-port</code>,
<code>current-error-port</code>, and <code>current-output-port</code>. 
</p></blockquote></div>

<h4 class="subsection">3.5.1 Syntactic Closure Macro Facility</h4>

<div align="center">A Syntactic Closures Macro Facility</div>
<div align="center">by Chris Hanson</div>
<div align="center">9 November 1991</div>

  <p>This document describes <dfn>syntactic closures</dfn>, a low-level macro
facility for the Scheme programming language.  The facility is an
alternative to the low-level macro facility described in the
<cite>Revised^4 Report on Scheme.</cite> This document is an addendum to that
report.

  <p>The syntactic closures facility extends the BNF rule for
<var>transformer spec</var> to allow a new keyword that introduces a
low-level macro transformer:

<pre class="example">     <var>transformer spec</var> := (transformer <var>expression</var>)
</pre>
  <p>Additionally, the following procedures are added:
<pre class="lisp">     make-syntactic-closure
     capture-syntactic-environment
     identifier?
     identifier=?
</pre>
  <p>The description of the facility is divided into three parts.  The first
part defines basic terminology.  The second part describes how macro
transformers are defined.  The third part describes the use of
<dfn>identifiers</dfn>, which extend the syntactic closure mechanism to be
compatible with <code>syntax-rules</code>.

<h5 class="subsubsection">3.5.1.1 Terminology</h5>

<p>This section defines the concepts and data types used by the syntactic
closures facility.

     <ul>
<li><dfn>Forms</dfn> are the syntactic entities out of which programs are
recursively constructed.  A form is any expression, any definition, any
syntactic keyword, or any syntactic closure.  The variable name that
appears in a <code>set!</code> special form is also a form.  Examples of
forms:

     <pre class="lisp">          17
          #t
          car
          (+ x 4)
          (lambda (x) x)
          (define pi 3.14159)
          if
          define
</pre>
     <li>An <dfn>alias</dfn> is an alternate name for a given symbol.  It can
appear anywhere in a form that the symbol could be used, and when quoted
it is replaced by the symbol; however, it does not satisfy the predicate
<code>symbol?</code>.  Macro transformers rarely distinguish symbols from
aliases, referring to both as identifiers.

     <li>A <dfn>syntactic</dfn> environment maps identifiers to their
meanings.  More precisely, it determines whether an identifier is a
syntactic keyword or a variable.  If it is a keyword, the meaning is an
interpretation for the form in which that keyword appears.  If it is a
variable, the meaning identifies which binding of that variable is
referenced.  In short, syntactic environments contain all of the
contextual information necessary for interpreting the meaning of a
particular form.

     <li>A <dfn>syntactic closure</dfn> consists of a form, a syntactic
environment, and a list of identifiers.  All identifiers in the form
take their meaning from the syntactic environment, except those in the
given list.  The identifiers in the list are to have their meanings
determined later.  A syntactic closure may be used in any context in
which its form could have been used.  Since a syntactic closure is also
a form, it may not be used in contexts where a form would be illegal. 
For example, a form may not appear as a clause in the cond special form. 
A syntactic closure appearing in a quoted structure is replaced by its
form.

  </ul>

<h5 class="subsubsection">3.5.1.2 Transformer Definition</h5>

<p>This section describes the <code>transformer</code> special form and the
procedures <code>make-syntactic-closure</code> and
<code>capture-syntactic-environment</code>.

<div class="defun">
&mdash; Syntax: <b>transformer</b><var> expression<a name="index-transformer-148"></a></var><br>
<blockquote>
       <p>Syntax: It is an error if this syntax occurs except as a
<var>transformer spec</var>.

       <p>Semantics: The <var>expression</var> is evaluated in the standard transformer
environment to yield a macro transformer as described below.  This macro
transformer is bound to a macro keyword by the special form in which the
<code>transformer</code> expression appears (for example,
<code>let-syntax</code>).

       <p>A <dfn>macro transformer</dfn> is a procedure that takes two arguments, a
form and a syntactic environment, and returns a new form.  The first
argument, the <dfn>input form</dfn>, is the form in which the macro keyword
occurred.  The second argument, the <dfn>usage environment</dfn>, is the
syntactic environment in which the input form occurred.  The result of
the transformer, the <dfn>output form</dfn>, is automatically closed in the
<dfn>transformer environment</dfn>, which is the syntactic environment in
which the <code>transformer</code> expression occurred.

       <p>For example, here is a definition of a push macro using
<code>syntax-rules</code>:

     <pre class="lisp">          (define-syntax  push
            (syntax-rules ()
              ((push item list)
               (set! list (cons item list)))))
</pre>
       <p>Here is an equivalent definition using <code>transformer</code>:
     <pre class="lisp">          (define-syntax push
            (transformer
             (lambda (exp env)
               (let ((item
                      (make-syntactic-closure env '() (cadr exp)))
                     (list
                      (make-syntactic-closure env '() (caddr exp))))
                 `(set! ,list (cons ,item ,list))))))
</pre>
       <p>In this example, the identifiers <code>set!</code> and <code>cons</code> are closed
in the transformer environment, and thus will not be affected by the
meanings of those identifiers in the usage environment
<code>env</code>.

       <p>Some macros may be non-hygienic by design.  For example, the following
defines a loop macro that implicitly binds <code>exit</code> to an escape
procedure.  The binding of <code>exit</code> is intended to capture free
references to <code>exit</code> in the body of the loop, so <code>exit</code> must
be left free when the body is closed:

     <pre class="lisp">          (define-syntax loop
            (transformer
             (lambda (exp env)
               (let ((body (cdr exp)))
                 `(call-with-current-continuation
                   (lambda (exit)
                     (let f ()
                       ,@(map (lambda  (exp)
                                 (make-syntactic-closure env '(exit)
                                                         exp))
                               body)
                       (f))))))))
</pre>
       <p>To assign meanings to the identifiers in a form, use
<code>make-syntactic-closure</code> to close the form in a syntactic
environment. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-syntactic-closure</b><var> environment free-names form<a name="index-make_002dsyntactic_002dclosure-149"></a></var><br>
<blockquote>
       <p><var>environment</var> must be a syntactic environment, <var>free-names</var> must
be a list of identifiers, and <var>form</var> must be a form. 
<code>make-syntactic-closure</code> constructs and returns a syntactic closure
of <var>form</var> in <var>environment</var>, which can be used anywhere that
<var>form</var> could have been used.  All the identifiers used in
<var>form</var>, except those explicitly excepted by <var>free-names</var>, obtain
their meanings from <var>environment</var>.

       <p>Here is an example where <var>free-names</var> is something other than the
empty list.  It is instructive to compare the use of <var>free-names</var> in
this example with its use in the <code>loop</code> example above: the examples
are similar except for the source of the identifier being left
free.
     <pre class="lisp">          (define-syntax let1
            (transformer
             (lambda (exp env)
               (let ((id (cadr exp))
                     (init (caddr exp))
                     (exp (cadddr exp)))
                 `((lambda (,id)
                     ,(make-syntactic-closure env (list id) exp))
                   ,(make-syntactic-closure env '() init))))))
</pre>
       <p><code>let1</code> is a simplified version of <code>let</code> that only binds a
single identifier, and whose body consists of a single expression.  When
the body expression is syntactically closed in its original syntactic
environment, the identifier that is to be bound by <code>let1</code> must be
left free, so that it can be properly captured by the <code>lambda</code> in
the output form.

       <p>To obtain a syntactic environment other than the usage environment, use
<code>capture-syntactic-environment</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>capture-syntactic-environment</b><var> procedure<a name="index-capture_002dsyntactic_002denvironment-150"></a></var><br>
<blockquote>
       <p><code>capture-syntactic-environment</code> returns a form that will, when
transformed, call <var>procedure</var> on the current syntactic environment. 
<var>procedure</var> should compute and return a new form to be transformed,
in that same syntactic environment, in place of the form.

       <p>An example will make this clear.  Suppose we wanted to define a simple
<code>loop-until</code> keyword equivalent to

     <pre class="lisp">          (define-syntax loop-until
            (syntax-rules ()
              ((loop-until id init test return step)
               (letrec ((loop
                         (lambda (id)
                           (if test return (loop step)))))
                 (loop init)))))
</pre>
       <p>The following attempt at defining <code>loop-until</code> has a subtle bug:
     <pre class="lisp">          (define-syntax loop-until
            (transformer
             (lambda (exp env)
               (let ((id (cadr exp))
                     (init (caddr exp))
                     (test (cadddr exp))
                     (return (cadddr (cdr exp)))
                     (step (cadddr (cddr exp)))
                     (close
                      (lambda (exp free)
                        (make-syntactic-closure env free exp))))
                 `(letrec ((loop
                            (lambda (,id)
                              (if ,(close test (list id))
                                  ,(close return (list id))
                                  (loop ,(close step (list id)))))))
                    (loop ,(close init '())))))))
</pre>
       <p>This definition appears to take all of the proper precautions to prevent
unintended captures.  It carefully closes the subexpressions in their
original syntactic environment and it leaves the <code>id</code> identifier
free in the <code>test</code>, <code>return</code>, and <code>step</code> expressions, so
that it will be captured by the binding introduced by the <code>lambda</code>
expression.  Unfortunately it uses the identifiers <code>if</code> and
<code>loop</code> within that <code>lambda</code> expression, so if the user of
<code>loop-until</code> just happens to use, say, <code>if</code> for the
identifier, it will be inadvertently captured.

       <p>The syntactic environment that <code>if</code> and <code>loop</code> want to be
exposed to is the one just outside the <code>lambda</code> expression: before
the user's identifier is added to the syntactic environment, but after
the identifier loop has been added. 
<code>capture-syntactic-environment</code> captures exactly that environment
as follows:

     <pre class="lisp">          (define-syntax loop-until
            (transformer
             (lambda (exp env)
               (let ((id (cadr exp))
                     (init (caddr exp))
                     (test (cadddr exp))
                     (return (cadddr (cdr exp)))
                     (step (cadddr (cddr exp)))
                     (close
                      (lambda (exp free)
                        (make-syntactic-closure env free exp))))
                 `(letrec ((loop
                            ,(capture-syntactic-environment
                              (lambda (env)
                                `(lambda (,id)
                                   (,(make-syntactic-closure env '() `if)
                                    ,(close test (list id))
                                    ,(close return (list id))
                                    (,(make-syntactic-closure env '()
                                                              `loop)
                                     ,(close step (list id)))))))))
                    (loop ,(close init '())))))))
</pre>
       <p>In this case, having captured the desired syntactic environment, it is
convenient to construct syntactic closures of the identifiers <code>if</code>
and the <code>loop</code> and use them in the body of the
<code>lambda</code>.

       <p>A common use of <code>capture-syntactic-environment</code> is to get the
transformer environment of a macro transformer:

     <pre class="lisp">          (transformer
           (lambda (exp env)
             (capture-syntactic-environment
              (lambda (transformer-env)
                ...))))
</pre>
       </blockquote></div>

<h5 class="subsubsection">3.5.1.3 Identifiers</h5>

<p>This section describes the procedures that create and manipulate
identifiers.  Previous syntactic closure proposals did not have an
identifier data type &ndash; they just used symbols.  The identifier data
type extends the syntactic closures facility to be compatible with the
high-level <code>syntax-rules</code> facility.

  <p>As discussed earlier, an identifier is either a symbol or an
<dfn>alias</dfn>.  An alias is implemented as a syntactic closure whose
<dfn>form</dfn> is an identifier:

<pre class="lisp">     (make-syntactic-closure env '() 'a)
        &rArr; an <dfn>alias</dfn>
</pre>
  <p>Aliases are implemented as syntactic closures because they behave just
like syntactic closures most of the time.  The difference is that an
alias may be bound to a new value (for example by <code>lambda</code> or
<code>let-syntax</code>); other syntactic closures may not be used this way. 
If an alias is bound, then within the scope of that binding it is looked
up in the syntactic environment just like any other identifier.

  <p>Aliases are used in the implementation of the high-level facility
<code>syntax-rules</code>.  A macro transformer created by <code>syntax-rules</code>
uses a template to generate its output form, substituting subforms of
the input form into the template.  In a syntactic closures
implementation, all of the symbols in the template are replaced by
aliases closed in the transformer environment, while the output form
itself is closed in the usage environment.  This guarantees that the
macro transformation is hygienic, without requiring the transformer to
know the syntactic roles of the substituted input subforms.

<div class="defun">
&mdash; Function: <b>identifier?</b><var> object<a name="index-identifier_003f-151"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>object</var> is an identifier, otherwise returns
<code>#f</code>.  Examples:

     <pre class="lisp">          (identifier? 'a)
             &rArr; #t
          (identifier? (make-syntactic-closure env '() 'a))
             &rArr; #t
          (identifier? "a")
             &rArr; #f
          (identifier? #\a)
             &rArr; #f
          (identifier? 97)
             &rArr; #f
          (identifier? #f)
             &rArr; #f
          (identifier? '(a))
             &rArr; #f
          (identifier? '#(a))
             &rArr; #f
</pre>
       <p>The predicate <code>eq?</code> is used to determine if two identifers are
&ldquo;the same&rdquo;.  Thus <code>eq?</code> can be used to compare identifiers
exactly as it would be used to compare symbols.  Often, though, it is
useful to know whether two identifiers &ldquo;mean the same thing&rdquo;.  For
example, the <code>cond</code> macro uses the symbol <code>else</code> to identify
the final clause in the conditional.  A macro transformer for
<code>cond</code> cannot just look for the symbol <code>else</code>, because the
<code>cond</code> form might be the output of another macro transformer that
replaced the symbol <code>else</code> with an alias.  Instead the transformer
must look for an identifier that &ldquo;means the same thing&rdquo; in the usage
environment as the symbol <code>else</code> means in the transformer
environment. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>identifier=?</b><var> environment1 identifier1 environment2 identifier2<a name="index-identifier_003d_003f-152"></a></var><br>
<blockquote><p><var>environment1</var> and <var>environment2</var> must be syntactic
environments, and <var>identifier1</var> and <var>identifier2</var> must be
identifiers.  <code>identifier=?</code> returns <code>#t</code> if the meaning of
<var>identifier1</var> in <var>environment1</var> is the same as that of
<var>identifier2</var> in <var>environment2</var>, otherwise it returns <code>#f</code>. 
Examples:

     <pre class="lisp">          (let-syntax
              ((foo
                (transformer
                 (lambda (form env)
                   (capture-syntactic-environment
                    (lambda (transformer-env)
                      (identifier=? transformer-env 'x env 'x)))))))
            (list (foo)
                  (let ((x 3))
                    (foo))))
             &rArr; (#t #f)
</pre>
       <pre class="lisp">          (let-syntax ((bar foo))
            (let-syntax
                ((foo
                  (transformer
                   (lambda (form env)
                     (capture-syntactic-environment
                      (lambda (transformer-env)
                        (identifier=? transformer-env 'foo
                                      env (cadr form))))))))
              (list (foo foo)
                    (foobar))))
             &rArr; (#f #t)
</pre>
       </blockquote></div>

<h5 class="subsubsection">3.5.1.4 Acknowledgements</h5>

<p>The syntactic closures facility was invented by Alan Bawden and Jonathan
Rees.  The use of aliases to implement <code>syntax-rules</code> was invented
by Alan Bawden (who prefers to call them <dfn>synthetic names</dfn>).  Much
of this proposal is derived from an earlier proposal by Alan
Bawden.

<div class="node">
<a name="Syntax-Case-Macros"></a>
<a name="Syntax_002dCase-Macros"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Define_002dStructure">Define-Structure</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Syntactic-Closures">Syntactic Closures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.6 Syntax-Case Macros</h3>

<p><code>(require 'syntax-case)</code>
<a name="index-syntax_002dcase-153"></a>

<div class="defun">
&mdash; Function: <b>macro:expand</b><var> expression<a name="index-macro_003aexpand-154"></a></var><br>
&mdash; Function: <b>syncase:expand</b><var> expression<a name="index-syncase_003aexpand-155"></a></var><br>
<blockquote><p>Returns scheme code with the macros and derived expression types of
<var>expression</var> expanded to primitive expression types. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>macro:eval</b><var> expression<a name="index-macro_003aeval-156"></a></var><br>
&mdash; Function: <b>syncase:eval</b><var> expression<a name="index-syncase_003aeval-157"></a></var><br>
<blockquote><p><code>macro:eval</code> returns the value of <var>expression</var> in the current
top level environment.  <var>expression</var> can contain macro definitions. 
Side effects of <var>expression</var> will affect the top level
environment. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>macro:load</b><var> filename<a name="index-macro_003aload-158"></a></var><br>
&mdash; Procedure: <b>syncase:load</b><var> filename<a name="index-syncase_003aload-159"></a></var><br>
<blockquote><p><var>filename</var> should be a string.  If filename names an existing
file, the <code>macro:load</code> procedure reads Scheme source code
expressions and definitions from the file and evaluates them
sequentially.  These source code expressions and definitions may
contain macro definitions.  The <code>macro:load</code> procedure does not
affect the values returned by <code>current-input-port</code>,
<code>current-error-port</code>, and <code>current-output-port</code>. 
</p></blockquote></div>

  <p>This is version 2.1 of <code>syntax-case</code>, the low-level macro facility
proposed and implemented by Robert Hieb and R. Kent Dybvig.

  <p>This version is further adapted by Harald Hanche-Olsen
&lt;hanche @ imf.unit.no&gt; to make it compatible with, and easily usable
with, SLIB.  Mainly, these adaptations consisted of:

     <ul>
<li>Removing white space from <samp><span class="file">expand.pp</span></samp> to save space in the
distribution.  This file is not meant for human readers anyway<small class="dots">...</small>

     <li>Removed a couple of Chez scheme dependencies.

     <li>Renamed global variables used to minimize the possibility of name
conflicts.

     <li>Adding an SLIB-specific initialization file.

     <li>Removing a couple extra files, most notably the documentation (but see
below). 
</ul>

  <p>If you wish, you can see exactly what changes were done by reading the
shell script in the file <samp><span class="file">syncase.sh</span></samp>.

  <p>The two PostScript files were omitted in order to not burden the SLIB
distribution with them.  If you do intend to use <code>syntax-case</code>,
however, you should get these files and print them out on a PostScript
printer.  They are available with the original <code>syntax-case</code>
distribution by anonymous FTP in
<samp><span class="file">cs.indiana.edu:/pub/scheme/syntax-case</span></samp>.

  <p>In order to use syntax-case from an interactive top level, execute:
<pre class="lisp">     (require 'syntax-case)
     <a name="index-syntax_002dcase-160"></a>(require 'repl)
     <a name="index-repl-161"></a>(repl:top-level macro:eval)
</pre>
  <p>See the section Repl (see <a href="#Repl">Repl</a>) for more information.

  <p>To check operation of syntax-case get
<samp><span class="file">cs.indiana.edu:/pub/scheme/syntax-case</span></samp>, and type
<pre class="lisp">     (require 'syntax-case)
     <a name="index-syntax_002dcase-162"></a><a name="index-syncase_003asanity_002dcheck-163"></a>(syncase:sanity-check)
</pre>
  <p>Beware that <code>syntax-case</code> takes a long time to load &ndash; about 20s on
a SPARCstation SLC (with SCM) and about 90s on a Macintosh SE/30 (with
Gambit).

<h4 class="subsection">3.6.1 Notes</h4>

<p>All R4RS syntactic forms are defined, including <code>delay</code>.  Along
with <code>delay</code> are simple definitions for <code>make-promise</code> (into
which <code>delay</code> expressions expand) and <code>force</code>.

  <p><code>syntax-rules</code> and <code>with-syntax</code> (described in <cite>TR356</cite>)
are defined.

  <p><code>syntax-case</code> is actually defined as a macro that expands into
calls to the procedure <code>syntax-dispatch</code> and the core form
<code>syntax-lambda</code>; do not redefine these names.

  <p>Several other top-level bindings not documented in TR356 are created:
     <ul>
<li>the &ldquo;hooks&rdquo; in <samp><span class="file">hooks.ss</span></samp>
<li>the <code>build-</code> procedures in <samp><span class="file">output.ss</span></samp>
<li><code>expand-syntax</code> (the expander)
</ul>

  <p>The syntax of define has been extended to allow <code>(define </code><var>id</var><code>)</code>,
which assigns <var>id</var> to some unspecified value.

  <p>We have attempted to maintain R4RS compatibility where possible.  The
incompatibilities should be confined to <samp><span class="file">hooks.ss</span></samp>.  Please let us
know if there is some incompatibility that is not flagged as such.

  <p>Send bug reports, comments, suggestions, and questions to Kent Dybvig
(dyb @ iuvax.cs.indiana.edu).

<div class="node">
<a name="Define-Structure"></a>
<a name="Define_002dStructure"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Define_002dRecord_002dType">Define-Record-Type</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Syntax_002dCase-Macros">Syntax-Case Macros</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.7 Define-Structure</h3>

<p><code>(require 'structure)</code>

<p class="noindent">Included with the <code>syntax-case</code> files was <samp><span class="file">structure.scm</span></samp>
which defines a macro <code>define-structure</code>.  Here is its
documentation from Gambit-4.0:

<div class="defun">
&mdash; special form: <b>define-structure</b> (<var>name field<small class="dots">...</small></var>)<var><a name="index-define_002dstructure-164"></a></var><br>
<blockquote>
       <p>Record data types similar to Pascal records and C <code>struct</code>
types can be defined using the <code>define-structure</code> special form. 
The identifier <var>name</var> specifies the name of the new data type.  The
structure name is followed by <var>k</var> identifiers naming each field of
the record.  The <code>define-structure</code> expands into a set of definitions
of the following procedures:

          <ul>
<li>`<tt>make-</tt><var>name</var>' &ndash; A <var>k</var> argument procedure which constructs
a new record from the value of its <var>k</var> fields.

          <li>`<var>name</var><tt>?</tt>' &ndash; A procedure which tests if its single argument
is of the given record type.

          <li>`<var>name</var><tt>-</tt><var>field</var>' &ndash; For each field, a procedure taking
as its single argument a value of the given record type and returning
the content of the corresponding field of the record.

          <li>`<var>name</var><tt>-</tt><var>field</var><tt>-set!</tt>' &ndash; For each field, a two
argument procedure taking as its first argument a value of the given
record type.  The second argument gets assigned to the corresponding
field of the record and the void object is returned.

       </ul>

       <p>Gambit record data types have a printed representation that includes
the name of the type and the name and value of each field.

       <p>For example:

     <pre class="smallexample">          &gt; <b>(require 'syntax-case)</b>
          &gt; <b>(require 'repl)</b>
          &gt; <b>(repl:top-level macro:eval)</b>
          &gt; <b>(require 'structure)</b>
          &gt; <b>(define-structure (point x y color))</b>
          &gt; <b>(define p (make-point 3 5 'red))</b>
          &gt; <b>p</b>
          #&lt;point #3 x: 3 y: 5 color: red&gt;
          &gt; <b>(point-x p)</b>
          3
          &gt; <b>(point-color p)</b>
          red
          &gt; <b>(point-color-set! p 'black)</b>
          &gt; <b>p</b>
          #&lt;point #3 x: 3 y: 5 color: black&gt;
</pre>
       </blockquote></div>

<div class="node">
<a name="Define-Record-Type"></a>
<a name="Define_002dRecord_002dType"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Fluid_002dLet">Fluid-Let</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Define_002dStructure">Define-Structure</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.8 Define-Record-Type</h3>

<p><code>(require 'define-record-type)</code> or <code>(require 'srfi-9)</code>
<a name="index-srfi_002d9-165"></a><a name="index-define_002drecord_002dtype-166"></a>
<a href="http://srfi.schemers.org/srfi-9/srfi-9.html">http://srfi.schemers.org/srfi-9/srfi-9.html</a>

<div class="defun">
&mdash; Special Form: <b>define-record-type</b><var> &lt;type-name&gt; </var>(<var>&lt;constructor-name&gt; &lt;field-tag&gt; ...</var>)<var> &lt;predicate-name&gt; &lt;field-spec&gt; ...<a name="index-define_002drecord_002dtype-167"></a></var><br>
<blockquote>
       <p>Where
     <pre class="lisp">          &lt;field-spec&gt; == (&lt;field-tag&gt; &lt;accessor-name&gt;)
                       == (&lt;field-tag&gt; &lt;accessor-name&gt; &lt;modifier-name&gt;)
          
</pre>
       <p><code>define-record-type</code> is a syntax wrapper for the SLIB
<code>record</code> module. 
</p></blockquote></div>

<div class="node">
<a name="Fluid-Let"></a>
<a name="Fluid_002dLet"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parameter-Objects">Parameter Objects</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Define_002dRecord_002dType">Define-Record-Type</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.9 Fluid-Let</h3>

<p><code>(require 'fluid-let)</code>
<a name="index-fluid_002dlet-168"></a>
<blockquote>
<em>Note:</em> <code>fluid-let</code> is not thread-safe.  It is better to use
<a href="#Parameter-Objects">Parameter Objects</a> (srfi-39) or <a href="#Dynamic-Data-Type">Dynamic Data Type</a>, both of
which will be made thread-safe in the future. 
</blockquote>

<div class="defun">
&mdash; Syntax: <b>fluid-let</b> <code>(</code><var>bindings</var><code> ...)</code><var> forms<small class="dots">...</small><a name="index-fluid_002dlet-169"></a></var><br>
       </div>

<pre class="lisp">     (fluid-let ((<var>variable</var> <var>init</var>) ...)
        <var>expression</var> <var>expression</var> ...)
</pre>
  <p>The <var>init</var>s are evaluated in the current environment (in some
unspecified order), the current values of the <var>variable</var>s are saved,
the results are assigned to the <var>variable</var>s, the <var>expression</var>s
are evaluated sequentially in the current environment, the
<var>variable</var>s are restored to their original values, and the value of
the last <var>expression</var> is returned.

  <p>The syntax of this special form is similar to that of <code>let</code>, but
<code>fluid-let</code> temporarily rebinds existing <var>variable</var>s.  Unlike
<code>let</code>, <code>fluid-let</code> creates no new bindings; instead it
<em>assigns</em> the values of each <var>init</var> to the binding (determined
by the rules of lexical scoping) of its corresponding
<var>variable</var>.

<div class="node">
<a name="Parameter-Objects"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Binding-to-multiple-values">Binding to multiple values</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Fluid_002dLet">Fluid-Let</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.10 Parameter Objects</h3>

<p><code>(require 'srfi-39)</code>
<a name="index-srfi_002d39-170"></a>
<a href="http://srfi.schemers.org/srfi-39/srfi-39.html">http://srfi.schemers.org/srfi-39/srfi-39.html</a>

<div class="node">
<a name="Binding-to-multiple-values"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Guarded-LET_002a-special-form">Guarded LET* special form</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parameter-Objects">Parameter Objects</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.11 Binding to multiple values</h3>

<p><code>(require 'receive)</code> or <code>(require 'srfi-8)</code>
<a name="index-srfi_002d8-171"></a><a name="index-receive-172"></a>

<div class="defun">
&mdash; Special Form: <b>receive</b><var> formals expression body <small class="dots">...</small><a name="index-receive-173"></a></var><br>
<blockquote>
       <p><a href="http://srfi.schemers.org/srfi-8/srfi-8.html">http://srfi.schemers.org/srfi-8/srfi-8.html</a>
</p></blockquote></div>

  <p><code>(require 'let-values)</code> or <code>(require 'srfi-11)</code>
<a name="index-srfi_002d11-174"></a><a name="index-let_002dvalues-175"></a>

<div class="defun">
&mdash; Special Form: <b>let-values</b> ((<var>formals expression</var>)<var> ...</var>)<var> body <small class="dots">...</small><a name="index-let_002dvalues-176"></a></var><br>
&mdash; Special Form: <b>let-values*</b> ((<var>formals expression</var>)<var> ...</var>)<var> body <small class="dots">...</small><a name="index-let_002dvalues_002a-177"></a></var><br>
<blockquote>
       <p><a href="http://srfi.schemers.org/srfi-11/srfi-11.html">http://srfi.schemers.org/srfi-11/srfi-11.html</a>
</p></blockquote></div>

<div class="node">
<a name="Guarded-LET*-special-form"></a>
<a name="Guarded-LET_002a-special-form"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Guarded-COND-Clause">Guarded COND Clause</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Binding-to-multiple-values">Binding to multiple values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.12 Guarded LET* special form</h3>

<p><code>(require 'and-let*)</code> or <code>(require 'srfi-2)</code>
<a name="index-srfi_002d2-178"></a><a name="index-and_002dlet_002a-179"></a>

<div class="defun">
&mdash; Macro: <b>and-let*</b><var> claws body <small class="dots">...</small><a name="index-and_002dlet_002a-180"></a></var><br>
<blockquote>
       <p><a href="http://srfi.schemers.org/srfi-2/srfi-2.html">http://srfi.schemers.org/srfi-2/srfi-2.html</a>
</p></blockquote></div>

<div class="node">
<a name="Guarded-COND-Clause"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Yasos">Yasos</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Guarded-LET_002a-special-form">Guarded LET* special form</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.13 Guarded COND Clause</h3>

<p><code>(require 'guarded-cond-clause)</code> or <code>(require 'srfi-61)</code>
<a name="index-srfi_002d61-181"></a><a name="index-guarded_002dcond_002dclause-182"></a>
<a href="http://srfi.schemers.org/srfi-61/srfi-61.html">http://srfi.schemers.org/srfi-61/srfi-61.html</a>

<div class="defun">
&mdash; library syntax: <b>cond</b><var> &lt;clause1&gt; &lt;clause2&gt; <small class="dots">...</small><a name="index-cond-183"></a></var><br>
<blockquote>
       <p><em>Syntax:</em>
Each <span class="roman">&lt;clause&gt;</span> should be of the form

     <pre class="format"><tt>(</tt><span class="roman">&lt;test&gt;</span> <span class="roman">&lt;expression1&gt;</span><tt> <small class="dots">...</small>)
     </tt>
</pre>
       <p>where <span class="roman">&lt;test&gt;</span> is any expression.  Alternatively, a <span class="roman">&lt;clause&gt;</span> may be
of the form

     <pre class="format"><tt>(</tt><span class="roman">&lt;test&gt;</span><tt> =&gt; </tt><span class="roman">&lt;expression&gt;</span><tt>)
     </tt>
</pre>
       <p>The <span class="roman">&lt;clause&gt;</span> production in the formal syntax of Scheme as
written by R5RS in section 7.1.3 is extended with a new option:
<a name="index-g_t_0040w_007b_003d_003e_007d-184"></a>
     <pre class="format"><span class="roman">&lt;clause&gt;</span><tt> =&gt; (</tt><span class="roman">&lt;generator&gt;</span> <span class="roman">&lt;guard&gt;</span><tt> =&gt; </tt><span class="roman">&lt;receiver&gt;</span><tt>)
     </tt>
</pre>
       <p>where <span class="roman">&lt;generator&gt;</span>, <span class="roman">&lt;guard&gt;</span>, &amp; <span class="roman">&lt;receiver&gt;</span> are all
<span class="roman">&lt;expression&gt;</span>s.

       <blockquote>
Clauses of this form have the following semantics: <span class="roman">&lt;generator&gt;</span> is
evaluated.  It may return arbitrarily many values.  <span class="roman">&lt;Guard&gt;</span> is
applied to an argument list containing the values in order that
<span class="roman">&lt;generator&gt;</span> returned.  If <span class="roman">&lt;guard&gt;</span> returns a true value for
that argument list, <span class="roman">&lt;receiver&gt;</span> is applied with an equivalent
argument list.  If <span class="roman">&lt;guard&gt;</span> returns a false value, however, the
clause is abandoned and the next one is tried. 
</blockquote>

       <p>The last <span class="roman">&lt;clause&gt;</span> may be
an &ldquo;else clause,&rdquo; which has the form

     <pre class="format"><tt>(else </tt><span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span><tt> <small class="dots">...</small>)</tt><span class="roman">.</span>
     
</pre>
       </blockquote></div>

<p class="noindent">This <code>port-&gt;char-list</code> procedure accepts an input port and
returns a list of all the characters it produces until the end.

<pre class="example">     (define (port-&gt;char-list port)
       (cond ((read-char port) char?
              =&gt; (lambda (c) (cons c (port-&gt;char-list port))))
             (else '())))
     
     (call-with-input-string "foo" port-&gt;char-list)  ==&gt;  (#\f #\o #\o)
</pre>
  <div class="node">
<a name="Yasos"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Guarded-COND-Clause">Guarded COND Clause</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>

</div>

<h3 class="section">3.14 Yasos</h3>

<!-- Much of the documentation in this section was written by Dave Love -->
<!-- (d.love@dl.ac.uk) - don't blame Ken Dickey for its faults. -->
<!-- but we can blame him for not writing it! -->
<p><code>(require 'oop)</code> or <code>(require 'yasos)</code>
<a name="index-oop-185"></a><a name="index-yasos-186"></a>
`Yet Another Scheme Object System' is a simple object system for Scheme
based on the paper by Norman Adams and Jonathan Rees: <cite>Object
Oriented Programming in Scheme</cite>, Proceedings of the 1988 ACM Conference
on LISP and Functional Programming, July 1988 [ACM #552880].

  <p>Another reference is:

  <p>Ken Dickey.<br>
Scheming with Objects<br>
<cite>AI Expert</cite> Volume 7, Number 10 (October 1992), pp. 24-33.<br>
<a href="ftp://ftp.cs.indiana.edu/pub/scheme-repository/doc/pubs/swob.txt">ftp://ftp.cs.indiana.edu/pub/scheme-repository/doc/pubs/swob.txt</a>

<ul class="menu">
<li><a accesskey="1" href="#Yasos-terms">Yasos terms</a>:                  Definitions and disclaimer. 
<li><a accesskey="2" href="#Yasos-interface">Yasos interface</a>:              The Yasos macros and procedures. 
<li><a accesskey="3" href="#Setters">Setters</a>:                      Dylan-like setters in Yasos. 
<li><a accesskey="4" href="#Yasos-examples">Yasos examples</a>:               Usage of Yasos and setters. 
</ul>

<div class="node">
<a name="Yasos-terms"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Yasos-interface">Yasos interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Yasos">Yasos</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Yasos">Yasos</a>

</div>

<h4 class="subsection">3.14.1 Terms</h4>

     <dl>
<dt><dfn>Object</dfn><dd>Any Scheme data object.

     <br><dt><dfn>Instance</dfn><dd>An instance of the OO system; an <dfn>object</dfn>.

     <br><dt><dfn>Operation</dfn><dd>A <var>method</var>. 
</dl>

     <dl>
<dt><em>Notes:</em><dd>The object system supports multiple inheritance.  An instance can
inherit from 0 or more ancestors.  In the case of multiple inherited
operations with the same identity, the operation used is that from the
first ancestor which contains it (in the ancestor <code>let</code>).  An
operation may be applied to any Scheme data object&mdash;not just instances. 
As code which creates instances is just code, there are no <dfn>classes</dfn>
and no meta-<var>anything</var>.  Method dispatch is by a procedure call a la
CLOS rather than by <code>send</code> syntax a la Smalltalk.

     <br><dt><em>Disclaimer:</em><dd>There are a number of optimizations which can be made.  This
implementation is expository (although performance should be quite
reasonable).  See the L&amp;FP paper for some suggestions. 
</dl>

<div class="node">
<a name="Yasos-interface"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Setters">Setters</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Yasos-terms">Yasos terms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Yasos">Yasos</a>

</div>

<h4 class="subsection">3.14.2 Interface</h4>

<div class="defun">
&mdash; Syntax: <b>define-operation</b> <code>(</code><var>opname self arg <small class="dots">...</small></var><code>)</code><var> default-body<a name="index-define_002doperation-187"></a></var><br>
<blockquote><p>Defines a default behavior for data objects which don't handle the
operation <var>opname</var>.  The default behavior (for an empty
<var>default-body</var>) is to generate an error. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>define-predicate</b><var> opname?<a name="index-define_002dpredicate-188"></a></var><br>
<blockquote><p>Defines a predicate <var>opname?</var>, usually used for determining the
<dfn>type</dfn> of an object, such that <code>(</code><var>opname?</var> <var>object</var><code>)</code>
returns <code>#t</code> if <var>object</var> has an operation <var>opname?</var> and
<code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>object</b> <code>((</code><var>name</var> <var>self</var> <var>arg</var><code> ...) </code><var>body</var><code>)</code><var> <small class="dots">...</small><a name="index-object-189"></a></var><br>
<blockquote><p>Returns an object (an instance of the object system) with operations. 
Invoking <code>(</code><var>name</var> <var>object</var> <var>arg</var><code> ...)</code> executes the
<var>body</var> of the <var>object</var> with <var>self</var> bound to <var>object</var> and
with argument(s) <var>arg</var><small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>object-with-ancestors</b> <code>((</code><var>ancestor1 init1</var><code>)</code><var> <small class="dots">...</small></var><code>)</code><var> operation <small class="dots">...</small><a name="index-object_002dwith_002dancestors-190"></a></var><br>
<blockquote><p>A <code>let</code>-like form of <code>object</code> for multiple inheritance.  It
returns an object inheriting the behaviour of <var>ancestor1</var> etc.  An
operation will be invoked in an ancestor if the object itself does not
provide such a method.  In the case of multiple inherited operations
with the same identity, the operation used is the one found in the first
ancestor in the ancestor list. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>operate-as</b><var> component operation self arg <small class="dots">...</small><a name="index-operate_002das-191"></a></var><br>
<blockquote><p>Used in an operation definition (of <var>self</var>) to invoke the
<var>operation</var> in an ancestor <var>component</var> but maintain the object's
identity.  Also known as &ldquo;send-to-super&rdquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>print</b><var> obj port<a name="index-print-192"></a></var><br>
<blockquote><p>A default <code>print</code> operation is provided which is just <code>(format
</code><var>port</var> <var>obj</var><code>)</code> (see <a href="#Format">Format</a>) for non-instances and prints
<var>obj</var> preceded by &lsquo;<samp><span class="samp">#&lt;INSTANCE&gt;</span></samp>&rsquo; for instances. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>size</b><var> obj<a name="index-size-193"></a></var><br>
<blockquote><p>The default method returns the number of elements in <var>obj</var> if it is
a vector, string or list, <code>2</code> for a pair, <code>1</code> for a character
and by default id an error otherwise.  Objects such as collections
(see <a href="#Collections">Collections</a>) may override the default in an obvious way. 
</p></blockquote></div>

<div class="node">
<a name="Setters"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Yasos-examples">Yasos examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Yasos-interface">Yasos interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Yasos">Yasos</a>

</div>

<h4 class="subsection">3.14.3 Setters</h4>

<p><dfn>Setters</dfn> implement <dfn>generalized locations</dfn> for objects
associated with some sort of mutable state.  A <dfn>getter</dfn> operation
retrieves a value from a generalized location and the corresponding
setter operation stores a value into the location.  Only the getter is
named &ndash; the setter is specified by a procedure call as below.  (Dylan
uses special syntax.)  Typically, but not necessarily, getters are
access operations to extract values from Yasos objects (see <a href="#Yasos">Yasos</a>). 
Several setters are predefined, corresponding to getters <code>car</code>,
<code>cdr</code>, <code>string-ref</code> and <code>vector-ref</code> e.g., <code>(setter
car)</code> is equivalent to <code>set-car!</code>.

  <p>This implementation of setters is similar to that in Dylan(TM)
(<cite>Dylan: An object-oriented dynamic language</cite>, Apple Computer
Eastern Research and Technology).  Common LISP provides similar
facilities through <code>setf</code>.

<div class="defun">
&mdash; Function: <b>setter</b><var> getter<a name="index-setter-194"></a></var><br>
<blockquote><p>Returns the setter for the procedure <var>getter</var>.  E.g., since
<code>string-ref</code> is the getter corresponding to a setter which is
actually <code>string-set!</code>:
     <pre class="example">          (define foo "foo")
          ((setter string-ref) foo 0 #\F) ; set element 0 of foo
          foo &rArr; "Foo"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Syntax: <b>set</b><var> place new-value<a name="index-set-195"></a></var><br>
<blockquote><p>If <var>place</var> is a variable name, <code>set</code> is equivalent to
<code>set!</code>.  Otherwise, <var>place</var> must have the form of a procedure
call, where the procedure name refers to a getter and the call indicates
an accessible generalized location, i.e., the call would return a value. 
The return value of <code>set</code> is usually unspecified unless used with a
setter whose definition guarantees to return a useful value.
     <pre class="example">          (set (string-ref foo 2) #\O)  ; generalized location with getter
          foo &rArr; "FoO"
          (set foo "foo")               ; like set!
          foo &rArr; "foo"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>add-setter</b><var> getter setter<a name="index-add_002dsetter-196"></a></var><br>
<blockquote><p>Add procedures <var>getter</var> and <var>setter</var> to the (inaccessible) list
of valid setter/getter pairs.  <var>setter</var> implements the store
operation corresponding to the <var>getter</var> access operation for the
relevant state.  The return value is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>remove-setter-for</b><var> getter<a name="index-remove_002dsetter_002dfor-197"></a></var><br>
<blockquote><p>Removes the setter corresponding to the specified <var>getter</var> from the
list of valid setters.  The return value is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>define-access-operation</b><var> getter-name<a name="index-define_002daccess_002doperation-198"></a></var><br>
<blockquote><p>Shorthand for a Yasos <code>define-operation</code> defining an operation
<var>getter-name</var> that objects may support to return the value of some
mutable state.  The default operation is to signal an error.  The return
value is unspecified. 
</p></blockquote></div>

<div class="node">
<a name="Yasos-examples"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Setters">Setters</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Yasos">Yasos</a>

</div>

<h4 class="subsection">3.14.4 Examples</h4>

<pre class="lisp">     ;;; These definitions for PRINT and SIZE are
     ;;; already supplied by
     (require 'yasos)
     
     (define-operation (print obj port)
       (format port
               (if (instance? obj) "#&lt;instance&gt;" "~s")
               obj))
     
     (define-operation (size obj)
       (cond
        ((vector? obj) (vector-length obj))
        ((list?   obj) (length obj))
        ((pair?   obj) 2)
        ((string? obj) (string-length obj))
        ((char?   obj) 1)
        (else
         (slib:error "Operation not supported: size" obj))))
     
     (define-predicate cell?)
     (define-operation (fetch obj))
     (define-operation (store! obj newValue))
     
     (define (make-cell value)
       (object
        ((cell? self) #t)
        ((fetch self) value)
        ((store! self newValue)
         (set! value newValue)
         newValue)
        ((size self) 1)
        ((print self port)
         (format port "#&lt;Cell: ~s&gt;" (fetch self)))))
     
     (define-operation (discard obj value)
       (format #t "Discarding ~s~%" value))
     
     (define (make-filtered-cell value filter)
       (object-with-ancestors
        ((cell (make-cell value)))
        ((store! self newValue)
        (if (filter newValue)
            (store! cell newValue)
            (discard self newValue)))))
     
     (define-predicate array?)
     (define-operation (array-ref array index))
     (define-operation (array-set! array index value))
     
     (define (make-array num-slots)
       (let ((anArray (make-vector num-slots)))
         (object
          ((array? self) #t)
          ((size self) num-slots)
          ((array-ref self index)
           (vector-ref  anArray index))
          ((array-set! self index newValue)
           (vector-set! anArray index newValue))
          ((print self port)
           (format port "#&lt;Array ~s&gt;" (size self))))))
     
     (define-operation (position obj))
     (define-operation (discarded-value obj))
     
     (define (make-cell-with-history value filter size)
       (let ((pos 0) (most-recent-discard #f))
         (object-with-ancestors
          ((cell (make-filtered-call value filter))
           (sequence (make-array size)))
          ((array? self) #f)
          ((position self) pos)
          ((store! self newValue)
           (operate-as cell store! self newValue)
           (array-set! self pos newValue)
           (set! pos (+ pos 1)))
          ((discard self value)
           (set! most-recent-discard value))
          ((discarded-value self) most-recent-discard)
          ((print self port)
           (format port "#&lt;Cell-with-history ~s&gt;"
                   (fetch self))))))
     
     (define-access-operation fetch)
     (add-setter fetch store!)
     (define foo (make-cell 1))
     (print foo #f)
     &rArr; "#&lt;Cell: 1&gt;"
     (set (fetch foo) 2)
     &rArr;
     (print foo #f)
     &rArr; "#&lt;Cell: 2&gt;"
     (fetch foo)
     &rArr; 2
</pre>
<div class="node">
<a name="Textual-Conversion-Packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Mathematical-Packages">Mathematical Packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Scheme-Syntax-Extension-Packages">Scheme Syntax Extension Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 Textual Conversion Packages</h2>

<ul class="menu">
<li><a accesskey="1" href="#Precedence-Parsing">Precedence Parsing</a>
<li><a accesskey="2" href="#Format">Format</a>:                       Common-Lisp Format
<li><a accesskey="3" href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a>:       Posix printf and scanf
<li><a accesskey="4" href="#Programs-and-Arguments">Programs and Arguments</a>
<li><a accesskey="5" href="#HTML">HTML</a>:                         Generating
<li><a accesskey="6" href="#HTML-Tables">HTML Tables</a>:                  Databases meet HTML
<li><a accesskey="7" href="#HTTP-and-CGI">HTTP and CGI</a>:                 Serve WWW sites
<li><a accesskey="8" href="#Parsing-HTML">Parsing HTML</a>:                 'html-for-each
<li><a accesskey="9" href="#URI">URI</a>:                          Uniform Resource Identifier
<li><a href="#Parsing-XML">Parsing XML</a>:                  'parse-xml or 'ssax
<li><a href="#Printing-Scheme">Printing Scheme</a>:              Nicely
<li><a href="#Time-and-Date">Time and Date</a>
<li><a href="#NCBI_002dDNA">NCBI-DNA</a>:                     DNA and protein sequences
<li><a href="#Schmooz">Schmooz</a>:                      Documentation markup for Scheme programs
</ul>

<div class="node">
<a name="Precedence-Parsing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Format">Format</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.1 Precedence Parsing</h3>

<p><code>(require 'precedence-parse)</code> or <code>(require 'parse)</code>
<a name="index-parse-199"></a><a name="index-precedence-200"></a>
This package implements:

     <ul>
<li>a Pratt style precedence parser;
<li>a <dfn>tokenizer</dfn> which congeals tokens according to assigned classes of
constituent characters;
<li>procedures giving direct control of parser rulesets;
<li>procedures for higher level specification of rulesets. 
</ul>

<ul class="menu">
<li><a accesskey="1" href="#Precedence-Parsing-Overview">Precedence Parsing Overview</a>
<li><a accesskey="2" href="#Rule-Types">Rule Types</a>
<li><a accesskey="3" href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a>
<li><a accesskey="4" href="#Token-definition">Token definition</a>
<li><a accesskey="5" href="#Nud-and-Led-Definition">Nud and Led Definition</a>
<li><a accesskey="6" href="#Grammar-Rule-Definition">Grammar Rule Definition</a>
</ul>

<div class="node">
<a name="Precedence-Parsing-Overview"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Rule-Types">Rule Types</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Precedence-Parsing">Precedence Parsing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence-Parsing">Precedence Parsing</a>

</div>

<h4 class="subsection">4.1.1 Precedence Parsing Overview</h4>

<p class="noindent">This package offers improvements over previous parsers.

     <ul>
<li>Common computer language constructs are concisely specified. 
<li>Grammars can be changed dynamically.  Operators can be assigned
different meanings within a lexical context. 
<li>Rulesets don't need compilation.  Grammars can be changed incrementally. 
<li>Operator precedence is specified by integers. 
<li>All possibilities of bad input are handled <a rel="footnote" href="#fn-4" name="fnd-4"><sup>4</sup></a> and return as much structure as was
parsed when the error occured; The symbol <code>?</code> is substituted for
missing input. 
</ul>

<p class="noindent"><a name="index-binding-power-201"></a>The notion of <dfn>binding power</dfn> may be unfamiliar to those
accustomed to BNF grammars.

<p class="noindent">When two consecutive objects are parsed, the first might be the prefix
to the second, or the second might be a suffix of the first. 
Comparing the left and right binding powers of the two objects decides
which way to interpret them.

<p class="noindent">Objects at each level of syntactic grouping have binding powers.

<p class="noindent"><a name="index-syntax-tree-202"></a>A syntax tree is not built unless the rules explicitly do so.  The
call graph of grammar rules effectively instantiate the sytnax tree.

<p class="noindent">The JACAL symbolic math system
(<a href="http://people.csail.mit.edu/jaffer/JACAL">http://people.csail.mit.edu/jaffer/JACAL</a>) uses
<tt>precedence-parse</tt>.  Its grammar definitions in the file
<samp><span class="file">jacal/English.scm</span></samp> can serve as examples of use.

<div class="node">
<a name="Rule-Types"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Precedence-Parsing-Overview">Precedence Parsing Overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence-Parsing">Precedence Parsing</a>

</div>

<h4 class="subsection">4.1.2 Rule Types</h4>

<p class="noindent">Here are the higher-level syntax types and an example of each. 
Precedence considerations are omitted for clarity. 
See <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a> for full details.

<div class="defun">
&mdash; Grammar: <b>nofix</b><var> bye exit<a name="index-nofix-203"></a></var><br>
<blockquote><pre class="example">          bye
</pre>
       <p>calls the function <code>exit</code> with no arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>prefix</b><var> - negate<a name="index-prefix-204"></a></var><br>
<blockquote><pre class="example">          - 42
</pre>
       <p>Calls the function <code>negate</code> with the argument <code>42</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>infix</b><var> - difference<a name="index-infix-205"></a></var><br>
<blockquote><pre class="example">          x - y
</pre>
       <p>Calls the function <code>difference</code> with arguments <code>x</code> and <code>y</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>nary</b><var> + sum<a name="index-nary-206"></a></var><br>
<blockquote><pre class="example">          x + y + z
</pre>
       <p>Calls the function <code>sum</code> with arguments <code>x</code>, <code>y</code>, and
<code>y</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>postfix</b><var> ! factorial<a name="index-postfix-207"></a></var><br>
<blockquote><pre class="example">          5 !
</pre>
       <p>Calls the function <code>factorial</code> with the argument <code>5</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>prestfix</b><var> set set!<a name="index-prestfix-208"></a></var><br>
<blockquote><pre class="example">          set foo bar
</pre>
       <p>Calls the function <code>set!</code> with the arguments <code>foo</code> and
<code>bar</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>commentfix</b><var> /* */<a name="index-commentfix-209"></a></var><br>
<blockquote><pre class="example">          /* almost any text here */
</pre>
       <p>Ignores the comment delimited by <code>/*</code> and <code>*/</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>matchfix</b><var> { list }<a name="index-matchfix-210"></a></var><br>
<blockquote><pre class="example">          {0, 1, 2}
</pre>
       <p>Calls the function <code>list</code> with the arguments <code>0</code>, <code>1</code>,
and <code>2</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>inmatchfix</b> (<var> funcall </var>)<var><a name="index-inmatchfix-211"></a></var><br>
<blockquote><pre class="example">          f(x, y)
</pre>
       <p>Calls the function <code>funcall</code> with the arguments <code>f</code>, <code>x</code>,
and <code>y</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Grammar: <b>delim</b><var> ;<a name="index-delim-212"></a></var><br>
<blockquote><pre class="example">          set foo bar;
</pre>
       <p>delimits the extent of the restfix operator <code>set</code>. 
</p></blockquote></div>

<div class="node">
<a name="Ruleset-Definition-and-Use"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Token-definition">Token definition</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rule-Types">Rule Types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence-Parsing">Precedence Parsing</a>

</div>

<h4 class="subsection">4.1.3 Ruleset Definition and Use</h4>

<div class="defun">
&mdash; Variable: <b>*syn-defs*</b><var><a name="index-g_t_002asyn_002ddefs_002a-213"></a></var><br>
<blockquote><p>A grammar is built by one or more calls to <code>prec:define-grammar</code>. 
The rules are appended to <var>*syn-defs*</var>.  The value of
<var>*syn-defs*</var> is the grammar suitable for passing as an argument to
<code>prec:parse</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>*syn-ignore-whitespace*</b><var><a name="index-g_t_002asyn_002dignore_002dwhitespace_002a-214"></a></var><br>
<blockquote><p>Is a nearly empty grammar with whitespace characters set to group 0,
which means they will not be made into tokens.  Most rulesets will want
to start with <code>*syn-ignore-whitespace*</code>
</p></blockquote></div>

<p class="noindent">In order to start defining a grammar, either

<pre class="example">     (set! *syn-defs* '())
</pre>
  <p class="noindent">or

<pre class="example">     (set! *syn-defs* *syn-ignore-whitespace*)
</pre>
  <div class="defun">
&mdash; Function: <b>prec:define-grammar</b><var> rule1 <small class="dots">...</small><a name="index-prec_003adefine_002dgrammar-215"></a></var><br>
<blockquote><p>Appends <var>rule1</var> <small class="dots">...</small> to <var>*syn-defs*</var>. 
<code>prec:define-grammar</code> is used to define both the character classes
and rules for tokens. 
</p></blockquote></div>

<p class="noindent">Once your grammar is defined, save the value of <code>*syn-defs*</code> in a
variable (for use when calling <code>prec:parse</code>).

<pre class="example">     (define my-ruleset *syn-defs*)
</pre>
  <div class="defun">
&mdash; Function: <b>prec:parse</b><var> ruleset delim column<a name="index-prec_003aparse-216"></a></var><br>
&mdash; Function: <b>prec:parse</b><var> ruleset delim column port<a name="index-prec_003aparse-217"></a></var><br>
<blockquote><p>The <var>ruleset</var> argument must be a list of rules as constructed by
<code>prec:define-grammar</code> and extracted from <var>*syn-defs*</var>.

       <p>The token <var>delim</var> may be a character, symbol, or string.  A
character <var>delim</var> argument will match only a character token;
i.e. a character for which no token-group is assigned.  A symbol or
string will match only a token string; i.e. a token resulting from a
token group.

       <p><code>prec:parse</code> reads a <var>ruleset</var> grammar expression delimited
by <var>delim</var> from the given input <var>port</var>.  <code>prec:parse</code>
returns the next object parsable from the given input <var>port</var>,
updating <var>port</var> to point to the first character past the end of the
external representation of the object.

       <p>For the purpose of reporting problems in error messages, this package
keeps track of the <dfn>current column</dfn>.  Its initial value is passed
as the third argument to <code>prec:parse</code>.

       <p>If an end of file is encountered in the input before any characters are
found that can begin an object, then an end of file object is returned. 
If a delimiter (such as <var>delim</var>) is found before any characters are
found that can begin an object, then <code>#f</code> is returned.

       <p>The <var>port</var> argument may be omitted, in which case it defaults to the
value returned by <code>current-input-port</code>.  It is an error to parse
from a closed port. 
<a name="index-current_002dinput_002dport-218"></a></p></blockquote></div>

<div class="node">
<a name="Token-definition"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Nud-and-Led-Definition">Nud and Led Definition</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence-Parsing">Precedence Parsing</a>

</div>

<h4 class="subsection">4.1.4 Token definition</h4>

<div class="defun">
&mdash; Function: <b>tok:char-group</b><var> group chars chars-proc<a name="index-tok_003achar_002dgroup-219"></a></var><br>
<blockquote><p>The argument <var>chars</var> may be a single character, a list of
characters, or a string.  Each character in <var>chars</var> is treated as
though <code>tok:char-group</code> was called with that character alone.

       <p>The argument <var>chars-proc</var> must be a procedure of one argument, a
list of characters.  After <code>tokenize</code> has finished
accumulating the characters for a token, it calls <var>chars-proc</var> with
the list of characters.  The value returned is the token which
<code>tokenize</code> returns.

       <p>The argument <var>group</var> may be an exact integer or a procedure of one
character argument.  The following discussion concerns the treatment
which the tokenizing routine, <code>tokenize</code>, will accord to characters
on the basis of their groups.

       <p>When <var>group</var> is a non-zero integer, characters whose group number is
equal to or exactly one less than <var>group</var> will continue to
accumulate.  Any other character causes the accumulation to stop (until
a new token is to be read).

       <p>The <var>group</var> of zero is special.  These characters are ignored when
parsed pending a token, and stop the accumulation of token characters
when the accumulation has already begun.  Whitespace characters are
usually put in group 0.

       <p>If <var>group</var> is a procedure, then, when triggerd by the occurence of
an initial (no accumulation) <var>chars</var> character, this procedure will
be repeatedly called with each successive character from the input
stream until the <var>group</var> procedure returns a non-false value. 
</p></blockquote></div>

<p class="noindent">The following convenient constants are provided for use with
<code>tok:char-group</code>.

<div class="defun">
&mdash; Constant: <b>tok:decimal-digits</b><var><a name="index-tok_003adecimal_002ddigits-220"></a></var><br>
<blockquote><p>Is the string <code>"0123456789"</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>tok:upper-case</b><var><a name="index-tok_003aupper_002dcase-221"></a></var><br>
<blockquote><p>Is the string consisting of all upper-case letters
("ABCDEFGHIJKLMNOPQRSTUVWXYZ"). 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>tok:lower-case</b><var><a name="index-tok_003alower_002dcase-222"></a></var><br>
<blockquote><p>Is the string consisting of all lower-case letters
("abcdefghijklmnopqrstuvwxyz"). 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>tok:whitespaces</b><var><a name="index-tok_003awhitespaces-223"></a></var><br>
<blockquote><p>Is the string consisting of all characters between 0 and 255 for which
<code>char-whitespace?</code> returns true. 
</p></blockquote></div>

<div class="node">
<a name="Nud-and-Led-Definition"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Grammar-Rule-Definition">Grammar Rule Definition</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Token-definition">Token definition</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence-Parsing">Precedence Parsing</a>

</div>

<h4 class="subsection">4.1.5 Nud and Led Definition</h4>

<p>This section describes advanced features.  You can skip this section on
first reading.

<p class="noindent">The <dfn>Null Denotation</dfn> (or <dfn>nud</dfn>)
<a name="index-Null-Denotation_002c-nud-224"></a>of a token is the procedure and arguments applying for that token when
<dfn>Left</dfn>, an unclaimed parsed expression is not extant.

<p class="noindent">The <dfn>Left Denotation</dfn> (or <dfn>led</dfn>)
<a name="index-Left-Denotation_002c-led-225"></a>of a token is the procedure, arguments, and lbp applying for that token
when there is a <dfn>Left</dfn>, an unclaimed parsed expression.

<p class="noindent">In his paper,

  <blockquote>
Pratt, V. R. 
Top Down Operator Precendence. 
<cite>SIGACT/SIGPLAN Symposium on Principles of Programming Languages</cite>,
Boston, 1973, pages 41-51
</blockquote>

  <p>the <dfn>left binding power</dfn> (or <dfn>lbp</dfn>) was an independent property
of tokens.  I think this was done in order to allow tokens with NUDs but
not LEDs to also be used as delimiters, which was a problem for
statically defined syntaxes.  It turns out that <em>dynamically
binding</em> NUDs and LEDs allows them independence.

<p class="noindent">For the rule-defining procedures that follow, the variable <var>tk</var> may
be a character, string, or symbol, or a list composed of characters,
strings, and symbols.  Each element of <var>tk</var> is treated as though the
procedure were called for each element.

<p class="noindent">Character <var>tk</var> arguments will match only character tokens;
i.e. characters for which no token-group is assigned.  Symbols and
strings will both match token strings; i.e. tokens resulting from token
groups.

<div class="defun">
&mdash; Function: <b>prec:make-nud</b><var> tk sop arg1 <small class="dots">...</small><a name="index-prec_003amake_002dnud-226"></a></var><br>
<blockquote><p>Returns a rule specifying that <var>sop</var> be called when <var>tk</var> is
parsed.  If <var>sop</var> is a procedure, it is called with <var>tk</var> and
<var>arg1</var> <small class="dots">...</small> as its arguments; the resulting value is incorporated
into the expression being built.  Otherwise, <code>(list </code><var>sop</var>
<var>arg1</var><code> ...)</code> is incorporated. 
</p></blockquote></div>

<p class="noindent">If no NUD has been defined for a token; then if that token is a string,
it is converted to a symbol and returned; if not a string, the token is
returned.

<div class="defun">
&mdash; Function: <b>prec:make-led</b><var> tk sop arg1 <small class="dots">...</small><a name="index-prec_003amake_002dled-227"></a></var><br>
<blockquote><p>Returns a rule specifying that <var>sop</var> be called when <var>tk</var> is
parsed and <var>left</var> has an unclaimed parsed expression.  If <var>sop</var>
is a procedure, it is called with <var>left</var>, <var>tk</var>, and <var>arg1</var>
<small class="dots">...</small> as its arguments; the resulting value is incorporated into the
expression being built.  Otherwise, <var>left</var> is incorporated. 
</p></blockquote></div>

<p class="noindent">If no LED has been defined for a token, and <var>left</var> is set, the
parser issues a warning.

<div class="node">
<a name="Grammar-Rule-Definition"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Nud-and-Led-Definition">Nud and Led Definition</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence-Parsing">Precedence Parsing</a>

</div>

<h4 class="subsection">4.1.6 Grammar Rule Definition</h4>

<p class="noindent">Here are procedures for defining rules for the syntax types introduced
in <a href="#Precedence-Parsing-Overview">Precedence Parsing Overview</a>.

<p class="noindent">For the rule-defining procedures that follow, the variable <var>tk</var> may
be a character, string, or symbol, or a list composed of characters,
strings, and symbols.  Each element of <var>tk</var> is treated as though the
procedure were called for each element.

<p class="noindent">For procedures prec:delim, <small class="dots">...</small>, prec:prestfix, if the <var>sop</var>
argument is <code>#f</code>, then the token which triggered this rule is
converted to a symbol and returned.  A false <var>sop</var> argument to the
procedures prec:commentfix, prec:matchfix, or prec:inmatchfix has a
different meaning.

<p class="noindent">Character <var>tk</var> arguments will match only character tokens;
i.e. characters for which no token-group is assigned.  Symbols and
strings will both match token strings; i.e. tokens resulting from token
groups.

<div class="defun">
&mdash; Function: <b>prec:delim</b><var> tk<a name="index-prec_003adelim-228"></a></var><br>
<blockquote><p>Returns a rule specifying that <var>tk</var> should not be returned from
parsing; i.e. <var>tk</var>'s function is purely syntactic.  The end-of-file
is always treated as a delimiter. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:nofix</b><var> tk sop<a name="index-prec_003anofix-229"></a></var><br>
<blockquote><p>Returns a rule specifying the following actions take place when <var>tk</var>
is parsed:
          <ul>
<li>If <var>sop</var> is a procedure, it is called with no arguments; the
resulting value is incorporated into the expression being built. 
Otherwise, the list of <var>sop</var> is incorporated. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:prefix</b><var> tk sop bp rule1 <small class="dots">...</small><a name="index-prec_003aprefix-230"></a></var><br>
<blockquote><p>Returns a rule specifying the following actions take place when <var>tk</var>
is parsed:
          <ul>
<li>The rules <var>rule1</var> <small class="dots">...</small> augment and, in case of conflict, override
rules currently in effect. 
<li><code>prec:parse1</code> is called with binding-power <var>bp</var>. 
<li>If <var>sop</var> is a procedure, it is called with the expression returned
from <code>prec:parse1</code>; the resulting value is incorporated into the
expression being built.  Otherwise, the list of <var>sop</var> and the
expression returned from <code>prec:parse1</code> is incorporated. 
<li>The ruleset in effect before <var>tk</var> was parsed is restored;
<var>rule1</var> <small class="dots">...</small> are forgotten. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:infix</b><var> tk sop lbp bp rule1 <small class="dots">...</small><a name="index-prec_003ainfix-231"></a></var><br>
<blockquote><p>Returns a rule declaring the left-binding-precedence of the token
<var>tk</var> is <var>lbp</var> and specifying the following actions take place
when <var>tk</var> is parsed:
          <ul>
<li>The rules <var>rule1</var> <small class="dots">...</small> augment and, in case of conflict, override
rules currently in effect. 
<li>One expression is parsed with binding-power <var>lbp</var>.  If instead a
delimiter is encountered, a warning is issued. 
<li>If <var>sop</var> is a procedure, it is applied to the list of <var>left</var> and
the parsed expression; the resulting value is incorporated into the
expression being built.  Otherwise, the list of <var>sop</var>, the
<var>left</var> expression, and the parsed expression is incorporated. 
<li>The ruleset in effect before <var>tk</var> was parsed is restored;
<var>rule1</var> <small class="dots">...</small> are forgotten. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:nary</b><var> tk sop bp<a name="index-prec_003anary-232"></a></var><br>
<blockquote><p>Returns a rule declaring the left-binding-precedence of the token
<var>tk</var> is <var>bp</var> and specifying the following actions take place
when <var>tk</var> is parsed:
          <ul>
<li>Expressions are parsed with binding-power <var>bp</var> as far as they are
interleaved with the token <var>tk</var>. 
<li>If <var>sop</var> is a procedure, it is applied to the list of <var>left</var> and
the parsed expressions; the resulting value is incorporated into the
expression being built.  Otherwise, the list of <var>sop</var>, the
<var>left</var> expression, and the parsed expressions is incorporated. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:postfix</b><var> tk sop lbp<a name="index-prec_003apostfix-233"></a></var><br>
<blockquote><p>Returns a rule declaring the left-binding-precedence of the token
<var>tk</var> is <var>lbp</var> and specifying the following actions take place
when <var>tk</var> is parsed:
          <ul>
<li>If <var>sop</var> is a procedure, it is called with the <var>left</var> expression;
the resulting value is incorporated into the expression being built. 
Otherwise, the list of <var>sop</var> and the <var>left</var> expression is
incorporated. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:prestfix</b><var> tk sop bp rule1 <small class="dots">...</small><a name="index-prec_003aprestfix-234"></a></var><br>
<blockquote><p>Returns a rule specifying the following actions take place when <var>tk</var>
is parsed:
          <ul>
<li>The rules <var>rule1</var> <small class="dots">...</small> augment and, in case of conflict, override
rules currently in effect. 
<li>Expressions are parsed with binding-power <var>bp</var> until a delimiter is
reached. 
<li>If <var>sop</var> is a procedure, it is applied to the list of parsed
expressions; the resulting value is incorporated into the expression
being built.  Otherwise, the list of <var>sop</var> and the parsed
expressions is incorporated. 
<li>The ruleset in effect before <var>tk</var> was parsed is restored;
<var>rule1</var> <small class="dots">...</small> are forgotten. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:commentfix</b><var> tk stp match rule1 <small class="dots">...</small><a name="index-prec_003acommentfix-235"></a></var><br>
<blockquote><p>Returns rules specifying the following actions take place when <var>tk</var>
is parsed:
          <ul>
<li>The rules <var>rule1</var> <small class="dots">...</small> augment and, in case of conflict, override
rules currently in effect. 
<li>Characters are read until and end-of-file or a sequence of characters
is read which matches the <em>string</em> <var>match</var>. 
<li>If <var>stp</var> is a procedure, it is called with the string of all that
was read between the <var>tk</var> and <var>match</var> (exclusive). 
<li>The ruleset in effect before <var>tk</var> was parsed is restored;
<var>rule1</var> <small class="dots">...</small> are forgotten. 
</ul>

       <p>Parsing of commentfix syntax differs from the others in several ways. 
It reads directly from input without tokenizing; It calls <var>stp</var> but
does not return its value; nay any value.  I added the <var>stp</var>
argument so that comment text could be echoed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:matchfix</b><var> tk sop sep match rule1 <small class="dots">...</small><a name="index-prec_003amatchfix-236"></a></var><br>
<blockquote><p>Returns a rule specifying the following actions take place when <var>tk</var>
is parsed:
          <ul>
<li>The rules <var>rule1</var> <small class="dots">...</small> augment and, in case of conflict, override
rules currently in effect. 
<li>A rule declaring the token <var>match</var> a delimiter takes effect. 
<li>Expressions are parsed with binding-power <code>0</code> until the token
<var>match</var> is reached.  If the token <var>sep</var> does not appear between
each pair of expressions parsed, a warning is issued. 
<li>If <var>sop</var> is a procedure, it is applied to the list of parsed
expressions; the resulting value is incorporated into the expression
being built.  Otherwise, the list of <var>sop</var> and the parsed
expressions is incorporated. 
<li>The ruleset in effect before <var>tk</var> was parsed is restored;
<var>rule1</var> <small class="dots">...</small> are forgotten. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prec:inmatchfix</b><var> tk sop sep match lbp rule1 <small class="dots">...</small><a name="index-prec_003ainmatchfix-237"></a></var><br>
<blockquote><p>Returns a rule declaring the left-binding-precedence of the token
<var>tk</var> is <var>lbp</var> and specifying the following actions take place
when <var>tk</var> is parsed:
          <ul>
<li>The rules <var>rule1</var> <small class="dots">...</small> augment and, in case of conflict, override
rules currently in effect. 
<li>A rule declaring the token <var>match</var> a delimiter takes effect. 
<li>Expressions are parsed with binding-power <code>0</code> until the token
<var>match</var> is reached.  If the token <var>sep</var> does not appear between
each pair of expressions parsed, a warning is issued. 
<li>If <var>sop</var> is a procedure, it is applied to the list of <var>left</var> and
the parsed expressions; the resulting value is incorporated into the
expression being built.  Otherwise, the list of <var>sop</var>, the
<var>left</var> expression, and the parsed expressions is incorporated. 
<li>The ruleset in effect before <var>tk</var> was parsed is restored;
<var>rule1</var> <small class="dots">...</small> are forgotten. 
</ul>
       </p></blockquote></div>

<div class="node">
<a name="Format"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Precedence-Parsing">Precedence Parsing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.2 Format (version 3.1)</h3>

<p><code>(require 'format)</code> or <code>(require 'srfi-28)</code>
<a name="index-format-238"></a>
<!-- The @file{format.scm} package was removed because it was not -->
<!-- reentrant.  @url{http://people.csail.mit.edu/jaffer/SLIB.FAQ} explains -->
<!-- more about FORMAT's woes. -->

<ul class="menu">
<li><a accesskey="1" href="#Format-Interface">Format Interface</a>
<li><a accesskey="2" href="#Format-Specification">Format Specification</a>
</ul>

<div class="node">
<a name="Format-Interface"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Format-Specification">Format Specification</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Format">Format</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Format">Format</a>

</div>

<h4 class="subsection">4.2.1 Format Interface</h4>

<div class="defun">
&mdash; Function: <b>format</b><var> destination format-string . arguments<a name="index-format-239"></a></var><br>
<blockquote><p>An almost complete implementation of Common LISP format description
according to the CL reference book <cite>Common LISP</cite> from Guy L. 
Steele, Digital Press.  Backward compatible to most of the available
Scheme format implementations.

       <p>Returns <code>#t</code>, <code>#f</code> or a string; has side effect of printing
according to <var>format-string</var>.  If <var>destination</var> is <code>#t</code>,
the output is to the current output port and <code>#t</code> is returned.  If
<var>destination</var> is <code>#f</code>, a formatted string is returned as the
result of the call.  NEW: If <var>destination</var> is a string,
<var>destination</var> is regarded as the format string; <var>format-string</var> is
then the first argument and the output is returned as a string. If
<var>destination</var> is a number, the output is to the current error port
if available by the implementation. Otherwise <var>destination</var> must be
an output port and <code>#t</code> is returned.

       <p><var>format-string</var> must be a string.  In case of a formatting error
format returns <code>#f</code> and prints a message on the current output or
error port.  Characters are output as if the string were output by the
<code>display</code> function with the exception of those prefixed by a tilde
(~).  For a detailed description of the <var>format-string</var> syntax
please consult a Common LISP format reference manual.  For a test suite
to verify this format implementation load <samp><span class="file">formatst.scm</span></samp>. 
<!-- Please send bug reports to @code{lutzeb@@cs.tu-berlin.de}. -->

     </blockquote></div>

<div class="node">
<a name="Format-Specification"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Format-Interface">Format Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Format">Format</a>

</div>

<h4 class="subsection">4.2.2 Format Specification (Format version 3.1)</h4>

<p>Please consult a Common LISP format reference manual for a detailed
description of the format string syntax.  For a demonstration of the
implemented directives see <samp><span class="file">formatst.scm</span></samp>.

  <p>This implementation supports directive parameters and modifiers
(<code>:</code> and <code>@</code> characters). Multiple parameters must be
separated by a comma (<code>,</code>).  Parameters can be numerical parameters
(positive or negative), character parameters (prefixed by a quote
character (<code>'</code>), variable parameters (<code>v</code>), number of rest
arguments parameter (<code>#</code>), empty and default parameters.  Directive
characters are case independent. The general form of a directive
is:

<p class="noindent"><var>directive</var> ::= ~{<var>directive-parameter</var>,}[:][@]<var>directive-character</var>

<p class="noindent"><var>directive-parameter</var> ::= [ [-|+]{0-9}+ | '<var>character</var> | v | # ]

<h5 class="subsubsection">4.2.2.1 Implemented CL Format Control Directives</h5>

<p>Documentation syntax: Uppercase characters represent the corresponding
control directive characters. Lowercase characters represent control
directive parameter descriptions.

     <dl>
<dt><code>~A</code><dd>Any (print as <code>display</code> does).
          <dl>
<dt><code>~@A</code><dd>left pad. 
<br><dt><code>~</code><var>mincol</var><code>,</code><var>colinc</var><code>,</code><var>minpad</var><code>,</code><var>padchar</var><code>A</code><dd>full padding. 
</dl>
     <br><dt><code>~S</code><dd>S-expression (print as <code>write</code> does).
          <dl>
<dt><code>~@S</code><dd>left pad. 
<br><dt><code>~</code><var>mincol</var><code>,</code><var>colinc</var><code>,</code><var>minpad</var><code>,</code><var>padchar</var><code>S</code><dd>full padding. 
</dl>
     <br><dt><code>~D</code><dd>Decimal.
          <dl>
<dt><code>~@D</code><dd>print number sign always. 
<br><dt><code>~:D</code><dd>print comma separated. 
<br><dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>D</code><dd>padding. 
</dl>
     <br><dt><code>~X</code><dd>Hexadecimal.
          <dl>
<dt><code>~@X</code><dd>print number sign always. 
<br><dt><code>~:X</code><dd>print comma separated. 
<br><dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>X</code><dd>padding. 
</dl>
     <br><dt><code>~O</code><dd>Octal.
          <dl>
<dt><code>~@O</code><dd>print number sign always. 
<br><dt><code>~:O</code><dd>print comma separated. 
<br><dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>O</code><dd>padding. 
</dl>
     <br><dt><code>~B</code><dd>Binary.
          <dl>
<dt><code>~@B</code><dd>print number sign always. 
<br><dt><code>~:B</code><dd>print comma separated. 
<br><dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>B</code><dd>padding. 
</dl>
     <br><dt><code>~</code><var>n</var><code>R</code><dd>Radix <var>n</var>.
          <dl>
<dt><code>~</code><var>n</var><code>,</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>R</code><dd>padding. 
</dl>
     <br><dt><code>~@R</code><dd>print a number as a Roman numeral. 
<br><dt><code>~:@R</code><dd>print a number as an &ldquo;old fashioned&rdquo; Roman numeral. 
<br><dt><code>~:R</code><dd>print a number as an ordinal English number. 
<br><dt><code>~R</code><dd>print a number as a cardinal English number. 
<br><dt><code>~P</code><dd>Plural.
          <dl>
<dt><code>~@P</code><dd>prints <code>y</code> and <code>ies</code>. 
<br><dt><code>~:P</code><dd>as <code>~P but jumps 1 argument backward.</code>
<br><dt><code>~:@P</code><dd>as <code>~@P but jumps 1 argument backward.</code>
</dl>
     <br><dt><code>~C</code><dd>Character.
          <dl>
<dt><code>~@C</code><dd>prints a character as the reader can understand it (i.e. <code>#\</code> prefixing). 
<br><dt><code>~:C</code><dd>prints a character as emacs does (eg. <code>^C</code> for ASCII 03). 
</dl>
     <br><dt><code>~F</code><dd>Fixed-format floating-point (prints a flonum like <var>mmm.nnn</var>).
          <dl>
<dt><code>~</code><var>width</var><code>,</code><var>digits</var><code>,</code><var>scale</var><code>,</code><var>overflowchar</var><code>,</code><var>padchar</var><code>F</code><br><dt><code>~@F</code><dd>If the number is positive a plus sign is printed. 
</dl>
     <br><dt><code>~E</code><dd>Exponential floating-point (prints a flonum like <var>mmm.nnn</var><code>E</code><var>ee</var>).
          <dl>
<dt><code>~</code><var>width</var><code>,</code><var>digits</var><code>,</code><var>exponentdigits</var><code>,</code><var>scale</var><code>,</code><var>overflowchar</var><code>,</code><var>padchar</var><code>,</code><var>exponentchar</var><code>E</code><br><dt><code>~@E</code><dd>If the number is positive a plus sign is printed. 
</dl>
     <br><dt><code>~G</code><dd>General floating-point (prints a flonum either fixed or exponential).
          <dl>
<dt><code>~</code><var>width</var><code>,</code><var>digits</var><code>,</code><var>exponentdigits</var><code>,</code><var>scale</var><code>,</code><var>overflowchar</var><code>,</code><var>padchar</var><code>,</code><var>exponentchar</var><code>G</code><br><dt><code>~@G</code><dd>If the number is positive a plus sign is printed. 
</dl>
     <br><dt><code>~$</code><dd>Dollars floating-point (prints a flonum in fixed with signs separated).
          <dl>
<dt><code>~</code><var>digits</var><code>,</code><var>scale</var><code>,</code><var>width</var><code>,</code><var>padchar</var><code>$</code><br><dt><code>~@$</code><dd>If the number is positive a plus sign is printed. 
<br><dt><code>~:@$</code><dd>A sign is always printed and appears before the padding. 
<br><dt><code>~:$</code><dd>The sign appears before the padding. 
</dl>
     <br><dt><code>~%</code><dd>Newline.
          <dl>
<dt><code>~</code><var>n</var><code>%</code><dd>print <var>n</var> newlines. 
</dl>
     <br><dt><code>~&amp;</code><dd>print newline if not at the beginning of the output line.
          <dl>
<dt><code>~</code><var>n</var><code>&amp;</code><dd>prints <code>~&amp;</code> and then <var>n-1</var> newlines. 
</dl>
     <br><dt><code>~|</code><dd>Page Separator.
          <dl>
<dt><code>~</code><var>n</var><code>|</code><dd>print <var>n</var> page separators. 
</dl>
     <br><dt><code>~~</code><dd>Tilde.
          <dl>
<dt><code>~</code><var>n</var><code>~</code><dd>print <var>n</var> tildes. 
</dl>
     <br><dt><code>~</code>&lt;newline&gt;<dd>Continuation Line.
          <dl>
<dt><code>~:</code>&lt;newline&gt;<dd>newline is ignored, white space left. 
<br><dt><code>~@</code>&lt;newline&gt;<dd>newline is left, white space ignored. 
</dl>
     <br><dt><code>~T</code><dd>Tabulation.
          <dl>
<dt><code>~@T</code><dd>relative tabulation. 
<br><dt><code>~</code><var>colnum,colinc</var><code>T</code><dd>full tabulation. 
</dl>
     <br><dt><code>~?</code><dd>Indirection (expects indirect arguments as a list).
          <dl>
<dt><code>~@?</code><dd>extracts indirect arguments from format arguments. 
</dl>
     <br><dt><code>~(</code><var>str</var><code>~)</code><dd>Case conversion (converts by <code>string-downcase</code>).
          <dl>
<dt><code>~:(</code><var>str</var><code>~)</code><dd>converts by <code>string-capitalize</code>. 
<br><dt><code>~@(</code><var>str</var><code>~)</code><dd>converts by <code>string-capitalize-first</code>. 
<br><dt><code>~:@(</code><var>str</var><code>~)</code><dd>converts by <code>string-upcase</code>. 
</dl>
     <br><dt><code>~*</code><dd>Argument Jumping (jumps 1 argument forward).
          <dl>
<dt><code>~</code><var>n</var><code>*</code><dd>jumps <var>n</var> arguments forward. 
<br><dt><code>~:*</code><dd>jumps 1 argument backward. 
<br><dt><code>~</code><var>n</var><code>:*</code><dd>jumps <var>n</var> arguments backward. 
<br><dt><code>~@*</code><dd>jumps to the 0th argument. 
<br><dt><code>~</code><var>n</var><code>@*</code><dd>jumps to the <var>n</var>th argument (beginning from 0)
</dl>
     <br><dt><code>~[</code><var>str0</var><code>~;</code><var>str1</var><code>~;...~;</code><var>strn</var><code>~]</code><dd>Conditional Expression (numerical clause conditional).
          <dl>
<dt><code>~</code><var>n</var><code>[</code><dd>take argument from <var>n</var>. 
<br><dt><code>~@[</code><dd>true test conditional. 
<br><dt><code>~:[</code><dd>if-else-then conditional. 
<br><dt><code>~;</code><dd>clause separator. 
<br><dt><code>~:;</code><dd>default clause follows. 
</dl>
     <br><dt><code>~{</code><var>str</var><code>~}</code><dd>Iteration (args come from the next argument (a list)). Iteration
bounding is controlled by configuration variables
<var>format:iteration-bounded</var> and <var>format:max-iterations</var>. 
With both variables default, a maximum of 100 iterations will be
performed.
          <dl>
<dt><code>~</code><var>n</var><code>{</code><dd>at most <var>n</var> iterations. 
<br><dt><code>~:{</code><dd>args from next arg (a list of lists). 
<br><dt><code>~@{</code><dd>args from the rest of arguments. 
<br><dt><code>~:@{</code><dd>args from the rest args (lists). 
</dl>
     <br><dt><code>~^</code><dd>Up and out.
          <dl>
<dt><code>~</code><var>n</var><code>^</code><dd>aborts if <var>n</var> = 0
<br><dt><code>~</code><var>n</var><code>,</code><var>m</var><code>^</code><dd>aborts if <var>n</var> = <var>m</var>
<br><dt><code>~</code><var>n</var><code>,</code><var>m</var><code>,</code><var>k</var><code>^</code><dd>aborts if <var>n</var> &lt;= <var>m</var> &lt;= <var>k</var>
</dl>
     </dl>

<h5 class="subsubsection">4.2.2.2 Not Implemented CL Format Control Directives</h5>

     <dl>
<dt><code>~:A</code><dd>print <code>#f</code> as an empty list (see below). 
<br><dt><code>~:S</code><dd>print <code>#f</code> as an empty list (see below). 
<br><dt><code>~&lt;~&gt;</code><dd>Justification. 
<br><dt><code>~:^</code><dd>(sorry I don't understand its semantics completely)
</dl>

<h5 class="subsubsection">4.2.2.3 Extended, Replaced and Additional Control Directives</h5>

     <dl>
<dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>,</code><var>commawidth</var><code>D</code><br><dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>,</code><var>commawidth</var><code>X</code><br><dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>,</code><var>commawidth</var><code>O</code><br><dt><code>~</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>,</code><var>commawidth</var><code>B</code><br><dt><code>~</code><var>n</var><code>,</code><var>mincol</var><code>,</code><var>padchar</var><code>,</code><var>commachar</var><code>,</code><var>commawidth</var><code>R</code><dd><var>commawidth</var> is the number of characters between two comma characters. 
</dl>

     <dl>
<dt><code>~I</code><dd>print a R4RS complex number as <code>~F~@Fi</code> with passed parameters for
<code>~F</code>. 
<br><dt><code>~Y</code><dd>Pretty print formatting of an argument for scheme code lists. 
<br><dt><code>~K</code><dd>Same as <code>~?.</code>
<br><dt><code>~!</code><dd>Flushes the output if format <var>destination</var> is a port. 
<br><dt><code>~_</code><dd>Print a <code>#\space</code> character
          <dl>
<dt><code>~</code><var>n</var><code>_</code><dd>print <var>n</var> <code>#\space</code> characters. 
</dl>
     <br><dt><code>~/</code><dd>Print a <code>#\tab</code> character
          <dl>
<dt><code>~</code><var>n</var><code>/</code><dd>print <var>n</var> <code>#\tab</code> characters. 
</dl>
     <br><dt><code>~</code><var>n</var><code>C</code><dd>Takes <var>n</var> as an integer representation for a character. No arguments
are consumed. <var>n</var> is converted to a character by
<code>integer-&gt;char</code>.  <var>n</var> must be a positive decimal number. 
<br><dt><code>~:S</code><dd>Print out readproof.  Prints out internal objects represented as
<code>#&lt;...&gt;</code> as strings <code>"#&lt;...&gt;"</code> so that the format output can always
be processed by <code>read</code>.

     <br><dt><code>~:A</code><dd>Print out readproof.  Prints out internal objects represented as
<code>#&lt;...&gt;</code> as strings <code>"#&lt;...&gt;"</code> so that the format output can always
be processed by <code>read</code>. 
<br><dt><code>~Q</code><dd>Prints information and a copyright notice on the format implementation.
          <dl>
<dt><code>~:Q</code><dd>prints format version. 
</dl>

     <br><dt><code>~F, ~E, ~G, ~$</code><dd>may also print number strings, i.e. passing a number as a string and
format it accordingly. 
</dl>

<h5 class="subsubsection">4.2.2.4 Configuration Variables</h5>

<p>Format has some configuration variables at the beginning of
<samp><span class="file">format.scm</span></samp> to suit the systems and users needs. There should be
no modification necessary for the configuration that comes with SLIB. 
If modification is desired the variable should be set after the format
code is loaded. Format detects automatically if the running scheme
system implements floating point numbers and complex numbers.

     <dl>
<dt><var>format:symbol-case-conv</var><dd>Symbols are converted by <code>symbol-&gt;string</code> so the case type of the
printed symbols is implementation dependent. 
<code>format:symbol-case-conv</code> is a one arg closure which is either
<code>#f</code> (no conversion), <code>string-upcase</code>, <code>string-downcase</code>
or <code>string-capitalize</code>. (default <code>#f</code>)

     <br><dt><var>format:iobj-case-conv</var><dd>As <var>format:symbol-case-conv</var> but applies for the representation of
implementation internal objects. (default <code>#f</code>)

     <br><dt><var>format:expch</var><dd>The character prefixing the exponent value in <code>~E</code> printing. (default
<code>#\E</code>)

     <br><dt><var>format:iteration-bounded</var><dd>When <code>#t</code>, a <code>~{...~}</code> control will iterate no more than the
number of times specified by <var>format:max-iterations</var> regardless of
the number of iterations implied by modifiers and arguments. 
When <code>#f</code>, a <code>~{...~}</code> control will iterate the number of
times implied by modifiers and arguments, unless termination is forced
by language or system limitations. (default <code>#t</code>)

     <br><dt><var>format:max-iterations</var><dd>The maximum number of iterations performed by a <code>~{...~}</code> control. 
Has effect only when <var>format:iteration-bounded</var> is <code>#t</code>. 
(default 100)

  </dl>

<h5 class="subsubsection">4.2.2.5 Compatibility With Other Format Implementations</h5>

     <dl>
<dt>SLIB format 2.x:<dd>See <samp><span class="file">format.doc</span></samp>.

     <br><dt>SLIB format 1.4:<dd>Downward compatible except for padding support and <code>~A</code>, <code>~S</code>,
<code>~P</code>, <code>~X</code> uppercase printing.  SLIB format 1.4 uses C-style
<code>printf</code> padding support which is completely replaced by the CL
<code>format</code> padding style.

     <br><dt>MIT C-Scheme 7.1:<dd>Downward compatible except for <code>~</code>, which is not documented
(ignores all characters inside the format string up to a newline
character).  (7.1 implements <code>~a</code>, <code>~s</code>,
~<var>newline</var>, <code>~~</code>, <code>~%</code>, numerical and variable
parameters and <code>:/@</code> modifiers in the CL sense).

     <br><dt>Elk 1.5/2.0:<dd>Downward compatible except for <code>~A</code> and <code>~S</code> which print in
uppercase.  (Elk implements <code>~a</code>, <code>~s</code>, <code>~~</code>, and
<code>~%</code> (no directive parameters or modifiers)).

     <br><dt>Scheme-&gt;C 01nov91:<dd>Downward compatible except for an optional destination parameter: S2C
accepts a format call without a destination which returns a formatted
string. This is equivalent to a #f destination in S2C. (S2C implements
<code>~a</code>, <code>~s</code>, <code>~c</code>, <code>~%</code>, and <code>~~</code> (no directive
parameters or modifiers)).

</dl>

  <p>This implementation of format is solely useful in the SLIB context
because it requires other components provided by SLIB.

<div class="node">
<a name="Standard-Formatted-I%2fO"></a>
<a name="Standard-Formatted-I_002fO"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Programs-and-Arguments">Programs and Arguments</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Format">Format</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.3 Standard Formatted I/O</h3>

<ul class="menu">
<li><a accesskey="1" href="#Standard-Formatted-Output">Standard Formatted Output</a>:    'printf
<li><a accesskey="2" href="#Standard-Formatted-Input">Standard Formatted Input</a>:     'scanf
</ul>

<h4 class="subsection">4.3.1 stdio</h4>

<p><code>(require 'stdio)</code>
<a name="index-stdio-240"></a>
<code>require</code>s <code>printf</code> and <code>scanf</code> and additionally defines
the symbols:

<div class="defun">
&mdash; Variable: <b>stdin</b><var><a name="index-stdin-241"></a></var><br>
<blockquote><p>Defined to be <code>(current-input-port)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>stdout</b><var><a name="index-stdout-242"></a></var><br>
<blockquote><p>Defined to be <code>(current-output-port)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>stderr</b><var><a name="index-stderr-243"></a></var><br>
<blockquote><p>Defined to be <code>(current-error-port)</code>. 
</p></blockquote></div>

<div class="node">
<a name="Standard-Formatted-Output"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Standard-Formatted-Input">Standard Formatted Input</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a>

</div>

<h4 class="subsection">4.3.2 Standard Formatted Output</h4>

<p><code>(require 'printf)</code>
<a name="index-printf-244"></a>

<div class="defun">
&mdash; Procedure: <b>printf</b><var> format arg1 <small class="dots">...</small><a name="index-printf-245"></a></var><br>
&mdash; Procedure: <b>fprintf</b><var> port format arg1 <small class="dots">...</small><a name="index-fprintf-246"></a></var><br>
&mdash; Procedure: <b>sprintf</b><var> str format arg1 <small class="dots">...</small><a name="index-sprintf-247"></a></var><br>
&mdash; Procedure: <b>sprintf</b><var> #f format arg1 <small class="dots">...</small><a name="index-sprintf-248"></a></var><br>
&mdash; Procedure: <b>sprintf</b><var> k format arg1 <small class="dots">...</small><a name="index-sprintf-249"></a></var><br>
<blockquote>
       <p>Each function converts, formats, and outputs its <var>arg1</var> <small class="dots">...</small>
arguments according to the control string <var>format</var> argument and
returns the number of characters output.

       <p><code>printf</code> sends its output to the port <code>(current-output-port)</code>. 
<code>fprintf</code> sends its output to the port <var>port</var>.  <code>sprintf</code>
<code>string-set!</code>s locations of the non-constant string argument
<var>str</var> to the output characters.

       <p>Two extensions of <code>sprintf</code> return new strings.  If the first
argument is <code>#f</code>, then the returned string's length is as many
characters as specified by the <var>format</var> and data; if the first
argument is a non-negative integer <var>k</var>, then the length of the
returned string is also bounded by <var>k</var>.

       <p>The string <var>format</var> contains plain characters which are copied to
the output stream, and conversion specifications, each of which results
in fetching zero or more of the arguments <var>arg1</var> <small class="dots">...</small>.  The
results are undefined if there are an insufficient number of arguments
for the format.  If <var>format</var> is exhausted while some of the
<var>arg1</var> <small class="dots">...</small> arguments remain unused, the excess <var>arg1</var>
<small class="dots">...</small> arguments are ignored.

       <p>The conversion specifications in a format string have the form:

     <pre class="example">          % <span class="roman">[</span> <var>flags</var> <span class="roman">]</span> <span class="roman">[</span> <var>width</var> <span class="roman">]</span> <span class="roman">[</span> . <var>precision</var> <span class="roman">]</span> <span class="roman">[</span> <var>type</var> <span class="roman">]</span> <var>conversion</var>
</pre>
       <p>An output conversion specifications consist of an initial &lsquo;<samp><span class="samp">%</span></samp>&rsquo;
character followed in sequence by:

          <ul>
<li>Zero or more <dfn>flag characters</dfn> that modify the normal behavior of
the conversion specification.

               <dl>
<dt>&lsquo;<samp><span class="samp">-</span></samp>&rsquo;<dd>Left-justify the result in the field.  Normally the result is
right-justified.

               <br><dt>&lsquo;<samp><span class="samp">+</span></samp>&rsquo;<dd>For the signed &lsquo;<samp><span class="samp">%d</span></samp>&rsquo; and &lsquo;<samp><span class="samp">%i</span></samp>&rsquo; conversions and all inexact
conversions, prefix a plus sign if the value is positive.

               <br><dt>&lsquo;<samp> </samp>&rsquo;<dd>For the signed &lsquo;<samp><span class="samp">%d</span></samp>&rsquo; and &lsquo;<samp><span class="samp">%i</span></samp>&rsquo; conversions, if the result
doesn't start with a plus or minus sign, prefix it with a space
character instead.  Since the &lsquo;<samp><span class="samp">+</span></samp>&rsquo; flag ensures that the result
includes a sign, this flag is ignored if both are specified.

               <br><dt>&lsquo;<samp><span class="samp">#</span></samp>&rsquo;<dd>For inexact conversions, &lsquo;<samp><span class="samp">#</span></samp>&rsquo; specifies that the result should
always include a decimal point, even if no digits follow it.  For the
&lsquo;<samp><span class="samp">%g</span></samp>&rsquo; and &lsquo;<samp><span class="samp">%G</span></samp>&rsquo; conversions, this also forces trailing zeros
after the decimal point to be printed where they would otherwise be
elided.

               <p>For the &lsquo;<samp><span class="samp">%o</span></samp>&rsquo; conversion, force the leading digit to be &lsquo;<samp><span class="samp">0</span></samp>&rsquo;, as
if by increasing the precision.  For &lsquo;<samp><span class="samp">%x</span></samp>&rsquo; or &lsquo;<samp><span class="samp">%X</span></samp>&rsquo;, prefix a
leading &lsquo;<samp><span class="samp">0x</span></samp>&rsquo; or &lsquo;<samp><span class="samp">0X</span></samp>&rsquo; (respectively) to the result.  This
doesn't do anything useful for the &lsquo;<samp><span class="samp">%d</span></samp>&rsquo;, &lsquo;<samp><span class="samp">%i</span></samp>&rsquo;, or &lsquo;<samp><span class="samp">%u</span></samp>&rsquo;
conversions.  Using this flag produces output which can be parsed by the
<code>scanf</code> functions with the &lsquo;<samp><span class="samp">%i</span></samp>&rsquo; conversion
(see <a href="#Standard-Formatted-Input">Standard Formatted Input</a>).

               <br><dt>&lsquo;<samp><span class="samp">0</span></samp>&rsquo;<dd>Pad the field with zeros instead of spaces.  The zeros are placed after
any indication of sign or base.  This flag is ignored if the &lsquo;<samp><span class="samp">-</span></samp>&rsquo;
flag is also specified, or if a precision is specified for an exact
converson. 
</dl>

          <li>An optional decimal integer specifying the <dfn>minimum field width</dfn>. 
If the normal conversion produces fewer characters than this, the field
is padded (with spaces or zeros per the &lsquo;<samp><span class="samp">0</span></samp>&rsquo; flag) to the specified
width.  This is a <em>minimum</em> width; if the normal conversion
produces more characters than this, the field is <em>not</em> truncated. 
<a name="index-minimum-field-width-_0028_0040code_007bprintf_007d_0029-250"></a>
Alternatively, if the field width is &lsquo;<samp><span class="samp">*</span></samp>&rsquo;, the next argument in the
argument list (before the actual value to be printed) is used as the
field width.  The width value must be an integer.  If the value is
negative it is as though the &lsquo;<samp><span class="samp">-</span></samp>&rsquo; flag is set (see above) and the
absolute value is used as the field width.

          <li>An optional <dfn>precision</dfn> to specify the number of digits to be
written for numeric conversions and the maximum field width for string
conversions.  The precision is specified by a period (&lsquo;<samp><span class="samp">.</span></samp>&rsquo;) followed
optionally by a decimal integer (which defaults to zero if omitted). 
<a name="index-precision-_0028_0040code_007bprintf_007d_0029-251"></a>
Alternatively, if the precision is &lsquo;<samp><span class="samp">.*</span></samp>&rsquo;, the next argument in the
argument list (before the actual value to be printed) is used as the
precision.  The value must be an integer, and is ignored if negative. 
If you specify &lsquo;<samp><span class="samp">*</span></samp>&rsquo; for both the field width and precision, the
field width argument precedes the precision argument.  The &lsquo;<samp><span class="samp">.*</span></samp>&rsquo;
precision is an enhancement.  C library versions may not accept this
syntax.

          <p>For the &lsquo;<samp><span class="samp">%f</span></samp>&rsquo;, &lsquo;<samp><span class="samp">%e</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">%E</span></samp>&rsquo; conversions, the precision
specifies how many digits follow the decimal-point character.  The
default precision is <code>6</code>.  If the precision is explicitly <code>0</code>,
the decimal point character is suppressed.

          <p>For the &lsquo;<samp><span class="samp">%g</span></samp>&rsquo; and &lsquo;<samp><span class="samp">%G</span></samp>&rsquo; conversions, the precision specifies how
many significant digits to print.  Significant digits are the first
digit before the decimal point, and all the digits after it.  If the
precision is <code>0</code> or not specified for &lsquo;<samp><span class="samp">%g</span></samp>&rsquo; or &lsquo;<samp><span class="samp">%G</span></samp>&rsquo;, it is
treated like a value of <code>1</code>.  If the value being printed cannot be
expressed accurately in the specified number of digits, the value is
rounded to the nearest number that fits.

          <p>For exact conversions, if a precision is supplied it specifies the
minimum number of digits to appear; leading zeros are produced if
necessary.  If a precision is not supplied, the number is printed with
as many digits as necessary.  Converting an exact &lsquo;<samp><span class="samp">0</span></samp>&rsquo; with an
explicit precision of zero produces no characters.

          <li>An optional one of &lsquo;<samp><span class="samp">l</span></samp>&rsquo;, &lsquo;<samp><span class="samp">h</span></samp>&rsquo; or &lsquo;<samp><span class="samp">L</span></samp>&rsquo;, which is ignored for
numeric conversions.  It is an error to specify these modifiers for
non-numeric conversions.

          <li>A character that specifies the conversion to be applied. 
</ul>

       <p>Exact Conversions

          <dl>
<dt>&lsquo;<samp><span class="samp">b</span></samp>&rsquo;, &lsquo;<samp><span class="samp">B</span></samp>&rsquo;<dd>Print an integer as an unsigned binary number.

          <p><em>Note:</em> &lsquo;<samp><span class="samp">%b</span></samp>&rsquo; and &lsquo;<samp><span class="samp">%B</span></samp>&rsquo; are SLIB extensions.

          <br><dt>&lsquo;<samp><span class="samp">d</span></samp>&rsquo;, &lsquo;<samp><span class="samp">i</span></samp>&rsquo;<dd>Print an integer as a signed decimal number.  &lsquo;<samp><span class="samp">%d</span></samp>&rsquo; and &lsquo;<samp><span class="samp">%i</span></samp>&rsquo;
are synonymous for output, but are different when used with <code>scanf</code>
for input (see <a href="#Standard-Formatted-Input">Standard Formatted Input</a>).

          <br><dt>&lsquo;<samp><span class="samp">o</span></samp>&rsquo;<dd>Print an integer as an unsigned octal number.

          <br><dt>&lsquo;<samp><span class="samp">u</span></samp>&rsquo;<dd>Print an integer as an unsigned decimal number.

          <br><dt>&lsquo;<samp><span class="samp">x</span></samp>&rsquo;, &lsquo;<samp><span class="samp">X</span></samp>&rsquo;<dd>Print an integer as an unsigned hexadecimal number.  &lsquo;<samp><span class="samp">%x</span></samp>&rsquo; prints
using the digits &lsquo;<samp><span class="samp">0123456789abcdef</span></samp>&rsquo;.  &lsquo;<samp><span class="samp">%X</span></samp>&rsquo; prints using the
digits &lsquo;<samp><span class="samp">0123456789ABCDEF</span></samp>&rsquo;. 
</dl>

       <p>Inexact Conversions

          <dl>
<dt>&lsquo;<samp><span class="samp">f</span></samp>&rsquo;<dd>Print a floating-point number in fixed-point notation.

          <br><dt>&lsquo;<samp><span class="samp">e</span></samp>&rsquo;, &lsquo;<samp><span class="samp">E</span></samp>&rsquo;<dd>Print a floating-point number in exponential notation.  &lsquo;<samp><span class="samp">%e</span></samp>&rsquo; prints
&lsquo;<samp><span class="samp">e</span></samp>&rsquo; between mantissa and exponont.  &lsquo;<samp><span class="samp">%E</span></samp>&rsquo; prints &lsquo;<samp><span class="samp">E</span></samp>&rsquo;
between mantissa and exponont.

          <br><dt>&lsquo;<samp><span class="samp">g</span></samp>&rsquo;, &lsquo;<samp><span class="samp">G</span></samp>&rsquo;<dd>Print a floating-point number in either fixed or exponential notation,
whichever is more appropriate for its magnitude.  Unless an &lsquo;<samp><span class="samp">#</span></samp>&rsquo;
flag has been supplied, trailing zeros after a decimal point will be
stripped off.  &lsquo;<samp><span class="samp">%g</span></samp>&rsquo; prints &lsquo;<samp><span class="samp">e</span></samp>&rsquo; between mantissa and exponont. 
&lsquo;<samp><span class="samp">%G</span></samp>&rsquo; prints &lsquo;<samp><span class="samp">E</span></samp>&rsquo; between mantissa and exponent.

          <br><dt>&lsquo;<samp><span class="samp">k</span></samp>&rsquo;, &lsquo;<samp><span class="samp">K</span></samp>&rsquo;<dd>Print a number like &lsquo;<samp><span class="samp">%g</span></samp>&rsquo;, except that an SI prefix is output
after the number, which is scaled accordingly.  &lsquo;<samp><span class="samp">%K</span></samp>&rsquo; outputs a
dot between number and prefix, &lsquo;<samp><span class="samp">%k</span></samp>&rsquo; does not.

       </dl>

       <p>Other Conversions

          <dl>
<dt>&lsquo;<samp><span class="samp">c</span></samp>&rsquo;<dd>Print a single character.  The &lsquo;<samp><span class="samp">-</span></samp>&rsquo; flag is the only one which can
be specified.  It is an error to specify a precision.

          <br><dt>&lsquo;<samp><span class="samp">s</span></samp>&rsquo;<dd>Print a string.  The &lsquo;<samp><span class="samp">-</span></samp>&rsquo; flag is the only one which can be
specified.  A precision specifies the maximum number of characters to
output; otherwise all characters in the string are output.

          <br><dt>&lsquo;<samp><span class="samp">a</span></samp>&rsquo;, &lsquo;<samp><span class="samp">A</span></samp>&rsquo;<dd>Print a scheme expression.  The &lsquo;<samp><span class="samp">-</span></samp>&rsquo; flag left-justifies the output. 
The &lsquo;<samp><span class="samp">#</span></samp>&rsquo; flag specifies that strings and characters should be quoted
as by <code>write</code> (which can be read using <code>read</code>); otherwise,
output is as <code>display</code> prints.  A precision specifies the maximum
number of characters to output; otherwise as many characters as needed
are output.

          <p><em>Note:</em> &lsquo;<samp><span class="samp">%a</span></samp>&rsquo; and &lsquo;<samp><span class="samp">%A</span></samp>&rsquo; are SLIB extensions.

          <!-- @item @samp{p} -->
          <!-- Print the value of a pointer. -->
          <!-- @item @samp{n} -->
          <!-- Get the number of characters printed so far.  See @ref{Other Output Conversions}. -->
          <!-- Note that this conversion specification never produces any output. -->
          <!-- @item @samp{m} -->
          <!-- Print the string corresponding to the value of @code{errno}. -->
          <!-- (This is a GNU extension.) -->
          <!-- @xref{Other Output Conversions}. -->
          <br><dt>&lsquo;<samp><span class="samp">%</span></samp>&rsquo;<dd>Print a literal &lsquo;<samp><span class="samp">%</span></samp>&rsquo; character.  No argument is consumed.  It is an
error to specify flags, field width, precision, or type modifiers with
&lsquo;<samp><span class="samp">%%</span></samp>&rsquo;. 
</dl>
       </p></blockquote></div>

<div class="node">
<a name="Standard-Formatted-Input"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Standard-Formatted-Output">Standard Formatted Output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a>

</div>

<h4 class="subsection">4.3.3 Standard Formatted Input</h4>

<p><code>(require 'scanf)</code>
<a name="index-scanf-252"></a>

<div class="defun">
&mdash; Function: <b>scanf-read-list</b><var> format<a name="index-scanf_002dread_002dlist-253"></a></var><br>
&mdash; Function: <b>scanf-read-list</b><var> format port<a name="index-scanf_002dread_002dlist-254"></a></var><br>
&mdash; Function: <b>scanf-read-list</b><var> format string<a name="index-scanf_002dread_002dlist-255"></a></var><br>
       </div>

<div class="defun">
&mdash; Macro: <b>scanf</b><var> format arg1 <small class="dots">...</small><a name="index-scanf-256"></a></var><br>
&mdash; Macro: <b>fscanf</b><var> port format arg1 <small class="dots">...</small><a name="index-fscanf-257"></a></var><br>
&mdash; Macro: <b>sscanf</b><var> str format arg1 <small class="dots">...</small><a name="index-sscanf-258"></a></var><br>
<blockquote>
       <p>Each function reads characters, interpreting them according to the
control string <var>format</var> argument.

       <p><code>scanf-read-list</code> returns a list of the items specified as far as
the input matches <var>format</var>.  <code>scanf</code>, <code>fscanf</code>, and
<code>sscanf</code> return the number of items successfully matched and
stored.  <code>scanf</code>, <code>fscanf</code>, and <code>sscanf</code> also set the
location corresponding to <var>arg1</var> <small class="dots">...</small> using the methods:

          <dl>
<dt>symbol<dd><code>set!</code>
<br><dt>car expression<dd><code>set-car!</code>
<br><dt>cdr expression<dd><code>set-cdr!</code>
<br><dt>vector-ref expression<dd><code>vector-set!</code>
<br><dt>substring expression<dd><code>substring-move-left!</code>
</dl>

       <p>The argument to a <code>substring</code> expression in <var>arg1</var> <small class="dots">...</small> must
be a non-constant string.  Characters will be stored starting at the
position specified by the second argument to <code>substring</code>.  The
number of characters stored will be limited by either the position
specified by the third argument to <code>substring</code> or the length of the
matched string, whichever is less.

       <p>The control string, <var>format</var>, contains conversion specifications and
other characters used to direct interpretation of input sequences.  The
control string contains:

          <ul>
<li>White-space characters (blanks, tabs, newlines, or formfeeds)
that cause input to be read (and discarded) up to the next
non-white-space character.

          <li>An ordinary character (not &lsquo;<samp><span class="samp">%</span></samp>&rsquo;) that must match the next
character of the input stream.

          <li>Conversion specifications, consisting of the character &lsquo;<samp><span class="samp">%</span></samp>&rsquo;, an
optional assignment suppressing character &lsquo;<samp><span class="samp">*</span></samp>&rsquo;, an optional
numerical maximum-field width, an optional &lsquo;<samp><span class="samp">l</span></samp>&rsquo;, &lsquo;<samp><span class="samp">h</span></samp>&rsquo; or
&lsquo;<samp><span class="samp">L</span></samp>&rsquo; which is ignored, and a conversion code.

          <!-- @item The conversion specification can alternatively be prefixed by -->
          <!-- the character sequence @samp{%n$} instead of the character @samp{%}, -->
          <!-- where @var{n} is a decimal integer in the range.  The @samp{%n$} -->
          <!-- construction indicates that the value of the next input field should be -->
          <!-- placed in the @var{n}th place in the return list, rather than to the next -->
          <!-- unused one.  The two forms of introducing a conversion specification, -->
          <!-- @samp{%} and @samp{%n$}, must not be mixed within a single format string -->
          <!-- with the following exception: Skip fields (see below) can be designated -->
          <!-- as @samp{%*} or @samp{%n$*}.  In the latter case, @var{n} is ignored. -->
       </ul>

       <p>Unless the specification contains the &lsquo;<samp><span class="samp">n</span></samp>&rsquo; conversion character
(described below), a conversion specification directs the conversion of
the next input field.  The result of a conversion specification is
returned in the position of the corresponding argument points, unless
&lsquo;<samp><span class="samp">*</span></samp>&rsquo; indicates assignment suppression.  Assignment suppression
provides a way to describe an input field to be skipped.  An input field
is defined as a string of characters; it extends to the next
inappropriate character or until the field width, if specified, is
exhausted.

       <blockquote>
<em>Note:</em> This specification of format strings differs from the
<cite>ANSI C</cite> and <cite>POSIX</cite> specifications.  In SLIB, white space
before an input field is not skipped unless white space appears before
the conversion specification in the format string.  In order to write
format strings which work identically with <cite>ANSI C</cite> and SLIB,
prepend whitespace to all conversion specifications except &lsquo;<samp><span class="samp">[</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">c</span></samp>&rsquo;. 
</blockquote>

       <p>The conversion code indicates the interpretation of the input field; For
a suppressed field, no value is returned.  The following conversion
codes are legal:

          <dl>
<dt>&lsquo;<samp><span class="samp">%</span></samp>&rsquo;<dd>A single % is expected in the input at this point; no value is returned.

          <br><dt>&lsquo;<samp><span class="samp">d</span></samp>&rsquo;, &lsquo;<samp><span class="samp">D</span></samp>&rsquo;<dd>A decimal integer is expected.

          <br><dt>&lsquo;<samp><span class="samp">u</span></samp>&rsquo;, &lsquo;<samp><span class="samp">U</span></samp>&rsquo;<dd>An unsigned decimal integer is expected.

          <br><dt>&lsquo;<samp><span class="samp">o</span></samp>&rsquo;, &lsquo;<samp><span class="samp">O</span></samp>&rsquo;<dd>An octal integer is expected.

          <br><dt>&lsquo;<samp><span class="samp">x</span></samp>&rsquo;, &lsquo;<samp><span class="samp">X</span></samp>&rsquo;<dd>A hexadecimal integer is expected.

          <br><dt>&lsquo;<samp><span class="samp">i</span></samp>&rsquo;<dd>An integer is expected.  Returns the value of the next input item,
interpreted according to C conventions; a leading &lsquo;<samp><span class="samp">0</span></samp>&rsquo; implies
octal, a leading &lsquo;<samp><span class="samp">0x</span></samp>&rsquo; implies hexadecimal; otherwise, decimal is
assumed.

          <br><dt>&lsquo;<samp><span class="samp">n</span></samp>&rsquo;<dd>Returns the total number of bytes (including white space) read by
<code>scanf</code>.  No input is consumed by <code>%n</code>.

          <br><dt>&lsquo;<samp><span class="samp">f</span></samp>&rsquo;, &lsquo;<samp><span class="samp">F</span></samp>&rsquo;, &lsquo;<samp><span class="samp">e</span></samp>&rsquo;, &lsquo;<samp><span class="samp">E</span></samp>&rsquo;, &lsquo;<samp><span class="samp">g</span></samp>&rsquo;, &lsquo;<samp><span class="samp">G</span></samp>&rsquo;<dd>A floating-point number is expected.  The input format for
floating-point numbers is an optionally signed string of digits,
possibly containing a radix character &lsquo;<samp><span class="samp">.</span></samp>&rsquo;, followed by an optional
exponent field consisting of an &lsquo;<samp><span class="samp">E</span></samp>&rsquo; or an &lsquo;<samp><span class="samp">e</span></samp>&rsquo;, followed by an
optional &lsquo;<samp><span class="samp">+</span></samp>&rsquo;, &lsquo;<samp><span class="samp">-</span></samp>&rsquo;, or space, followed by an integer.

          <br><dt>&lsquo;<samp><span class="samp">c</span></samp>&rsquo;, &lsquo;<samp><span class="samp">C</span></samp>&rsquo;<dd><var>Width</var> characters are expected.  The normal skip-over-white-space
is suppressed in this case; to read the next non-space character, use
&lsquo;<samp><span class="samp">%1s</span></samp>&rsquo;.  If a field width is given, a string is returned; up to the
indicated number of characters is read.

          <br><dt>&lsquo;<samp><span class="samp">s</span></samp>&rsquo;, &lsquo;<samp><span class="samp">S</span></samp>&rsquo;<dd>A character string is expected The input field is terminated by a
white-space character.  <code>scanf</code> cannot read a null string.

          <br><dt>&lsquo;<samp><span class="samp">[</span></samp>&rsquo;<dd>Indicates string data and the normal skip-over-leading-white-space is
suppressed.  The left bracket is followed by a set of characters, called
the scanset, and a right bracket; the input field is the maximal
sequence of input characters consisting entirely of characters in the
scanset.  &lsquo;<samp><span class="samp">^</span></samp>&rsquo;, when it appears as the first character in the
scanset, serves as a complement operator and redefines the scanset as
the set of all characters not contained in the remainder of the scanset
string.  Construction of the scanset follows certain conventions.  A
range of characters may be represented by the construct first-last,
enabling &lsquo;<samp><span class="samp">[0123456789]</span></samp>&rsquo; to be expressed &lsquo;<samp><span class="samp">[0-9]</span></samp>&rsquo;.  Using this
convention, first must be lexically less than or equal to last;
otherwise, the dash stands for itself.  The dash also stands for itself
when it is the first or the last character in the scanset.  To include
the right square bracket as an element of the scanset, it must appear as
the first character (possibly preceded by a &lsquo;<samp><span class="samp">^</span></samp>&rsquo;) of the scanset, in
which case it will not be interpreted syntactically as the closing
bracket.  At least one character must match for this conversion to
succeed. 
</dl>

       <p>The <code>scanf</code> functions terminate their conversions at end-of-file,
at the end of the control string, or when an input character conflicts
with the control string.  In the latter case, the offending character is
left unread in the input stream. 
</p></blockquote></div>

<div class="node">
<a name="Programs-and-Arguments"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#HTML">HTML</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.4 Program and Arguments</h3>

<ul class="menu">
<li><a accesskey="1" href="#Getopt">Getopt</a>:                       Command Line option parsing
<li><a accesskey="2" href="#Command-Line">Command Line</a>:                 A command line reader for Scheme shells
<li><a accesskey="3" href="#Parameter-lists">Parameter lists</a>:              'parameters
<li><a accesskey="4" href="#Getopt-Parameter-lists">Getopt Parameter lists</a>:       'getopt-parameters
<li><a accesskey="5" href="#Filenames">Filenames</a>:                    'filename
<li><a accesskey="6" href="#Batch">Batch</a>:                        'batch
</ul>

<div class="node">
<a name="Getopt"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Command-Line">Command Line</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Programs-and-Arguments">Programs and Arguments</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programs-and-Arguments">Programs and Arguments</a>

</div>

<h4 class="subsection">4.4.1 Getopt</h4>

<p><code>(require 'getopt)</code>
<a name="index-getopt-259"></a>
This routine implements Posix command line argument parsing.  Notice
that returning values through global variables means that <code>getopt</code>
is <em>not</em> reentrant.

  <p>Obedience to Posix format for the <code>getopt</code> calls sows confusion. 
Passing <var>argc</var> and <var>argv</var> as arguments while referencing
<var>optind</var> as a global variable leads to strange behavior,
especially when the calls to <code>getopt</code> are buried in other
procedures.

  <p>Even in C, <var>argc</var> can be derived from <var>argv</var>; what purpose
does it serve beyond providing an opportunity for
<var>argv</var>/<var>argc</var> mismatch?  Just such a mismatch existed for
years in a SLIB <code>getopt--</code> example.

  <p>I have removed the <var>argc</var> and <var>argv</var> arguments to getopt
procedures; and replaced them with a global variable:

<div class="defun">
&mdash; Variable: <b>*argv*</b><var><a name="index-g_t_002aargv_002a-260"></a></var><br>
<blockquote><p>Define <var>*argv*</var> with a list of arguments before calling getopt
procedures.  If you don't want the first (0th) element to be ignored,
set <var>*optind*</var> to 0 (after requiring getopt). 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>*optind*</b><var><a name="index-g_t_002aoptind_002a-261"></a></var><br>
<blockquote><p>Is the index of the current element of the command line.  It is
initially one.  In order to parse a new command line or reparse an old
one, <var>*optind*</var> must be reset. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>*optarg*</b><var><a name="index-g_t_002aoptarg_002a-262"></a></var><br>
<blockquote><p>Is set by getopt to the (string) option-argument of the current option. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getopt</b><var> optstring<a name="index-getopt-263"></a></var><br>
<blockquote><p>Returns the next option letter in <var>*argv*</var> (starting from
<code>(vector-ref argv *optind*)</code>) that matches a letter in
<var>optstring</var>.  <var>*argv*</var> is a vector or list of strings, the 0th
of which getopt usually ignores.  <var>optstring</var> is a string of
recognized option characters; if a character is followed by a colon,
the option takes an argument which may be immediately following it in
the string or in the next element of <var>*argv*</var>.

       <p><var>*optind*</var> is the index of the next element of the <var>*argv*</var> vector
to be processed.  It is initialized to 1 by <samp><span class="file">getopt.scm</span></samp>, and
<code>getopt</code> updates it when it finishes with each element of
<var>*argv*</var>.

       <p><code>getopt</code> returns the next option character from <var>*argv*</var> that
matches a character in <var>optstring</var>, if there is one that matches. 
If the option takes an argument, <code>getopt</code> sets the variable
<var>*optarg*</var> to the option-argument as follows:

          <ul>
<li>If the option was the last character in the string pointed to by an
element of <var>*argv*</var>, then <var>*optarg*</var> contains the next element
of <var>*argv*</var>, and <var>*optind*</var> is incremented by 2.  If the
resulting value of <var>*optind*</var> is greater than or equal to
<code>(length </code><var>*argv*</var><code>)</code>, this indicates a missing option
argument, and <code>getopt</code> returns an error indication.

          <li>Otherwise, <var>*optarg*</var> is set to the string following the option
character in that element of <var>*argv*</var>, and <var>*optind*</var> is
incremented by 1. 
</ul>

       <p>If, when <code>getopt</code> is called, the string <code>(vector-ref argv
*optind*)</code> either does not begin with the character <code>#\-</code> or is
just <code>"-"</code>, <code>getopt</code> returns <code>#f</code> without changing
<var>*optind*</var>.  If <code>(vector-ref argv *optind*)</code> is the string
<code>"--"</code>, <code>getopt</code> returns <code>#f</code> after incrementing
<var>*optind*</var>.

       <p>If <code>getopt</code> encounters an option character that is not contained in
<var>optstring</var>, it returns the question-mark <code>#\?</code> character.  If
it detects a missing option argument, it returns the colon character
<code>#\:</code> if the first character of <var>optstring</var> was a colon, or a
question-mark character otherwise.  In either case, <code>getopt</code> sets
the variable <var>getopt:opt</var> to the option character that caused the
error.

       <p>The special option <code>"--"</code> can be used to delimit the end of the
options; <code>#f</code> is returned, and <code>"--"</code> is skipped.

       <p>RETURN VALUE

       <p><code>getopt</code> returns the next option character specified on the command
line.  A colon <code>#\:</code> is returned if <code>getopt</code> detects a missing
argument and the first character of <var>optstring</var> was a colon
<code>#\:</code>.

       <p>A question-mark <code>#\?</code> is returned if <code>getopt</code> encounters an
option character not in <var>optstring</var> or detects a missing argument
and the first character of <var>optstring</var> was not a colon <code>#\:</code>.

       <p>Otherwise, <code>getopt</code> returns <code>#f</code> when all command line options
have been parsed.

       <p>Example:
     <pre class="lisp">          #! /usr/local/bin/scm
          (require 'program-arguments)
          (require 'getopt)
          (define argv (program-arguments))
          <a name="index-getopt-264"></a><a name="index-program_002darguments-265"></a>
          (define opts ":a:b:cd")
          (let loop ((opt (getopt (length argv) argv opts)))
            (case opt
              ((#\a) (print "option a: " *optarg*))
              ((#\b) (print "option b: " *optarg*))
              ((#\c) (print "option c"))
              ((#\d) (print "option d"))
              ((#\?) (print "error" getopt:opt))
              ((#\:) (print "missing arg" getopt:opt))
              ((#f) (if (&lt; *optind* (length argv))
                        (print "argv[" *optind* "]="
                               (list-ref argv *optind*)))
                    (set! *optind* (+ *optind* 1))))
            (if (&lt; *optind* (length argv))
                (loop (getopt (length argv) argv opts))))
          
          (slib:exit)
</pre>
       </blockquote></div>

<h4 class="subsection">4.4.2 Getopt&mdash;</h4>

<div class="defun">
&mdash; Function: <code>getopt--</code><var> optstring<a name="index-g_t_0040code_007bgetopt_002d_002d_007d-266"></a></var><br>
<blockquote><p>The procedure <code>getopt--</code> is an extended version of <code>getopt</code>
which parses <dfn>long option names</dfn> of the form
&lsquo;<samp><span class="samp">--hold-the-onions</span></samp>&rsquo; and &lsquo;<samp><span class="samp">--verbosity-level=extreme</span></samp>&rsquo;. 
<code>Getopt--</code><!-- /@w --> behaves as <code>getopt</code> except for non-empty
options beginning with &lsquo;<samp><span class="samp">--</span></samp>&rsquo;.

       <p>Options beginning with &lsquo;<samp><span class="samp">--</span></samp>&rsquo; are returned as strings rather than
characters.  If a value is assigned (using &lsquo;<samp><span class="samp">=</span></samp>&rsquo;) to a long option,
<code>*optarg*</code> is set to the value.  The &lsquo;<samp><span class="samp">=</span></samp>&rsquo; and value are
not returned as part of the option string.

       <p>No information is passed to <code>getopt--</code> concerning which long
options should be accepted or whether such options can take arguments. 
If a long option did not have an argument, <code>*optarg*</code> will be set
to <code>#f</code>.  The caller is responsible for detecting and reporting
errors.

     <pre class="example">          (define opts ":-:b:")
          (define *argv* '("foo" "-b9" "--f1" "--2=" "--g3=35234.342" "--"))
          (define *optind* 1)
          (define *optarg* #f)
          (require 'qp)
          <a name="index-qp-267"></a>(do ((i 5 (+ -1 i)))
              ((zero? i))
            (let ((opt (getopt-- opts)))
              (print *optind* opt *optarg*)))
          -|
          2 #\b "9"
          3 "f1" #f
          4 "2" ""
          5 "g3" "35234.342"
          5 #f "35234.342"
</pre>
       </blockquote></div>

<div class="node">
<a name="Command-Line"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parameter-lists">Parameter lists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getopt">Getopt</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programs-and-Arguments">Programs and Arguments</a>

</div>

<h4 class="subsection">4.4.3 Command Line</h4>

<p><code>(require 'read-command)</code>
<a name="index-read_002dcommand-268"></a>

<div class="defun">
&mdash; Function: <b>read-command</b><var> port<a name="index-read_002dcommand-269"></a></var><br>

  &mdash; Function: <b>read-command</b><var><a name="index-read_002dcommand-270"></a></var><br>
<blockquote><p><code>read-command</code> converts a <dfn>command line</dfn> into a list of strings
<a name="index-command-line-271"></a><a name="index-command-line-272"></a>suitable for parsing by <code>getopt</code>.  The syntax of command lines
supported resembles that of popular <dfn>shell</dfn>s.  <code>read-command</code>
<a name="index-shell-273"></a>updates <var>port</var> to point to the first character past the command
delimiter.

       <p>If an end of file is encountered in the input before any characters are
found that can begin an object or comment, then an end of file object is
returned.

       <p>The <var>port</var> argument may be omitted, in which case it defaults to the
value returned by <code>current-input-port</code>.

       <p>The fields into which the command line is split are delimited by
whitespace as defined by <code>char-whitespace?</code>.  The end of a command
is delimited by end-of-file or unescaped semicolon (&lt;;&gt;) or
&lt;newline&gt;.  Any character can be literally included in a field by
escaping it with a backslach (&lt;\&gt;).

       <p>The initial character and types of fields recognized are:
          <dl>
<dt>&lsquo;<samp><span class="samp">\</span></samp>&rsquo;<dd>The next character has is taken literally and not interpreted as a field
delimiter.  If &lt;\&gt; is the last character before a &lt;newline&gt;,
that &lt;newline&gt; is just ignored.  Processing continues from the
characters after the &lt;newline&gt; as though the backslash and
&lt;newline&gt; were not there. 
<br><dt>&lsquo;<samp><span class="samp">"</span></samp>&rsquo;<dd>The characters up to the next unescaped &lt;"&gt; are taken literally,
according to [R4RS] rules for literal strings
(see <a href="r4rs.html#Strings">Strings</a>). 
<br><dt>&lsquo;<samp><span class="samp">(</span></samp>&rsquo;, &lsquo;<samp><span class="samp">%'</span></samp>&rsquo;<dd>One scheme expression is <code>read</code> starting with this character.  The
<code>read</code> expression is evaluated, converted to a string
(using <code>display</code>), and replaces the expression in the returned
field. 
<br><dt>&lsquo;<samp><span class="samp">;</span></samp>&rsquo;<dd>Semicolon delimits a command.  Using semicolons more than one command
can appear on a line.  Escaped semicolons and semicolons inside strings
do not delimit commands. 
</dl>

     <p class="noindent">The comment field differs from the previous fields in that it must be
the first character of a command or appear after whitespace in order to
be recognized.  &lt;#&gt; can be part of fields if these conditions are
not met.  For instance, <code>ab#c</code> is just the field ab#c.

          <dl>
<dt>&lsquo;<samp><span class="samp">#</span></samp>&rsquo;<dd>Introduces a comment.  The comment continues to the end of the line on
which the semicolon appears.  Comments are treated as whitespace by
<code>read-dommand-line</code> and backslashes before &lt;newline&gt;s in
comments are also ignored. 
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>read-options-file</b><var> filename<a name="index-read_002doptions_002dfile-274"></a></var><br>
<blockquote>
       <p><code>read-options-file</code> converts an <dfn>options file</dfn> into a list of
<a name="index-options-file-275"></a><a name="index-options-file-276"></a>strings suitable for parsing by <code>getopt</code>.  The syntax of options
files is the same as the syntax for command
lines, except that &lt;newline&gt;s do not terminate reading (only &lt;;&gt;
or end of file).

       <p>If an end of file is encountered before any characters are found that
can begin an object or comment, then an end of file object is returned. 
</p></blockquote></div>

<div class="node">
<a name="Parameter-lists"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Getopt-Parameter-lists">Getopt Parameter lists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Command-Line">Command Line</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programs-and-Arguments">Programs and Arguments</a>

</div>

<h4 class="subsection">4.4.4 Parameter lists</h4>

<p><code>(require 'parameters)</code>
<a name="index-parameters-277"></a>
Arguments to procedures in scheme are distinguished from each other by
their position in the procedure call.  This can be confusing when a
procedure takes many arguments, many of which are not often used.

<p class="noindent">A <dfn>parameter-list</dfn> is a way of passing named information to a
procedure.  Procedures are also defined to set unused parameters to
default values, check parameters, and combine parameter lists.

<p class="noindent">A <var>parameter</var> has the form <code>(</code><span class="roman">parameter-name</span> <span class="roman">value1</span><code>
...)</code>.  This format allows for more than one value per
parameter-name.

<p class="noindent">A <var>parameter-list</var> is a list of <var>parameter</var>s, each with a
different <var>parameter-name</var>.

<div class="defun">
&mdash; Function: <b>make-parameter-list</b><var> parameter-names<a name="index-make_002dparameter_002dlist-278"></a></var><br>
<blockquote><p>Returns an empty parameter-list with slots for <var>parameter-names</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>parameter-list-ref</b><var> parameter-list parameter-name<a name="index-parameter_002dlist_002dref-279"></a></var><br>
<blockquote><p><var>parameter-name</var> must name a valid slot of <var>parameter-list</var>. 
<code>parameter-list-ref</code> returns the value of parameter
<var>parameter-name</var> of <var>parameter-list</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>remove-parameter</b><var> parameter-name parameter-list<a name="index-remove_002dparameter-280"></a></var><br>
<blockquote><p>Removes the parameter <var>parameter-name</var> from <var>parameter-list</var>. 
<code>remove-parameter</code> does not alter the argument
<var>parameter-list</var>.

       <p>If there are more than one <var>parameter-name</var> parameters, an error is
signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>adjoin-parameters!</b><var> parameter-list parameter1 <small class="dots">...</small><a name="index-adjoin_002dparameters_0021-281"></a></var><br>
<blockquote><p>Returns <var>parameter-list</var> with <var>parameter1</var> <small class="dots">...</small> merged in. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>parameter-list-expand</b><var> expanders parameter-list<a name="index-parameter_002dlist_002dexpand-282"></a></var><br>
<blockquote><p><var>expanders</var> is a list of procedures whose order matches the order of
the <var>parameter-name</var>s in the call to <code>make-parameter-list</code>
which created <var>parameter-list</var>.  For each non-false element of
<var>expanders</var> that procedure is mapped over the corresponding
parameter value and the returned parameter lists are merged into
<var>parameter-list</var>.

       <p>This process is repeated until <var>parameter-list</var> stops growing.  The
value returned from <code>parameter-list-expand</code> is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fill-empty-parameters</b><var> defaulters parameter-list<a name="index-fill_002dempty_002dparameters-283"></a></var><br>
<blockquote><p><var>defaulters</var> is a list of procedures whose order matches the order
of the <var>parameter-name</var>s in the call to <code>make-parameter-list</code>
which created <var>parameter-list</var>.  <code>fill-empty-parameters</code>
returns a new parameter-list with each empty parameter replaced with the
list returned by calling the corresponding <var>defaulter</var> with
<var>parameter-list</var> as its argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>check-parameters</b><var> checks parameter-list<a name="index-check_002dparameters-284"></a></var><br>
<blockquote><p><var>checks</var> is a list of procedures whose order matches the order of
the <var>parameter-name</var>s in the call to <code>make-parameter-list</code>
which created <var>parameter-list</var>.

       <p><code>check-parameters</code> returns <var>parameter-list</var> if each <var>check</var>
of the corresponding <var>parameter-list</var> returns non-false.  If some
<var>check</var> returns <code>#f</code> a warning is signaled. 
</p></blockquote></div>

<p class="noindent">In the following procedures <var>arities</var> is a list of symbols.  The
elements of <code>arities</code> can be:

     <dl>
<dt><code>single</code><dd>Requires a single parameter. 
<br><dt><code>optional</code><dd>A single parameter or no parameter is acceptable. 
<br><dt><code>boolean</code><dd>A single boolean parameter or zero parameters is acceptable. 
<br><dt><code>nary</code><dd>Any number of parameters are acceptable. 
<br><dt><code>nary1</code><dd>One or more of parameters are acceptable. 
</dl>

<div class="defun">
&mdash; Function: <b>parameter-list-&gt;arglist</b><var> positions arities parameter-list<a name="index-parameter_002dlist_002d_003earglist-285"></a></var><br>
<blockquote><p>Returns <var>parameter-list</var> converted to an argument list.  Parameters
of <var>arity</var> type <code>single</code> and <code>boolean</code> are converted to
the single value associated with them.  The other <var>arity</var> types are
converted to lists of the value(s).

       <p><var>positions</var> is a list of positive integers whose order matches the
order of the <var>parameter-name</var>s in the call to
<code>make-parameter-list</code> which created <var>parameter-list</var>.  The
integers specify in which argument position the corresponding parameter
should appear. 
</p></blockquote></div>

<div class="node">
<a name="Getopt-Parameter-lists"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Filenames">Filenames</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parameter-lists">Parameter lists</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programs-and-Arguments">Programs and Arguments</a>

</div>

<h4 class="subsection">4.4.5 Getopt Parameter lists</h4>

<p><code>(require 'getopt-parameters)</code>
<a name="index-getopt_002dparameters-286"></a>

<div class="defun">
&mdash; Function: <b>getopt-&gt;parameter-list</b><var> optnames arities types aliases desc <small class="dots">...</small><a name="index-getopt_002d_003eparameter_002dlist-287"></a></var><br>
<blockquote>
       <p>Returns <var>*argv*</var> converted to a parameter-list.  <var>optnames</var> are
the parameter-names.  <var>arities</var> and <var>types</var> are lists of symbols
corresponding to <var>optnames</var>.

       <p><var>aliases</var> is a list of lists of strings or integers paired with
elements of <var>optnames</var>.  Each one-character string will be treated
as a single &lsquo;<samp><span class="samp">-</span></samp>&rsquo; option by <code>getopt</code>.  Longer strings will be
treated as long-named options (see <a href="#Getopt">getopt&ndash;</a>).

       <p>If the <var>aliases</var> association list has only strings as its
<code>car</code>s, then all the option-arguments after an option (and before
the next option) are adjoined to that option.

       <p>If the <var>aliases</var> association list has integers, then each (string)
option will take at most one option-argument.  Unoptioned arguments are
collected in a list.  A &lsquo;<samp><span class="samp">-1</span></samp>&rsquo; alias will take the last argument in
this list; &lsquo;<samp><span class="samp">+1</span></samp>&rsquo; will take the first argument in the list.  The
aliases -2 then +2; -3 then +3; <small class="dots">...</small> are tried so long as a positive
or negative consecutive alias is found and arguments remain in the list. 
Finally a &lsquo;<samp><span class="samp">0</span></samp>&rsquo; alias, if found, absorbs any remaining arguments.

       <p>In all cases, if unclaimed arguments remain after processing, a warning
is signaled and #f is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getopt-&gt;arglist</b><var> optnames positions arities types defaulters checks aliases desc <small class="dots">...</small><a name="index-getopt_002d_003earglist-288"></a></var><br>
<blockquote>
       <p>Like <code>getopt-&gt;parameter-list</code>, but converts <var>*argv*</var> to an
argument-list as specified by <var>optnames</var>, <var>positions</var>,
<var>arities</var>, <var>types</var>, <var>defaulters</var>, <var>checks</var>, and
<var>aliases</var>.  If the options supplied violate the <var>arities</var> or
<var>checks</var> constraints, then a warning is signaled and #f is returned. 
</p></blockquote></div>

<p class="noindent">These <code>getopt</code> functions can be used with SLIB relational
databases.  For an example, See <a href="#Using-Databases">make-command-server</a>.

<p class="noindent">If errors are encountered while processing options, directions for using
the options (and argument strings <var>desc</var> <small class="dots">...</small>) are printed to
<code>current-error-port</code>.

<pre class="example">     (begin
       (set! *optind* 1)
       (set! *argv* '("cmd" "-?")
       (getopt-&gt;parameter-list
        '(flag number symbols symbols string flag2 flag3 num2 num3)
        '(boolean optional nary1 nary single boolean boolean nary nary)
        '(boolean integer symbol symbol string boolean boolean integer integer)
        '(("flag" flag)
          ("f" flag)
          ("Flag" flag2)
          ("B" flag3)
          ("optional" number)
          ("o" number)
          ("nary1" symbols)
          ("N" symbols)
          ("nary" symbols)
          ("n" symbols)
          ("single" string)
          ("s" string)
          ("a" num2)
          ("Abs" num3))))
     -|
     Usage: cmd [OPTION ARGUMENT ...] ...
     
       -f, --flag
       -o, --optional=&lt;number&gt;
       -n, --nary=&lt;symbols&gt; ...
       -N, --nary1=&lt;symbols&gt; ...
       -s, --single=&lt;string&gt;
           --Flag
       -B
       -a        &lt;num2&gt; ...
           --Abs=&lt;num3&gt; ...
     
     ERROR: getopt-&gt;parameter-list "unrecognized option" "-?"
</pre>
  <div class="node">
<a name="Filenames"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Batch">Batch</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getopt-Parameter-lists">Getopt Parameter lists</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programs-and-Arguments">Programs and Arguments</a>

</div>

<h4 class="subsection">4.4.6 Filenames</h4>

<p><a name="index-glob-289"></a>

  <p><code>(require 'filename)</code>
<a name="index-filename-290"></a><a name="index-glob-291"></a>

<div class="defun">
&mdash; Function: <b>filename:match??</b><var> pattern<a name="index-filename_003amatch_003f_003f-292"></a></var><br>
&mdash; Function: <b>filename:match-ci??</b><var> pattern<a name="index-filename_003amatch_002dci_003f_003f-293"></a></var><br>
<blockquote>
       <p>Returns a predicate which returns a non-false value if its string argument
matches (the string) <var>pattern</var>, false otherwise.  Filename matching
is like
<a name="index-glob-294"></a><dfn>glob</dfn> expansion described the bash manpage, except that names
<a name="index-glob-295"></a>beginning with &lsquo;<samp><span class="samp">.</span></samp>&rsquo; are matched and &lsquo;<samp><span class="samp">/</span></samp>&rsquo; characters are not
treated specially.

       <p>These functions interpret the following characters specially in
<var>pattern</var> strings:
          <dl>
<dt>&lsquo;<samp><span class="samp">*</span></samp>&rsquo;<dd>Matches any string, including the null string. 
<br><dt>&lsquo;<samp><span class="samp">?</span></samp>&rsquo;<dd>Matches any single character. 
<br><dt>&lsquo;<samp><span class="samp">[...]</span></samp>&rsquo;<dd>Matches any one of the enclosed characters.  A pair of characters
separated by a minus sign (-) denotes a range; any character lexically
between those two characters, inclusive, is matched.  If the first
character following the &lsquo;<samp><span class="samp">[</span></samp>&rsquo; is a &lsquo;<samp><span class="samp">!</span></samp>&rsquo; or a &lsquo;<samp><span class="samp">^</span></samp>&rsquo; then any
character not enclosed is matched.  A &lsquo;<samp><span class="samp">-</span></samp>&rsquo; or &lsquo;<samp><span class="samp">]</span></samp>&rsquo; may be
matched by including it as the first or last character in the set. 
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>filename:substitute??</b><var> pattern template<a name="index-filename_003asubstitute_003f_003f-296"></a></var><br>
&mdash; Function: <b>filename:substitute-ci??</b><var> pattern template<a name="index-filename_003asubstitute_002dci_003f_003f-297"></a></var><br>
<blockquote>
       <p>Returns a function transforming a single string argument according to
glob patterns <var>pattern</var> and <var>template</var>.  <var>pattern</var> and
<var>template</var> must have the same number of wildcard specifications,
which need not be identical.  <var>pattern</var> and <var>template</var> may have
a different number of literal sections. If an argument to the function
matches <var>pattern</var> in the sense of <code>filename:match??</code> then it
returns a copy of <var>template</var> in which each wildcard specification is
replaced by the part of the argument matched by the corresponding
wildcard specification in <var>pattern</var>.  A <code>*</code> wildcard matches
the longest leftmost string possible.  If the argument does not match
<var>pattern</var> then false is returned.

       <p><var>template</var> may be a function accepting the same number of string
arguments as there are wildcard specifications in <var>pattern</var>.  In
the case of a match the result of applying <var>template</var> to a list
of the substrings matched by wildcard specifications will be returned,
otherwise <var>template</var> will not be called and <code>#f</code> will be returned. 
</p></blockquote></div>

<pre class="example">     ((filename:substitute?? "scm_[0-9]*.html" "scm5c4_??.htm")
      "scm_10.html")
     &rArr; "scm5c4_10.htm"
     ((filename:substitute?? "??" "beg?mid?end") "AZ")
     &rArr; "begAmidZend"
     ((filename:substitute?? "*na*" "?NA?") "banana")
     &rArr; "banaNA"
     ((filename:substitute?? "?*?" (lambda (s1 s2 s3) (string-append s3 s1)))
      "ABZ")
     &rArr; "ZA"
</pre>
  <div class="defun">
&mdash; Function: <b>replace-suffix</b><var> str old new<a name="index-replace_002dsuffix-298"></a></var><br>
<blockquote>
       <p><var>str</var> can be a string or a list of strings.  Returns a new string
(or strings) similar to <code>str</code> but with the suffix string <var>old</var>
removed and the suffix string <var>new</var> appended.  If the end of
<var>str</var> does not match <var>old</var>, an error is signaled. 
</p></blockquote></div>

<pre class="example">     (replace-suffix "/usr/local/lib/slib/batch.scm" ".scm" ".c")
     &rArr; "/usr/local/lib/slib/batch.c"
</pre>
  <div class="defun">
&mdash; Function: <b>call-with-tmpnam</b><var> proc k<a name="index-call_002dwith_002dtmpnam-299"></a></var><br>

  &mdash; Function: <b>call-with-tmpnam</b><var> proc<a name="index-call_002dwith_002dtmpnam-300"></a></var><br>
<blockquote><p>Calls <var>proc</var> with <var>k</var> arguments, strings returned by successive calls to
<code>tmpnam</code>. 
If <var>proc</var> returns, then any files named by the arguments to <var>proc</var> are
deleted automatically and the value(s) yielded by the <var>proc</var> is(are)
returned.  <var>k</var> may be ommited, in which case it defaults to <code>1</code>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>call-with-tmpnam</b><var> proc suffix1 <small class="dots">...</small><a name="index-call_002dwith_002dtmpnam-301"></a></var><br>
<blockquote><p>Calls <var>proc</var> with strings returned by successive calls to <code>tmpnam</code>,
each with the corresponding <var>suffix</var> string appended. 
If <var>proc</var> returns, then any files named by the arguments to <var>proc</var> are
deleted automatically and the value(s) yielded by the <var>proc</var> is(are)
returned. 
</p></blockquote></div>

<div class="node">
<a name="Batch"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Filenames">Filenames</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programs-and-Arguments">Programs and Arguments</a>

</div>

<h4 class="subsection">4.4.7 Batch</h4>

<p><code>(require 'batch)</code>
<a name="index-batch-302"></a>
The batch procedures provide a way to write and execute portable scripts
for a variety of operating systems.  Each <code>batch:</code> procedure takes
as its first argument a parameter-list (see <a href="#Parameter-lists">Parameter lists</a>).  This
parameter-list argument <var>parms</var> contains named associations.  Batch
currently uses 2 of these:

     <dl>
<dt><code>batch-port</code><dd>The port on which to write lines of the batch file. 
<br><dt><code>batch-dialect</code><dd>The syntax of batch file to generate.  Currently supported are:
          <ul>
<li>unix
<li>dos
<li>vms
<li>amigaos
<li>system
<li>*unknown*
</ul>
     </dl>

<p class="noindent">The &lsquo;<samp><span class="samp">batch</span></samp>&rsquo; module uses 2 enhanced relational tables
(see <a href="#Using-Databases">Using Databases</a>) to store information linking the names of
<code>operating-system</code>s to <code>batch-dialect</code>es.

<div class="defun">
&mdash; Function: <b>batch:initialize!</b><var> database<a name="index-batch_003ainitialize_0021-303"></a></var><br>
<blockquote><p>Defines <code>operating-system</code> and <code>batch-dialect</code> tables and adds
the domain <code>operating-system</code> to the enhanced relational database
<var>database</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>*operating-system*</b><var><a name="index-g_t_002aoperating_002dsystem_002a-304"></a></var><br>
<blockquote><p>Is batch's best guess as to which operating-system it is running under. 
<code>*operating-system*</code> is set to <code>(software-type)</code>
(see <a href="#Configuration">Configuration</a>) unless <code>(software-type)</code> is <code>unix</code>,
in which case finer distinctions are made. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>batch:call-with-output-script</b><var> parms file proc<a name="index-batch_003acall_002dwith_002doutput_002dscript-305"></a></var><br>
<blockquote><p><var>proc</var> should be a procedure of one argument.  If <var>file</var> is an
output-port, <code>batch:call-with-output-script</code> writes an appropriate
header to <var>file</var> and then calls <var>proc</var> with <var>file</var> as the
only argument.  If <var>file</var> is a string,
<code>batch:call-with-output-script</code> opens a output-file of name
<var>file</var>, writes an appropriate header to <var>file</var>, and then calls
<var>proc</var> with the newly opened port as the only argument.  Otherwise,
<code>batch:call-with-output-script</code> acts as if it was called with the
result of <code>(current-output-port)</code> as its third argument. 
</p></blockquote></div>

<p class="noindent">The rest of the <code>batch:</code> procedures write (or execute if
<code>batch-dialect</code> is <code>system</code>) commands to the batch port which
has been added to <var>parms</var> or <code>(copy-tree </code><var>parms</var><code>)</code> by the
code:

<pre class="example">     (adjoin-parameters! <var>parms</var> (list 'batch-port <var>port</var>))
</pre>
  <div class="defun">
&mdash; Function: <b>batch:command</b><var> parms string1 string2 <small class="dots">...</small><a name="index-batch_003acommand-306"></a></var><br>
<blockquote><p>Calls <code>batch:try-command</code> (below) with arguments, but signals an
error if <code>batch:try-command</code> returns <code>#f</code>. 
</p></blockquote></div>

<p class="noindent">These functions return a non-false value if the command was successfully
translated into the batch dialect and <code>#f</code> if not.  In the case of
the <code>system</code> dialect, the value is non-false if the operation
suceeded.

<div class="defun">
&mdash; Function: <b>batch:try-command</b><var> parms string1 string2 <small class="dots">...</small><a name="index-batch_003atry_002dcommand-307"></a></var><br>
<blockquote><p>Writes a command to the <code>batch-port</code> in <var>parms</var> which executes
the program named <var>string1</var> with arguments <var>string2</var> <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>batch:try-chopped-command</b><var> parms arg1 arg2 <small class="dots">...</small> list<a name="index-batch_003atry_002dchopped_002dcommand-308"></a></var><br>
<blockquote><p>breaks the last argument <var>list</var> into chunks small enough so that the
command:

     <pre class="example">          <var>arg1</var> <var>arg2</var> ... <var>chunk</var>
</pre>
       <p>fits withing the platform's maximum command-line length.

       <p><code>batch:try-chopped-command</code> calls <code>batch:try-command</code> with the
command and returns non-false only if the commands all fit and
<code>batch:try-command</code> of each command line returned non-false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>batch:run-script</b><var> parms string1 string2 <small class="dots">...</small><a name="index-batch_003arun_002dscript-309"></a></var><br>
<blockquote><p>Writes a command to the <code>batch-port</code> in <var>parms</var> which executes
the batch script named <var>string1</var> with arguments <var>string2</var>
<small class="dots">...</small>.

       <p><em>Note:</em> <code>batch:run-script</code> and <code>batch:try-command</code> are not the
same for some operating systems (VMS). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>batch:comment</b><var> parms line1 <small class="dots">...</small><a name="index-batch_003acomment-310"></a></var><br>
<blockquote><p>Writes comment lines <var>line1</var> <small class="dots">...</small> to the <code>batch-port</code> in
<var>parms</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>batch:lines-&gt;file</b><var> parms file line1 <small class="dots">...</small><a name="index-batch_003alines_002d_003efile-311"></a></var><br>
<blockquote><p>Writes commands to the <code>batch-port</code> in <var>parms</var> which create a
file named <var>file</var> with contents <var>line1</var> <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>batch:delete-file</b><var> parms file<a name="index-batch_003adelete_002dfile-312"></a></var><br>
<blockquote><p>Writes a command to the <code>batch-port</code> in <var>parms</var> which deletes
the file named <var>file</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>batch:rename-file</b><var> parms old-name new-name<a name="index-batch_003arename_002dfile-313"></a></var><br>
<blockquote><p>Writes a command to the <code>batch-port</code> in <var>parms</var> which renames
the file <var>old-name</var> to <var>new-name</var>. 
</p></blockquote></div>

<p class="noindent">In addition, batch provides some small utilities very useful for writing
scripts:

<div class="defun">
&mdash; Function: <b>truncate-up-to</b><var> path char<a name="index-truncate_002dup_002dto-314"></a></var><br>
&mdash; Function: <b>truncate-up-to</b><var> path string<a name="index-truncate_002dup_002dto-315"></a></var><br>
&mdash; Function: <b>truncate-up-to</b><var> path charlist<a name="index-truncate_002dup_002dto-316"></a></var><br>
<blockquote><p><var>path</var> can be a string or a list of strings.  Returns <var>path</var>
sans any prefixes ending with a character of the second argument.  This
can be used to derive a filename moved locally from elsewhere.

     <pre class="example">          (truncate-up-to "/usr/local/lib/slib/batch.scm" "/")
          &rArr; "batch.scm"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>string-join</b><var> joiner string1 <small class="dots">...</small><a name="index-string_002djoin-317"></a></var><br>
<blockquote><p>Returns a new string consisting of all the strings <var>string1</var> <small class="dots">...</small>
in order appended together with the string <var>joiner</var> between each
adjacent pair. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>must-be-first</b><var> list1 list2<a name="index-must_002dbe_002dfirst-318"></a></var><br>
<blockquote><p>Returns a new list consisting of the elements of <var>list2</var> ordered so
that if some elements of <var>list1</var> are <code>equal?</code> to elements of
<var>list2</var>, then those elements will appear first and in the order of
<var>list1</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>must-be-last</b><var> list1 list2<a name="index-must_002dbe_002dlast-319"></a></var><br>
<blockquote><p>Returns a new list consisting of the elements of <var>list1</var> ordered so
that if some elements of <var>list2</var> are <code>equal?</code> to elements of
<var>list1</var>, then those elements will appear last and in the order of
<var>list2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>os-&gt;batch-dialect</b><var> osname<a name="index-os_002d_003ebatch_002ddialect-320"></a></var><br>
<blockquote><p>Returns its best guess for the <code>batch-dialect</code> to be used for the
operating-system named <var>osname</var>.  <code>os-&gt;batch-dialect</code> uses the
tables added to <var>database</var> by <code>batch:initialize!</code>. 
</p></blockquote></div>

<p class="noindent">Here is an example of the use of most of batch's procedures:

<pre class="example">     (require 'databases)
     <a name="index-databases-321"></a>(require 'parameters)
     <a name="index-parameters-322"></a>(require 'batch)
     <a name="index-batch-323"></a>(require 'filename)
     <a name="index-filename-324"></a>
     (define batch (create-database #f 'alist-table))
     (batch:initialize! batch)
     
     (define my-parameters
       (list (list 'batch-dialect (os-&gt;batch-dialect *operating-system*))
             (list 'operating-system *operating-system*)
             (list 'batch-port (current-output-port)))) ;gets filled in later
     
     (batch:call-with-output-script
      my-parameters
      "my-batch"
      (lambda (batch-port)
        (adjoin-parameters! my-parameters (list 'batch-port batch-port))
        (and
         (batch:comment my-parameters
                        "================ Write file with C program.")
         (batch:rename-file my-parameters "hello.c" "hello.c~")
         (batch:lines-&gt;file my-parameters "hello.c"
                            "#include &lt;stdio.h&gt;"
                            "int main(int argc, char **argv)"
                            "{"
                            "  printf(\"hello world\\n\");"
                            "  return 0;"
                            "}" )
         (batch:command my-parameters "cc" "-c" "hello.c")
         (batch:command my-parameters "cc" "-o" "hello"
                       (replace-suffix "hello.c" ".c" ".o"))
         (batch:command my-parameters "hello")
         (batch:delete-file my-parameters "hello")
         (batch:delete-file my-parameters "hello.c")
         (batch:delete-file my-parameters "hello.o")
         (batch:delete-file my-parameters "my-batch")
         )))
</pre>
  <p class="noindent">Produces the file <samp><span class="file">my-batch</span></samp>:

<pre class="example">     #! /bin/sh
     # "my-batch" script created by SLIB/batch Sun Oct 31 18:24:10 1999
     # ================ Write file with C program.
     mv -f hello.c hello.c~
     rm -f hello.c
     echo '#include &lt;stdio.h&gt;'&gt;&gt;hello.c
     echo 'int main(int argc, char **argv)'&gt;&gt;hello.c
     echo '{'&gt;&gt;hello.c
     echo '  printf("hello world\n");'&gt;&gt;hello.c
     echo '  return 0;'&gt;&gt;hello.c
     echo '}'&gt;&gt;hello.c
     cc -c hello.c
     cc -o hello hello.o
     hello
     rm -f hello
     rm -f hello.c
     rm -f hello.o
     rm -f my-batch
</pre>
  <p class="noindent">When run, <samp><span class="file">my-batch</span></samp> prints:

<pre class="example">     bash$ my-batch
     mv: hello.c: No such file or directory
     hello world
</pre>
  <div class="node">
<a name="HTML"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#HTML-Tables">HTML Tables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Programs-and-Arguments">Programs and Arguments</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.5 HTML</h3>

<p><code>(require 'html-form)</code>
<a name="index-html_002dform-325"></a>

<div class="defun">
&mdash; Function: <b>html:atval</b><var> txt<a name="index-html_003aatval-326"></a></var><br>
<blockquote><p>Returns a string with character substitutions appropriate to
send <var>txt</var> as an <dfn>attribute-value</dfn>. 
<a name="index-attribute_002dvalue-327"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:plain</b><var> txt<a name="index-html_003aplain-328"></a></var><br>
<blockquote><p>Returns a string with character substitutions appropriate to
send <var>txt</var> as an <dfn>plain-text</dfn>. 
<a name="index-plain_002dtext-329"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:meta</b><var> name content<a name="index-html_003ameta-330"></a></var><br>
<blockquote><p>Returns a tag of meta-information suitable for passing as the
third argument to <code>html:head</code>.  The tag produced is &lsquo;<samp><span class="samp">&lt;META
NAME="</span><var>name</var><span class="samp">" CONTENT="</span><var>content</var><span class="samp">"&gt;</span></samp>&rsquo;.  The string or symbol <var>name</var> can be
&lsquo;<samp><span class="samp">author</span></samp>&rsquo;, &lsquo;<samp><span class="samp">copyright</span></samp>&rsquo;, &lsquo;<samp><span class="samp">keywords</span></samp>&rsquo;, &lsquo;<samp><span class="samp">description</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">date</span></samp>&rsquo;, &lsquo;<samp><span class="samp">robots</span></samp>&rsquo;, <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:http-equiv</b><var> name content<a name="index-html_003ahttp_002dequiv-331"></a></var><br>
<blockquote><p>Returns a tag of HTTP information suitable for passing as the
third argument to <code>html:head</code>.  The tag produced is &lsquo;<samp><span class="samp">&lt;META
HTTP-EQUIV="</span><var>name</var><span class="samp">" CONTENT="</span><var>content</var><span class="samp">"&gt;</span></samp>&rsquo;.  The string or symbol <var>name</var> can be
&lsquo;<samp><span class="samp">Expires</span></samp>&rsquo;, &lsquo;<samp><span class="samp">PICS-Label</span></samp>&rsquo;, &lsquo;<samp><span class="samp">Content-Type</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">Refresh</span></samp>&rsquo;, <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:meta-refresh</b><var> delay uri<a name="index-html_003ameta_002drefresh-332"></a></var><br>

  &mdash; Function: <b>html:meta-refresh</b><var> delay<a name="index-html_003ameta_002drefresh-333"></a></var><br>
<blockquote>
       <p>Returns a tag suitable for passing as the third argument to
<code>html:head</code>.  If <var>uri</var> argument is supplied, then <var>delay</var> seconds after
displaying the page with this tag, Netscape or IE browsers will fetch
and display <var>uri</var>.  Otherwise, <var>delay</var> seconds after displaying the page with
this tag, Netscape or IE browsers will fetch and redisplay this page. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:head</b><var> title backlink tags <small class="dots">...</small><a name="index-html_003ahead-334"></a></var><br>

  &mdash; Function: <b>html:head</b><var> title backlink<a name="index-html_003ahead-335"></a></var><br>

  &mdash; Function: <b>html:head</b><var> title<a name="index-html_003ahead-336"></a></var><br>
<blockquote>
       <p>Returns header string for an HTML page named <var>title</var>.  If <var>backlink</var> is a string,
it is used verbatim between the &lsquo;<samp><span class="samp">H1</span></samp>&rsquo; tags; otherwise <var>title</var> is
used.  If string arguments <var>tags</var> ... are supplied, then they are
included verbatim within the <tt>&lt;HEAD&gt;</tt> section. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:body</b><var> body <small class="dots">...</small><a name="index-html_003abody-337"></a></var><br>
<blockquote><p>Returns HTML string to end a page. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:pre</b><var> line1 line <small class="dots">...</small><a name="index-html_003apre-338"></a></var><br>
<blockquote><p>Returns the strings <var>line1</var>, <var>lines</var> as <dfn>PRE</dfn>formmated plain text
<a name="index-PRE-339"></a>(rendered in fixed-width font).  Newlines are inserted between <var>line1</var>,
<var>lines</var>.  HTML tags (&lsquo;<samp><span class="samp">&lt;tag&gt;</span></samp>&rsquo;) within <var>lines</var> will be visible verbatim. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:comment</b><var> line1 line <small class="dots">...</small><a name="index-html_003acomment-340"></a></var><br>
<blockquote><p>Returns the strings <var>line1</var> as HTML comments. 
</p></blockquote></div>

<h3 class="section">4.6 HTML Forms</h3>

<div class="defun">
&mdash; Function: <b>html:form</b><var> method action body <small class="dots">...</small><a name="index-html_003aform-341"></a></var><br>
<blockquote><p>The symbol <var>method</var> is either <code>get</code>, <code>head</code>, <code>post</code>,
<code>put</code>, or <code>delete</code>.  The strings <var>body</var> form the body of the
form.  <code>html:form</code> returns the HTML <dfn>form</dfn>. 
<a name="index-form-342"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:hidden</b><var> name value<a name="index-html_003ahidden-343"></a></var><br>
<blockquote><p>Returns HTML string which will cause <var>name</var>=<var>value</var> in form. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:checkbox</b><var> pname default<a name="index-html_003acheckbox-344"></a></var><br>
<blockquote><p>Returns HTML string for check box. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:text</b><var> pname default size <small class="dots">...</small><a name="index-html_003atext-345"></a></var><br>
<blockquote><p>Returns HTML string for one-line text box. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:text-area</b><var> pname default-list<a name="index-html_003atext_002darea-346"></a></var><br>
<blockquote><p>Returns HTML string for multi-line text box. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:select</b><var> pname arity default-list foreign-values<a name="index-html_003aselect-347"></a></var><br>
<blockquote><p>Returns HTML string for pull-down menu selector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:buttons</b><var> pname arity default-list foreign-values<a name="index-html_003abuttons-348"></a></var><br>
<blockquote><p>Returns HTML string for any-of selector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>form:submit</b><var> submit-label command<a name="index-form_003asubmit-349"></a></var><br>

  &mdash; Function: <b>form:submit</b><var> submit-label<a name="index-form_003asubmit-350"></a></var><br>
<blockquote>
       <p>The string or symbol <var>submit-label</var> appears on the button which submits the form. 
If the optional second argument <var>command</var> is given, then <code>*command*=</code><var>command</var>
and <code>*button*=</code><var>submit-label</var> are set in the query.  Otherwise,
<code>*command*=</code><var>submit-label</var> is set in the query. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>form:image</b><var> submit-label image-src<a name="index-form_003aimage-351"></a></var><br>
<blockquote><p>The <var>image-src</var> appears on the button which submits the form. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>form:reset</b><var><a name="index-form_003areset-352"></a></var><br>
<blockquote><p>Returns a string which generates a <dfn>reset</dfn> button. 
<a name="index-reset-353"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>form:element</b><var> pname arity default-list foreign-values<a name="index-form_003aelement-354"></a></var><br>
<blockquote><p>Returns a string which generates an INPUT element for the field
named <var>pname</var>.  The element appears in the created form with its
representation determined by its <var>arity</var> and domain.  For domains which
are foreign-keys:

          <dl>
<dt><code>single</code><dd>select menu
<br><dt><code>optional</code><dd>select menu
<br><dt><code>nary</code><dd>check boxes
<br><dt><code>nary1</code><dd>check boxes
</dl>

       <p>If the foreign-key table has a field named &lsquo;<samp><span class="samp">visible-name</span></samp>&rsquo;, then
the contents of that field are the names visible to the user for
those choices.  Otherwise, the foreign-key itself is visible.

       <p>For other types of domains:

          <dl>
<dt><code>single</code><dd>text area
<br><dt><code>optional</code><dd>text area
<br><dt><code>boolean</code><dd>check box
<br><dt><code>nary</code><dd>text area
<br><dt><code>nary1</code><dd>text area
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>form:delimited</b><var> pname doc aliat arity default-list foreign-values<a name="index-form_003adelimited-355"></a></var><br>
<blockquote>
       <p>Returns a HTML string for a form element embedded in a line of a
delimited list.  Apply map <code>form:delimited</code> to the list returned by
<code>command-&gt;p-specs</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:delimited-list</b><var> row <small class="dots">...</small><a name="index-html_003adelimited_002dlist-356"></a></var><br>
<blockquote><p>Wraps its arguments with delimited-list (&lsquo;<samp><span class="samp">DL</span></samp>&rsquo; command. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>get-foreign-choices</b><var> tab<a name="index-get_002dforeign_002dchoices-357"></a></var><br>
<blockquote><p>Returns a list of the &lsquo;<samp><span class="samp">visible-name</span></samp>&rsquo; or first fields of
table <var>tab</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>command-&gt;p-specs</b><var> rdb command-table command<a name="index-command_002d_003ep_002dspecs-358"></a></var><br>
<blockquote>
       <p>The symbol <var>command-table</var> names a command table in the <var>rdb</var> relational database. 
The symbol <var>command</var> names a key in <var>command-table</var>.

       <p><code>command-&gt;p-specs</code> returns a list of lists of <var>pname</var>, <var>doc</var>, <var>aliat</var>,
<var>arity</var>, <var>default-list</var>, and <var>foreign-values</var>.  The
returned list has one element for each parameter of command <var>command</var>.

       <p>This example demonstrates how to create a HTML-form for the &lsquo;<samp><span class="samp">build</span></samp>&rsquo;
command.

     <pre class="example">          (require (in-vicinity (implementation-vicinity) "build.scm"))
          (call-with-output-file "buildscm.html"
            (lambda (port)
              (display
               (string-append
                (html:head 'commands)
                (html:body
                 (sprintf #f "&lt;H2&gt;%s:&lt;/H2&gt;&lt;BLOCKQUOTE&gt;%s&lt;/BLOCKQUOTE&gt;\\n"
                          (html:plain 'build)
                          (html:plain ((comtab 'get 'documentation) 'build)))
                 (html:form
                  'post
                  (or "http://localhost:8081/buildscm" "/cgi-bin/build.cgi")
                  (apply html:delimited-list
                         (apply map form:delimited
                                (command-&gt;p-specs build '*commands* 'build)))
                  (form:submit 'build)
                  (form:reset))))
               port)))
</pre>
       </blockquote></div>

<div class="node">
<a name="HTML-Tables"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#HTTP-and-CGI">HTTP and CGI</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#HTML">HTML</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.7 HTML Tables</h3>

<p><code>(require 'db-&gt;html)</code>
<a name="index-db_002d_003ehtml-359"></a>

<div class="defun">
&mdash; Function: <b>html:table</b><var> options row <small class="dots">...</small><a name="index-html_003atable-360"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>html:caption</b><var> caption align<a name="index-html_003acaption-361"></a></var><br>

  &mdash; Function: <b>html:caption</b><var> caption<a name="index-html_003acaption-362"></a></var><br>
<blockquote><p><var>align</var> can be &lsquo;<samp><span class="samp">top</span></samp>&rsquo; or &lsquo;<samp><span class="samp">bottom</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:heading</b><var> columns<a name="index-html_003aheading-363"></a></var><br>
<blockquote><p>Outputs a heading row for the currently-started table. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:href-heading</b><var> columns uris<a name="index-html_003ahref_002dheading-364"></a></var><br>
<blockquote><p>Outputs a heading row with column-names <var>columns</var> linked to URIs <var>uris</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:linked-row-converter</b><var> k foreigns<a name="index-html_003alinked_002drow_002dconverter-365"></a></var><br>
<blockquote>
       <p>The positive integer <var>k</var> is the primary-key-limit (number of
primary-keys) of the table.  <var>foreigns</var> is a list of the filenames of
foreign-key field pages and #f for non foreign-key fields.

       <p><code>html:linked-row-converter</code> returns a procedure taking a row for its single argument.  This
returned procedure returns the html string for that table row. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>table-name-&gt;filename</b><var> table-name<a name="index-table_002dname_002d_003efilename-366"></a></var><br>
<blockquote>
       <p>Returns the symbol <var>table-name</var> converted to a filename. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>table-&gt;linked-html</b><var> caption db table-name match-key1 <small class="dots">...</small><a name="index-table_002d_003elinked_002dhtml-367"></a></var><br>
<blockquote>
       <p>Returns HTML string for <var>db</var> table <var>table-name</var> chopped into 50-row HTML tables. 
Every foreign-key value is linked to the page (of the table)
defining that key.

       <p>The optional <var>match-key1</var> <small class="dots">...</small> arguments restrict actions to a subset of
the table.  See <a href="#Table-Operations">match-key</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>table-&gt;linked-page</b><var> db table-name index-filename arg <small class="dots">...</small><a name="index-table_002d_003elinked_002dpage-368"></a></var><br>
<blockquote>
       <p>Returns a complete HTML page.  The string <var>index-filename</var> names the page which
refers to this one.

       <p>The optional <var>args</var> <small class="dots">...</small> arguments restrict actions to a subset of
the table.  See <a href="#Table-Operations">match-key</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>catalog-&gt;html</b><var> db caption arg <small class="dots">...</small><a name="index-catalog_002d_003ehtml-369"></a></var><br>
<blockquote>
       <p>Returns HTML string for the catalog table of <var>db</var>. 
</p></blockquote></div>

<h4 class="subsection">4.7.1 HTML editing tables</h4>

<p class="noindent">A client can modify one row of an editable table at a time. 
For any change submitted, these routines check if that row has been
modified during the time the user has been editing the form.  If so,
an error page results.

<p class="noindent">The behavior of edited rows is:

     <ul>
<li>If no fields are changed, then no change is made to the table. 
<li>If the primary keys equal null-keys (parameter defaults), and no other
user has modified that row, then that row is deleted. 
<li>If only primary keys are changed, there are non-key fields, and no
row with the new keys is in the table, then the old row is
deleted and one with the new keys is inserted. 
<li>If only non-key fields are changed, and that row has not been
modified by another user, then the row is changed to reflect the
fields. 
<li>If both keys and non-key fields are changed, and no row with the
new keys is in the table, then a row is created with the new
keys and fields. 
<li>If fields are changed, all fields are primary keys, and no row with
the new keys is in the table, then a row is created with the new
keys. 
</ul>

<p class="noindent">After any change to the table, a <code>sync-database</code> of the
database is performed.

<div class="defun">
&mdash; Function: <b>command:modify-table</b><var> table-name null-keys update delete retrieve<a name="index-command_003amodify_002dtable-370"></a></var><br>

  &mdash; Function: <b>command:modify-table</b><var> table-name null-keys update delete<a name="index-command_003amodify_002dtable-371"></a></var><br>

  &mdash; Function: <b>command:modify-table</b><var> table-name null-keys update<a name="index-command_003amodify_002dtable-372"></a></var><br>

  &mdash; Function: <b>command:modify-table</b><var> table-name null-keys<a name="index-command_003amodify_002dtable-373"></a></var><br>
<blockquote>
       <p>Returns procedure (of <var>db</var>) which returns procedure to modify
row of <var>table-name</var>.  <var>null-keys</var> is the list of <dfn>null</dfn> keys indicating the row is
<a name="index-null-374"></a>to be deleted when any matches its corresponding primary key. 
Optional arguments <var>update</var>, <var>delete</var>, and <var>retrieve</var> default to the <code>row:update</code>,
<code>row:delete</code>, and <code>row:retrieve</code> of <var>table-name</var> in <var>db</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>command:make-editable-table</b><var> rdb table-name arg <small class="dots">...</small><a name="index-command_003amake_002deditable_002dtable-375"></a></var><br>
<blockquote><p>Given <var>table-name</var> in <var>rdb</var>, creates parameter and <code>*command*</code> tables
for editing one row of <var>table-name</var> at a time.  <code>command:make-editable-table</code> returns a procedure taking a
row argument which returns the HTML string for editing that row.

       <p>Optional <var>args</var> are expressions (lists) added to the call to
<code>command:modify-table</code>.

       <p>The domain name of a column determines the expected arity of the data
stored in that column.  Domain names ending in:

          <dl>
<dt>&lsquo;<samp><span class="samp">*</span></samp>&rsquo;<dd>have arity &lsquo;<samp><span class="samp">nary</span></samp>&rsquo;;
<br><dt>&lsquo;<samp><span class="samp">+</span></samp>&rsquo;<dd>have arity &lsquo;<samp><span class="samp">nary1</span></samp>&rsquo;. 
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:editable-row-converter</b><var> k names edit-point edit-converter<a name="index-html_003aeditable_002drow_002dconverter-376"></a></var><br>
<blockquote>
       <p>The positive integer <var>k</var> is the primary-key-limit (number of
primary-keys) of the table.  <var>names</var> is a list of the field-names.  <var>edit-point</var> is
the list of primary-keys denoting the row to edit (or #f).  <var>edit-converter</var> is the
procedure called with <var>k</var>, <var>names</var>, and the row to edit.

       <p><code>html:editable-row-converter</code> returns a procedure taking a row for its single argument.  This
returned procedure returns the html string for that table row.

       <p>Each HTML table constructed using <code>html:editable-row-converter</code> has first <var>k</var> fields (typically
the primary key fields) of each row linked to a text encoding of these
fields (the result of calling <code>row-&gt;anchor</code>).  The page so
referenced typically allows the user to edit fields of that row. 
</p></blockquote></div>

<h4 class="subsection">4.7.2 HTML databases</h4>

<div class="defun">
&mdash; Function: <b>db-&gt;html-files</b><var> db dir index-filename caption<a name="index-db_002d_003ehtml_002dfiles-377"></a></var><br>
<blockquote><p><var>db</var> must be a relational database.  <var>dir</var> must be #f or a
non-empty string naming an existing sub-directory of the current
directory.

       <p><code>db-&gt;html-files</code> creates an html page for each table in the database <var>db</var> in the
sub-directory named <var>dir</var>, or the current directory if <var>dir</var> is #f.  The
top level page with the catalog of tables (captioned <var>caption</var>) is written
to a file named <var>index-filename</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>db-&gt;html-directory</b><var> db dir index-filename<a name="index-db_002d_003ehtml_002ddirectory-378"></a></var><br>

  &mdash; Function: <b>db-&gt;html-directory</b><var> db dir<a name="index-db_002d_003ehtml_002ddirectory-379"></a></var><br>
<blockquote><p><var>db</var> must be a relational database.  <var>dir</var> must be a non-empty
string naming an existing sub-directory of the current directory or
one to be created.  The optional string <var>index-filename</var> names the filename of the
top page, which defaults to <samp><span class="file">index.html</span></samp>.

       <p><code>db-&gt;html-directory</code> creates sub-directory <var>dir</var> if neccessary, and calls
<code>(db-&gt;html-files </code><var>db</var> <var>dir</var> <var>index-filename</var> <var>dir</var><code>)</code>.  The &lsquo;<samp><span class="samp">file:</span></samp>&rsquo; URI of <var>index-filename</var> is
returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>db-&gt;netscape</b><var> db dir index-filename<a name="index-db_002d_003enetscape-380"></a></var><br>

  &mdash; Function: <b>db-&gt;netscape</b><var> db dir<a name="index-db_002d_003enetscape-381"></a></var><br>
<blockquote><p><code>db-&gt;netscape</code> is just like <code>db-&gt;html-directory</code>, but calls
<code>browse-url</code> with the uri for the top page after the
pages are created. 
</p></blockquote></div>

<div class="node">
<a name="HTTP-and-CGI"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parsing-HTML">Parsing HTML</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#HTML-Tables">HTML Tables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.8 HTTP and CGI</h3>

<p><code>(require 'http)</code> or <code>(require 'cgi)</code>
<a name="index-http-382"></a><a name="index-cgi-383"></a>

<div class="defun">
&mdash; Function: <b>http:header</b><var> alist<a name="index-http_003aheader-384"></a></var><br>
<blockquote><p>Returns a string containing lines for each element of <var>alist</var>; the
<code>car</code> of which is followed by &lsquo;<samp><span class="samp">: </span></samp>&rsquo;, then the <code>cdr</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>http:content</b><var> alist body <small class="dots">...</small><a name="index-http_003acontent-385"></a></var><br>
<blockquote><p>Returns the concatenation of strings <var>body</var> with the
<code>(http:header </code><var>alist</var><code>)</code> and the &lsquo;<samp><span class="samp">Content-Length</span></samp>&rsquo; prepended. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>*http:byline*</b><var><a name="index-g_t_002ahttp_003abyline_002a-386"></a></var><br>
<blockquote><p>String appearing at the bottom of error pages. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>http:error-page</b><var> status-code reason-phrase html-string <small class="dots">...</small><a name="index-http_003aerror_002dpage-387"></a></var><br>
<blockquote><p><var>status-code</var> and <var>reason-phrase</var> should be an integer and string as specified in
<cite>RFC 2068</cite>.  The returned page (string) will show the <var>status-code</var> and <var>reason-phrase</var>
and any additional <var>html-strings</var> <small class="dots">...</small>; with <var>*http:byline*</var> or SLIB's
default at the bottom. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>http:forwarding-page</b><var> title dly uri html-string <small class="dots">...</small><a name="index-http_003aforwarding_002dpage-388"></a></var><br>
<blockquote><p>The string or symbol <var>title</var> is the page title.  <var>dly</var> is a non-negative
integer.  The <var>html-strings</var> <small class="dots">...</small> are typically used to explain to the user why
this page is being forwarded.

       <p><code>http:forwarding-page</code> returns an HTML string for a page which automatically forwards to
<var>uri</var> after <var>dly</var> seconds.  The returned page (string) contains any <var>html-strings</var>
<small class="dots">...</small> followed by a manual link to <var>uri</var>, in case the browser does not
forward automatically. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>http:serve-query</b><var> serve-proc input-port output-port<a name="index-http_003aserve_002dquery-389"></a></var><br>
<blockquote><p>reads the <dfn>URI</dfn> and <dfn>query-string</dfn> from <var>input-port</var>.  If the
<a name="index-URI-390"></a><a name="index-query_002dstring-391"></a>query is a valid &lsquo;<samp><span class="samp">"POST"</span></samp>&rsquo; or &lsquo;<samp><span class="samp">"GET"</span></samp>&rsquo; query, then <code>http:serve-query</code> calls
<var>serve-proc</var> with three arguments, the <var>request-line</var>, <var>query-string</var>,
and <var>header-alist</var>.  Otherwise, <code>http:serve-query</code> calls <var>serve-proc</var> with the
<var>request-line</var>, #f, and <var>header-alist</var>.

       <p>If <var>serve-proc</var> returns a string, it is sent to <var>output-port</var>.  If <var>serve-proc</var> returns a list
whose first element is an integer, then an error page with the
status integer which is the first element of the list and strings
from the list.  If <var>serve-proc</var> returns a list whose first element isn't an
number, then an error page with the status code 500 and strings from
the list.  If <var>serve-proc</var> returns #f, then a &lsquo;<samp><span class="samp">Bad Request</span></samp>&rsquo; (400) page is
sent to <var>output-port</var>.

       <p>Otherwise, <code>http:serve-query</code> replies (to <var>output-port</var>) with appropriate HTML describing the
problem. 
</p></blockquote></div>

  <p>This example services HTTP queries from <var>port-number</var>:
<pre class="example">     
     (define socket (make-stream-socket AF_INET 0))
     (and (socket:bind socket port-number) ; AF_INET INADDR_ANY
          (socket:listen socket 10)        ; Queue up to 10 requests.
          (dynamic-wind
              (lambda () #f)
              (lambda ()
                (do ((port (socket:accept socket) (socket:accept socket)))
                    (#f)
                  (let ((iport (duplicate-port port "r"))
                        (oport (duplicate-port port "w")))
                    (http:serve-query build:serve iport oport)
                    (close-port iport)
                    (close-port oport))
                  (close-port port)))
              (lambda () (close-port socket))))
</pre>
  <div class="defun">
&mdash; Function: <b>cgi:serve-query</b><var> serve-proc<a name="index-cgi_003aserve_002dquery-392"></a></var><br>
<blockquote><p>reads the <dfn>URI</dfn> and <dfn>query-string</dfn> from
<a name="index-URI-393"></a><a name="index-query_002dstring-394"></a><code>(current-input-port)</code>.  If the query is a valid &lsquo;<samp><span class="samp">"POST"</span></samp>&rsquo;
or &lsquo;<samp><span class="samp">"GET"</span></samp>&rsquo; query, then <code>cgi:serve-query</code> calls <var>serve-proc</var> with three arguments, the
<var>request-line</var>, <var>query-string</var>, and <var>header-alist</var>. 
Otherwise, <code>cgi:serve-query</code> calls <var>serve-proc</var> with the <var>request-line</var>, #f, and
<var>header-alist</var>.

       <p>If <var>serve-proc</var> returns a string, it is sent to <code>(current-ouput-port)</code>. 
If <var>serve-proc</var> returns a list whose first element is an integer, then an
error page with the status integer which is the first element of the
list and strings from the list.  If <var>serve-proc</var> returns a list whose first
element isn't an number, then an error page with the status code 500
and strings from the list.  If <var>serve-proc</var> returns #f, then a &lsquo;<samp><span class="samp">Bad
Request</span></samp>&rsquo; (400) page is sent to <code>(current-ouput-port)</code>.

       <p>Otherwise, <code>cgi:serve-query</code> replies (to <code>(current-output-port)</code>) with
appropriate HTML describing the problem. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-query-alist-command-server</b><var> rdb command-table<a name="index-make_002dquery_002dalist_002dcommand_002dserver-395"></a></var><br>

  &mdash; Function: <b>make-query-alist-command-server</b><var> rdb command-table #t<a name="index-make_002dquery_002dalist_002dcommand_002dserver-396"></a></var><br>
<blockquote>
       <p>Returns a procedure of one argument.  When that procedure is called
with a <var>query-alist</var> (as returned by <code>uri:decode-query</code>, the
value of the &lsquo;<samp><span class="samp">*command*</span></samp>&rsquo; association will be the command invoked
in <var>command-table</var>.  If &lsquo;<samp><span class="samp">*command*</span></samp>&rsquo; is not in the <var>query-alist</var> then the
value of &lsquo;<samp><span class="samp">*suggest*</span></samp>&rsquo; is tried.  If neither name is in the
<var>query-alist</var>, then the literal value &lsquo;<samp><span class="samp">*default*</span></samp>&rsquo; is tried in
<var>command-table</var>.

       <p>If optional third argument is non-false, then the command is called
with just the parameter-list; otherwise, command is called with the
arguments described in its table. 
</p></blockquote></div>

<div class="node">
<a name="Parsing-HTML"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#URI">URI</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#HTTP-and-CGI">HTTP and CGI</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.9 Parsing HTML</h3>

<p><code>(require 'html-for-each)</code>
<a name="index-html_002dfor_002deach-397"></a>

<div class="defun">
&mdash; Function: <b>html-for-each</b><var> file word-proc markup-proc white-proc newline-proc<a name="index-html_002dfor_002deach-398"></a></var><br>
<blockquote>
       <p><var>file</var> is an input port or a string naming an existing file containing
HTML text. 
<var>word-proc</var> is a procedure of one argument or #f. 
<var>markup-proc</var> is a procedure of one argument or #f. 
<var>white-proc</var> is a procedure of one argument or #f. 
<var>newline-proc</var> is a procedure of no arguments or #f.

       <p><code>html-for-each</code> opens and reads characters from port <var>file</var> or the file named by
string <var>file</var>.  Sequential groups of characters are assembled into
strings which are either

          <ul>
<li>enclosed by &lsquo;<samp><span class="samp">&lt;</span></samp>&rsquo; and &lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo; (hypertext markups or comments);
<li>end-of-line;
<li>whitespace; or
<li>none of the above (words). 
</ul>

       <p>Procedures are called according to these distinctions in order of
the string's occurrence in <var>file</var>.

       <p><var>newline-proc</var> is called with no arguments for end-of-line <em>not within a
markup or comment</em>.

       <p><var>white-proc</var> is called with strings of non-newline whitespace.

       <p><var>markup-proc</var> is called with hypertext markup strings (including &lsquo;<samp><span class="samp">&lt;</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo;).

       <p><var>word-proc</var> is called with the remaining strings.

       <p><code>html-for-each</code> returns an unspecified value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:read-title</b><var> file limit<a name="index-html_003aread_002dtitle-399"></a></var><br>

  &mdash; Function: <b>html:read-title</b><var> file<a name="index-html_003aread_002dtitle-400"></a></var><br>
<blockquote><p><var>file</var> is an input port or a string naming an existing file containing
HTML text.  If supplied, <var>limit</var> must be an integer.  <var>limit</var> defaults to
1000.

       <p><code>html:read-title</code> opens and reads HTML from port <var>file</var> or the file named by string <var>file</var>,
until reaching the (mandatory) &lsquo;<samp><span class="samp">TITLE</span></samp>&rsquo; field.  <code>html:read-title</code> returns the
title string with adjacent whitespaces collapsed to one space.  <code>html:read-title</code>
returns #f if the title field is empty, absent, if the first
character read from <var>file</var> is not &lsquo;<samp><span class="samp">#\&lt;</span></samp>&rsquo;, or if the end of title is
not found within the first (approximately) <var>limit</var> words. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>htm-fields</b><var> htm<a name="index-htm_002dfields-401"></a></var><br>
<blockquote>
       <p><var>htm</var> is a hypertext markup string.

       <p>If <var>htm</var> is a (hypertext) comment or DTD, then <code>htm-fields</code> returns #f. 
Otherwise <code>htm-fields</code> returns the hypertext element string consed onto an
association list of the attribute name-symbols and values.  If the
tag ends with "/&gt;", then "/" is appended to the hypertext element
string.  The name-symbols are created by <code>string-ci-&gt;symbol</code>. 
Each value is a string; or #t if the name had no value
assigned within the markup. 
</p></blockquote></div>

<div class="node">
<a name="URI"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parsing-XML">Parsing XML</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parsing-HTML">Parsing HTML</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.10 URI</h3>

<p><code>(require 'uri)</code>
<a name="index-uri-402"></a>
Implements <dfn>Uniform Resource Identifiers</dfn> (URI) as
<a name="index-Uniform-Resource-Identifiers-403"></a>described in RFC 2396.

<div class="defun">
&mdash; Function: <b>make-uri</b><var><a name="index-make_002duri-404"></a></var><br>

  &mdash; Function: <b>make-uri</b><var> fragment<a name="index-make_002duri-405"></a></var><br>

  &mdash; Function: <b>make-uri</b><var> query fragment<a name="index-make_002duri-406"></a></var><br>

  &mdash; Function: <b>make-uri</b><var> path query fragment<a name="index-make_002duri-407"></a></var><br>

  &mdash; Function: <b>make-uri</b><var> authority path query fragment<a name="index-make_002duri-408"></a></var><br>

  &mdash; Function: <b>make-uri</b><var> scheme authority path query fragment<a name="index-make_002duri-409"></a></var><br>
<blockquote>
       <p>Returns a Uniform Resource Identifier string from component arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>uri:make-path</b><var> path<a name="index-uri_003amake_002dpath-410"></a></var><br>
<blockquote>
       <p>Returns a URI string combining the components of list <var>path</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:anchor</b><var> name<a name="index-html_003aanchor-411"></a></var><br>
<blockquote><p>Returns a string which defines this location in the (HTML) file
as <var>name</var>.  The hypertext &lsquo;<samp><span class="samp">&lt;A HREF="#</span><var>name</var><span class="samp">"&gt;</span></samp>&rsquo; will link to this point.

     <pre class="example">          (html:anchor "(section 7)")
          &rArr;
          "&lt;A NAME=\"(section%207)\"&gt;&lt;/A&gt;"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>html:link</b><var> uri highlighted<a name="index-html_003alink-412"></a></var><br>
<blockquote><p>Returns a string which links the <var>highlighted</var> text to <var>uri</var>.

     <pre class="example">          (html:link (make-uri "(section 7)") "section 7")
          &rArr;
          "&lt;A HREF=\"#(section%207)\"&gt;section 7&lt;/A&gt;"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>html:base</b><var> uri<a name="index-html_003abase-413"></a></var><br>
<blockquote><p>Returns a string specifying the <dfn>base</dfn> <var>uri</var> of a document, for
<a name="index-base-414"></a>inclusion in the HEAD of the document (see <a href="#HTML">head</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>html:isindex</b><var> prompt<a name="index-html_003aisindex-415"></a></var><br>
<blockquote><p>Returns a string specifying the search <var>prompt</var> of a document, for
inclusion in the HEAD of the document (see <a href="#HTML">head</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>uri-&gt;tree</b><var> uri-reference base-tree<a name="index-uri_002d_003etree-416"></a></var><br>

  &mdash; Function: <b>uri-&gt;tree</b><var> uri-reference<a name="index-uri_002d_003etree-417"></a></var><br>
<blockquote>
       <p>Returns a list of 5 elements corresponding to the parts
(<var>scheme</var> <var>authority</var> <var>path</var> <var>query</var> <var>fragment</var>)
of string <var>uri-reference</var>.  Elements corresponding to absent parts are #f.

       <p>The <var>path</var> is a list of strings.  If the first string is empty,
then the path is absolute; otherwise relative.  The optional <var>base-tree</var> is a
tree as returned by <code>uri-&gt;tree</code>; and is used as the base address for relative
URIs.

       <p>If the <var>authority</var> component is a
<dfn>Server-based Naming Authority</dfn>, then it is a list of the
<a name="index-Server_002dbased-Naming-Authority-418"></a><var>userinfo</var>, <var>host</var>, and <var>port</var> strings (or #f).  For other
types of <var>authority</var> components the <var>authority</var> will be a
string.

     <pre class="example">          (uri-&gt;tree "http://www.ics.uci.edu/pub/ietf/uri/#Related")
          &rArr;
          (http "www.ics.uci.edu" ("" "pub" "ietf" "uri" "") #f "Related")
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>uri:split-fields</b><var> txt chr<a name="index-uri_003asplit_002dfields-419"></a></var><br>
<blockquote>
       <p>Returns a list of <var>txt</var> split at each occurrence of <var>chr</var>.  <var>chr</var> does not
appear in the returned list of strings. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>uri:decode-query</b><var> query-string<a name="index-uri_003adecode_002dquery-420"></a></var><br>
<blockquote><p>Converts a <dfn>URI</dfn> encoded <var>query-string</var> to a query-alist. 
<a name="index-URI-421"></a></p></blockquote></div>

<p class="noindent"><code>uric:</code> prefixes indicate procedures dealing with
URI-components.

<div class="defun">
&mdash; Function: <b>uric:encode</b><var> uri-component allows<a name="index-uric_003aencode-422"></a></var><br>
<blockquote><p>Returns a copy of the string <var>uri-component</var> in which all <dfn>unsafe</dfn> octets
<a name="index-unsafe-423"></a>(as defined in RFC 2396) have been &lsquo;<samp><span class="samp">%</span></samp>&rsquo; <dfn>escaped</dfn>. 
<a name="index-escaped-424"></a><code>uric:decode</code> decodes strings encoded by <code>uric:encode</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>uric:decode</b><var> uri-component<a name="index-uric_003adecode-425"></a></var><br>
<blockquote><p>Returns a copy of the string <var>uri-component</var> in which each &lsquo;<samp><span class="samp">%</span></samp>&rsquo; escaped
characters in <var>uri-component</var> is replaced with the character it encodes.  This
routine is useful for showing URI contents on error pages. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>uri:path-&gt;keys</b><var> path-list ptypes<a name="index-uri_003apath_002d_003ekeys-426"></a></var><br>
<blockquote><p><var>path-list</var> is a path-list as returned by <code>uri:split-fields</code>.  <code>uri:path-&gt;keys</code>
returns a list of items returned by <code>uri:decode-path</code>, coerced
to types <var>ptypes</var>. 
</p></blockquote></div>

<h4 class="subheading">File-system Locators and Predicates</h4>

<div class="defun">
&mdash; Function: <b>path-&gt;uri</b><var> path<a name="index-path_002d_003euri-427"></a></var><br>
<blockquote><p>Returns a URI-string for <var>path</var> on the local host. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>absolute-uri?</b><var> str<a name="index-absolute_002duri_003f-428"></a></var><br>
<blockquote><p>Returns #t if <var>str</var> is an absolute-URI as indicated by a
syntactically valid (per RFC 2396) <dfn>scheme</dfn>; otherwise returns
<a name="index-scheme-429"></a>#f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>absolute-path?</b><var> file-name<a name="index-absolute_002dpath_003f-430"></a></var><br>
<blockquote><p>Returns #t if <var>file-name</var> is a fully specified pathname (does not
depend on the current working directory); otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>null-directory?</b><var> str<a name="index-null_002ddirectory_003f-431"></a></var><br>
<blockquote><p>Returns #t if changing directory to <var>str</var> would leave the current
directory unchanged; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>glob-pattern?</b><var> str<a name="index-glob_002dpattern_003f-432"></a></var><br>
<blockquote><p>Returns #t if the string <var>str</var> contains characters used for
specifying glob patterns, namely &lsquo;<samp><span class="samp">*</span></samp>&rsquo;, &lsquo;<samp><span class="samp">?</span></samp>&rsquo;, or &lsquo;<samp><span class="samp">[</span></samp>&rsquo;. 
</p></blockquote></div>

<p class="noindent">Before RFC 2396, the <dfn>File Transfer Protocol</dfn> (FTP) served a
<a name="index-File-Transfer-Protocol-433"></a>similar purpose.

<div class="defun">
&mdash; Function: <b>parse-ftp-address</b><var> uri<a name="index-parse_002dftp_002daddress-434"></a></var><br>
<blockquote>
       <p>Returns a list of the decoded FTP <var>uri</var>; or #f if indecipherable.  FTP
<dfn>Uniform Resource Locator</dfn>, <dfn>ange-ftp</dfn>, and <dfn>getit</dfn>
<a name="index-Uniform-Resource-Locator-435"></a><a name="index-ange_002dftp-436"></a><a name="index-getit-437"></a>formats are handled.  The returned list has four elements which are
strings or #f:

          <ol type=1 start=0>
<li>username
<li>password
<li>remote-site
<li>remote-directory
            </ol>
</p></blockquote></div>

<div class="node">
<a name="Parsing-XML"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Printing-Scheme">Printing Scheme</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#URI">URI</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.11 Parsing XML</h3>

<p><code>(require 'xml-parse)</code> or <code>(require 'ssax)</code>

<p class="noindent">The XML standard document referred to in this module is<br>
<a href="http://www.w3.org/TR/1998/REC-xml-19980210.html">http://www.w3.org/TR/1998/REC-xml-19980210.html</a>.

<p class="noindent">The present frameworks fully supports the XML Namespaces
Recommendation<br>
<a href="http://www.w3.org/TR/REC-xml-names">http://www.w3.org/TR/REC-xml-names</a>.

<h4 class="subsection">4.11.1 String Glue</h4>

<div class="defun">
&mdash; Function: <b>ssax:reverse-collect-str</b><var> list-of-frags<a name="index-ssax_003areverse_002dcollect_002dstr-438"></a></var><br>
<blockquote>
       <p>Given the list of fragments (some of which are text strings),
reverse the list and concatenate adjacent text strings.  If
LIST-OF-FRAGS has zero or one element, the result of the procedure
is <code>equal?</code> to its argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:reverse-collect-str-drop-ws</b><var> list-of-frags<a name="index-ssax_003areverse_002dcollect_002dstr_002ddrop_002dws-439"></a></var><br>
<blockquote>
       <p>Given the list of fragments (some of which are text strings),
reverse the list and concatenate adjacent text strings while
dropping "unsignificant" whitespace, that is, whitespace in front,
behind and between elements.  The whitespace that is included in
character data is not affected.

       <p>Use this procedure to "intelligently" drop "insignificant"
whitespace in the parsed SXML.  If the strict compliance with the
XML Recommendation regarding the whitespace is desired, use the
<code>ssax:reverse-collect-str</code> procedure instead. 
</p></blockquote></div>

<h4 class="subsection">4.11.2 Character and Token Functions</h4>

<p>The following functions either skip, or build and return tokens,
according to inclusion or delimiting semantics.  The list of
characters to expect, include, or to break at may vary from one
invocation of a function to another.  This allows the functions to
easily parse even context-sensitive languages.

  <p>Exceptions are mentioned specifically.  The list of expected
characters (characters to skip until, or break-characters) may
include an EOF "character", which is coded as symbol *eof*

  <p>The input stream to parse is specified as a PORT, which is the last
argument.

<div class="defun">
&mdash; Function: <b>ssax:assert-current-char</b><var> char-list string port<a name="index-ssax_003aassert_002dcurrent_002dchar-440"></a></var><br>
<blockquote>
       <p>Reads a character from the <var>port</var> and looks it up in the
<var>char-list</var> of expected characters.  If the read character was
found among expected, it is returned.  Otherwise, the
procedure writes a message using <var>string</var> as a comment
and quits. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:skip-while</b><var> char-list port<a name="index-ssax_003askip_002dwhile-441"></a></var><br>
<blockquote>
       <p>Reads characters from the <var>port</var> and disregards them, as long as they
are mentioned in the <var>char-list</var>.  The first character (which may be EOF)
peeked from the stream that is <em>not</em> a member of the <var>char-list</var> is
returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:init-buffer</b><var><a name="index-ssax_003ainit_002dbuffer-442"></a></var><br>
<blockquote>
       <p>Returns an initial buffer for <code>ssax:next-token*</code> procedures. 
<code>ssax:init-buffer</code> may allocate a new buffer at each invocation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:next-token</b><var> prefix-char-list break-char-list comment-string port<a name="index-ssax_003anext_002dtoken-443"></a></var><br>
<blockquote>
       <p>Skips any number of the prefix characters (members of the <var>prefix-char-list</var>), if
any, and reads the sequence of characters up to (but not including)
a break character, one of the <var>break-char-list</var>.

       <p>The string of characters thus read is returned.  The break character
is left on the input stream.  <var>break-char-list</var> may include the symbol <code>*eof*</code>;
otherwise, EOF is fatal, generating an error message including a
specified <var>comment-string</var>. 
</p></blockquote></div>

<p class="noindent"><code>ssax:next-token-of</code> is similar to <code>ssax:next-token</code>
except that it implements an inclusion rather than delimiting
semantics.

<div class="defun">
&mdash; Function: <b>ssax:next-token-of</b><var> inc-charset port<a name="index-ssax_003anext_002dtoken_002dof-444"></a></var><br>
<blockquote>
       <p>Reads characters from the <var>port</var> that belong to the list of characters
<var>inc-charset</var>.  The reading stops at the first character which is not a member
of the set.  This character is left on the stream.  All the read
characters are returned in a string.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:next-token-of</b><var> pred port<a name="index-ssax_003anext_002dtoken_002dof-445"></a></var><br>
<blockquote>
       <p>Reads characters from the <var>port</var> for which <var>pred</var> (a procedure of
one argument) returns non-#f.  The reading stops at the first
character for which <var>pred</var> returns #f.  That character is left
on the stream.  All the results of evaluating of <var>pred</var> up to #f
are returned in a string.

       <p><var>pred</var> is a procedure that takes one argument (a character or
the EOF object) and returns a character or #f.  The returned
character does not have to be the same as the input argument to the
<var>pred</var>.  For example,

     <pre class="example">          (ssax:next-token-of (lambda (c)
                                (cond ((eof-object? c) #f)
                                      ((char-alphabetic? c) (char-downcase c))
                                      (else #f)))
                              (current-input-port))
</pre>
       <p>will try to read an alphabetic token from the current input port,
and return it in lower case. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-string</b><var> len port<a name="index-ssax_003aread_002dstring-446"></a></var><br>
<blockquote>
       <p>Reads <var>len</var> characters from the <var>port</var>, and returns them in a string.  If
EOF is encountered before <var>len</var> characters are read, a shorter string
will be returned. 
</p></blockquote></div>

<h4 class="subsection">4.11.3 Data Types</h4>

     <dl>
<dt><code>TAG-KIND</code><dd>
A symbol &lsquo;<samp><span class="samp">START</span></samp>&rsquo;, &lsquo;<samp><span class="samp">END</span></samp>&rsquo;, &lsquo;<samp><span class="samp">PI</span></samp>&rsquo;, &lsquo;<samp><span class="samp">DECL</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">COMMENT</span></samp>&rsquo;, &lsquo;<samp><span class="samp">CDSECT</span></samp>&rsquo;, or &lsquo;<samp><span class="samp">ENTITY-REF</span></samp>&rsquo; that identifies
a markup token

     <br><dt><code>UNRES-NAME</code><dd>
a name (called GI in the XML Recommendation) as given in an XML
document for a markup token: start-tag, PI target, attribute name. 
If a GI is an NCName, UNRES-NAME is this NCName converted into a
Scheme symbol.  If a GI is a QName, &lsquo;<samp><span class="samp">UNRES-NAME</span></samp>&rsquo; is a pair of
symbols: <code>(</code><var>PREFIX</var><code> . </code><var>LOCALPART</var><code>)</code>.

     <br><dt><code>RES-NAME</code><dd>
An expanded name, a resolved version of an &lsquo;<samp><span class="samp">UNRES-NAME</span></samp>&rsquo;.  For
an element or an attribute name with a non-empty namespace URI,
&lsquo;<samp><span class="samp">RES-NAME</span></samp>&rsquo; is a pair of symbols,
<code>(</code><var>URI-SYMB</var><code> . </code><var>LOCALPART</var><code>)</code>. 
Otherwise, it's a single symbol.

     <br><dt><code>ELEM-CONTENT-MODEL</code><dd>
A symbol:
          <dl>
<dt>&lsquo;<samp><span class="samp">ANY</span></samp>&rsquo;<dd>anything goes, expect an END tag. 
<br><dt>&lsquo;<samp><span class="samp">EMPTY-TAG</span></samp>&rsquo;<dd>no content, and no END-tag is coming
<br><dt>&lsquo;<samp><span class="samp">EMPTY</span></samp>&rsquo;<dd>no content, expect the END-tag as the next token
<br><dt>&lsquo;<samp><span class="samp">PCDATA</span></samp>&rsquo;<dd>expect character data only, and no children elements
<br><dt>&lsquo;<samp><span class="samp">MIXED</span></samp>&rsquo;<br><dt>&lsquo;<samp><span class="samp">ELEM-CONTENT</span></samp>&rsquo;<dd></dl>

     <br><dt><code>URI-SYMB</code><dd>
A symbol representing a namespace URI &ndash; or other symbol chosen by
the user to represent URI.  In the former case, <code>URI-SYMB</code> is
created by %-quoting of bad URI characters and converting the
resulting string into a symbol.

     <br><dt><code>NAMESPACES</code><dd>
A list representing namespaces in effect.  An element of the list
has one of the following forms:

          <dl>
<dt><code>(</code><var>prefix</var> <var>uri-symb</var><code> . </code><var>uri-symb</var><code>) or</code>
<br><dt><code>(</code><var>prefix</var> <var>user-prefix</var><code> . </code><var>uri-symb</var><code>)</code><dd><var>user-prefix</var> is a symbol chosen by the user to represent the URI.

          <br><dt><code>(#f </code><var>user-prefix</var><code> . </code><var>uri-symb</var><code>)</code><dd>Specification of the user-chosen prefix and a URI-SYMBOL.

          <br><dt><code>(*DEFAULT* </code><var>user-prefix</var><code> . </code><var>uri-symb</var><code>)</code><dd>Declaration of the default namespace

          <br><dt><code>(*DEFAULT* #f . #f)</code><dd>Un-declaration of the default namespace.  This notation
represents overriding of the previous declaration

     </dl>

     <p>A NAMESPACES list may contain several elements for the same <var>prefix</var>. 
The one closest to the beginning of the list takes effect.

     <br><dt><code>ATTLIST</code><dd>
An ordered collection of (<var>NAME</var> . <var>VALUE</var>) pairs, where
<var>NAME</var> is a RES-NAME or an UNRES-NAME.  The collection is an ADT.

     <br><dt><code>STR-HANDLER</code><dd>
A procedure of three arguments: <var>string1</var> <var>string2</var>
<var>seed</var> returning a new <var>seed</var>.  The procedure is supposed to
handle a chunk of character data <var>string1</var> followed by a chunk
of character data <var>string2</var>.  <var>string2</var> is a short string,
often &lsquo;<samp><span class="samp">"\n"</span></samp>&rsquo; and even &lsquo;<samp><span class="samp">""</span></samp>&rsquo;.

     <br><dt><code>ENTITIES</code><dd>An assoc list of pairs:
     <pre class="lisp">             (<var>named-entity-name</var> . <var>named-entity-body</var>)
</pre>
     <p>where <var>named-entity-name</var> is a symbol under which the entity was
declared, <var>named-entity-body</var> is either a string, or (for an
external entity) a thunk that will return an input port (from which
the entity can be read).  <var>named-entity-body</var> may also be #f. 
This is an indication that a <var>named-entity-name</var> is currently
being expanded.  A reference to this <var>named-entity-name</var> will be
an error: violation of the WFC nonrecursion.

     <br><dt><code>XML-TOKEN</code><dd>
This record represents a markup, which is, according to the XML
Recommendation, "takes the form of start-tags, end-tags,
empty-element tags, entity references, character references,
comments, CDATA section delimiters, document type declarations, and
processing instructions."

          <dl>
<dt>kind<dd>a TAG-KIND
<br><dt>head<dd>an UNRES-NAME.  For XML-TOKENs of kinds 'COMMENT and 'CDSECT, the
head is #f. 
</dl>

     <p>For example,
     <pre class="example">          &lt;P&gt;                   =&gt; kind=START,      head=P
          &lt;/P&gt;                  =&gt; kind=END,        head=P
          &lt;BR/&gt;                 =&gt; kind=EMPTY-EL,   head=BR
          &lt;!DOCTYPE OMF ...&gt;    =&gt; kind=DECL,       head=DOCTYPE
          &lt;?xml version="1.0"?&gt; =&gt; kind=PI,         head=xml
          &amp;my-ent;              =&gt; kind=ENTITY-REF, head=my-ent
</pre>
     <p>Character references are not represented by xml-tokens as these
references are transparently resolved into the corresponding
characters.

     <br><dt><code>XML-DECL</code><dd>
The record represents a datatype of an XML document: the list of
declared elements and their attributes, declared notations, list of
replacement strings or loading procedures for parsed general
entities, etc.  Normally an XML-DECL record is created from a DTD or
an XML Schema, although it can be created and filled in in many
other ways (e.g., loaded from a file).

          <dl>
<dt><var>elems</var><dd>an (assoc) list of decl-elem or #f.  The latter instructs
the parser to do no validation of elements and attributes.

          <br><dt><var>decl-elem</var><dd>declaration of one element:

          <p><code>(</code><var>elem-name</var> <var>elem-content</var> <var>decl-attrs</var><code>)</code>

          <p><var>elem-name</var> is an UNRES-NAME for the element.

          <p><var>elem-content</var> is an ELEM-CONTENT-MODEL.

          <p><var>decl-attrs</var> is an <code>ATTLIST</code>, of
<code>(</code><var>attr-name</var><code> . </code><var>value</var><code>)</code> associations.

          <p>This element can declare a user procedure to handle parsing of an
element (e.g., to do a custom validation, or to build a hash of IDs
as they're encountered).

          <br><dt><var>decl-attr</var><dd>an element of an <code>ATTLIST</code>, declaration of one attribute:

          <p><code>(</code><var>attr-name</var> <var>content-type</var> <var>use-type</var> <var>default-value</var><code>)</code>

          <p><var>attr-name</var> is an UNRES-NAME for the declared attribute.

          <p><var>content-type</var> is a symbol: <code>CDATA</code>, <code>NMTOKEN</code>,
<code>NMTOKENS</code>, <small class="dots">...</small> or a list of strings for the enumerated
type.

          <p><var>use-type</var> is a symbol: <code>REQUIRED</code>, <code>IMPLIED</code>, or
<code>FIXED</code>.

          <p><var>default-value</var> is a string for the default value, or #f if not
given.

     </dl>

</dl>

<h4 class="subsection">4.11.4 Low-Level Parsers and Scanners</h4>

<p class="noindent">These procedures deal with primitive lexical units (Names,
whitespaces, tags) and with pieces of more generic productions. 
Most of these parsers must be called in appropriate context.  For
example, <code>ssax:complete-start-tag</code> must be called only when the
start-tag has been detected and its GI has been read.

<div class="defun">
&mdash; Function: <b>ssax:skip-s</b><var> port<a name="index-ssax_003askip_002ds-447"></a></var><br>
<blockquote>
       <p>Skip the S (whitespace) production as defined by
     <pre class="example">          [3] S ::= (#x20 | #x09 | #x0D | #x0A)
</pre>
       <p><code>ssax:skip-s</code> returns the first not-whitespace character it encounters while
scanning the <var>port</var>.  This character is left on the input stream. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-ncname</b><var> port<a name="index-ssax_003aread_002dncname-448"></a></var><br>
<blockquote>
       <p>Read a NCName starting from the current position in the <var>port</var> and
return it as a symbol.

     <pre class="example">          [4] NameChar ::= Letter | Digit | '.' | '-' | '_' | ':'
                           | CombiningChar | Extender
          [5] Name ::= (Letter | '_' | ':') (NameChar)*
</pre>
       <p>This code supports the XML Namespace Recommendation REC-xml-names,
which modifies the above productions as follows:

     <pre class="example">          [4] NCNameChar ::= Letter | Digit | '.' | '-' | '_'
                                | CombiningChar | Extender
          [5] NCName ::= (Letter | '_') (NCNameChar)*
</pre>
       <p>As the Rec-xml-names says,

       <blockquote>
"An XML document conforms to this specification if all other tokens
[other than element types and attribute names] in the document which
are required, for XML conformance, to match the XML production for
Name, match this specification's production for NCName." 
</blockquote>

       <p>Element types and attribute names must match the production QName,
defined below. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-qname</b><var> port<a name="index-ssax_003aread_002dqname-449"></a></var><br>
<blockquote>
       <p>Read a (namespace-) Qualified Name, QName, from the current position
in <var>port</var>; and return an UNRES-NAME.

       <p>From REC-xml-names:
     <pre class="example">          [6] QName ::= (Prefix ':')? LocalPart
          [7] Prefix ::= NCName
          [8] LocalPart ::= NCName
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-markup-token</b><var> port<a name="index-ssax_003aread_002dmarkup_002dtoken-450"></a></var><br>
<blockquote>
       <p>This procedure starts parsing of a markup token.  The current
position in the stream must be &lsquo;<samp><span class="samp">&lt;</span></samp>&rsquo;.  This procedure scans
enough of the input stream to figure out what kind of a markup token
it is seeing.  The procedure returns an XML-TOKEN structure
describing the token.  Note, generally reading of the current markup
is not finished!  In particular, no attributes of the start-tag
token are scanned.

       <p>Here's a detailed break out of the return values and the position in
the PORT when that particular value is returned:

          <dl>
<dt>PI-token<dd>
only PI-target is read.  To finish the Processing-Instruction and
disregard it, call <code>ssax:skip-pi</code>.  <code>ssax:read-attributes</code>
may be useful as well (for PIs whose content is attribute-value
pairs).

          <br><dt>END-token<dd>
The end tag is read completely; the current position is right after
the terminating &lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo; character.

          <br><dt>COMMENT<dd>
is read and skipped completely.  The current position is right after
&lsquo;<samp><span class="samp">--&gt;</span></samp>&rsquo; that terminates the comment.

          <br><dt>CDSECT<dd>
The current position is right after &lsquo;<samp><span class="samp">&lt;!CDATA[</span></samp>&rsquo;.  Use
<code>ssax:read-cdata-body</code> to read the rest.

          <br><dt>DECL<dd>
We have read the keyword (the one that follows &lsquo;<samp><span class="samp">&lt;!</span></samp>&rsquo;)
identifying this declaration markup.  The current position is after
the keyword (usually a whitespace character)

          <br><dt>START-token<dd>
We have read the keyword (GI) of this start tag.  No attributes are
scanned yet.  We don't know if this tag has an empty content either. 
Use <code>ssax:complete-start-tag</code> to finish parsing of the token.

       </dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:skip-pi</b><var> port<a name="index-ssax_003askip_002dpi-451"></a></var><br>
<blockquote>
       <p>The current position is inside a PI.  Skip till the rest of the PI
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-pi-body-as-string</b><var> port<a name="index-ssax_003aread_002dpi_002dbody_002das_002dstring-452"></a></var><br>
<blockquote>
       <p>The current position is right after reading the PITarget.  We read
the body of PI and return is as a string.  The port will point to
the character right after &lsquo;<samp><span class="samp">?&gt;</span></samp>&rsquo; combination that terminates PI.

     <pre class="example">          [16] PI ::= '&lt;?' PITarget (S (Char* - (Char* '?&gt;' Char*)))? '?&gt;'
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:skip-internal-dtd</b><var> port<a name="index-ssax_003askip_002dinternal_002ddtd-453"></a></var><br>
<blockquote>
       <p>The current pos in the port is inside an internal DTD subset (e.g.,
after reading &lsquo;<samp><span class="samp">#\[</span></samp>&rsquo; that begins an internal DTD subset) Skip
until the &lsquo;<samp><span class="samp">]&gt;</span></samp>&rsquo; combination that terminates this DTD. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-cdata-body</b><var> port str-handler seed<a name="index-ssax_003aread_002dcdata_002dbody-454"></a></var><br>
<blockquote>
       <p>This procedure must be called after we have read a string
&lsquo;<samp><span class="samp">&lt;![CDATA[</span></samp>&rsquo; that begins a CDATA section.  The current position
must be the first position of the CDATA body.  This function reads
<em>lines</em> of the CDATA body and passes them to a <var>str-handler</var>, a character
data consumer.

       <p><var>str-handler</var> is a procedure taking arguments: <var>string1</var>, <var>string2</var>,
and <var>seed</var>.  The first <var>string1</var> argument to <var>str-handler</var> never
contains a newline; the second <var>string2</var> argument often will. 
On the first invocation of <var>str-handler</var>, <var>seed</var> is the one passed to <code>ssax:read-cdata-body</code> as the
third argument.  The result of this first invocation will be passed
as the <var>seed</var> argument to the second invocation of the line
consumer, and so on.  The result of the last invocation of the <var>str-handler</var> is
returned by the <code>ssax:read-cdata-body</code>.  Note a similarity to the fundamental <dfn>fold</dfn>
<a name="index-fold-455"></a>iterator.

       <p>Within a CDATA section all characters are taken at their face value,
with three exceptions:
          <ul>
<li>CR, LF, and CRLF are treated as line delimiters, and passed
as a single &lsquo;<samp><span class="samp">#\newline</span></samp>&rsquo; to <var>str-handler</var>

          <li>&lsquo;<samp><span class="samp">]]&gt;</span></samp>&rsquo; combination is the end of the CDATA section. 
&lsquo;<samp><span class="samp">&amp;gt;</span></samp>&rsquo; is treated as an embedded &lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo; character.

          <li>&lsquo;<samp><span class="samp">&amp;lt;</span></samp>&rsquo; and &lsquo;<samp><span class="samp">&amp;amp;</span></samp>&rsquo; are not specially recognized (and are
not expanded)!

       </ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-char-ref</b><var> port<a name="index-ssax_003aread_002dchar_002dref-456"></a></var><br>
<blockquote>
     <pre class="example">          [66]  CharRef ::=  '&amp;#' [0-9]+ ';'
                           | '&amp;#x' [0-9a-fA-F]+ ';'
</pre>
       <p>This procedure must be called after we we have read &lsquo;<samp><span class="samp">&amp;#</span></samp>&rsquo; that
introduces a char reference.  The procedure reads this reference and
returns the corresponding char.  The current position in PORT will
be after the &lsquo;<samp><span class="samp">;</span></samp>&rsquo; that terminates the char reference.

       <p>Faults detected:<br>
WFC: XML-Spec.html#wf-Legalchar

       <p>According to Section <cite>4.1 Character and Entity References</cite>
of the XML Recommendation:

       <blockquote>
"[Definition: A character reference refers to a specific character
in the ISO/IEC 10646 character set, for example one not directly
accessible from available input devices.]" 
</blockquote>

     <!-- Therefore, we use a @code{ucscode->char} function to convert a -->
     <!-- character code into the character - *regardless* of the current -->
     <!-- character encoding of the input stream. -->
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:handle-parsed-entity</b><var> port name entities content-handler str-handler seed<a name="index-ssax_003ahandle_002dparsed_002dentity-457"></a></var><br>
<blockquote>
       <p>Expands and handles a parsed-entity reference.

       <p><var>name</var> is a symbol, the name of the parsed entity to expand. 
<!-- entities - see ENTITIES -->
<var>content-handler</var> is a procedure of arguments <var>port</var>, <var>entities</var>, and
<var>seed</var> that returns a seed. 
<var>str-handler</var> is called if the entity in question is a pre-declared entity.

       <p><code>ssax:handle-parsed-entity</code> returns the result returned by <var>content-handler</var> or <var>str-handler</var>.

       <p>Faults detected:<br>
WFC: XML-Spec.html#wf-entdeclared<br>
WFC: XML-Spec.html#norecursion
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>attlist-add</b><var> attlist name-value<a name="index-attlist_002dadd-458"></a></var><br>
<blockquote>
       <p>Add a <var>name-value</var> pair to the existing <var>attlist</var>, preserving its sorted ascending
order; and return the new list.  Return #f if a pair with the same
name already exists in <var>attlist</var>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>attlist-remove-top</b><var> attlist<a name="index-attlist_002dremove_002dtop-459"></a></var><br>
<blockquote>
       <p>Given an non-null <var>attlist</var>, return a pair of values: the top and the rest. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-attributes</b><var> port entities<a name="index-ssax_003aread_002dattributes-460"></a></var><br>
<blockquote>
       <p>This procedure reads and parses a production <dfn>Attribute</dfn>. 
<a name="index-Attribute-461"></a>
     <pre class="example">          [41] Attribute ::= Name Eq AttValue
          [10] AttValue ::=  '"' ([^&lt;&amp;"] | Reference)* '"'
                          | "'" ([^&lt;&amp;'] | Reference)* "'"
          [25] Eq ::= S? '=' S?
</pre>
       <p>The procedure returns an ATTLIST, of Name (as UNRES-NAME), Value (as
string) pairs.  The current character on the <var>port</var> is a non-whitespace
character that is not an NCName-starting character.

       <p>Note the following rules to keep in mind when reading an
<dfn>AttValue</dfn>:
<a name="index-AttValue-462"></a><blockquote>
Before the value of an attribute is passed to the application or
checked for validity, the XML processor must normalize it as
follows:

          <ul>
<li>A character reference is processed by appending the referenced
character to the attribute value.

          <li>An entity reference is processed by recursively processing the
replacement text of the entity.  The named entities &lsquo;<samp><span class="samp">amp</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">lt</span></samp>&rsquo;, &lsquo;<samp><span class="samp">gt</span></samp>&rsquo;, &lsquo;<samp><span class="samp">quot</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">apos</span></samp>&rsquo; are pre-declared.

          <li>A whitespace character (#x20, #x0D, #x0A, #x09) is processed by
appending #x20 to the normalized value, except that only a single
#x20 is appended for a "#x0D#x0A" sequence that is part of an
external parsed entity or the literal entity value of an internal
parsed entity.

          <li>Other characters are processed by appending them to the normalized
value.

       </ul>

       </blockquote>

       <p>Faults detected:<br>
WFC: XML-Spec.html#CleanAttrVals<br>
WFC: XML-Spec.html#uniqattspec
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:resolve-name</b><var> port unres-name namespaces apply-default-ns?<a name="index-ssax_003aresolve_002dname-463"></a></var><br>
<blockquote>
       <p>Convert an <var>unres-name</var> to a RES-NAME, given the appropriate <var>namespaces</var> declarations. 
The last parameter, <var>apply-default-ns?</var>, determines if the default namespace applies
(for instance, it does not for attribute names).

       <p>Per REC-xml-names/#nsc-NSDeclared, the "xml" prefix is considered
pre-declared and bound to the namespace name
"http://www.w3.org/XML/1998/namespace".

       <p><code>ssax:resolve-name</code> tests for the namespace constraints:<br>
<a href="http://www.w3.org/TR/REC-xml-names/#nsc-NSDeclared">http://www.w3.org/TR/REC-xml-names/#nsc-NSDeclared</a>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:complete-start-tag</b><var> tag port elems entities namespaces<a name="index-ssax_003acomplete_002dstart_002dtag-464"></a></var><br>
<blockquote>
       <p>Complete parsing of a start-tag markup.  <code>ssax:complete-start-tag</code> must be called after the
start tag token has been read.  <var>tag</var> is an UNRES-NAME.  <var>elems</var> is an
instance of the ELEMS slot of XML-DECL; it can be #f to tell the
function to do <em>no</em> validation of elements and their
attributes.

       <p><code>ssax:complete-start-tag</code> returns several values:
          <ul>
<li>ELEM-GI:
a RES-NAME. 
<li>ATTRIBUTES:
element's attributes, an ATTLIST of (RES-NAME . STRING) pairs. 
The list does NOT include xmlns attributes. 
<li>NAMESPACES:
the input list of namespaces amended with namespace
(re-)declarations contained within the start-tag under parsing
<li>ELEM-CONTENT-MODEL
</ul>

       <p>On exit, the current position in <var>port</var> will be the first character
after &lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo; that terminates the start-tag markup.

       <p>Faults detected:<br>
VC: XML-Spec.html#enum<br>
VC: XML-Spec.html#RequiredAttr<br>
VC: XML-Spec.html#FixedAttr<br>
VC: XML-Spec.html#ValueType<br>
WFC: XML-Spec.html#uniqattspec (after namespaces prefixes are resolved)<br>
VC: XML-Spec.html#elementvalid<br>
WFC: REC-xml-names/#dt-NSName

       <p><em>Note</em>: although XML Recommendation does not explicitly say it,
xmlns and xmlns: attributes don't have to be declared (although they
can be declared, to specify their default value). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-external-id</b><var> port<a name="index-ssax_003aread_002dexternal_002did-465"></a></var><br>
<blockquote>
       <p>Parses an ExternalID production:

     <pre class="example">          [75] ExternalID ::= 'SYSTEM' S SystemLiteral
                            | 'PUBLIC' S PubidLiteral S SystemLiteral
          [11] SystemLiteral ::= ('"' [^"]* '"') | ("'" [^']* "'")
          [12] PubidLiteral ::=  '"' PubidChar* '"'
                               | "'" (PubidChar - "'")* "'"
          [13] PubidChar ::=  #x20 | #x0D | #x0A | [a-zA-Z0-9]
                                   | [-'()+,./:=?;!*#@$_%]
</pre>
       <p>Call <code>ssax:read-external-id</code> when an ExternalID is expected; that is, the current
character must be either #\S or #\P that starts correspondingly a
SYSTEM or PUBLIC token.  <code>ssax:read-external-id</code> returns the <var>SystemLiteral</var> as a
string.  A <var>PubidLiteral</var> is disregarded if present. 
</p></blockquote></div>

<h4 class="subsection">4.11.5 Mid-Level Parsers and Scanners</h4>

<p class="noindent">These procedures parse productions corresponding to the whole
(document) entity or its higher-level pieces (prolog, root element,
etc).

<div class="defun">
&mdash; Function: <b>ssax:scan-misc</b><var> port<a name="index-ssax_003ascan_002dmisc-466"></a></var><br>
<blockquote>
       <p>Scan the Misc production in the context:

     <pre class="example">          [1]  document ::=  prolog element Misc*
          [22] prolog ::= XMLDecl? Misc* (doctypedec l Misc*)?
          [27] Misc ::= Comment | PI |  S
</pre>
       <p>Call <code>ssax:scan-misc</code> in the prolog or epilog contexts.  In these contexts,
whitespaces are completely ignored.  The return value from <code>ssax:scan-misc</code> is
either a PI-token, a DECL-token, a START token, or *EOF*.  Comments
are ignored and not reported. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:read-char-data</b><var> port expect-eof? str-handler iseed<a name="index-ssax_003aread_002dchar_002ddata-467"></a></var><br>
<blockquote>
       <p>Read the character content of an XML document or an XML element.

     <pre class="example">          [43] content ::=
          (element | CharData | Reference | CDSect | PI | Comment)*
</pre>
       <p>To be more precise, <code>ssax:read-char-data</code> reads CharData, expands CDSect and character
entities, and skips comments.  <code>ssax:read-char-data</code> stops at a named reference, EOF,
at the beginning of a PI, or a start/end tag.

       <p><var>expect-eof?</var> is a boolean indicating if EOF is normal; i.e., the character
data may be terminated by the EOF.  EOF is normal while processing a
parsed entity.

       <p><var>iseed</var> is an argument passed to the first invocation of <var>str-handler</var>.

       <p><code>ssax:read-char-data</code> returns two results: <var>seed</var> and <var>token</var>.  The <var>seed</var>
is the result of the last invocation of <var>str-handler</var>, or the original <var>iseed</var> if <var>str-handler</var>
was never called.

       <p><var>token</var> can be either an eof-object (this can happen only if <var>expect-eof?</var>
was #t), or:
          <ul>
<li>an xml-token describing a START tag or an END-tag;
For a start token, the caller has to finish reading it.

          <li>an xml-token describing the beginning of a PI.  It's up to an
application to read or skip through the rest of this PI;

          <li>an xml-token describing a named entity reference.

       </ul>

       <p>CDATA sections and character references are expanded inline and
never returned.  Comments are silently disregarded.

       <p>As the XML Recommendation requires, all whitespace in character data
must be preserved.  However, a CR character (#x0D) must be
disregarded if it appears before a LF character (#x0A), or replaced
by a #x0A character otherwise.  See Secs. 2.10 and 2.11 of the XML
Recommendation.  See also the canonical XML Recommendation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:assert-token</b><var> token kind gi error-cont<a name="index-ssax_003aassert_002dtoken-468"></a></var><br>
<blockquote>
       <p>Make sure that <var>token</var> is of anticipated <var>kind</var> and has anticipated <var>gi</var>.  Note
that the <var>gi</var> argument may actually be a pair of two symbols,
Namespace-URI or the prefix, and of the localname.  If the assertion
fails, <var>error-cont</var> is evaluated by passing it three arguments: <var>token</var> <var>kind</var> <var>gi</var>.  The
result of <var>error-cont</var> is returned. 
</p></blockquote></div>

<h4 class="subsection">4.11.6 High-level Parsers</h4>

<p>These procedures are to instantiate a SSAX parser.  A user can
instantiate the parser to do the full validation, or no validation,
or any particular validation.  The user specifies which PI he wants
to be notified about.  The user tells what to do with the parsed
character and element data.  The latter handlers determine if the
parsing follows a SAX or a DOM model.

<div class="defun">
&mdash; Function: <b>ssax:make-pi-parser</b><var> my-pi-handlers<a name="index-ssax_003amake_002dpi_002dparser-469"></a></var><br>
<blockquote>
       <p>Create a parser to parse and process one Processing Element (PI).

       <p><var>my-pi-handlers</var> is an association list of pairs
<code>(</code><var>pi-tag</var><code> . </code><var>pi-handler</var><code>)</code> where <var>pi-tag</var> is an
NCName symbol, the PI target; and <var>pi-handler</var> is a procedure
taking arguments <var>port</var>, <var>pi-tag</var>, and <var>seed</var>.

       <p><var>pi-handler</var> should read the rest of the PI up to and including
the combination &lsquo;<samp><span class="samp">?&gt;</span></samp>&rsquo; that terminates the PI.  The handler
should return a new seed.  One of the <var>pi-tag</var>s may be the
symbol <code>*DEFAULT*</code>.  The corresponding handler will handle PIs
that no other handler will.  If the *DEFAULT* <var>pi-tag</var> is not
specified, <code>ssax:make-pi-parser</code> will assume the default handler that skips the body of
the PI.

       <p><code>ssax:make-pi-parser</code> returns a procedure of arguments <var>port</var>, <var>pi-tag</var>, and
<var>seed</var>; that will parse the current PI according to <var>my-pi-handlers</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:make-elem-parser</b><var> my-new-level-seed my-finish-element my-char-data-handler my-pi-handlers<a name="index-ssax_003amake_002delem_002dparser-470"></a></var><br>
<blockquote>
       <p>Create a parser to parse and process one element, including its
character content or children elements.  The parser is typically
applied to the root element of a document.

          <dl>
<dt><var>my-new-level-seed</var><dd>is a procedure taking arguments:

          <p><var>elem-gi</var> <var>attributes</var> <var>namespaces</var> <var>expected-content</var> <var>seed</var>

          <p>where <var>elem-gi</var> is a RES-NAME of the element about to be
processed.

          <p><var>my-new-level-seed</var> is to generate the seed to be passed to handlers that process the
content of the element.

          <br><dt><var>my-finish-element</var><dd>is a procedure taking arguments:

          <p><var>elem-gi</var> <var>attributes</var> <var>namespaces</var> <var>parent-seed</var> <var>seed</var>

          <p><var>my-finish-element</var> is called when parsing of <var>elem-gi</var> is finished. 
The <var>seed</var> is the result from the last content parser (or
from <var>my-new-level-seed</var> if the element has the empty content). 
<var>parent-seed</var> is the same seed as was passed to <var>my-new-level-seed</var>. 
<var>my-finish-element</var> is to generate a seed that will be the result
of the element parser.

          <br><dt><var>my-char-data-handler</var><dd>is a STR-HANDLER as described in Data Types above.

          <br><dt><var>my-pi-handlers</var><dd>is as described for <code>ssax:make-pi-handler</code> above.

       </dl>

       <p>The generated parser is a procedure taking arguments:

       <p><var>start-tag-head</var> <var>port</var> <var>elems</var> <var>entities</var> <var>namespaces</var> <var>preserve-ws?</var> <var>seed</var>

       <p>The procedure must be called after the start tag token has been
read.  <var>start-tag-head</var> is an UNRES-NAME from the start-element
tag.  ELEMS is an instance of ELEMS slot of XML-DECL.

       <p>Faults detected:<br>
VC: XML-Spec.html#elementvalid<br>
WFC: XML-Spec.html#GIMatch
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax:make-parser</b><var> user-handler-tag user-handler <small class="dots">...</small><a name="index-ssax_003amake_002dparser-471"></a></var><br>
<blockquote>
       <p>Create an XML parser, an instance of the XML parsing framework. 
This will be a SAX, a DOM, or a specialized parser depending on the
supplied user-handlers.

       <p><code>ssax:make-parser</code> takes an even number of arguments; <var>user-handler-tag</var> is a symbol that identifies
a procedure (or association list for <code>PROCESSING-INSTRUCTIONS</code>)
(<var>user-handler</var>) that follows the tag.  Given below are tags and signatures of
the corresponding procedures.  Not all tags have to be specified. 
If some are omitted, reasonable defaults will apply.

          <dl>
<dt>&lsquo;<samp><span class="samp">DOCTYPE</span></samp>&rsquo;<dd>handler-procedure: <var>port</var> <var>docname</var> <var>systemid</var> <var>internal-subset?</var> <var>seed</var>

          <p>If <var>internal-subset?</var> is #t, the current position in the port is
right after we have read &lsquo;<samp><span class="samp">[</span></samp>&rsquo; that begins the internal DTD
subset.  We must finish reading of this subset before we return (or
must call <code>skip-internal-dtd</code> if we aren't interested in
reading it).  <var>port</var> at exit must be at the first symbol after
the whole DOCTYPE declaration.

          <p>The handler-procedure must generate four values:
<blockquote>
<var>elems</var> <var>entities</var> <var>namespaces</var> <var>seed</var>
</blockquote>

          <p><var>elems</var> is as defined for the ELEMS slot of XML-DECL.  It may be
#f to switch off validation.  <var>namespaces</var> will typically
contain <var>user-prefix</var>es for selected <var>uri-symb</var>s.  The
default handler-procedure skips the internal subset, if any, and
returns <code>(values #f '() '() seed)</code>.

          <br><dt>&lsquo;<samp><span class="samp">UNDECL-ROOT</span></samp>&rsquo;<dd>procedure: <var>elem-gi</var> <var>seed</var>

          <p>where <var>elem-gi</var> is an UNRES-NAME of the root element.  This
procedure is called when an XML document under parsing contains
<em>no</em> DOCTYPE declaration.

          <p>The handler-procedure, as a DOCTYPE handler procedure above,
must generate four values:
<blockquote>
<var>elems</var> <var>entities</var> <var>namespaces</var> <var>seed</var>
</blockquote>

          <p>The default handler-procedure returns (values #f '() '() seed)

          <br><dt>&lsquo;<samp><span class="samp">DECL-ROOT</span></samp>&rsquo;<dd>procedure: <var>elem-gi</var> <var>seed</var>

          <p>where <var>elem-gi</var> is an UNRES-NAME of the root element.  This
procedure is called when an XML document under parsing does contains
the DOCTYPE declaration.  The handler-procedure must generate a new
<var>seed</var> (and verify that the name of the root element matches the
doctype, if the handler so wishes).  The default handler-procedure
is the identity function.

          <br><dt>&lsquo;<samp><span class="samp">NEW-LEVEL-SEED</span></samp>&rsquo;<dd>procedure: see ssax:make-elem-parser, my-new-level-seed

          <br><dt>&lsquo;<samp><span class="samp">FINISH-ELEMENT</span></samp>&rsquo;<dd>procedure: see ssax:make-elem-parser, my-finish-element

          <br><dt>&lsquo;<samp><span class="samp">CHAR-DATA-HANDLER</span></samp>&rsquo;<dd>procedure: see ssax:make-elem-parser, my-char-data-handler

          <br><dt>&lsquo;<samp><span class="samp">PROCESSING-INSTRUCTIONS</span></samp>&rsquo;<dd>association list as is passed to <code>ssax:make-pi-parser</code>. 
The default value is '()

       </dl>

       <p>The generated parser is a procedure of arguments <var>port</var> and
<var>seed</var>.

       <p>This procedure parses the document prolog and then exits to an
element parser (created by <code>ssax:make-elem-parser</code>) to handle
the rest.

     <pre class="example">          [1]  document ::=  prolog element Misc*
          [22] prolog ::= XMLDecl? Misc* (doctypedec | Misc*)?
          [27] Misc ::= Comment | PI |  S
          [28] doctypedecl ::=  '&lt;!DOCTYPE' S Name (S ExternalID)? S?
                        ('[' (markupdecl | PEReference | S)* ']' S?)? '&gt;'
          [29] markupdecl ::= elementdecl | AttlistDecl
                               | EntityDecl
                               | NotationDecl | PI
                               | Comment
</pre>
       </blockquote></div>

<h4 class="subsection">4.11.7 Parsing XML to SXML</h4>

<div class="defun">
&mdash; Function: <b>ssax:xml-&gt;sxml</b><var> port namespace-prefix-assig<a name="index-ssax_003axml_002d_003esxml-472"></a></var><br>
<blockquote>
       <p>This is an instance of the SSAX parser that returns an SXML
representation of the XML document to be read from <var>port</var>.  <var>namespace-prefix-assig</var> is a list
of <code>(</code><var>user-prefix</var><code> . </code><var>uri-string</var><code>)</code> that assigns
<var>user-prefix</var>es to certain namespaces identified by particular
<var>uri-string</var>s.  It may be an empty list.  <code>ssax:xml-&gt;sxml</code> returns an SXML
tree.  The port points out to the first character after the root
element. 
</p></blockquote></div>

<div class="node">
<a name="Printing-Scheme"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Time-and-Date">Time and Date</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parsing-XML">Parsing XML</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.12 Printing Scheme</h3>

<ul class="menu">
<li><a accesskey="1" href="#Generic_002dWrite">Generic-Write</a>:                'generic-write
<li><a accesskey="2" href="#Object_002dTo_002dString">Object-To-String</a>:             'object-&gt;string
<li><a accesskey="3" href="#Pretty_002dPrint">Pretty-Print</a>:                 'pretty-print, 'pprint-file
</ul>

<div class="node">
<a name="Generic-Write"></a>
<a name="Generic_002dWrite"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Object_002dTo_002dString">Object-To-String</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Printing-Scheme">Printing Scheme</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Printing-Scheme">Printing Scheme</a>

</div>

<h4 class="subsection">4.12.1 Generic-Write</h4>

<p><code>(require 'generic-write)</code>
<a name="index-generic_002dwrite-473"></a>
<code>generic-write</code> is a procedure that transforms a Scheme data value
(or Scheme program expression) into its textual representation and
prints it.  The interface to the procedure is sufficiently general to
easily implement other useful formatting procedures such as pretty
printing, output to a string and truncated output.

<div class="defun">
&mdash; Procedure: <b>generic-write</b><var> obj display? width output<a name="index-generic_002dwrite-474"></a></var><br>
<blockquote><dl>
<dt><var>obj</var><dd>Scheme data value to transform. 
<br><dt><var>display?</var><dd>Boolean, controls whether characters and strings are quoted. 
<br><dt><var>width</var><dd>Extended boolean, selects format:
               <dl>
<dt>#f<dd>single line format
<br><dt>integer &gt; 0<dd>pretty-print (value = max nb of chars per line)
</dl>
          <br><dt><var>output</var><dd>Procedure of 1 argument of string type, called repeatedly with
successive substrings of the textual representation.  This procedure can
return <code>#f</code> to stop the transformation. 
</dl>

       <p>The value returned by <code>generic-write</code> is undefined.

       <p>Examples:
     <pre class="lisp">          (write obj) == (generic-write obj #f #f <var>display-string</var>)
          (display obj) == (generic-write obj #t #f <var>display-string</var>)
</pre>
       <p class="noindent">where
     <pre class="lisp">          <var>display-string</var> ==
          (lambda (s) (for-each write-char (string-&gt;list s)) #t)
</pre>
       </blockquote></div>

<div class="node">
<a name="Object-To-String"></a>
<a name="Object_002dTo_002dString"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Pretty_002dPrint">Pretty-Print</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Generic_002dWrite">Generic-Write</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Printing-Scheme">Printing Scheme</a>

</div>

<h4 class="subsection">4.12.2 Object-To-String</h4>

<p><code>(require 'object-&gt;string)</code>
<a name="index-object_002d_003estring-475"></a>

<div class="defun">
&mdash; Function: <b>object-&gt;string</b><var> obj<a name="index-object_002d_003estring-476"></a></var><br>
<blockquote><p>Returns the textual representation of <var>obj</var> as a string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>object-&gt;limited-string</b><var> obj limit<a name="index-object_002d_003elimited_002dstring-477"></a></var><br>
<blockquote><p>Returns the textual representation of <var>obj</var> as a string of length
at most <var>limit</var>. 
</p></blockquote></div>

<div class="node">
<a name="Pretty-Print"></a>
<a name="Pretty_002dPrint"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Object_002dTo_002dString">Object-To-String</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Printing-Scheme">Printing Scheme</a>

</div>

<h4 class="subsection">4.12.3 Pretty-Print</h4>

<p><code>(require 'pretty-print)</code>
<a name="index-pretty_002dprint-478"></a>

<div class="defun">
&mdash; Procedure: <b>pretty-print</b><var> obj<a name="index-pretty_002dprint-479"></a></var><br>
&mdash; Procedure: <b>pretty-print</b><var> obj port<a name="index-pretty_002dprint-480"></a></var><br>
<blockquote>
       <p><code>pretty-print</code>s <var>obj</var> on <var>port</var>.  If <var>port</var> is not
specified, <code>current-output-port</code> is used.

       <p>Example:
     <pre class="example">          (pretty-print '((1 2 3 4 5) (6 7 8 9 10) (11 12 13 14 15)
                          (16 17 18 19 20) (21 22 23 24 25)))
             -| ((1 2 3 4 5)
             -|  (6 7 8 9 10)
             -|  (11 12 13 14 15)
             -|  (16 17 18 19 20)
             -|  (21 22 23 24 25))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pretty-print-&gt;string</b><var> obj<a name="index-pretty_002dprint_002d_003estring-481"></a></var><br>
&mdash; Procedure: <b>pretty-print-&gt;string</b><var> obj width<a name="index-pretty_002dprint_002d_003estring-482"></a></var><br>
<blockquote>
       <p>Returns the string of <var>obj</var> <code>pretty-print</code>ed in <var>width</var>
columns.  If <var>width</var> is not specified, <code>(output-port-width)</code> is
used.

       <p>Example:
     <pre class="example">          (pretty-print-&gt;string '((1 2 3 4 5) (6 7 8 9 10) (11 12 13 14 15)
                                  (16 17 18 19 20) (21 22 23 24 25)))
          &rArr;
          "((1 2 3 4 5)
           (6 7 8 9 10)
           (11 12 13 14 15)
           (16 17 18 19 20)
           (21 22 23 24 25))
          "
          (pretty-print-&gt;string '((1 2 3 4 5) (6 7 8 9 10) (11 12 13 14 15)
                                  (16 17 18 19 20) (21 22 23 24 25))
                                16)
          &rArr;
          "((1 2 3 4 5)
           (6 7 8 9 10)
           (11
            12
            13
            14
            15)
           (16
            17
            18
            19
            20)
           (21
            22
            23
            24
            25))
          "
</pre>
       </blockquote></div>

  <p><code>(require 'pprint-file)</code>
<a name="index-pprint_002dfile-483"></a>

<div class="defun">
&mdash; Procedure: <b>pprint-file</b><var> infile<a name="index-pprint_002dfile-484"></a></var><br>
&mdash; Procedure: <b>pprint-file</b><var> infile outfile<a name="index-pprint_002dfile-485"></a></var><br>
<blockquote><p>Pretty-prints all the code in <var>infile</var>.  If <var>outfile</var> is
specified, the output goes to <var>outfile</var>, otherwise it goes to
<code>(current-output-port)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pprint-filter-file</b><var> infile proc outfile<a name="index-pprint_002dfilter_002dfile-486"></a></var><br>
&mdash; Function: <b>pprint-filter-file</b><var> infile proc<a name="index-pprint_002dfilter_002dfile-487"></a></var><br>
<blockquote><p><var>infile</var> is a port or a string naming an existing file.  Scheme
source code expressions and definitions are read from the port (or file)
and <var>proc</var> is applied to them sequentially.

       <p><var>outfile</var> is a port or a string.  If no <var>outfile</var> is specified
then <code>current-output-port</code> is assumed.  These expanded expressions
are then <code>pretty-print</code>ed to this port.

       <p>Whitepsace and comments (introduced by <code>;</code>) which are not part of
scheme expressions are reproduced in the output.  This procedure does
not affect the values returned by <code>current-input-port</code>,
<code>current-error-port</code>, and <code>current-output-port</code>. 
</p></blockquote></div>

  <p><code>pprint-filter-file</code> can be used to pre-compile macro-expansion and
thus can reduce loading time.  The following will write into
<samp><span class="file">exp-code.scm</span></samp> the result of expanding all defmacros in
<samp><span class="file">code.scm</span></samp>.
<pre class="lisp">     (require 'pprint-file)
     <a name="index-pprint_002dfile-488"></a>(require 'defmacroexpand)
     <a name="index-defmacroexpand-489"></a>(defmacro:load "my-macros.scm")
     (pprint-filter-file "code.scm" defmacro:expand* "exp-code.scm")
</pre>
  <div class="node">
<a name="Time-and-Date"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#NCBI_002dDNA">NCBI-DNA</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Printing-Scheme">Printing Scheme</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.13 Time and Date</h3>

<ul class="menu">
<li><a accesskey="1" href="#Time-Zone">Time Zone</a>
<li><a accesskey="2" href="#Posix-Time">Posix Time</a>:                   'posix-time
<li><a accesskey="3" href="#Common_002dLisp-Time">Common-Lisp Time</a>:             'common-lisp-time
<li><a accesskey="4" href="#Time-Infrastructure">Time Infrastructure</a>
</ul>

<p class="noindent">If <code>(provided? 'current-time)</code>:

<p class="noindent">The procedures <code>current-time</code>, <code>difftime</code>, and
<code>offset-time</code> deal with a <dfn>calendar time</dfn> datatype
<a name="index-time-490"></a><a name="index-calendar-time-491"></a>which may or may not be disjoint from other Scheme datatypes.

<div class="defun">
&mdash; Function: <b>current-time</b><var><a name="index-current_002dtime-492"></a></var><br>
<blockquote><p>Returns the time since 00:00:00 GMT, January 1, 1970, measured in
seconds.  Note that the reference time is different from the reference
time for <code>get-universal-time</code> in <a href="#Common_002dLisp-Time">Common-Lisp Time</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>difftime</b><var> caltime1 caltime0<a name="index-difftime-493"></a></var><br>
<blockquote><p>Returns the difference (number of seconds) between twe calendar times:
<var>caltime1</var> - <var>caltime0</var>.  <var>caltime0</var> may also be a number. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>offset-time</b><var> caltime offset<a name="index-offset_002dtime-494"></a></var><br>
<blockquote><p>Returns the calendar time of <var>caltime</var> offset by <var>offset</var> number
of seconds <code>(+ caltime offset)</code>. 
</p></blockquote></div>

<div class="node">
<a name="Time-Zone"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Posix-Time">Posix Time</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Time-and-Date">Time and Date</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Time-and-Date">Time and Date</a>

</div>

<h4 class="subsection">4.13.1 Time Zone</h4>

<p>(require 'time-zone)

<div class="defun">
&mdash; Data Format: <b>TZ-string</b><var><a name="index-TZ_002dstring-495"></a></var><br>
<blockquote>
       <p>POSIX standards specify several formats for encoding time-zone rules.

          <dl>
<dt><tt>:</tt><i>&lt;pathname&gt;</i><dd>If the first character of <i>&lt;pathname&gt;</i> is &lsquo;<samp><span class="samp">/</span></samp>&rsquo;, then
<i>&lt;pathname&gt;</i> specifies the absolute pathname of a tzfile(5) format
time-zone file.  Otherwise, <i>&lt;pathname&gt;</i> is interpreted as a pathname
within <var>tzfile:vicinity</var> (/usr/lib/zoneinfo/) naming a tzfile(5)
format time-zone file. 
<br><dt><i>&lt;std&gt;</i><i>&lt;offset&gt;</i><dd>The string <i>&lt;std&gt;</i> consists of 3 or more alphabetic characters. 
<i>&lt;offset&gt;</i> specifies the time difference from GMT.  The <i>&lt;offset&gt;</i>
is positive if the local time zone is west of the Prime Meridian and
negative if it is east.  <i>&lt;offset&gt;</i> can be the number of hours or
hours and minutes (and optionally seconds) separated by &lsquo;<samp><span class="samp">:</span></samp>&rsquo;.  For
example, <code>-4:30</code>. 
<br><dt><i>&lt;std&gt;</i><i>&lt;offset&gt;</i><i>&lt;dst&gt;</i><dd><i>&lt;dst&gt;</i> is the at least 3 alphabetic characters naming the local
daylight-savings-time. 
<br><dt><i>&lt;std&gt;</i><i>&lt;offset&gt;</i><i>&lt;dst&gt;</i><i>&lt;doffset&gt;</i><dd><i>&lt;doffset&gt;</i> specifies the offset from the Prime Meridian when
daylight-savings-time is in effect. 
</dl>

       <p>The non-tzfile formats can optionally be followed by transition times
specifying the day and time when a zone changes from standard to
daylight-savings and back again.

          <dl>
<dt><tt>,</tt><i>&lt;date&gt;</i><tt>/</tt><i>&lt;time&gt;</i><tt>,</tt><i>&lt;date&gt;</i><tt>/</tt><i>&lt;time&gt;</i><dd>The <i>&lt;time&gt;</i>s are specified like the <i>&lt;offset&gt;</i>s above, except that
leading &lsquo;<samp><span class="samp">+</span></samp>&rsquo; and &lsquo;<samp><span class="samp">-</span></samp>&rsquo; are not allowed.

          <p>Each <i>&lt;date&gt;</i> has one of the formats:

               <dl>
<dt><tt>J</tt><i>&lt;day&gt;</i><dd>specifies the Julian day with <i>&lt;day&gt;</i> between 1 and 365.  February 29
is never counted and cannot be referenced. 
<br><dt><i>&lt;day&gt;</i><dd>This specifies the Julian day with n between 0 and 365.  February 29 is
counted in leap years and can be specified. 
<br><dt><tt>M</tt><i>&lt;month&gt;</i><tt>.</tt><i>&lt;week&gt;</i><tt>.</tt><i>&lt;day&gt;</i><dd>This specifies day <i>&lt;day&gt;</i> (0 &lt;= <i>&lt;day&gt;</i> &lt;= 6) of week <i>&lt;week&gt;</i> (1
&lt;= <i>&lt;week&gt;</i> &lt;= 5) of month <i>&lt;month&gt;</i> (1 &lt;= <i>&lt;month&gt;</i> &lt;= 12).  Week
1 is the first week in which day d occurs and week 5 is the last week in
which day <i>&lt;day&gt;</i> occurs.  Day 0 is a Sunday. 
</dl>
          </dl>

       </blockquote></div>

<div class="defun">
&mdash; Data Type: <b>time-zone</b><var><a name="index-time_002dzone-496"></a></var><br>
<blockquote><p>is a datatype encoding how many hours from Greenwich Mean Time the local
time is, and the <dfn>Daylight Savings Time</dfn> rules for changing it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>time-zone</b><var> TZ-string<a name="index-time_002dzone-497"></a></var><br>
<blockquote><p>Creates and returns a time-zone object specified by the string
<var>TZ-string</var>.  If <code>time-zone</code> cannot interpret <var>TZ-string</var>,
<code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>tz:params</b><var> caltime tz<a name="index-tz_003aparams-498"></a></var><br>
<blockquote><p><var>tz</var> is a time-zone object.  <code>tz:params</code> returns a list of
three items:
          <ol type=1 start=0>
<li>An integer.  0 if standard time is in effect for timezone <var>tz</var> at
<var>caltime</var>; 1 if daylight savings time is in effect for timezone
<var>tz</var> at <var>caltime</var>. 
<li>The number of seconds west of the Prime Meridian timezone <var>tz</var> is at
<var>caltime</var>. 
<li>The name for timezone <var>tz</var> at <var>caltime</var>.
            </ol>

       <p><code>tz:params</code> is unaffected by the default timezone; inquiries can be
made of any timezone at any calendar time.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>tz:std-offset</b><var> tz<a name="index-tz_003astd_002doffset-499"></a></var><br>
<blockquote><p><var>tz</var> is a time-zone object.  <code>tz:std-offset</code> returns the
number of seconds west of the Prime Meridian timezone <var>tz</var> is.

       </blockquote></div>

<p class="noindent">The rest of these procedures and variables are provided for POSIX
compatability.  Because of shared state they are not thread-safe.

<div class="defun">
&mdash; Function: <b>tzset</b><var><a name="index-tzset-500"></a></var><br>
<blockquote><p>Returns the default time-zone. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>tzset</b><var> tz<a name="index-tzset-501"></a></var><br>
<blockquote><p>Sets (and returns) the default time-zone to <var>tz</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>tzset</b><var> TZ-string<a name="index-tzset-502"></a></var><br>
<blockquote><p>Sets (and returns) the default time-zone to that specified by
<var>TZ-string</var>.

       <p><code>tzset</code> also sets the variables <var>*timezone*</var>, <var>daylight?</var>,
and <var>tzname</var>.  This function is automatically called by the time
conversion procedures which depend on the time zone
(see <a href="#Time-and-Date">Time and Date</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>*timezone*</b><var><a name="index-g_t_002atimezone_002a-503"></a></var><br>
<blockquote><p>Contains the difference, in seconds, between Greenwich Mean Time and
local standard time (for example, in the U.S.  Eastern time zone (EST),
timezone is 5*60*60).  <code>*timezone*</code> is initialized by <code>tzset</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>daylight?</b><var><a name="index-daylight_003f-504"></a></var><br>
<blockquote><p>is <code>#t</code> if the default timezone has rules for <dfn>Daylight Savings
Time</dfn>.  <em>Note:</em> <var>daylight?</var> does not tell you when Daylight
Savings Time is in effect, just that the default zone sometimes has
Daylight Savings Time. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>tzname</b><var><a name="index-tzname-505"></a></var><br>
<blockquote><p>is a vector of strings.  Index 0 has the abbreviation for the standard
timezone; If <var>daylight?</var>, then index 1 has the abbreviation for the
Daylight Savings timezone. 
</p></blockquote></div>

<div class="node">
<a name="Posix-Time"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Common_002dLisp-Time">Common-Lisp Time</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Time-Zone">Time Zone</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Time-and-Date">Time and Date</a>

</div>

<h4 class="subsection">4.13.2 Posix Time</h4>

<pre class="example">     (require 'posix-time)
     <a name="index-posix_002dtime-506"></a></pre>
<div class="defun">
&mdash; Data Type: <b>Calendar-Time</b><var><a name="index-Calendar_002dTime-507"></a></var><br>
<blockquote><p><a name="index-calendar-time-508"></a><a name="index-caltime-509"></a>is a datatype encapsulating time. 
</p></blockquote></div>

<div class="defun">
&mdash; Data Type: <b>Coordinated Universal Time</b><var><a name="index-Coordinated-Universal-Time-510"></a></var><br>
<blockquote><p><a name="index-Coordinated-Universal-Time-511"></a><a name="index-UTC-512"></a>(abbreviated <dfn>UTC</dfn>) is a vector of integers representing time:

          <ol type=1 start=0>
<li> seconds (0 - 61)
<li> minutes (0 - 59)
<li> hours since midnight (0 - 23)
<li> day of month (1 - 31)
<li> month (0 - 11).  Note difference from <code>decode-universal-time</code>. 
<li> the number of years since 1900.  Note difference from
<code>decode-universal-time</code>. 
<li> day of week (0 - 6)
<li> day of year (0 - 365)
<li> 1 for daylight savings, 0 for regular time
            </ol>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>gmtime</b><var> caltime<a name="index-gmtime-513"></a></var><br>
<blockquote><p>Converts the calendar time <var>caltime</var> to UTC and returns it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>localtime</b><var> caltime tz<a name="index-localtime-514"></a></var><br>
<blockquote><p>Returns <var>caltime</var> converted to UTC relative to timezone <var>tz</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>localtime</b><var> caltime<a name="index-localtime-515"></a></var><br>
<blockquote><p>converts the calendar time <var>caltime</var> to a vector of integers
expressed relative to the user's time zone.  <code>localtime</code> sets the
variable <var>*timezone*</var> with the difference between Coordinated
Universal Time (UTC) and local standard time in seconds
(see <a href="#Time-Zone">tzset</a>).

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>gmktime</b><var> univtime<a name="index-gmktime-516"></a></var><br>
<blockquote><p>Converts a vector of integers in GMT Coordinated Universal Time (UTC)
format to a calendar time. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>mktime</b><var> univtime<a name="index-mktime-517"></a></var><br>
<blockquote><p>Converts a vector of integers in local Coordinated Universal Time (UTC)
format to a calendar time. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>mktime</b><var> univtime tz<a name="index-mktime-518"></a></var><br>
<blockquote><p>Converts a vector of integers in Coordinated Universal Time (UTC) format
(relative to time-zone <var>tz</var>)
to calendar time. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>asctime</b><var> univtime<a name="index-asctime-519"></a></var><br>
<blockquote><p>Converts the vector of integers <var>caltime</var> in Coordinated
Universal Time (UTC) format into a string of the form
<code>"Wed Jun 30 21:49:08 1993"</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>gtime</b><var> caltime<a name="index-gtime-520"></a></var><br>
&mdash; Function: <b>ctime</b><var> caltime<a name="index-ctime-521"></a></var><br>
&mdash; Function: <b>ctime</b><var> caltime tz<a name="index-ctime-522"></a></var><br>
<blockquote><p>Equivalent to <code>(asctime (gmtime </code><var>caltime</var><code>))</code>,
<code>(asctime (localtime </code><var>caltime</var><code>))</code>, and
<code>(asctime (localtime </code><var>caltime</var> <var>tz</var><code>))</code>, respectively. 
</p></blockquote></div>

<div class="node">
<a name="Common-Lisp-Time"></a>
<a name="Common_002dLisp-Time"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Time-Infrastructure">Time Infrastructure</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Posix-Time">Posix Time</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Time-and-Date">Time and Date</a>

</div>

<h4 class="subsection">4.13.3 Common-Lisp Time</h4>

<div class="defun">
&mdash; Function: <b>get-decoded-time</b><var><a name="index-get_002ddecoded_002dtime-523"></a></var><br>
<blockquote><p>Equivalent to <code>(decode-universal-time (get-universal-time))</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>get-universal-time</b><var><a name="index-get_002duniversal_002dtime-524"></a></var><br>
<blockquote><p>Returns the current time as <dfn>Universal Time</dfn>, number of seconds
since 00:00:00 Jan 1, 1900 GMT.  Note that the reference time is
different from <code>current-time</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>decode-universal-time</b><var> univtime<a name="index-decode_002duniversal_002dtime-525"></a></var><br>
<blockquote><p>Converts <var>univtime</var> to <dfn>Decoded Time</dfn> format. 
Nine values are returned:
          <ol type=1 start=0>
<li> seconds (0 - 61)
<li> minutes (0 - 59)
<li> hours since midnight
<li> day of month
<li> month (1 - 12).  Note difference from <code>gmtime</code> and <code>localtime</code>. 
<li> year (A.D.).  Note difference from <code>gmtime</code> and <code>localtime</code>. 
<li> day of week (0 - 6)
<li> #t for daylight savings, #f otherwise
<li> hours west of GMT (-24 - +24)
            </ol>

       <p>Notice that the values returned by <code>decode-universal-time</code> do not
match the arguments to <code>encode-universal-time</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>encode-universal-time</b><var> second minute hour date month year<a name="index-encode_002duniversal_002dtime-526"></a></var><br>
&mdash; Function: <b>encode-universal-time</b><var> second minute hour date month year time-zone<a name="index-encode_002duniversal_002dtime-527"></a></var><br>
<blockquote><p>Converts the arguments in Decoded Time format to Universal Time format. 
If <var>time-zone</var> is not specified, the returned time is adjusted for
daylight saving time.  Otherwise, no adjustment is performed.

       <p>Notice that the values returned by <code>decode-universal-time</code> do not
match the arguments to <code>encode-universal-time</code>. 
</p></blockquote></div>

<div class="node">
<a name="Time-Infrastructure"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Common_002dLisp-Time">Common-Lisp Time</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Time-and-Date">Time and Date</a>

</div>

<h4 class="subsection">4.13.4 Time Infrastructure</h4>

<p><code>(require 'time-core)</code>

<div class="defun">
&mdash; Function: <b>time:gmtime</b><var> tm<a name="index-time_003agmtime-528"></a></var><br>
&mdash; Function: <b>time:invert</b><var> decoder target<a name="index-time_003ainvert-529"></a></var><br>
&mdash; Function: <b>time:split</b><var> t tm_isdst tm_gmtoff tm_zone<a name="index-time_003asplit-530"></a></var><br>
       </div>

  <p><code>(require 'tzfile)</code>

<div class="defun">
&mdash; Function: <b>tzfile:read</b><var> path<a name="index-tzfile_003aread-531"></a></var><br>
       </div>

<div class="node">
<a name="NCBI-DNA"></a>
<a name="NCBI_002dDNA"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Schmooz">Schmooz</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Time-and-Date">Time and Date</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.14 NCBI-DNA</h3>

<p><code>(require 'ncbi-dma)</code>
<a name="index-ncbi_002ddma-532"></a>

<div class="defun">
&mdash; Function: <b>ncbi:read-dna-sequence</b><var> port<a name="index-ncbi_003aread_002ddna_002dsequence-533"></a></var><br>
<blockquote>
       <p>Reads the NCBI-format DNA sequence following the word &lsquo;<samp><span class="samp">ORIGIN</span></samp>&rsquo;
from <var>port</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ncbi:read-file</b><var> file<a name="index-ncbi_003aread_002dfile-534"></a></var><br>
<blockquote>
       <p>Reads the NCBI-format DNA sequence following the word &lsquo;<samp><span class="samp">ORIGIN</span></samp>&rsquo;
from <var>file</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>mrna&lt;-cdna</b><var> str<a name="index-mrna_003c_002dcdna-535"></a></var><br>
<blockquote>
       <p>Replaces &lsquo;<samp><span class="samp">T</span></samp>&rsquo; with &lsquo;<samp><span class="samp">U</span></samp>&rsquo; in <var>str</var>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>codons&lt;-cdna</b><var> cdna<a name="index-codons_003c_002dcdna-536"></a></var><br>
<blockquote>
       <p>Returns a list of three-letter symbol codons comprising the protein
sequence encoded by <var>cdna</var> starting with its first occurence of
&lsquo;<samp><span class="samp">atg</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>protein&lt;-cdna</b><var> cdna<a name="index-protein_003c_002dcdna-537"></a></var><br>
<blockquote>
       <p>Returns a list of three-letter symbols for the protein sequence
encoded by <var>cdna</var> starting with its first occurence of &lsquo;<samp><span class="samp">atg</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>p&lt;-cdna</b><var> cdna<a name="index-p_003c_002dcdna-538"></a></var><br>
<blockquote>
       <p>Returns a string of one-letter amino acid codes for the protein
sequence encoded by <var>cdna</var> starting with its first occurence of
&lsquo;<samp><span class="samp">atg</span></samp>&rsquo;. 
</p></blockquote></div>

  <p>These cDNA count routines provide a means to check the nucleotide
sequence with the &lsquo;<samp><span class="samp">BASE COUNT</span></samp>&rsquo; line preceding the sequence from
NCBI.

<div class="defun">
&mdash; Function: <b>cdna:base-count</b><var> cdna<a name="index-cdna_003abase_002dcount-539"></a></var><br>
<blockquote>
       <p>Returns a list of counts of &lsquo;<samp><span class="samp">a</span></samp>&rsquo;, &lsquo;<samp><span class="samp">c</span></samp>&rsquo;, &lsquo;<samp><span class="samp">g</span></samp>&rsquo;, and
&lsquo;<samp><span class="samp">t</span></samp>&rsquo; occurrencing in <var>cdna</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cdna:report-base-count</b><var> cdna<a name="index-cdna_003areport_002dbase_002dcount-540"></a></var><br>
<blockquote>
       <p>Prints the counts of &lsquo;<samp><span class="samp">a</span></samp>&rsquo;, &lsquo;<samp><span class="samp">c</span></samp>&rsquo;, &lsquo;<samp><span class="samp">g</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">t</span></samp>&rsquo;
occurrencing in <var>cdna</var>. 
</p></blockquote></div>

<div class="node">
<a name="Schmooz"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#NCBI_002dDNA">NCBI-DNA</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>

</div>

<h3 class="section">4.15 Schmooz</h3>

<p><a name="index-schmooz-541"></a><dfn>Schmooz</dfn> is a simple, lightweight markup language for interspersing
Texinfo documentation with Scheme source code.  Schmooz does not create
the top level Texinfo file; it creates &lsquo;<samp><span class="samp">txi</span></samp>&rsquo; files which can be
imported into the documentation using the Texinfo command
&lsquo;<samp><span class="samp">@include</span></samp>&rsquo;.

  <p><a name="index-schmooz-542"></a><code>(require 'schmooz)</code> defines the function <code>schmooz</code>, which is
used to process files.  Files containing schmooz documentation should
not contain <code>(require 'schmooz)</code>.

<div class="defun">
&mdash; Procedure: <b>schmooz</b><var> filename</var><span class="roman">.scm</span><var> <small class="dots">...</small><a name="index-schmooz-543"></a></var><br>
<blockquote><p><var>Filename</var>.scm should be a string ending with &lsquo;<samp><span class="samp">.scm</span></samp>&rsquo; naming an
existing file containing Scheme source code.  <code>schmooz</code> extracts
top-level comments containing schmooz commands from <var>filename</var>.scm
and writes the converted Texinfo source to a file named
<var>filename</var>.txi. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>schmooz</b><var> filename</var><span class="roman">.texi</span><var> <small class="dots">...</small><a name="index-schmooz-544"></a></var><br>
&mdash; Procedure: <b>schmooz</b><var> filename</var><span class="roman">.tex</span><var> <small class="dots">...</small><a name="index-schmooz-545"></a></var><br>
&mdash; Procedure: <b>schmooz</b><var> filename</var><span class="roman">.txi</span><var> <small class="dots">...</small><a name="index-schmooz-546"></a></var><br>
<blockquote><p><var>Filename</var> should be a string naming an existing file containing
Texinfo source code.  For every occurrence of the string &lsquo;<samp><span class="samp">@include
</span><var>filename</var><span class="samp">.txi</span></samp>&rsquo; within that file, <code>schmooz</code> calls itself with
the argument &lsquo;<samp><var>filename</var><span class="samp">.scm</span></samp>&rsquo;. 
</p></blockquote></div>

  <p>Schmooz comments are distinguished (from non-schmooz comments) by their
first line, which must start with an at-sign (@) preceded by one or
more semicolons (<tt>;</tt>).  A schmooz comment ends at the first subsequent
line which does <em>not</em> start with a semicolon.  Currently schmooz
comments are recognized only at top level.

  <p>Schmooz comments are copied to the Texinfo output file with the leading
contiguous semicolons removed.  Certain character sequences starting
with at-sign are treated specially.  Others are copied unchanged.

  <p>A schmooz comment starting with &lsquo;<samp><span class="samp">@body</span></samp>&rsquo; must be followed by a
Scheme definition.  All comments between the &lsquo;<samp><span class="samp">@body</span></samp>&rsquo; line and
the definition will be included in a Texinfo definition, either
a &lsquo;<samp><span class="samp">@defun</span></samp>&rsquo; or a &lsquo;<samp><span class="samp">@defvar</span></samp>&rsquo;, depending on whether a procedure
or a variable is being defined.

  <p>Within the text of that schmooz comment, at-sign
followed by &lsquo;<samp><span class="samp">0</span></samp>&rsquo; will be replaced by <code>@code{procedure-name}</code>
if the following definition is of a procedure; or
<code>@var{variable}</code> if defining a variable.

  <p>An at-sign followed by a non-zero digit will expand to the variable
citation of that numbered argument: &lsquo;<samp><span class="samp">@var{argument-name}</span></samp>&rsquo;.

  <p>If more than one definition follows a &lsquo;<samp><span class="samp">@body</span></samp>&rsquo; comment line
without an intervening blank or comment line, then those definitions
will be included in the same Texinfo definition using &lsquo;<samp><span class="samp">@defvarx</span></samp>&rsquo;
or &lsquo;<samp><span class="samp">@defunx</span></samp>&rsquo;, depending on whether the first definition is of
a variable or of a procedure.

  <p>Schmooz can figure out whether a definition is of a procedure if
it is of the form:

  <p>&lsquo;<samp><span class="samp">(define (&lt;identifier&gt; &lt;arg&gt; ...) &lt;expression&gt;)</span></samp>&rsquo;

<p class="noindent">or if the left hand side of the definition is some form ending in
a lambda expression.  Obviously, it can be fooled.  In order to
force recognition of a procedure definition, start the documentation
with &lsquo;<samp><span class="samp">@args</span></samp>&rsquo; instead of &lsquo;<samp><span class="samp">@body</span></samp>&rsquo;.  &lsquo;<samp><span class="samp">@args</span></samp>&rsquo; should
be followed by the argument list of the function being defined,
which may be enclosed in parentheses and delimited by whitespace,
(as in Scheme), enclosed in braces and separated by commas, (as
in Texinfo), or consist of the remainder of the line, separated
by whitespace.

  <p>For example:

<pre class="example">     ;;@args arg1 args ...
     ;;@0 takes argument @1 and any number of @2
     (define myfun (some-function-returning-magic))
</pre>
  <p>Will result in:

<pre class="example">     @defun myfun arg1 args @dots{}
     
     @code{myfun} takes argument @var{arg1} and any number of @var{args}
     @end defun
</pre>
  <p>&lsquo;<samp><span class="samp">@args</span></samp>&rsquo; may also be useful for indicating optional arguments
by name.  If &lsquo;<samp><span class="samp">@args</span></samp>&rsquo; occurs inside a schmooz comment section,
rather than at the beginning, then it will generate a &lsquo;<samp><span class="samp">@defunx</span></samp>&rsquo;
line with the arguments supplied.

  <p>If the first at-sign in a schmooz comment is immediately followed by
whitespace, then the comment will be expanded to whatever follows that
whitespace.  If the at-sign is followed by a non-whitespace character
then the at-sign will be included as the first character of the expansion. 
This feature is intended to make it easy to include Texinfo directives
in schmooz comments.

<div class="node">
<a name="Mathematical-Packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Database-Packages">Database Packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Textual-Conversion-Packages">Textual Conversion Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">5 Mathematical Packages</h2>

<ul class="menu">
<li><a accesskey="1" href="#Bit_002dTwiddling">Bit-Twiddling</a>:                'logical
<li><a accesskey="2" href="#Modular-Arithmetic">Modular Arithmetic</a>:           'modular
<li><a accesskey="3" href="#Irrational-Integer-Functions">Irrational Integer Functions</a>
<li><a accesskey="4" href="#Irrational-Real-Functions">Irrational Real Functions</a>
<li><a accesskey="5" href="#Prime-Numbers">Prime Numbers</a>:                'factor
<li><a accesskey="6" href="#Random-Numbers">Random Numbers</a>:               'random
<li><a accesskey="7" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a>:   'dft
<li><a accesskey="8" href="#Cyclic-Checksum">Cyclic Checksum</a>:              'crc
<li><a accesskey="9" href="#Graphing">Graphing</a>
<li><a href="#Solid-Modeling">Solid Modeling</a>:               VRML97
<li><a href="#Color">Color</a>
<li><a href="#Root-Finding">Root Finding</a>:                 'root
<li><a href="#Minimizing">Minimizing</a>:                   'minimize
<li><a href="#The-Limit">The Limit</a>:                    'limit
<li><a href="#Commutative-Rings">Commutative Rings</a>:            'commutative-ring
<li><a href="#Matrix-Algebra">Matrix Algebra</a>:               'determinant
</ul>

<div class="node">
<a name="Bit-Twiddling"></a>
<a name="Bit_002dTwiddling"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Modular-Arithmetic">Modular Arithmetic</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Mathematical-Packages">Mathematical Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.1 Bit-Twiddling</h3>

<p><code>(require 'logical)</code> or <code>(require 'srfi-60)</code>
<a name="index-logical-547"></a><a name="index-srfi_002d60-548"></a>
The bit-twiddling functions are made available through the use of the
<code>logical</code> package.  <code>logical</code> is loaded by inserting
<a name="index-logical-549"></a><code>(require 'logical)</code> before the code that uses these functions. 
These functions behave as though operating on integers in
two's-complement representation.

<h4 class="subsection">5.1.1 Bitwise Operations</h4>

<div class="defun">
&mdash; Function: <b>logand</b><var> n1 <small class="dots">...</small><a name="index-logand-550"></a></var><br>
&mdash; Function: <b>bitwise-and</b><var> n1 <small class="dots">...</small><a name="index-bitwise_002dand-551"></a></var><br>
<blockquote><p>Returns the integer which is the bit-wise AND of the integer
arguments.

       <p>Example:
     <pre class="lisp">          (number-&gt;string (logand #b1100 #b1010) 2)
             &rArr; "1000"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>logior</b><var> n1 <small class="dots">...</small><a name="index-logior-552"></a></var><br>
&mdash; Function: <b>bitwise-ior</b><var> n1 <small class="dots">...</small><a name="index-bitwise_002dior-553"></a></var><br>
<blockquote><p>Returns the integer which is the bit-wise OR of the integer arguments.

       <p>Example:
     <pre class="lisp">          (number-&gt;string (logior #b1100 #b1010) 2)
             &rArr; "1110"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>logxor</b><var> n1 <small class="dots">...</small><a name="index-logxor-554"></a></var><br>
&mdash; Function: <b>bitwise-xor</b><var> n1 <small class="dots">...</small><a name="index-bitwise_002dxor-555"></a></var><br>
<blockquote><p>Returns the integer which is the bit-wise XOR of the integer
arguments.

       <p>Example:
     <pre class="lisp">          (number-&gt;string (logxor #b1100 #b1010) 2)
             &rArr; "110"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>lognot</b><var> n<a name="index-lognot-556"></a></var><br>
&mdash; Function: <b>bitwise-not</b><var> n<a name="index-bitwise_002dnot-557"></a></var><br>
<blockquote><p>Returns the integer which is the one's-complement of the integer
argument.

       <p>Example:
     <pre class="lisp">          (number-&gt;string (lognot #b10000000) 2)
             &rArr; "-10000001"
          (number-&gt;string (lognot #b0) 2)
             &rArr; "-1"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>bitwise-if</b><var> mask n0 n1<a name="index-bitwise_002dif-558"></a></var><br>
&mdash; Function: <b>bitwise-merge</b><var> mask n0 n1<a name="index-bitwise_002dmerge-559"></a></var><br>
<blockquote><p>Returns an integer composed of some bits from integer <var>n0</var> and some
from integer <var>n1</var>.  A bit of the result is taken from <var>n0</var> if the
corresponding bit of integer <var>mask</var> is 1 and from <var>n1</var> if that bit
of <var>mask</var> is 0. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>logtest</b><var> j k<a name="index-logtest-560"></a></var><br>
&mdash; Function: <b>any-bits-set?</b><var> j k<a name="index-any_002dbits_002dset_003f-561"></a></var><br>
<blockquote><pre class="example">          (logtest j k) == (not (zero? (logand j k)))
          
          (logtest #b0100 #b1011) &rArr; #f
          (logtest #b0100 #b0111) &rArr; #t
</pre>
       </blockquote></div>

<h4 class="subsection">5.1.2 Integer Properties</h4>

<div class="defun">
&mdash; Function: <b>logcount</b><var> n<a name="index-logcount-562"></a></var><br>
<blockquote><p>Returns the number of bits in integer <var>n</var>.  If integer is positive,
the 1-bits in its binary representation are counted.  If negative, the
0-bits in its two's-complement binary representation are counted.  If 0,
0 is returned.

       <p>Example:
     <pre class="lisp">          (logcount #b10101010)
             &rArr; 4
          (logcount 0)
             &rArr; 0
          (logcount -2)
             &rArr; 1
</pre>
       </blockquote></div>

<p class="noindent">On <code>discuss@r6rs.org</code> Ben Harris credits Simon Tatham with the
idea to have <code>bitwise-bit-count</code> return a negative count for
negative inputs.  Alan Bawden came up with the succinct invariant.

<div class="defun">
&mdash; Function: <b>bitwise-bit-count</b><var> n<a name="index-bitwise_002dbit_002dcount-563"></a></var><br>
<blockquote><p>If <var>n</var> is non-negative, this procedure returns the number of 1
bits in the two's-complement representation of <var>n</var>.  Otherwise it
returns the result of the following computation:

     <pre class="lisp">          (bitwise-not (bitwise-bit-count (bitwise-not <var>n</var>)))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-length</b><var> n<a name="index-integer_002dlength-564"></a></var><br>
<blockquote><p>Returns the number of bits neccessary to represent <var>n</var>.

       <p>Example:
     <pre class="lisp">          (integer-length #b10101010)
             &rArr; 8
          (integer-length 0)
             &rArr; 0
          (integer-length #b1111)
             &rArr; 4
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>log2-binary-factors</b><var> n<a name="index-log2_002dbinary_002dfactors-565"></a></var><br>
&mdash; Function: <b>first-set-bit</b><var> n<a name="index-first_002dset_002dbit-566"></a></var><br>
<blockquote><p>Returns the number of factors of two of integer <var>n</var>.  This value
is also the bit-index of the least-significant &lsquo;<samp><span class="samp">1</span></samp>&rsquo; bit in
<var>n</var>.

     <pre class="lisp">          (require 'printf)
          (do ((idx 0 (+ 1 idx)))
                ((&gt; idx 16))
              (printf "%s(%3d) ==&gt; %-5d %s(%2d) ==&gt; %-5d\n"
                      'log2-binary-factors
                      (- idx) (log2-binary-factors (- idx))
                      'log2-binary-factors
                      idx (log2-binary-factors idx)))
          -|
          log2-binary-factors(  0) ==&gt; -1    log2-binary-factors( 0) ==&gt; -1
          log2-binary-factors( -1) ==&gt; 0     log2-binary-factors( 1) ==&gt; 0
          log2-binary-factors( -2) ==&gt; 1     log2-binary-factors( 2) ==&gt; 1
          log2-binary-factors( -3) ==&gt; 0     log2-binary-factors( 3) ==&gt; 0
          log2-binary-factors( -4) ==&gt; 2     log2-binary-factors( 4) ==&gt; 2
          log2-binary-factors( -5) ==&gt; 0     log2-binary-factors( 5) ==&gt; 0
          log2-binary-factors( -6) ==&gt; 1     log2-binary-factors( 6) ==&gt; 1
          log2-binary-factors( -7) ==&gt; 0     log2-binary-factors( 7) ==&gt; 0
          log2-binary-factors( -8) ==&gt; 3     log2-binary-factors( 8) ==&gt; 3
          log2-binary-factors( -9) ==&gt; 0     log2-binary-factors( 9) ==&gt; 0
          log2-binary-factors(-10) ==&gt; 1     log2-binary-factors(10) ==&gt; 1
          log2-binary-factors(-11) ==&gt; 0     log2-binary-factors(11) ==&gt; 0
          log2-binary-factors(-12) ==&gt; 2     log2-binary-factors(12) ==&gt; 2
          log2-binary-factors(-13) ==&gt; 0     log2-binary-factors(13) ==&gt; 0
          log2-binary-factors(-14) ==&gt; 1     log2-binary-factors(14) ==&gt; 1
          log2-binary-factors(-15) ==&gt; 0     log2-binary-factors(15) ==&gt; 0
          log2-binary-factors(-16) ==&gt; 4     log2-binary-factors(16) ==&gt; 4
</pre>
       </blockquote></div>

<h4 class="subsection">5.1.3 Bit Within Word</h4>

<div class="defun">
&mdash; Function: <b>logbit?</b><var> index n<a name="index-logbit_003f-567"></a></var><br>
&mdash; Function: <b>bit-set?</b><var> index n<a name="index-bit_002dset_003f-568"></a></var><br>
<blockquote><pre class="example">          (logbit? index n) == (logtest (expt 2 index) n)
          
          (logbit? 0 #b1101) &rArr; #t
          (logbit? 1 #b1101) &rArr; #f
          (logbit? 2 #b1101) &rArr; #t
          (logbit? 3 #b1101) &rArr; #t
          (logbit? 4 #b1101) &rArr; #f
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>copy-bit</b><var> index from bit<a name="index-copy_002dbit-569"></a></var><br>
<blockquote><p>Returns an integer the same as <var>from</var> except in the <var>index</var>th bit,
which is 1 if <var>bit</var> is <code>#t</code> and 0 if <var>bit</var> is <code>#f</code>.

       <p>Example:
     <pre class="example">          (number-&gt;string (copy-bit 0 0 #t) 2)       &rArr; "1"
          (number-&gt;string (copy-bit 2 0 #t) 2)       &rArr; "100"
          (number-&gt;string (copy-bit 2 #b1111 #f) 2)  &rArr; "1011"
</pre>
       </blockquote></div>

<h4 class="subsection">5.1.4 Field of Bits</h4>

<div class="defun">
&mdash; Function: <b>bit-field</b><var> n start end<a name="index-bit_002dfield-570"></a></var><br>
<blockquote><p>Returns the integer composed of the <var>start</var> (inclusive) through
<var>end</var> (exclusive) bits of <var>n</var>.  The <var>start</var>th bit becomes
the 0-th bit in the result.

       <p>Example:
     <pre class="lisp">          (number-&gt;string (bit-field #b1101101010 0 4) 2)
             &rArr; "1010"
          (number-&gt;string (bit-field #b1101101010 4 9) 2)
             &rArr; "10110"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>copy-bit-field</b><var> to from start end<a name="index-copy_002dbit_002dfield-571"></a></var><br>
<blockquote><p>Returns an integer the same as <var>to</var> except possibly in the
<var>start</var> (inclusive) through <var>end</var> (exclusive) bits, which are
the same as those of <var>from</var>.  The 0-th bit of <var>from</var> becomes the
<var>start</var>th bit of the result.

       <p>Example:
     <pre class="example">          (number-&gt;string (copy-bit-field #b1101101010 0 0 4) 2)
                  &rArr; "1101100000"
          (number-&gt;string (copy-bit-field #b1101101010 -1 0 4) 2)
                  &rArr; "1101101111"
          (number-&gt;string (copy-bit-field #b110100100010000 -1 5 9) 2)
                  &rArr; "110100111110000"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>ash</b><var> n count<a name="index-ash-572"></a></var><br>
&mdash; Function: <b>arithmetic-shift</b><var> n count<a name="index-arithmetic_002dshift-573"></a></var><br>
<blockquote><p>Returns an integer equivalent to
<code>(inexact-&gt;exact (floor (* </code><var>n</var><code> (expt 2 </code><var>count</var><code>))))</code>.

       <p>Example:
     <pre class="lisp">          (number-&gt;string (ash #b1 3) 2)
             &rArr; "1000"
          (number-&gt;string (ash #b1010 -1) 2)
             &rArr; "101"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>rotate-bit-field</b><var> n count start end<a name="index-rotate_002dbit_002dfield-574"></a></var><br>
<blockquote><p>Returns <var>n</var> with the bit-field from <var>start</var> to <var>end</var>
cyclically permuted by <var>count</var> bits towards high-order.

       <p>Example:
     <pre class="lisp">          (number-&gt;string (rotate-bit-field #b0100 3 0 4) 2)
              &rArr; "10"
          (number-&gt;string (rotate-bit-field #b0100 -1 0 4) 2)
              &rArr; "10"
          (number-&gt;string (rotate-bit-field #b110100100010000 -1 5 9) 2)
              &rArr; "110100010010000"
          (number-&gt;string (rotate-bit-field #b110100100010000 1 5 9) 2)
              &rArr; "110100000110000"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>reverse-bit-field</b><var> n start end<a name="index-reverse_002dbit_002dfield-575"></a></var><br>
<blockquote><p>Returns <var>n</var> with the order of bits <var>start</var> to <var>end</var>
reversed.

     <pre class="example">          (number-&gt;string (reverse-bit-field #xa7 0 8) 16)
            &rArr; "e5"
</pre>
       </blockquote></div>

<h4 class="subsection">5.1.5 Bits as Booleans</h4>

<div class="defun">
&mdash; Function: <b>integer-&gt;list</b><var> k len<a name="index-integer_002d_003elist-576"></a></var><br>
&mdash; Function: <b>integer-&gt;list</b><var> k<a name="index-integer_002d_003elist-577"></a></var><br>
<blockquote><p><code>integer-&gt;list</code> returns a list of <var>len</var> booleans
corresponding to each bit of the non-negative integer <var>k</var>.  #t is
coded for each 1; #f for 0.  The <var>len</var> argument defaults to
<code>(integer-length </code><var>k</var><code>)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>list-&gt;integer</b><var> list<a name="index-list_002d_003einteger-578"></a></var><br>
<blockquote><p><code>list-&gt;integer</code> returns an integer formed from the booleans in the
list <var>list</var>, which must be a list of booleans.  A 1 bit is coded for
each #t; a 0 bit for #f.

     <pre class="example">          (list-&gt;integer (integer-&gt;list <var>k</var>))  &rArr;  <var>k</var>
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>booleans-&gt;integer</b><var> bool1 <small class="dots">...</small><a name="index-booleans_002d_003einteger-579"></a></var><br>
<blockquote><p>Returns the integer coded by the <var>bool1</var> <small class="dots">...</small> arguments. 
</p></blockquote></div>

<div class="node">
<a name="Modular-Arithmetic"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Irrational-Integer-Functions">Irrational Integer Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bit_002dTwiddling">Bit-Twiddling</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.2 Modular Arithmetic</h3>

<p><code>(require 'modular)</code>
<a name="index-modular-580"></a>

<div class="defun">
&mdash; Function: <b>extended-euclid</b><var> n1 n2<a name="index-extended_002deuclid-581"></a></var><br>
<blockquote>
       <p>Returns a list of 3 integers <code>(d x y)</code> such that d = gcd(<var>n1</var>,
<var>n2</var>) = <var>n1</var> * x + <var>n2</var> * y. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>symmetric:modulus</b><var> m<a name="index-symmetric_003amodulus-582"></a></var><br>
<blockquote>
       <p>For odd positive integer <var>m</var>, returns an object suitable for passing
as the first argument to <code>modular:</code> procedures, directing them
to return a symmetric modular number, ie. an <var>n</var> such that
     <pre class="example">          (&lt;= (quotient <var>m</var> -2) <var>n</var> (quotient <var>m</var> 2)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:characteristic</b><var> modulus<a name="index-modular_003acharacteristic-583"></a></var><br>
<blockquote>
       <p>Returns the non-negative integer characteristic of the ring formed when
<var>modulus</var> is used with <code>modular:</code> procedures. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:normalize</b><var> modulus n<a name="index-modular_003anormalize-584"></a></var><br>
<blockquote>
       <p>Returns the integer <code>(modulo </code><var>n</var><code> (modular:characteristic
</code><var>modulus</var><code>))</code> in the representation specified by <var>modulus</var>. 
</p></blockquote></div>

<p class="noindent">The rest of these functions assume normalized arguments; That is, the
arguments are constrained by the following table:

<p class="noindent">For all of these functions, if the first argument (<var>modulus</var>) is:
     <dl>
<dt><code>positive?</code><dd>Integers mod <var>modulus</var>.  The result is between 0 and
<var>modulus</var>.

     <br><dt><code>zero?</code><dd>The arguments are treated as integers.  An integer is returned. 
</dl>

<p class="noindent">Otherwise, if <var>modulus</var> is a value returned by
<code>(symmetric:modulus </code><var>radix</var><code>)</code>, then the arguments and
result are treated as members of the integers modulo <var>radix</var>,
but with <dfn>symmetric</dfn> representation; i.e. 
<a name="index-symmetric-585"></a>
<pre class="example">     (&lt;= (quotient <var>radix</var> 2) <var>n</var> (quotient (- -1 <var>radix</var>) 2)
</pre>
  <p class="noindent">If all the arguments are fixnums the computation will use only fixnums.

<div class="defun">
&mdash; Function: <b>modular:invertable?</b><var> modulus k<a name="index-modular_003ainvertable_003f-586"></a></var><br>
<blockquote>
       <p>Returns <code>#t</code> if there exists an integer n such that <var>k</var> * n
== 1 mod <var>modulus</var>, and <code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:invert</b><var> modulus n2<a name="index-modular_003ainvert-587"></a></var><br>
<blockquote>
       <p>Returns an integer n such that 1 = (n * <var>n2</var>) mod <var>modulus</var>.  If
<var>n2</var> has no inverse mod <var>modulus</var> an error is signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:negate</b><var> modulus n2<a name="index-modular_003anegate-588"></a></var><br>
<blockquote>
       <p>Returns (&minus;<var>n2</var>) mod <var>modulus</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:+</b><var> modulus n2 n3<a name="index-modular_003a_002b-589"></a></var><br>
<blockquote>
       <p>Returns (<var>n2</var> + <var>n3</var>) mod <var>modulus</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:-</b><var> modulus n2 n3<a name="index-modular_003a_002d-590"></a></var><br>
<blockquote>
       <p>Returns (<var>n2</var> &minus; <var>n3</var>) mod <var>modulus</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:*</b><var> modulus n2 n3<a name="index-modular_003a_002a-591"></a></var><br>
<blockquote>
       <p>Returns (<var>n2</var> * <var>n3</var>) mod <var>modulus</var>.

       <p>The Scheme code for <code>modular:*</code> with negative <var>modulus</var> is
not completed for fixnum-only implementations. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>modular:expt</b><var> modulus n2 n3<a name="index-modular_003aexpt-592"></a></var><br>
<blockquote>
       <p>Returns (<var>n2</var> ^ <var>n3</var>) mod <var>modulus</var>. 
</p></blockquote></div>

<div class="node">
<a name="Irrational-Integer-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Irrational-Real-Functions">Irrational Real Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Modular-Arithmetic">Modular Arithmetic</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.3 Irrational Integer Functions</h3>

<p><code>(require 'math-integer)</code>
<a name="index-math_002dinteger-593"></a>

<div class="defun">
&mdash; Function: <b>integer-expt</b><var> n1 n2<a name="index-integer_002dexpt-594"></a></var><br>
<blockquote>
       <p>Returns <var>n1</var> raised to the power <var>n2</var> if that result is an exact
integer; otherwise signals an error.

       <p><code>(integer-expt 0 </code><var>n2</var><code>)</code>

       <p>returns 1 for <var>n2</var> equal to 0;
returns 0 for positive integer <var>n2</var>;
signals an error otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-log</b><var> base k<a name="index-integer_002dlog-595"></a></var><br>
<blockquote>
       <p>Returns the largest exact integer whose power of <var>base</var> is less than or
equal to <var>k</var>. If <var>base</var> or <var>k</var> is not a positive exact integer, then
<code>integer-log</code> signals an error. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-sqrt</b><var> k<a name="index-integer_002dsqrt-596"></a></var><br>
<blockquote>
       <p>For non-negative integer <var>k</var> returns the largest integer whose square
is less than or equal to <var>k</var>; otherwise signals an error. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>quotient</b><var> n1 n2<a name="index-quotient-597"></a></var><br>

  &mdash; Function: <b>remainder</b><var> n1 n2<a name="index-remainder-598"></a></var><br>
&mdash; Function: <b>modulo</b><var> n1 n2<a name="index-modulo-599"></a></var><br>
<blockquote><p>are redefined so that they accept only exact-integer arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>round-quotient</b><var> n1 n2<a name="index-round_002dquotient-600"></a></var><br>
<blockquote>
       <p>Returns the quotient of <var>n1</var> and <var>n2</var> rounded toward even.

     <pre class="example">          (quotient 3 2)        &rArr; 1
          (round-quotient 3 2)  &rArr; 2
</pre>
       </blockquote></div>

<div class="node">
<a name="Irrational-Real-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Prime-Numbers">Prime Numbers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Irrational-Integer-Functions">Irrational Integer Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.4 Irrational Real Functions</h3>

<p><code>(require 'math-real)</code>
<a name="index-math_002dreal-601"></a>
Although this package defines real and complex functions, it is safe
to load into an integer-only implementation; those functions will be
defined to #f.

<div class="defun">
&mdash; Function: <b>real-exp</b><var> x<a name="index-real_002dexp-602"></a></var><br>
&mdash; Function: <b>real-ln</b><var> x<a name="index-real_002dln-603"></a></var><br>
&mdash; Function: <b>real-log</b><var> y x<a name="index-real_002dlog-604"></a></var><br>
&mdash; Function: <b>real-sin</b><var> x<a name="index-real_002dsin-605"></a></var><br>
&mdash; Function: <b>real-cos</b><var> x<a name="index-real_002dcos-606"></a></var><br>
&mdash; Function: <b>real-tan</b><var> x<a name="index-real_002dtan-607"></a></var><br>
&mdash; Function: <b>real-asin</b><var> x<a name="index-real_002dasin-608"></a></var><br>
&mdash; Function: <b>real-acos</b><var> x<a name="index-real_002dacos-609"></a></var><br>
&mdash; Function: <b>real-atan</b><var> x<a name="index-real_002datan-610"></a></var><br>
&mdash; Function: <b>atan</b><var> y x<a name="index-atan-611"></a></var><br>
<blockquote>
       <p>These procedures are part of every implementation that supports
general real numbers; they compute the usual transcendental functions. 
&lsquo;<samp><span class="samp">real-ln</span></samp>&rsquo; computes the natural logarithm of <var>x</var>;
&lsquo;<samp><span class="samp">real-log</span></samp>&rsquo; computes the logarithm of <var>x</var> base <var>y</var>, which
is <code>(/ (real-ln x) (real-ln y))</code>.  If arguments <var>x</var> and
<var>y</var> are not both real; or if the correct result would not be real,
then these procedures signal an error.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>real-sqrt</b><var> x<a name="index-real_002dsqrt-612"></a></var><br>
<blockquote>
       <p>For non-negative real <var>x</var> the result will be its positive square
root; otherwise an error will be signaled.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>real-expt</b><var> x1 x2<a name="index-real_002dexpt-613"></a></var><br>
<blockquote>
       <p>Returns <var>x1</var> raised to the power <var>x2</var> if that result is a real
number; otherwise signals an error.

       <p><code>(real-expt 0.0 </code><var>x2</var><code>)</code>

          <ul>
<li>returns 1.0 for <var>x2</var> equal to 0.0;
<li>returns 0.0 for positive real <var>x2</var>;
<li>signals an error otherwise. 
</ul>

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>quo</b><var> x1 x2<a name="index-quo-614"></a></var><br>
&mdash; Function: <b>rem</b><var> x1 x2<a name="index-rem-615"></a></var><br>
&mdash; Function: <b>mod</b><var> x1 x2<a name="index-mod-616"></a></var><br>
<blockquote>
       <p><var>x2</var> should be non-zero.

     <pre class="example">              (quo <var>x1</var> <var>x2</var>)                     ==&gt; <var>n_q</var>
              (rem <var>x1</var> <var>x2</var>)                     ==&gt; <var>x_r</var>
              (mod <var>x1</var> <var>x2</var>)                     ==&gt; <var>x_m</var>
</pre>
       <p>where <var>n_q</var> is <var>x1</var>/<var>x2</var> rounded towards zero,
0 &lt; |<var>x_r</var>| &lt; |<var>x2</var>|, 0 &lt; |<var>x_m</var>| &lt; |<var>x2</var>|, <var>x_r</var>
and <var>x_m</var> differ from <var>x1</var> by a multiple of <var>x2</var>,
<var>x_r</var> has the same sign as <var>x1</var>, and <var>x_m</var> has the same
sign as <var>x2</var>.

       <p>From this we can conclude that for <var>x2</var> not equal to 0,

     <pre class="example">               (= <var>x1</var> (+ (* <var>x2</var> (quo <var>x1</var> <var>x2</var>))
                     (rem <var>x1</var> <var>x2</var>)))
                                                 ==&gt;  #t
</pre>
       <p>provided all numbers involved in that computation are exact.

     <pre class="example">              (quo 2/3 1/5)                         ==&gt;  3
              (mod 2/3 1/5)                         ==&gt;  1/15
          
              (quo .666 1/5)                        ==&gt;  3.0
              (mod .666 1/5)                        ==&gt;  65.99999999999995e-3
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>ln</b><var> z<a name="index-ln-617"></a></var><br>
<blockquote>
       <p>These procedures are part of every implementation that supports
general real numbers. 
&lsquo;<samp><span class="samp">Ln</span></samp>&rsquo; computes the natural logarithm of <var>z</var>

       <p>In general, the mathematical function ln is multiply defined.  The
value of ln <var>z</var> is defined to be the one whose imaginary part lies
in the range from -pi (exclusive) to pi (inclusive).

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>abs</b><var> x<a name="index-abs-618"></a></var><br>
<blockquote>
       <p>For real argument <var>x</var>, &lsquo;<samp><span class="samp">Abs</span></samp>&rsquo; returns the absolute value of
<var>x</var>' otherwise it signals an error.

     <pre class="format"><tt>(abs -7)                               ==&gt;  7
     </tt>
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>make-rectangular</b><var> x1 x2<a name="index-make_002drectangular-619"></a></var><br>
&mdash; Function: <b>make-polar</b><var> x3 x4<a name="index-make_002dpolar-620"></a></var><br>
<blockquote>
       <p>These procedures are part of every implementation that supports
general complex numbers.  Suppose <var>x1</var>, <var>x2</var>, <var>x3</var>, and
<var>x4</var> are real numbers and <var>z</var> is a complex number such that

     <div align="center"><var>z</var> = <var>x1</var> + <var>x2</var>i<!-- /@w --> = <var>x3</var> . e^i<!-- /@w --> <var>x4</var></div>

       <p>Then

     <pre class="format"><tt>(make-rectangular </tt><var>x1</var> <var>x2</var><tt>)               ==&gt; </tt><var>z</var><tt>
     (make-polar </tt><var>x3</var> <var>x4</var><tt>)                     ==&gt; </tt><var>z</var>
     
</pre>
       <p>where -pi &lt; x_angle &lt;= pi with x_angle = <var>x4</var> + 2pi n
for some integer n.

       <p>If an argument is not real, then these procedures signal an error.

       </blockquote></div>

<div class="node">
<a name="Prime-Numbers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Random-Numbers">Random Numbers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Irrational-Real-Functions">Irrational Real Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.5 Prime Numbers</h3>

<p><code>(require 'factor)</code>
<a name="index-factor-621"></a><a name="index-primes-622"></a>

<div class="defun">
&mdash; Variable: <b>prime:prngs</b><var><a name="index-prime_003aprngs-623"></a></var><br>
<blockquote>
       <p><var>prime:prngs</var> is the random-state (see <a href="#Random-Numbers">Random Numbers</a>) used by these
procedures.  If you call these procedures from more than one thread
(or from interrupt), <code>random</code> may complain about reentrant
calls. 
</p></blockquote></div>
  <em>Note:</em> The prime test and generation procedures implement (or
use) the Solovay-Strassen primality test. See

     <ul>
<li>Robert Solovay and Volker Strassen,
<cite>A Fast Monte-Carlo Test for Primality</cite>,
SIAM Journal on Computing, 1977, pp 84-85. 
</ul>

<div class="defun">
&mdash; Function: <b>jacobi-symbol</b><var> p q<a name="index-jacobi_002dsymbol-624"></a></var><br>
<blockquote>
       <p>Returns the value (+1, &minus;1, or 0) of the Jacobi-Symbol of
exact non-negative integer <var>p</var> and exact positive odd integer <var>q</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>prime:trials</b><var><a name="index-prime_003atrials-625"></a></var><br>
<blockquote>
       <p><var>prime:trials</var> the maxinum number of iterations of Solovay-Strassen that will
be done to test a number for primality. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>prime?</b><var> n<a name="index-prime_003f-626"></a></var><br>
<blockquote>
       <p>Returns <code>#f</code> if <var>n</var> is composite; <code>#t</code> if <var>n</var> is prime. 
There is a slight chance <code>(expt 2 (- prime:trials))</code> that a
composite will return <code>#t</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>primes&lt;</b><var> start count<a name="index-primes_003c-627"></a></var><br>
<blockquote>
       <p>Returns a list of the first <var>count</var> prime numbers less than
<var>start</var>.  If there are fewer than <var>count</var> prime numbers
less than <var>start</var>, then the returned list will have fewer than
<var>start</var> elements. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>primes&gt;</b><var> start count<a name="index-primes_003e-628"></a></var><br>
<blockquote>
       <p>Returns a list of the first <var>count</var> prime numbers greater than <var>start</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>factor</b><var> k<a name="index-factor-629"></a></var><br>
<blockquote>
       <p>Returns a list of the prime factors of <var>k</var>.  The order of the
factors is unspecified.  In order to obtain a sorted list do
<code>(sort! (factor </code><var>k</var><code>) &lt;)</code>. 
</p></blockquote></div>

<div class="node">
<a name="Random-Numbers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Prime-Numbers">Prime Numbers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.6 Random Numbers</h3>

<p><a name="index-RNG-630"></a><a name="index-PRNG-631"></a>A pseudo-random number generator is only as good as the tests it passes. 
George Marsaglia of Florida State University developed a battery of
tests named <dfn>DIEHARD</dfn> (<a href="http://stat.fsu.edu/~geo/diehard.html">http://stat.fsu.edu/~geo/diehard.html</a>). 
<samp><span class="file">diehard.c</span></samp> has a bug which the patch
<a href="http://groups.csail.mit.edu/mac/ftpdir/users/jaffer/diehard.c.pat">http://groups.csail.mit.edu/mac/ftpdir/users/jaffer/diehard.c.pat</a> corrects.

  <p>SLIB's PRNG generates 8 bits at a time.  With the degenerate seed
&lsquo;<samp><span class="samp">0</span></samp>&rsquo;, the numbers generated pass DIEHARD; but when bits are
combined from sequential bytes, tests fail.  With the seed
&lsquo;<samp><span class="samp">http://swissnet.ai.mit.edu/~jaffer/SLIB.html</span></samp>&rsquo;, all of those
tests pass.

<ul class="menu">
<li><a accesskey="1" href="#Exact-Random-Numbers">Exact Random Numbers</a>:         'random
<li><a accesskey="2" href="#Inexact-Random-Numbers">Inexact Random Numbers</a>:       'random-inexact
</ul>

<div class="node">
<a name="Exact-Random-Numbers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Inexact-Random-Numbers">Inexact Random Numbers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Random-Numbers">Random Numbers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Random-Numbers">Random Numbers</a>

</div>

<h4 class="subsection">5.6.1 Exact Random Numbers</h4>

<p><code>(require 'random)</code>
<a name="index-random-632"></a>

<div class="defun">
&mdash; Function: <b>random</b><var> n state<a name="index-random-633"></a></var><br>

  &mdash; Function: <b>random</b><var> n<a name="index-random-634"></a></var><br>
<blockquote>
       <p><var>n</var> must be an exact positive integer.  <code>random</code> returns an exact integer
between zero (inclusive) and <var>n</var> (exclusive).  The values returned by
<code>random</code> are uniformly distributed from 0 to <var>n</var>.

       <p>The optional argument <var>state</var> must be of the type returned by
<code>(seed-&gt;random-state)</code> or <code>(make-random-state)</code>.  It
defaults to the value of the variable <code>*random-state*</code>.  This
object is used to maintain the state of the pseudo-random-number
generator and is altered as a side effect of calls to <code>random</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>*random-state*</b><var><a name="index-g_t_002arandom_002dstate_002a-635"></a></var><br>
<blockquote><p>Holds a data structure that encodes the internal state of the
random-number generator that <code>random</code> uses by default.  The nature
of this data structure is implementation-dependent.  It may be printed
out and successfully read back in, but may or may not function correctly
as a random-number state object in another implementation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>copy-random-state</b><var> state<a name="index-copy_002drandom_002dstate-636"></a></var><br>
<blockquote>
       <p>Returns a new copy of argument <var>state</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>copy-random-state</b><var><a name="index-copy_002drandom_002dstate-637"></a></var><br>
<blockquote><p>Returns a new copy of <code>*random-state*</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>seed-&gt;random-state</b><var> seed<a name="index-seed_002d_003erandom_002dstate-638"></a></var><br>
<blockquote>
       <p>Returns a new object of type suitable for use as the value of the
variable <code>*random-state*</code> or as a second argument to <code>random</code>. 
The number or string <var>seed</var> is used to initialize the state.  If
<code>seed-&gt;random-state</code> is called twice with arguments which are
<code>equal?</code>, then the returned data structures will be <code>equal?</code>. 
Calling <code>seed-&gt;random-state</code> with unequal arguments will nearly
always return unequal states. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-random-state</b><var><a name="index-make_002drandom_002dstate-639"></a></var><br>

  &mdash; Function: <b>make-random-state</b><var> obj<a name="index-make_002drandom_002dstate-640"></a></var><br>
<blockquote><p>Returns a new object of type suitable for use as the value of the
variable <code>*random-state*</code> or as a second argument to <code>random</code>. 
If the optional argument <var>obj</var> is given, it should be a printable
Scheme object; the first 50 characters of its printed representation
will be used as the seed.  Otherwise the value of <code>*random-state*</code>
is used as the seed. 
</p></blockquote></div>

<div class="node">
<a name="Inexact-Random-Numbers"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Exact-Random-Numbers">Exact Random Numbers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Random-Numbers">Random Numbers</a>

</div>

<h4 class="subsection">5.6.2 Inexact Random Numbers</h4>

<p><code>(require 'random-inexact)</code>
<a name="index-random_002dinexact-641"></a>

<div class="defun">
&mdash; Function: <b>random:uniform</b><var><a name="index-random_003auniform-642"></a></var><br>

  &mdash; Function: <b>random:uniform</b><var> state<a name="index-random_003auniform-643"></a></var><br>
<blockquote><p>Returns an uniformly distributed inexact real random number in the
range between 0 and 1. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>random:exp</b><var><a name="index-random_003aexp-644"></a></var><br>

  &mdash; Function: <b>random:exp</b><var> state<a name="index-random_003aexp-645"></a></var><br>
<blockquote><p>Returns an inexact real in an exponential distribution with mean 1.  For
an exponential distribution with mean <var>u</var> use
<code>(*&nbsp;</code><var>u</var><code>&nbsp;(random:exp))</code><!-- /@w -->. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>random:normal</b><var><a name="index-random_003anormal-646"></a></var><br>

  &mdash; Function: <b>random:normal</b><var> state<a name="index-random_003anormal-647"></a></var><br>
<blockquote><p>Returns an inexact real in a normal distribution with mean 0 and
standard deviation 1.  For a normal distribution with mean <var>m</var> and
standard deviation <var>d</var> use
<code>(+&nbsp;</code><var>m</var><code>&nbsp;(*&nbsp;</code><var>d</var><code>&nbsp;(random:normal)))</code><!-- /@w -->. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>random:normal-vector!</b><var> vect<a name="index-random_003anormal_002dvector_0021-648"></a></var><br>

  &mdash; Procedure: <b>random:normal-vector!</b><var> vect state<a name="index-random_003anormal_002dvector_0021-649"></a></var><br>
<blockquote><p>Fills <var>vect</var> with inexact real random numbers which are independent
and standard normally distributed (i.e., with mean 0 and variance 1). 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>random:hollow-sphere!</b><var> vect<a name="index-random_003ahollow_002dsphere_0021-650"></a></var><br>

  &mdash; Procedure: <b>random:hollow-sphere!</b><var> vect state<a name="index-random_003ahollow_002dsphere_0021-651"></a></var><br>
<blockquote><p>Fills <var>vect</var> with inexact real random numbers the sum of whose
squares is equal to 1.0.  Thinking of <var>vect</var> as coordinates in space
of dimension n = <code>(vector-length </code><var>vect</var><code>)</code>, the coordinates are
uniformly distributed over the surface of the unit n-shere. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>random:solid-sphere!</b><var> vect<a name="index-random_003asolid_002dsphere_0021-652"></a></var><br>

  &mdash; Procedure: <b>random:solid-sphere!</b><var> vect state<a name="index-random_003asolid_002dsphere_0021-653"></a></var><br>
<blockquote><p>Fills <var>vect</var> with inexact real random numbers the sum of whose
squares is less than 1.0.  Thinking of <var>vect</var> as coordinates in
space of dimension <var>n</var> = <code>(vector-length </code><var>vect</var><code>)</code>, the
coordinates are uniformly distributed within the unit <var>n</var>-shere. 
The sum of the squares of the numbers is returned. 
</p></blockquote></div>

<div class="node">
<a name="Discrete-Fourier-Transform"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cyclic-Checksum">Cyclic Checksum</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Random-Numbers">Random Numbers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.7 Discrete Fourier Transform</h3>

<p><code>(require 'dft)</code> or
<code>(require 'Fourier-transform)</code>
<a name="index-dft_002c-Fourier_002dtransform-654"></a>
<code>fft</code> and <code>fft-1</code> compute the Fast-Fourier-Transforms
(O(n*log(n))) of arrays whose dimensions are all powers of 2.

  <p><code>sft</code> and <code>sft-1</code> compute the Discrete-Fourier-Transforms
for all combinations of dimensions (O(n^2)).

<div class="defun">
&mdash; Function: <b>sft</b><var> array prot<a name="index-sft-655"></a></var><br>

  &mdash; Function: <b>sft</b><var> array<a name="index-sft-656"></a></var><br>
<blockquote><p><var>array</var> is an array of positive rank.  <code>sft</code> returns an
array of type <var>prot</var> (defaulting to <var>array</var>) of complex numbers comprising
the <dfn>Discrete Fourier Transform</dfn> of <var>array</var>. 
<a name="index-Discrete-Fourier-Transform-657"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sft-1</b><var> array prot<a name="index-sft_002d1-658"></a></var><br>

  &mdash; Function: <b>sft-1</b><var> array<a name="index-sft_002d1-659"></a></var><br>
<blockquote><p><var>array</var> is an array of positive rank.  <code>sft-1</code> returns an
array of type <var>prot</var> (defaulting to <var>array</var>) of complex numbers comprising
the inverse Discrete Fourier Transform of <var>array</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fft</b><var> array prot<a name="index-fft-660"></a></var><br>

  &mdash; Function: <b>fft</b><var> array<a name="index-fft-661"></a></var><br>
<blockquote><p><var>array</var> is an array of positive rank whose dimensions are all
powers of 2.  <code>fft</code> returns an array of type <var>prot</var> (defaulting to
<var>array</var>) of complex numbers comprising the Discrete Fourier Transform of
<var>array</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fft-1</b><var> array prot<a name="index-fft_002d1-662"></a></var><br>

  &mdash; Function: <b>fft-1</b><var> array<a name="index-fft_002d1-663"></a></var><br>
<blockquote><p><var>array</var> is an array of positive rank whose dimensions are all
powers of 2.  <code>fft-1</code> returns an array of type <var>prot</var> (defaulting
to <var>array</var>) of complex numbers comprising the inverse Discrete Fourier
Transform of <var>array</var>. 
</p></blockquote></div>

  <p><code>dft</code> and <code>dft-1</code> compute the discrete Fourier transforms
using the best method for decimating each dimension.

<div class="defun">
&mdash; Function: <b>dft</b><var> array prot<a name="index-dft-664"></a></var><br>

  &mdash; Function: <b>dft</b><var> array<a name="index-dft-665"></a></var><br>
<blockquote><p><code>dft</code> returns an array of type <var>prot</var> (defaulting to <var>array</var>) of complex
numbers comprising the Discrete Fourier Transform of <var>array</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>dft-1</b><var> array prot<a name="index-dft_002d1-666"></a></var><br>

  &mdash; Function: <b>dft-1</b><var> array<a name="index-dft_002d1-667"></a></var><br>
<blockquote><p><code>dft-1</code> returns an array of type <var>prot</var> (defaulting to <var>array</var>) of
complex numbers comprising the inverse Discrete Fourier Transform of
<var>array</var>. 
</p></blockquote></div>

<p class="noindent"><code>(fft-1 (fft </code><var>array</var><code>))</code> will return an array of values close to
<var>array</var>.

<pre class="example">     (fft '#(1 0+i -1 0-i 1 0+i -1 0-i)) &rArr;
     
     #(0.0 0.0 0.0+628.0783185208527e-18i 0.0
       0.0 0.0 8.0-628.0783185208527e-18i 0.0)
     
     (fft-1 '#(0 0 0 0 0 0 8 0)) &rArr;
     
     #(1.0 -61.23031769111886e-18+1.0i -1.0 61.23031769111886e-18-1.0i
       1.0 -61.23031769111886e-18+1.0i -1.0 61.23031769111886e-18-1.0i)
</pre>
  <div class="node">
<a name="Cyclic-Checksum"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Graphing">Graphing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.8 Cyclic Checksum</h3>

<p><code>(require 'crc)</code>
<a name="index-crc-668"></a>Cyclic Redundancy Checks using Galois field GF(2) polynomial
arithmetic are used for error detection in many data transmission
and storage applications.

<p class="noindent">The generator polynomials for various CRC protocols are availble
from many sources.  But the polynomial is just one of many
parameters which must match in order for a CRC implementation to
interoperate with existing systems:

     <ul>
<li>the byte-order and bit-order of the data stream;

     <li>whether the CRC or its inverse is being calculated;

     <li>the initial CRC value; and

     <li>whether and where the CRC value is appended (inverted
or non-inverted) to the data stream.

  </ul>

<p class="noindent">The performance of a particular CRC polynomial over packets of given
sizes varies widely.  In terms of the probability of undetected
errors, some uses of extant CRC polynomials are suboptimal by several
orders of magnitude.

<p class="noindent">If you are considering CRC for a new application, consult the
following article to find the optimum CRC polynomial for your range of
data lengths:

     <ul>
<li>Philip Koopman and Tridib Chakravarty,<br>
&ldquo;Cyclic Redundancy Code (CRC) Polynomial Selection For Embedded Networks&rdquo;,<br>
The International Conference on Dependable Systems and Networks, DSN-2004.<br>
</ul>

  <p><br><a href="http://www.ece.cmu.edu/~koopman/roses/dsn04/koopman04_crc_poly_embedded.pdf">http://www.ece.cmu.edu/~koopman/roses/dsn04/koopman04_crc_poly_embedded.pdf</a><br>


<p class="noindent">There is even some controversy over the polynomials themselves.

<div class="defun">
&mdash; Constant: <b>crc-32-polynomial</b><var><a name="index-crc_002d32_002dpolynomial-669"></a></var><br>
<blockquote><p>For CRC-32, http://www2.sis.pitt.edu/~jkabara/tele-2100/lect08.html
gives x^32+x^26+x^23+x^16+x^12+x^11+x^10+x^8+x^7+x^5+x^4+x^2+x^1+1.

       <p>But
http://www.cs.ncl.ac.uk/people/harry.whitfield/home.formal/CRCs.html,
http://duchon.umuc.edu/Web_Pages/duchon/99_f_cm435/ShiftRegister.htm,
http://spinroot.com/spin/Doc/Book91_PDF/ch3.pdf,
http://www.erg.abdn.ac.uk/users/gorry/course/dl-pages/crc.html,
http://www.rad.com/networks/1994/err_con/crc_most.htm, and
http://www.gpfn.sk.ca/~rhg/csc8550s02/crc.html,
http://www.nobugconsulting.ro/crc.php give
x^32+x^26+x^23+x^22+x^16+x^12+x^11+x^10+x^8+x^7+x^5+x^4+x^2+x+1.

       <p>SLIB <code>crc-32-polynomial</code> uses the latter definition. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>crc-ccitt-polynomial</b><var><a name="index-crc_002dccitt_002dpolynomial-670"></a></var><br>
<blockquote>
       <p>http://www.math.grin.edu/~rebelsky/Courses/CS364/2000S/Outlines/outline.12.html,
http://duchon.umuc.edu/Web_Pages/duchon/99_f_cm435/ShiftRegister.htm,
http://www.cs.ncl.ac.uk/people/harry.whitfield/home.formal/CRCs.html,
http://www2.sis.pitt.edu/~jkabara/tele-2100/lect08.html, and
http://www.gpfn.sk.ca/~rhg/csc8550s02/crc.html give
CRC-CCITT: x^16+x^12+x^5+1. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>crc-16-polynomial</b><var><a name="index-crc_002d16_002dpolynomial-671"></a></var><br>
<blockquote>
       <p>http://www.math.grin.edu/~rebelsky/Courses/CS364/2000S/Outlines/outline.12.html,
http://duchon.umuc.edu/Web_Pages/duchon/99_f_cm435/ShiftRegister.htm,
http://www.cs.ncl.ac.uk/people/harry.whitfield/home.formal/CRCs.html,
http://www.gpfn.sk.ca/~rhg/csc8550s02/crc.html, and
http://www.usb.org/developers/data/crcdes.pdf give
CRC-16: x^16+x^15+x^2+1. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>crc-12-polynomial</b><var><a name="index-crc_002d12_002dpolynomial-672"></a></var><br>
<blockquote>
       <p>http://www.math.grin.edu/~rebelsky/Courses/CS364/2000S/Outlines/outline.12.html,
http://www.cs.ncl.ac.uk/people/harry.whitfield/home.formal/CRCs.html,
http://www.it.iitb.ac.in/it605/lectures/link/node4.html, and
http://spinroot.com/spin/Doc/Book91_PDF/ch3.pdf give
CRC-12: x^12+x^11+x^3+x^2+1.

       <p>But
http://www.ffldusoe.edu/Faculty/Denenberg/Topics/Networks/Error_Detection_Correction/crc.html,
http://duchon.umuc.edu/Web_Pages/duchon/99_f_cm435/ShiftRegister.htm,
http://www.eng.uwi.tt/depts/elec/staff/kimal/errorcc.html,
http://www.ee.uwa.edu.au/~roberto/teach/itc314/java/CRC/,
http://www.gpfn.sk.ca/~rhg/csc8550s02/crc.html, and
http://www.efg2.com/Lab/Mathematics/CRC.htm give
CRC-12: x^12+x^11+x^3+x^2+x+1.

       <p>These differ in bit 1 and calculations using them return different
values.  With citations near evenly split, it is hard to know which is
correct.  Thanks to Philip Koopman for breaking the tie in favor of
the latter (#xC07). 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>crc-10-polynomial</b><var><a name="index-crc_002d10_002dpolynomial-673"></a></var><br>
<blockquote>
       <p>http://www.math.grin.edu/~rebelsky/Courses/CS364/2000S/Outlines/outline.12.html gives
CRC-10: x^10+x^9+x^5+x^4+1;
but
http://cell-relay.indiana.edu/cell-relay/publications/software/CRC/crc10.html,
http://www.it.iitb.ac.in/it605/lectures/link/node4.html,
http://www.gpfn.sk.ca/~rhg/csc8550s02/crc.html,
http://www.techfest.com/networking/atm/atm.htm,
http://www.protocols.com/pbook/atmcell2.htm, and
http://www.nobugconsulting.ro/crc.php give
CRC-10: x^10+x^9+x^5+x^4+x+1. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>crc-08-polynomial</b><var><a name="index-crc_002d08_002dpolynomial-674"></a></var><br>
<blockquote>
       <p>http://www.math.grin.edu/~rebelsky/Courses/CS364/2000S/Outlines/outline.12.html,
http://www.cs.ncl.ac.uk/people/harry.whitfield/home.formal/CRCs.html,
http://www.it.iitb.ac.in/it605/lectures/link/node4.html, and
http://www.nobugconsulting.ro/crc.php give
CRC-8: x^8+x^2+x^1+1
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>atm-hec-polynomial</b><var><a name="index-atm_002dhec_002dpolynomial-675"></a></var><br>
<blockquote>
       <p>http://cell-relay.indiana.edu/cell-relay/publications/software/CRC/32bitCRC.tutorial.html and
http://www.gpfn.sk.ca/~rhg/csc8550s02/crc.html give
ATM HEC: x^8+x^2+x+1. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>dowcrc-polynomial</b><var><a name="index-dowcrc_002dpolynomial-676"></a></var><br>
<blockquote>
       <p>http://www.cs.ncl.ac.uk/people/harry.whitfield/home.formal/CRCs.html gives
DOWCRC: x^8+x^5+x^4+1. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>usb-token-polynomial</b><var><a name="index-usb_002dtoken_002dpolynomial-677"></a></var><br>
<blockquote>
       <p>http://www.usb.org/developers/data/crcdes.pdf and
http://www.nobugconsulting.ro/crc.php give
USB-token: x^5+x^2+1. 
</p></blockquote></div>

<p class="noindent">Each of these polynomial constants is a string of &lsquo;<samp><span class="samp">1</span></samp>&rsquo;s and
&lsquo;<samp><span class="samp">0</span></samp>&rsquo;s, the exponent of each power of <var>x</var> in descending order.

<div class="defun">
&mdash; Function: <b>crc:make-table</b><var> poly<a name="index-crc_003amake_002dtable-678"></a></var><br>
<blockquote>
       <p><var>poly</var> must be string of &lsquo;<samp><span class="samp">1</span></samp>&rsquo;s and &lsquo;<samp><span class="samp">0</span></samp>&rsquo;s beginning with
&lsquo;<samp><span class="samp">1</span></samp>&rsquo; and having length greater than 8.  <code>crc:make-table</code>
returns a vector of 256 integers, such that:

     <pre class="example">          (set! <var>crc</var>
                (logxor (ash (logand (+ -1 (ash 1 (- <var>deg</var> 8))) <var>crc</var>) 8)
                        (vector-ref <var>crc-table</var>
                                    (logxor (ash <var>crc</var> (- 8 <var>deg</var>)) <var>byte</var>))))
</pre>
       <p>will compute the <var>crc</var> with the 8 additional bits in <var>byte</var>;
where <var>crc</var> is the previous accumulated CRC value, <var>deg</var> is
the degree of <var>poly</var>, and <var>crc-table</var> is the vector returned
by <code>crc:make-table</code>.

       <p>If the implementation does not support <var>deg</var>-bit integers, then
<code>crc:make-table</code> returns #f.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>cksum</b><var> file<a name="index-cksum-679"></a></var><br>
<blockquote>
       <p>Computes the P1003.2/D11.2 (POSIX.2) 32-bit checksum of <var>file</var>.

     <pre class="example">          (require 'crc)
          <a name="index-crc-680"></a>(cksum (in-vicinity (library-vicinity) "ratize.scm"))
          &rArr; 157103930
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>cksum</b><var> port<a name="index-cksum-681"></a></var><br>
<blockquote><p>Computes the checksum of the bytes read from <var>port</var> until the
end-of-file.

       </blockquote></div>

<p class="noindent"><a name="index-cksum_002dstring-682"></a><code>cksum-string</code>, which returns the P1003.2/D11.2 (POSIX.2) 32-bit
checksum of the bytes in <var>str</var>, can be defined as follows:

<pre class="example">     (require 'string-port)
     (define (cksum-string str) (call-with-input-string str cksum))
</pre>
  <div class="defun">
&mdash; Function: <b>crc16</b><var> file<a name="index-crc16-683"></a></var><br>
<blockquote>
       <p>Computes the USB data-packet (16-bit) CRC of <var>file</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>crc16</b><var> port<a name="index-crc16-684"></a></var><br>
<blockquote><p>Computes the USB data-packet (16-bit) CRC of the bytes read from
<var>port</var> until the end-of-file.

       <p><code>crc16</code> calculates the same values as the crc16.pl program given
in http://www.usb.org/developers/data/crcdes.pdf.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>crc5</b><var> file<a name="index-crc5-685"></a></var><br>
<blockquote>
       <p>Computes the USB token (5-bit) CRC of <var>file</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>crc5</b><var> port<a name="index-crc5-686"></a></var><br>
<blockquote><p>Computes the USB token (5-bit) CRC of the bytes read from
<var>port</var> until the end-of-file.

       <p><code>crc5</code> calculates the same values as the crc5.pl program given
in http://www.usb.org/developers/data/crcdes.pdf.

       </blockquote></div>

<div class="node">
<a name="Graphing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Solid-Modeling">Solid Modeling</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Cyclic-Checksum">Cyclic Checksum</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.9 Graphing</h3>

<ul class="menu">
<li><a accesskey="1" href="#Character-Plotting">Character Plotting</a>
<li><a accesskey="2" href="#PostScript-Graphing">PostScript Graphing</a>
</ul>

<div class="node">
<a name="Character-Plotting"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#PostScript-Graphing">PostScript Graphing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Graphing">Graphing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Graphing">Graphing</a>

</div>

<h4 class="subsection">5.9.1 Character Plotting</h4>

<p><code>(require 'charplot)</code>
<a name="index-charplot-687"></a>

<div class="defun">
&mdash; Variable: <b>charplot:dimensions</b><var><a name="index-charplot_003adimensions-688"></a></var><br>
<blockquote><p>A list of the maximum height (number of lines) and maximum width (number
of columns) for the graph, its scales, and labels.

       <p>The default value for <var>charplot:dimensions</var> is the
<code>output-port-height</code> and <code>output-port-width</code> of
<code>current-output-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>plot</b><var> coords x-label y-label<a name="index-plot-689"></a></var><br>
<blockquote><p><var>coords</var> is a list or vector of coordinates, lists of x and y
coordinates.  <var>x-label</var> and <var>y-label</var> are strings with which to
label the x and y axes.

       <p>Example:
     <pre class="example">          (require 'charplot)
          <a name="index-charplot-690"></a>(set! charplot:dimensions '(20 55))
          
          (define (make-points n)
            (if (zero? n)
                '()
                (cons (list (/ n 6) (sin (/ n 6))) (make-points (1- n)))))
          
          (plot (make-points 40) "x" "Sin(x)")
          -|
            Sin(x)   _________________________________________
                   1|-       ****                             |
                    |      **    **                           |
                0.75|-    *        *                          |
                    |    *          *                         |
                 0.5|-  *            *                        |
                    |  *                                     *|
                0.25|-                *                     * |
                    | *                *                      |
                   0|-------------------*------------------*--|
                    |                                     *   |
               -0.25|-                   *               *    |
                    |                     *             *     |
                -0.5|-                     *                  |
                    |                       *          *      |
               -0.75|-                       *        *       |
                    |                         **    **        |
                  -1|-                          ****          |
                    |:_____._____:_____._____:_____._____:____|
               x                 2           4           6
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>plot</b><var> func x1 x2<a name="index-plot-691"></a></var><br>
&mdash; Procedure: <b>plot</b><var> func x1 x2 npts<a name="index-plot-692"></a></var><br>
<blockquote><p>Plots the function of one argument <var>func</var> over the range <var>x1</var> to
<var>x2</var>.  If the optional integer argument <var>npts</var> is supplied, it
specifies the number of points to evaluate <var>func</var> at.

     <pre class="example">          (plot sin 0 (* 2 pi))
          -|
                     _________________________________________
                   1|-:       ****                            |
                    | :     **    **                          |
                0.75|-:    *        *                         |
                    | :   *          *                        |
                 0.5|-:  **          **                       |
                    | : *             *                       |
                0.25|-:**              **                     |
                    | :*                *                     |
                   0|-*------------------*--------------------|
                    | :                  *                 *  |
               -0.25|-:                   **              **  |
                    | :                    *             *    |
                -0.5|-:                     *           **    |
                    | :                      *          *     |
               -0.75|-:                       *       **      |
                    | :                        **    **       |
                  -1|-:                          ****         |
                    |_:_____._____:_____._____:_____._____:___|
                      0           2           4           6
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>histograph</b><var> data label<a name="index-histograph-693"></a></var><br>
<blockquote><p>Creates and displays a histogram of the numerical values contained in
vector or list <var>data</var>

     <pre class="example">          (require 'random-inexact)
          (histograph (do ((idx 99 (+ -1 idx))
                           (lst '() (cons (* .02 (random:normal)) lst)))
                          ((negative? idx) lst))
                      "normal")
          -|
                     _________________________________________
                   8|-                :    I                  |
                    |                 :    I                  |
                   7|-           I  I :    I                  |
                    |            I  I :    I                  |
                   6|-          III I :I   I                  |
                    |           III I :I   I                  |
                   5|-          IIIIIIIIII I                  |
                    |           IIIIIIIIII I                  |
                   4|-          IIIIIIIIIIII                  |
                    |           IIIIIIIIIIII                  |
                   3|-I    I I  IIIIIIIIIIII  II     I        |
                    | I    I I  IIIIIIIIIIII  II     I        |
                   2|-I    I I IIIIIIIIIIIIIIIII     I        |
                    | I    I I IIIIIIIIIIIIIIIII     I        |
                   1|-II I I IIIIIIIIIIIIIIIIIIIII   I I I    |
                    | II I I IIIIIIIIIIIIIIIIIIIII   I I I    |
                   0|-IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII----|
                    |__.____:____.____:____.____:____.____:___|
            normal        -0.025      0       0.025      0.05
</pre>
       </blockquote></div>

<div class="node">
<a name="PostScript-Graphing"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Character-Plotting">Character Plotting</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Graphing">Graphing</a>

</div>

<h4 class="subsection">5.9.2 PostScript Graphing</h4>

<p><code>(require 'eps-graph)</code>

<p class="noindent">This is a graphing package creating encapsulated-PostScript files. 
Its motivations and design choice are described in
<a href="http://people.csail.mit.edu/jaffer/Docupage/grapheps">http://people.csail.mit.edu/jaffer/Docupage/grapheps</a>

<p class="noindent">A dataset to be plotted is taken from a 2-dimensional array. 
Corresponding coordinates are in rows.  Coordinates from any
pair of columns can be plotted.

<div class="defun">
&mdash; Function: <b>create-postscript-graph</b><var> filename.eps size elt1 <small class="dots">...</small><a name="index-create_002dpostscript_002dgraph-694"></a></var><br>
<blockquote>
       <p><var>filename.eps</var> should be a string naming an output file to be created.  <var>size</var>
should be an exact integer, a list of two exact integers, or #f. 
<var>elt1</var>, ... are values returned by graphing primitives described here.

       <p><code>create-postscript-graph</code> creates an <dfn>Encapsulated-PostScript</dfn> file named <var>filename.eps</var> containing
<a name="index-Encapsulated_002dPostScript-695"></a>graphs as directed by the <var>elt1</var>, ... arguments.

       <p>The size of the graph is determined by the <var>size</var> argument.  If a list
of two integers, they specify the width and height.  If one integer,
then that integer is the width and the height is 3/4 of the width. 
If #f, the graph will be 800 by 600. 
</p></blockquote></div>

<p class="noindent">These graphing procedures should be called as arguments to
<code>create-postscript-graph</code>.  The order of these arguments is
significant; PostScript graphics state is affected serially from the
first <var>elt</var> argument to the last.

<div class="defun">
&mdash; Function: <b>whole-page</b><var><a name="index-whole_002dpage-696"></a></var><br>
<blockquote>
       <p>Pushes a rectangle for the whole encapsulated page onto the
PostScript stack.  This pushed rectangle is an implicit argument to
<code>partition-page</code> or <code>setup-plot</code>. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#Column-Ranges">Column Ranges</a>
<li><a accesskey="2" href="#Drawing-the-Graph">Drawing the Graph</a>
<li><a accesskey="3" href="#Graphics-Context">Graphics Context</a>
<li><a accesskey="4" href="#Rectangles">Rectangles</a>
<li><a accesskey="5" href="#Legending">Legending</a>
<li><a accesskey="6" href="#Legacy-Plotting">Legacy Plotting</a>
<li><a accesskey="7" href="#Example-Graph">Example Graph</a>
</ul>

<div class="node">
<a name="Column-Ranges"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Drawing-the-Graph">Drawing the Graph</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#PostScript-Graphing">PostScript Graphing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#PostScript-Graphing">PostScript Graphing</a>

</div>

<h5 class="subsubsection">5.9.2.1 Column Ranges</h5>

<p class="noindent">A <dfn>range</dfn> is a list of two numbers, the minimum and the maximum. 
<a name="index-range-697"></a><a name="index-range-698"></a>Ranges can be given explicity or computed in PostScript by
<code>column-range</code>.

<div class="defun">
&mdash; Function: <b>column-range</b><var> array k<a name="index-column_002drange-699"></a></var><br>
<blockquote>
       <p>Returns the range of values in 2-dimensional <var>array</var> column <var>k</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pad-range</b><var> range p<a name="index-pad_002drange-700"></a></var><br>
<blockquote>
       <p>Expands <var>range</var> by <var>p</var>/100 on each end. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>snap-range</b><var> range<a name="index-snap_002drange-701"></a></var><br>
<blockquote>
       <p>Expands <var>range</var> to round number of ticks. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>combine-ranges</b><var> range1 range2 <small class="dots">...</small><a name="index-combine_002dranges-702"></a></var><br>
<blockquote>
       <p>Returns the minimal range covering all <var>range1</var>, <var>range2</var>, ... 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>setup-plot</b><var> x-range y-range pagerect<a name="index-setup_002dplot-703"></a></var><br>

  &mdash; Function: <b>setup-plot</b><var> x-range y-range<a name="index-setup_002dplot-704"></a></var><br>
<blockquote><p><var>x-range</var> and <var>y-range</var> should each be a list of two numbers or the value returned
by <code>pad-range</code>, <code>snap-range</code>, or <code>combine-range</code>. 
<var>pagerect</var> is the rectangle bounding the graph to be drawn; if missing, the
rectangle from the top of the PostScript stack is popped and used.

       <p>Based on the given ranges, <code>setup-plot</code> sets up scaling and margins for making
a graph.  The margins are sized proportional to the <var>fontheight</var>
value at the time of the call to setup-plot.  <code>setup-plot</code> sets two variables:

          <dl>
<dt><var>plotrect</var><dd>The region where data points will be plotted. 
<br><dt><var>graphrect</var><dd>The <var>pagerect</var> argument to <code>setup-plot</code>.  Includes plotrect, legends, etc. 
</dl>
       </p></blockquote></div>

<div class="node">
<a name="Drawing-the-Graph"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Graphics-Context">Graphics Context</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Column-Ranges">Column Ranges</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#PostScript-Graphing">PostScript Graphing</a>

</div>

<h5 class="subsubsection">5.9.2.2 Drawing the Graph</h5>

<div class="defun">
&mdash; Function: <b>plot-column</b><var> array x-column y-column proc3s<a name="index-plot_002dcolumn-705"></a></var><br>
<blockquote>
       <p>Plots points with x coordinate in <var>x-column</var> of <var>array</var> and y coordinate <var>y-column</var> of
<var>array</var>.  The symbol <var>proc3s</var> specifies the type of glyph or drawing style for
presenting these coordinates. 
</p></blockquote></div>

<p class="noindent">The glyphs and drawing styles available are:

     <dl>
<dt><code>line</code><dd>Draws line connecting points in order. 
<br><dt><code>mountain</code><dd>Fill area below line connecting points. 
<br><dt><code>cloud</code><dd>Fill area above line connecting points. 
<br><dt><code>impulse</code><dd>Draw line from x-axis to each point. 
<br><dt><code>bargraph</code><dd>Draw rectangle from x-axis to each point. 
<br><dt><code>disc</code><dd>Solid round dot. 
<br><dt><code>point</code><dd>Minimal point &ndash; invisible if linewidth is 0. 
<br><dt><code>square</code><dd>Square box. 
<br><dt><code>diamond</code><dd>Square box at 45.o
<br><dt><code>plus</code><dd>Plus sign. 
<br><dt><code>cross</code><dd>X sign. 
<br><dt><code>triup</code><dd>Triangle pointing upward
<br><dt><code>tridown</code><dd>Triangle pointing downward
<br><dt><code>pentagon</code><dd>Five sided polygon
<br><dt><code>circle</code><dd>Hollow circle
</dl>

<div class="defun">
&mdash; Function: <b>plot-text-column</b><var> array x-column y-column t-column proc3s<a name="index-plot_002dtext_002dcolumn-706"></a></var><br>
<blockquote>
       <p>Plots text in <var>t-column</var> of <var>array</var> at x coordinate in <var>x-column</var> of <var>array</var> and y coordinate
<var>y-column</var> of <var>array</var>.  The symbol <var>proc3s</var> specifies the offset of the text from the
specified coordinates. 
</p></blockquote></div>

<p class="noindent">The offsets available are:

     <dl>
<dt><code>above</code><dd>Draws the text centered above at the point. 
<br><dt><code>center</code><dd>Draws the text centered at the point. 
<br><dt><code>below</code><dd>Draws the text centered below the point. 
<br><dt><code>left</code><dd>Draws the text to the left of the point. 
<br><dt><code>right</code><dd>Draws the text to the right of the point. 
</dl>

  <p>All the offsets other than <code>center</code> are calculated to keep the
text clear of a glyph drawn at the same coordinates.  If you need
more or less clearance, use <code>set-glyphsize</code>.

<div class="node">
<a name="Graphics-Context"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Rectangles">Rectangles</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Drawing-the-Graph">Drawing the Graph</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#PostScript-Graphing">PostScript Graphing</a>

</div>

<h5 class="subsubsection">5.9.2.3 Graphics Context</h5>

<div class="defun">
&mdash; Function: <b>in-graphic-context</b><var> arg <small class="dots">...</small><a name="index-in_002dgraphic_002dcontext-707"></a></var><br>
<blockquote>
       <p>Saves the current graphics state, executes <var>args</var>, then restores
to saved graphics state. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-color</b><var> color<a name="index-set_002dcolor-708"></a></var><br>
<blockquote>
       <p><var>color</var> should be a string naming a Resene color, a saturate color, or a
number between 0 and 100.

       <p><code>set-color</code> sets the PostScript color to the color of the given string, or a
grey value between black (0) and white (100). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-font</b><var> font height<a name="index-set_002dfont-709"></a></var><br>

  &mdash; Function: <b>set-font</b><var> font encoding height<a name="index-set_002dfont-710"></a></var><br>
<blockquote><p><var>font</var> should be a (case-sensitive) string naming a PostScript font. 
<var>height</var> should be a positive real number. 
<var>encoding</var> should name a PostScript encoding such as
&lsquo;<samp><span class="samp">ISOLatin1Encoding</span></samp>&rsquo;.

       <p><code>set-font</code> Changes the current PostScript font to <var>font</var> with the <var>encoding</var>
encoding, and height equal to <var>height</var>.  The default font is
&lsquo;<samp><span class="samp">Helvetica</span></samp>&rsquo; (12pt).  The default encoding is
&lsquo;<samp><span class="samp">StandardEncoding</span></samp>&rsquo;. 
</p></blockquote></div>

<p class="noindent">The base set of PostScript fonts is:

  <p><table summary=""><tr align="left"><td valign="top" width="20%">Times </td><td valign="top" width="25%">Times-Italic </td><td valign="top" width="25%">Times-Bold </td><td valign="top" width="30%">Times-BoldItalic
<br></td></tr><tr align="left"><td valign="top" width="20%">Helvetica </td><td valign="top" width="25%">Helvetica-Oblique </td><td valign="top" width="25%">Helvetica-Bold </td><td valign="top" width="30%">Helvetica-BoldOblique
<br></td></tr><tr align="left"><td valign="top" width="20%">Courier </td><td valign="top" width="25%">Courier-Oblique </td><td valign="top" width="25%">Courier-Bold </td><td valign="top" width="30%">Courier-BoldOblique
<br></td></tr><tr align="left"><td valign="top" width="20%">Symbol
  <br></td></tr></table>

<p class="noindent">The base set of PostScript encodings is:

  <p><table summary=""><tr align="left"><td valign="top" width="33%">StandardEncoding </td><td valign="top" width="33%">ISOLatin1Encoding </td><td valign="top" width="33%">ExpertEncoding
<br></td></tr><tr align="left"><td valign="top" width="33%">ExpertSubsetEncoding </td><td valign="top" width="33%">SymbolEncoding
  <br></td></tr></table>

<p class="noindent">Line parameters do no affect fonts; they do effect glyphs.

<div class="defun">
&mdash; Function: <b>set-linewidth</b><var> w<a name="index-set_002dlinewidth-711"></a></var><br>
<blockquote>
       <p>The default linewidth is 1.  Setting it to 0 makes the lines drawn
as skinny as possible.  Linewidth must be much smaller than
glyphsize for readable glyphs. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-linedash</b><var> j k<a name="index-set_002dlinedash-712"></a></var><br>
<blockquote>
       <p>Lines are drawn <var>j</var>-on <var>k</var>-off.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>set-linedash</b><var> j<a name="index-set_002dlinedash-713"></a></var><br>
<blockquote><p>Lines are drawn <var>j</var>-on <var>j</var>-off.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>set-linedash</b><var><a name="index-set_002dlinedash-714"></a></var><br>
<blockquote><p>Turns off dashing. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-glyphsize</b><var> w<a name="index-set_002dglyphsize-715"></a></var><br>
<blockquote>
       <p>Sets the (PostScript) variable glyphsize to <var>w</var>.  The default
glyphsize is 6. 
</p></blockquote></div>

<p class="noindent">The effects of <code>clip-to-rect</code> are also part of the graphic
context.

<div class="node">
<a name="Rectangles"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Legending">Legending</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Graphics-Context">Graphics Context</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#PostScript-Graphing">PostScript Graphing</a>

</div>

<h5 class="subsubsection">5.9.2.4 Rectangles</h5>

<p class="noindent">A <dfn>rectangle</dfn> is a list of 4 numbers; the first two elements are
<a name="index-rectangle-716"></a>the x and y coordinates of lower left corner of the rectangle.  The
other two elements are the width and height of the rectangle.

<div class="defun">
&mdash; Function: <b>whole-page</b><var><a name="index-whole_002dpage-717"></a></var><br>
<blockquote>
       <p>Pushes a rectangle for the whole encapsulated page onto the
PostScript stack.  This pushed rectangle is an implicit argument to
<code>partition-page</code> or <code>setup-plot</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>partition-page</b><var> xparts yparts<a name="index-partition_002dpage-718"></a></var><br>
<blockquote>
       <p>Pops the rectangle currently on top of the stack and pushes <var>xparts</var> * <var>yparts</var>
sub-rectangles onto the stack in decreasing y and increasing x order. 
If you are drawing just one graph, then you don't need <code>partition-page</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>plotrect</b><var><a name="index-plotrect-719"></a></var><br>
<blockquote>
       <p>The rectangle where data points should be plotted.  <var>plotrect</var> is set by
<code>setup-plot</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>graphrect</b><var><a name="index-graphrect-720"></a></var><br>
<blockquote>
       <p>The <var>pagerect</var> argument of the most recent call to
<code>setup-plot</code>.  Includes plotrect, legends, etc. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fill-rect</b><var> rect<a name="index-fill_002drect-721"></a></var><br>
<blockquote>
       <p>fills <var>rect</var> with the current color. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>outline-rect</b><var> rect<a name="index-outline_002drect-722"></a></var><br>
<blockquote>
       <p>Draws the perimiter of <var>rect</var> in the current color. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>clip-to-rect</b><var> rect<a name="index-clip_002dto_002drect-723"></a></var><br>
<blockquote>
       <p>Modifies the current graphics-state so that nothing will be drawn
outside of the rectangle <var>rect</var>.  Use <code>in-graphic-context</code> to limit
the extent of <code>clip-to-rect</code>. 
</p></blockquote></div>

<div class="node">
<a name="Legending"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Legacy-Plotting">Legacy Plotting</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rectangles">Rectangles</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#PostScript-Graphing">PostScript Graphing</a>

</div>

<h5 class="subsubsection">5.9.2.5 Legending</h5>

<div class="defun">
&mdash; Function: <b>title-top</b><var> title subtitle<a name="index-title_002dtop-724"></a></var><br>

  &mdash; Function: <b>title-top</b><var> title<a name="index-title_002dtop-725"></a></var><br>
<blockquote><p>Puts a <var>title</var> line and an optional <var>subtitle</var> line above the <code>graphrect</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>title-bottom</b><var> title subtitle<a name="index-title_002dbottom-726"></a></var><br>

  &mdash; Function: <b>title-bottom</b><var> title<a name="index-title_002dbottom-727"></a></var><br>
<blockquote><p>Puts a <var>title</var> line and an optional <var>subtitle</var> line below the <code>graphrect</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>topedge</b><var><a name="index-topedge-728"></a></var><br>
&mdash; Variable: <b>bottomedge</b><var><a name="index-bottomedge-729"></a></var><br>
<blockquote>
       <p>These edge coordinates of <code>graphrect</code> are suitable for passing
as the first argument to <code>rule-horizontal</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>leftedge</b><var><a name="index-leftedge-730"></a></var><br>
&mdash; Variable: <b>rightedge</b><var><a name="index-rightedge-731"></a></var><br>
<blockquote>
       <p>These edge coordinates of <code>graphrect</code> are suitable for passing
as the first argument to <code>rule-vertical</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-margin-templates</b><var> left right<a name="index-set_002dmargin_002dtemplates-732"></a></var><br>
<blockquote>
       <p>The margin-templates are strings whose displayed width is used to
reserve space for the left and right side numerical legends. 
The default values are "-.0123456789". 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>rule-vertical</b><var> x-coord text tick-width<a name="index-rule_002dvertical-733"></a></var><br>
<blockquote>
       <p>Draws a vertical ruler with X coordinate <var>x-coord</var> and labeled with string
<var>text</var>.  If <var>tick-width</var> is positive, then the ticks are <var>tick-width</var> long on the right side
of <var>x-coord</var>; and <var>text</var> and numeric legends are on the left.  If <var>tick-width</var> is
negative, then the ticks are -<var>tick-width</var> long on the left side of <var>x-coord</var>; and <var>text</var>
and numeric legends are on the right. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>rule-horizontal</b><var> y-coord text tick-height<a name="index-rule_002dhorizontal-734"></a></var><br>
<blockquote>
       <p>Draws a horizontal ruler with Y coordinate <var>y-coord</var> and labeled with
string <var>text</var>.  If <var>tick-height</var> is positive, then the ticks are <var>tick-height</var> long on the top
side of <var>y-coord</var>; and <var>text</var> and numeric legends are on the bottom.  If <var>tick-height</var> is
negative, then the ticks are -<var>tick-height</var> long on the bottom side of <var>y-coord</var>; and
<var>text</var> and numeric legends are on the top. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>y-axis</b><var><a name="index-y_002daxis-735"></a></var><br>
<blockquote>
       <p>Draws the y-axis. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>x-axis</b><var><a name="index-x_002daxis-736"></a></var><br>
<blockquote>
       <p>Draws the x-axis. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>grid-verticals</b><var><a name="index-grid_002dverticals-737"></a></var><br>
<blockquote>
       <p>Draws vertical lines through <code>graphrect</code> at each tick on the
vertical ruler. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>grid-horizontals</b><var><a name="index-grid_002dhorizontals-738"></a></var><br>
<blockquote>
       <p>Draws horizontal lines through <code>graphrect</code> at each tick on the
horizontal ruler. 
</p></blockquote></div>

<div class="node">
<a name="Legacy-Plotting"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Example-Graph">Example Graph</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Legending">Legending</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#PostScript-Graphing">PostScript Graphing</a>

</div>

<h5 class="subsubsection">5.9.2.6 Legacy Plotting</h5>

<div class="defun">
&mdash; Variable: <b>graph:dimensions</b><var><a name="index-graph_003adimensions-739"></a></var><br>
<blockquote>
       <p>A list of the width and height of the graph to be plotted using
<code>plot</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>plot</b><var> func x1 x2 npts<a name="index-plot-740"></a></var><br>

  &mdash; Function: <b>plot</b><var> func x1 x2<a name="index-plot-741"></a></var><br>
<blockquote><p>Creates and displays using <code>(system "gv tmp.eps")</code> an
encapsulated PostScript graph of the function of one argument <var>func</var>
over the range <var>x1</var> to <var>x2</var>.  If the optional integer argument <var>npts</var> is
supplied, it specifies the number of points to evaluate <var>func</var> at.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>plot</b><var> x1 x2 npts func1 func2 <small class="dots">...</small><a name="index-plot-742"></a></var><br>
<blockquote><p>Creates and displays an encapsulated PostScript graph of the
one-argument functions <var>func1</var>, <var>func2</var>, ... over the range
<var>x1</var> to <var>x2</var> at <var>npts</var> points.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>plot</b><var> coords x-label y-label<a name="index-plot-743"></a></var><br>
<blockquote><p><var>coords</var> is a list or vector of coordinates, lists of x and y
coordinates.  <var>x-label</var> and <var>y-label</var> are strings with which
to label the x and y axes. 
</p></blockquote></div>

<div class="node">
<a name="Example-Graph"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Legacy-Plotting">Legacy Plotting</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#PostScript-Graphing">PostScript Graphing</a>

</div>

<h5 class="subsubsection">5.9.2.7 Example Graph</h5>

<p class="noindent">The file <samp><span class="file">am1.5.html</span></samp>, a table of solar irradiance, is fetched
with &lsquo;<samp><span class="samp">wget</span></samp>&rsquo; if it isn't already in the working directory.  The
file is read and stored into an array, <var>irradiance</var>.

  <p><code>create-postscript-graph</code> is then called to create an
encapsulated-PostScript file, <samp><span class="file">solarad.eps</span></samp>.  The size of the
page is set to 600 by 300.  <code>whole-page</code> is called and leaves
the rectangle on the PostScript stack.  <code>setup-plot</code> is called
with a literal range for x and computes the range for column 1.

  <p>Two calls to <code>top-title</code> are made so a different font can be
used for the lower half.  <code>in-graphic-context</code> is used to limit
the scope of the font change.  The graphing area is outlined and a
rule drawn on the left side.

  <p>Because the X range was intentionally reduced,
<code>in-graphic-context</code> is called and <code>clip-to-rect</code> limits
drawing to the plotting area.  A black line is drawn from data
column 1.  That line is then overlayed with a mountain plot of the
same column colored "Bright Sun".

  <p>After returning from the <code>in-graphic-context</code>, the bottom ruler
is drawn.  Had it been drawn earlier, all its ticks would have been
painted over by the mountain plot.

  <p>The color is then changed to &lsquo;<samp><span class="samp">seagreen</span></samp>&rsquo; and the same graphrect
is setup again, this time with a different Y scale, 0 to 1000.  The
graphic context is again clipped to <var>plotrect</var>, linedash is set,
and column 2 is plotted as a dashed line.  Finally the rightedge is
ruled.  Having the line and its scale both in green helps
disambiguate the scales.

<pre class="example">     (require 'eps-graph)
     (require 'line-i/o)
     (require 'string-port)
     
     (define irradiance
       (let ((url "http://www.pv.unsw.edu.au/am1.5.html")
             (file "am1.5.html"))
         (define (read-&gt;list line)
           (define elts '())
           (call-with-input-string line
             (lambda (iprt) (do ((elt (read iprt) (read iprt)))
                                ((eof-object? elt) elts)
                              (set! elts (cons elt elts))))))
         (if (not (file-exists? file))
             (system (string-append "wget -c -O" file " " url)))
         (call-with-input-file file
           (lambda (iprt)
             (define lines '())
             (do ((line (read-line iprt) (read-line iprt)))
                 ((eof-object? line)
                  (let ((nra (make-array (A:floR64b)
                                           (length lines)
                                           (length (car lines)))))
                    (do ((lns lines (cdr lns))
                         (idx (+ -1 (length lines)) (+ -1 idx)))
                        ((null? lns) nra)
                      (do ((kdx (+ -1 (length (car lines))) (+ -1 kdx))
                           (lst (car lns) (cdr lst)))
                          ((null? lst))
                        (array-set! nra (car lst) idx kdx)))))
               (if (and (positive? (string-length line))
                        (char-numeric? (string-ref line 0)))
                   (set! lines (cons (read-&gt;list line) lines))))))))
     
     (let ((xrange '(.25 2.5)))
       (create-postscript-graph
        "solarad.eps" '(600 300)
        (whole-page)
        (setup-plot xrange (column-range irradiance 1))
        (title-top
         "Solar Irradiance   http://www.pv.unsw.edu.au/am1.5.html")
        (in-graphic-context
         (set-font "Helvetica-Oblique" 12)
         (title-top
          ""
          "Key Centre for Photovoltaic Engineering UNSW - Air Mass 1.5 Global Spectrum"))
        (outline-rect plotrect)
        (rule-vertical leftedge "W/(m^2.um)" 10)
        (in-graphic-context (clip-to-rect plotrect)
                            (plot-column irradiance 0 1 'line)
                            (set-color "Bright Sun")
                            (plot-column irradiance 0 1 'mountain)
                            )
        (rule-horizontal bottomedge "Wavelength in .um" 5)
        (set-color 'seagreen)
     
        (setup-plot xrange '(0 1000) graphrect)
        (in-graphic-context (clip-to-rect plotrect)
                            (set-linedash 5 2)
                            (plot-column irradiance 0 2 'line))
        (rule-vertical rightedge "Integrated .W/(m^2)" -10)
        ))
     
     (system "gv solarad.eps")
</pre>
  <div class="node">
<a name="Solid-Modeling"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Color">Color</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Graphing">Graphing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.10 Solid Modeling</h3>

<p><code>(require 'solid)</code>
<a name="index-solids-744"></a><a name="index-solid-745"></a><a name="index-solid_002dmodeling-746"></a>
<a href="http://people.csail.mit.edu/jaffer/Solid/#Example">http://people.csail.mit.edu/jaffer/Solid/#Example</a> gives an
example use of this package.

<div class="defun">
&mdash; Function: <b>vrml</b><var> node <small class="dots">...</small><a name="index-vrml-747"></a></var><br>
<blockquote><p>Returns the VRML97 string (including header) of the concatenation
of strings <var>nodes</var>, <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>vrml-append</b><var> node1 node2 <small class="dots">...</small><a name="index-vrml_002dappend-748"></a></var><br>
<blockquote><p>Returns the concatenation with interdigitated newlines of
strings <var>node1</var>, <var>node2</var>, <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>vrml-to-file</b><var> file node <small class="dots">...</small><a name="index-vrml_002dto_002dfile-749"></a></var><br>
<blockquote><p>Writes to file named <var>file</var> the VRML97 string (including header) of
the concatenation of strings <var>nodes</var>, <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>world:info</b><var> title info <small class="dots">...</small><a name="index-world_003ainfo-750"></a></var><br>
<blockquote><p>Returns a VRML97 string setting the title of the file in which
it appears to <var>title</var>.  Additional strings <var>info</var>, <small class="dots">...</small> are comments. 
</p></blockquote></div>

<p class="noindent">VRML97 strings passed to <code>vrml</code> and <code>vrml-to-file</code> as
arguments will appear in the resulting VRML code.  This string turns
off the headlight at the viewpoint:
<pre class="example">     " NavigationInfo {headlight FALSE}"
</pre>
  <div class="defun">
&mdash; Function: <b>scene:panorama</b><var> front right back left top bottom<a name="index-scene_003apanorama-751"></a></var><br>
<blockquote><p>Specifies the distant images on the inside faces of the cube
enclosing the virtual world. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>scene:sphere</b><var> colors angles<a name="index-scene_003asphere-752"></a></var><br>
<blockquote>
       <p><var>colors</var> is a list of color objects.  Each may be of type
<a href="#Color-Data_002dType">color</a>, a 24-bit sRGB integer, or a list of 3
numbers between 0.0 and 1.0.

       <p><var>angles</var> is a list of non-increasing angles the same length as
<var>colors</var>.  Each angle is between 90 and -90 degrees.  If 90 or -90 are not
elements of <var>angles</var>, then the color at the zenith and nadir are taken from
the colors paired with the angles nearest them.

       <p><code>scene:sphere</code> fills horizontal bands with interpolated colors on the background
sphere encasing the world. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>scene:sky-and-dirt</b><var><a name="index-scene_003asky_002dand_002ddirt-753"></a></var><br>
<blockquote><p>Returns a blue and brown background sphere encasing the world. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>scene:sky-and-grass</b><var><a name="index-scene_003asky_002dand_002dgrass-754"></a></var><br>
<blockquote><p>Returns a blue and green background sphere encasing the world. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>scene:sun</b><var> latitude julian-day hour turbidity strength<a name="index-scene_003asun-755"></a></var><br>

  &mdash; Function: <b>scene:sun</b><var> latitude julian-day hour turbidity<a name="index-scene_003asun-756"></a></var><br>
<blockquote>
       <p><var>latitude</var> is the virtual place's latitude in degrees.  <var>julian-day</var> is an integer from
0 to 366, the day of the year.  <var>hour</var> is a real number from 0 to 24 for
the time of day; 12 is noon.  <var>turbidity</var> is the degree of fogginess described
in See <a href="#Daylight">turbidity</a>.

       <p><code>scene:sun</code> returns a bright yellow, distant sphere where the sun would be at
<var>hour</var> on <var>julian-day</var> at <var>latitude</var>.  If <var>strength</var> is positive, included is a light source of <var>strength</var>
(default 1). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>scene:overcast</b><var> latitude julian-day hour turbidity strength<a name="index-scene_003aovercast-757"></a></var><br>

  &mdash; Function: <b>scene:overcast</b><var> latitude julian-day hour turbidity<a name="index-scene_003aovercast-758"></a></var><br>
<blockquote>
       <p><var>latitude</var> is the virtual place's latitude in degrees.  <var>julian-day</var> is an integer from
0 to 366, the day of the year.  <var>hour</var> is a real number from 0 to 24 for
the time of day; 12 is noon.  <var>turbidity</var> is the degree of cloudiness described
in See <a href="#Daylight">turbidity</a>.

       <p><code>scene:overcast</code> returns an overcast sky as it might look at <var>hour</var> on <var>julian-day</var> at <var>latitude</var>.  If <var>strength</var>
is positive, included is an ambient light source of <var>strength</var> (default 1). 
</p></blockquote></div>

<p class="noindent">Viewpoints are objects in the virtual world, and can be transformed
individually or with solid objects.

<div class="defun">
&mdash; Function: <b>scene:viewpoint</b><var> name distance compass pitch<a name="index-scene_003aviewpoint-759"></a></var><br>

  &mdash; Function: <b>scene:viewpoint</b><var> name distance compass<a name="index-scene_003aviewpoint-760"></a></var><br>
<blockquote><p>Returns a viewpoint named <var>name</var> facing the origin and placed <var>distance</var> from it. 
<var>compass</var> is a number from 0 to 360 giving the compass heading.  <var>pitch</var> is a
number from -90 to 90, defaulting to 0, specifying the angle from the
horizontal. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>scene:viewpoints</b><var> proximity<a name="index-scene_003aviewpoints-761"></a></var><br>
<blockquote><p>Returns 6 viewpoints, one at the center of each face of a cube
with sides 2 * <var>proximity</var>, centered on the origin. 
</p></blockquote></div>

<h4 class="subheading">Light Sources</h4>

<p class="noindent">In VRML97, lights shine only on objects within the same children node
and descendants of that node.  Although it would have been convenient
to let light direction be rotated by <code>solid:rotation</code>, this
restricts a rotated light's visibility to objects rotated with it.

<p class="noindent">To workaround this limitation, these directional light source
procedures accept either Cartesian or spherical coordinates for
direction.  A spherical coordinate is a list <code>(</code><var>theta</var>
<var>azimuth</var><code>)</code>; where <var>theta</var> is the angle in degrees from the
zenith, and <var>azimuth</var> is the angle in degrees due west of south.

<p class="noindent">It is sometimes useful for light sources to be brighter than &lsquo;<samp><span class="samp">1</span></samp>&rsquo;. 
When <var>intensity</var> arguments are greater than 1, these functions
gang multiple sources to reach the desired strength.

<div class="defun">
&mdash; Function: <b>light:ambient</b><var> color intensity<a name="index-light_003aambient-762"></a></var><br>

  &mdash; Function: <b>light:ambient</b><var> color<a name="index-light_003aambient-763"></a></var><br>
<blockquote><p>Ambient light shines on all surfaces with which it is grouped.

       <p><var>color</var> is a an object of type <a href="#Color-Data_002dType">color</a>, a 24-bit sRGB
integer, or a list of 3 numbers between 0.0 and 1.0.  If <var>color</var> is #f,
then the default color will be used.  <var>intensity</var> is a real non-negative number
defaulting to &lsquo;<samp><span class="samp">1</span></samp>&rsquo;.

       <p><code>light:ambient</code> returns a light source or sources of <var>color</var> with total strength of <var>intensity</var>
(or 1 if omitted). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>light:directional</b><var> color direction intensity<a name="index-light_003adirectional-764"></a></var><br>

  &mdash; Function: <b>light:directional</b><var> color direction<a name="index-light_003adirectional-765"></a></var><br>

  &mdash; Function: <b>light:directional</b><var> color<a name="index-light_003adirectional-766"></a></var><br>
<blockquote><p>Directional light shines parallel rays with uniform intensity on all
objects with which it is grouped.

       <p><var>color</var> is a an object of type <a href="#Color-Data_002dType">color</a>, a 24-bit sRGB
integer, or a list of 3 numbers between 0.0 and 1.0.  If <var>color</var> is #f,
then the default color will be used.

       <p><var>direction</var> must be a list or vector of 2 or 3 numbers specifying the direction
to this light.  If <var>direction</var> has 2 numbers, then these numbers are the angle
from zenith and the azimuth in degrees; if <var>direction</var> has 3 numbers, then
these are taken as a Cartesian vector specifying the direction to the
light source.  The default direction is upwards; thus its light will
shine down.

       <p><var>intensity</var> is a real non-negative number defaulting to &lsquo;<samp><span class="samp">1</span></samp>&rsquo;.

       <p><code>light:directional</code> returns a light source or sources of <var>color</var> with total strength of <var>intensity</var>,
shining from <var>direction</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>light:beam</b><var> attenuation radius aperture peak<a name="index-light_003abeam-767"></a></var><br>

  &mdash; Function: <b>light:beam</b><var> attenuation radius aperture<a name="index-light_003abeam-768"></a></var><br>

  &mdash; Function: <b>light:beam</b><var> attenuation radius<a name="index-light_003abeam-769"></a></var><br>

  &mdash; Function: <b>light:beam</b><var> attenuation<a name="index-light_003abeam-770"></a></var><br>
<blockquote>
       <p><var>attenuation</var> is a list or vector of three nonnegative real numbers specifying
the reduction of intensity, the reduction of intensity with distance,
and the reduction of intensity as the square of distance.  <var>radius</var> is the
distance beyond which the light does not shine.  <var>radius</var> defaults to
&lsquo;<samp><span class="samp">100</span></samp>&rsquo;.

       <p><var>aperture</var> is a real number between 0 and 180, the angle centered on the
light's axis through which it sheds some light.  <var>peak</var> is a real number
between 0 and 90, the angle of greatest illumination. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>light:point</b><var> location color intensity beam<a name="index-light_003apoint-771"></a></var><br>

  &mdash; Function: <b>light:point</b><var> location color intensity<a name="index-light_003apoint-772"></a></var><br>

  &mdash; Function: <b>light:point</b><var> location color<a name="index-light_003apoint-773"></a></var><br>

  &mdash; Function: <b>light:point</b><var> location<a name="index-light_003apoint-774"></a></var><br>
<blockquote>
       <p>Point light radiates from <var>location</var>, intensity decreasing with distance,
towards all objects with which it is grouped.

       <p><var>color</var> is a an object of type <a href="#Color-Data_002dType">color</a>, a 24-bit sRGB
integer, or a list of 3 numbers between 0.0 and 1.0.  If <var>color</var> is #f,
then the default color will be used.  <var>intensity</var> is a real non-negative number
defaulting to &lsquo;<samp><span class="samp">1</span></samp>&rsquo;.  <var>beam</var> is a structure returned by
<code>light:beam</code> or #f.

       <p><code>light:point</code> returns a light source or sources at <var>location</var> of <var>color</var> with total strength
<var>intensity</var> and <var>beam</var> properties.  Note that the pointlight itself is not visible. 
To make it so, place an object with emissive appearance at <var>location</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>light:spot</b><var> location direction color intensity beam<a name="index-light_003aspot-775"></a></var><br>

  &mdash; Function: <b>light:spot</b><var> location direction color intensity<a name="index-light_003aspot-776"></a></var><br>

  &mdash; Function: <b>light:spot</b><var> location direction color<a name="index-light_003aspot-777"></a></var><br>

  &mdash; Function: <b>light:spot</b><var> location direction<a name="index-light_003aspot-778"></a></var><br>

  &mdash; Function: <b>light:spot</b><var> location<a name="index-light_003aspot-779"></a></var><br>
<blockquote>
       <p>Spot light radiates from <var>location</var> towards <var>direction</var>, intensity decreasing with
distance, illuminating objects with which it is grouped.

       <p><var>direction</var> must be a list or vector of 2 or 3 numbers specifying the direction
to this light.  If <var>direction</var> has 2 numbers, then these numbers are the angle
from zenith and the azimuth in degrees; if <var>direction</var> has 3 numbers, then
these are taken as a Cartesian vector specifying the direction to the
light source.  The default direction is upwards; thus its light will
shine down.

       <p><var>color</var> is a an object of type <a href="#Color-Data_002dType">color</a>, a 24-bit sRGB
integer, or a list of 3 numbers between 0.0 and 1.0.  If <var>color</var> is #f,
then the default color will be used.

       <p><var>intensity</var> is a real non-negative number defaulting to &lsquo;<samp><span class="samp">1</span></samp>&rsquo;.

       <p><code>light:spot</code> returns a light source or sources at <var>location</var> of <var>direction</var> with total strength
<var>color</var>.  Note that the spotlight itself is not visible.  To make it so,
place an object with emissive appearance at <var>location</var>. 
</p></blockquote></div>

<h4 class="subheading">Object Primitives</h4>

<div class="defun">
&mdash; Function: <b>solid:box</b><var> geometry appearance<a name="index-solid_003abox-780"></a></var><br>

  &mdash; Function: <b>solid:box</b><var> geometry<a name="index-solid_003abox-781"></a></var><br>
<blockquote><p><var>geometry</var> must be a number or a list or vector of three numbers.  If <var>geometry</var> is a
number, the <code>solid:box</code> returns a cube with sides of length <var>geometry</var> centered on the
origin.  Otherwise, <code>solid:box</code> returns a rectangular box with dimensions <var>geometry</var>
centered on the origin.  <var>appearance</var> determines the surface properties of the
returned object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:lumber</b><var> geometry appearance<a name="index-solid_003alumber-782"></a></var><br>
<blockquote>
       <p>Returns a box of the specified <var>geometry</var>, but with the y-axis of a texture
specified in <var>appearance</var> being applied along the longest dimension in <var>geometry</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:cylinder</b><var> radius height appearance<a name="index-solid_003acylinder-783"></a></var><br>

  &mdash; Function: <b>solid:cylinder</b><var> radius height<a name="index-solid_003acylinder-784"></a></var><br>
<blockquote><p>Returns a right cylinder with dimensions <code>(abs </code><var>radius</var><code>)</code> and <code>(abs </code><var>height</var><code>)</code>
centered on the origin.  If <var>height</var> is positive, then the cylinder ends
will be capped.  If <var>radius</var> is negative, then only the ends will appear. 
<var>appearance</var> determines the surface properties of the returned
object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:disk</b><var> radius thickness appearance<a name="index-solid_003adisk-785"></a></var><br>

  &mdash; Function: <b>solid:disk</b><var> radius thickness<a name="index-solid_003adisk-786"></a></var><br>
<blockquote><p><var>thickness</var> must be a positive real number.  <code>solid:disk</code> returns a circular disk
with dimensions <var>radius</var> and <var>thickness</var> centered on the origin.  <var>appearance</var> determines the
surface properties of the returned object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:cone</b><var> radius height appearance<a name="index-solid_003acone-787"></a></var><br>

  &mdash; Function: <b>solid:cone</b><var> radius height<a name="index-solid_003acone-788"></a></var><br>
<blockquote><p>Returns an isosceles cone with dimensions <var>radius</var> and <var>height</var> centered on
the origin.  <var>appearance</var> determines the surface properties of the returned
object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:pyramid</b><var> side height appearance<a name="index-solid_003apyramid-789"></a></var><br>

  &mdash; Function: <b>solid:pyramid</b><var> side height<a name="index-solid_003apyramid-790"></a></var><br>
<blockquote><p>Returns an isosceles pyramid with dimensions <var>side</var> and <var>height</var> centered on
the origin.  <var>appearance</var> determines the surface properties of the returned
object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:sphere</b><var> radius appearance<a name="index-solid_003asphere-791"></a></var><br>

  &mdash; Function: <b>solid:sphere</b><var> radius<a name="index-solid_003asphere-792"></a></var><br>
<blockquote><p>Returns a sphere of radius <var>radius</var> centered on the origin.  <var>appearance</var> determines
the surface properties of the returned object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:ellipsoid</b><var> geometry appearance<a name="index-solid_003aellipsoid-793"></a></var><br>

  &mdash; Function: <b>solid:ellipsoid</b><var> geometry<a name="index-solid_003aellipsoid-794"></a></var><br>
<blockquote><p><var>geometry</var> must be a number or a list or vector of three numbers.  If <var>geometry</var> is a
number, the <code>solid:ellipsoid</code> returns a sphere of diameter <var>geometry</var> centered on the origin. 
Otherwise, <code>solid:ellipsoid</code> returns an ellipsoid with diameters <var>geometry</var> centered on the
origin.  <var>appearance</var> determines the surface properties of the returned object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:polyline</b><var> coordinates appearance<a name="index-solid_003apolyline-795"></a></var><br>

  &mdash; Function: <b>solid:polyline</b><var> coordinates<a name="index-solid_003apolyline-796"></a></var><br>
<blockquote><p><var>coordinates</var> must be a list or vector of coordinate lists or vectors
specifying the x, y, and z coordinates of points.  <code>solid:polyline</code> returns lines
connecting successive pairs of points.  If called with one argument,
then the polyline will be white.  If <var>appearance</var> is given, then the polyline
will have its emissive color only; being black if <var>appearance</var> does not have
an emissive color.

       <p>The following code will return a red line between points at
<code>(1 2 3)</code> and <code>(4 5 6)</code>:
     <pre class="example">          (solid:polyline '((1 2 3) (4 5 6)) (solid:color #f 0 #f 0 '(1 0 0)))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:prism</b><var> xz-array y appearance<a name="index-solid_003aprism-797"></a></var><br>

  &mdash; Function: <b>solid:prism</b><var> xz-array y<a name="index-solid_003aprism-798"></a></var><br>
<blockquote><p><var>xz-array</var> must be an <var>n</var>-by-2 array holding a sequence of coordinates
tracing a non-intersecting clockwise loop in the x-z plane.  <code>solid:prism</code> will
close the sequence if the first and last coordinates are not the
same.

       <p><code>solid:prism</code> returns a capped prism <var>y</var> long. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:basrelief</b><var> width height depth colorray appearance<a name="index-solid_003abasrelief-799"></a></var><br>

  &mdash; Function: <b>solid:basrelief</b><var> width height depth appearance<a name="index-solid_003abasrelief-800"></a></var><br>

  &mdash; Function: <b>solid:basrelief</b><var> width height depth<a name="index-solid_003abasrelief-801"></a></var><br>
<blockquote><p>One of <var>width</var>, <var>height</var>, or <var>depth</var> must be a 2-dimensional array; the others must
be real numbers giving the length of the basrelief in those
dimensions.  The rest of this description assumes that <var>height</var> is an
array of heights.

       <p><code>solid:basrelief</code> returns a <var>width</var> by <var>depth</var> basrelief solid with heights per array <var>height</var> with
the buttom surface centered on the origin.

       <p>If present, <var>appearance</var> determines the surface properties of the returned
object.  If present, <var>colorray</var> must be an array of objects of type
<a href="#Color-Data_002dType">color</a>, 24-bit sRGB integers or lists of 3
numbers between 0.0 and 1.0.

       <p>If <var>colorray</var>'s dimensions match <var>height</var>, then each element of <var>colorray</var> paints its
corresponding vertex of <var>height</var>.  If <var>colorray</var> has all dimensions one smaller
than <var>height</var>, then each element of <var>colorray</var> paints the corresponding face of
<var>height</var>.  Other dimensions for <var>colorray</var> are in error. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:text</b><var> fontstyle str len appearance<a name="index-solid_003atext-802"></a></var><br>

  &mdash; Function: <b>solid:text</b><var> fontstyle str len<a name="index-solid_003atext-803"></a></var><br>
<blockquote>
       <p><var>fontstyle</var> must be a value returned by <code>solid:font</code>.

       <p><var>str</var> must be a string or list of strings.

       <p><var>len</var> must be #f, a nonnegative integer, or list of nonnegative
integers.

       <p><var>appearance</var>, if given, determines the surface properties of the returned
object.

       <p><code>solid:text</code> returns a two-sided, flat text object positioned in the Z=0 plane
of the local coordinate system
</p></blockquote></div>

<h4 class="subheading">Surface Attributes</h4>

<div class="defun">
&mdash; Function: <b>solid:color</b><var> diffuseColor ambientIntensity specularColor shininess emissiveColor transparency<a name="index-solid_003acolor-804"></a></var><br>

  &mdash; Function: <b>solid:color</b><var> diffuseColor ambientIntensity specularColor shininess emissiveColor<a name="index-solid_003acolor-805"></a></var><br>

  &mdash; Function: <b>solid:color</b><var> diffuseColor ambientIntensity specularColor shininess<a name="index-solid_003acolor-806"></a></var><br>

  &mdash; Function: <b>solid:color</b><var> diffuseColor ambientIntensity specularColor<a name="index-solid_003acolor-807"></a></var><br>

  &mdash; Function: <b>solid:color</b><var> diffuseColor ambientIntensity<a name="index-solid_003acolor-808"></a></var><br>

  &mdash; Function: <b>solid:color</b><var> diffuseColor<a name="index-solid_003acolor-809"></a></var><br>
<blockquote>
       <p>Returns an <dfn>appearance</dfn>, the optical properties of the objects
<a name="index-appearance-810"></a>with which it is associated.  <var>ambientIntensity</var>, <var>shininess</var>, and <var>transparency</var> must be numbers between 0
and 1.  <var>diffuseColor</var>, <var>specularColor</var>, and <var>emissiveColor</var> are objects of type <a href="#Color-Data_002dType">color</a>,
24-bit sRGB integers or lists of 3 numbers between 0.0 and 1.0. 
If a color argument is omitted or #f, then the default color will be used. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:texture</b><var> image color scale rotation center translation<a name="index-solid_003atexture-811"></a></var><br>

  &mdash; Function: <b>solid:texture</b><var> image color scale rotation center<a name="index-solid_003atexture-812"></a></var><br>

  &mdash; Function: <b>solid:texture</b><var> image color scale rotation<a name="index-solid_003atexture-813"></a></var><br>

  &mdash; Function: <b>solid:texture</b><var> image color scale<a name="index-solid_003atexture-814"></a></var><br>

  &mdash; Function: <b>solid:texture</b><var> image color<a name="index-solid_003atexture-815"></a></var><br>

  &mdash; Function: <b>solid:texture</b><var> image<a name="index-solid_003atexture-816"></a></var><br>
<blockquote>
       <p>Returns an <dfn>appearance</dfn>, the optical properties of the objects
<a name="index-appearance-817"></a>with which it is associated.  <var>image</var> is a string naming a JPEG or PNG
image resource.  <var>color</var> is #f, a color, or the string returned by
<code>solid:color</code>.  The rest of the optional arguments specify
2-dimensional transforms applying to the <var>image</var>.

       <p><var>scale</var> must be #f, a number, or list or vector of 2 numbers specifying the
scale to apply to <var>image</var>.  <var>rotation</var> must be #f or the number of degrees to
rotate <var>image</var>.  <var>center</var> must be #f or a list or vector of 2 numbers specifying
the center of <var>image</var> relative to the <var>image</var> dimensions.  <var>translation</var> must be #f or a
list or vector of 2 numbers specifying the translation to apply to <var>image</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:font</b><var> family style justify size spacing language direction<a name="index-solid_003afont-818"></a></var><br>
<blockquote>
       <p>Returns a fontstyle object suitable for passing as an argument to
<code>solid:text</code>.  Any of the arguments may be #f, in which case
its default value, which is first in each list of allowed values, is
used.

       <p><var>family</var> is a case-sensitive string naming a font; &lsquo;<samp><span class="samp">SERIF</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">SANS</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">TYPEWRITER</span></samp>&rsquo; are supported at the minimum.

       <p><var>style</var> is a case-sensitive string &lsquo;<samp><span class="samp">PLAIN</span></samp>&rsquo;, &lsquo;<samp><span class="samp">BOLD</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">ITALIC</span></samp>&rsquo;, or &lsquo;<samp><span class="samp">BOLDITALIC</span></samp>&rsquo;.

       <p><var>justify</var> is a case-sensitive string &lsquo;<samp><span class="samp">FIRST</span></samp>&rsquo;, &lsquo;<samp><span class="samp">BEGIN</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">MIDDLE</span></samp>&rsquo;, or &lsquo;<samp><span class="samp">END</span></samp>&rsquo;; or a list of one or two case-sensitive
strings (same choices).  The mechanics of <var>justify</var> get complicated; it is
explained by tables 6.2 to 6.7 of
<a href="http://www.web3d.org/x3d/specifications/vrml/ISO-IEC-14772-IS-VRML97WithAmendment1/part1/nodesRef.html#Table6.2">http://www.web3d.org/x3d/specifications/vrml/ISO-IEC-14772-IS-VRML97WithAmendment1/part1/nodesRef.html#Table6.2</a>

       <p><var>size</var> is the extent, in the non-advancing direction, of the text. 
<var>size</var> defaults to 1.

       <p><var>spacing</var> is the ratio of the line (or column) offset to <var>size</var>. 
<var>spacing</var> defaults to 1.

       <p><var>language</var> is the RFC-1766 language name.

       <p><var>direction</var> is a list of two numbers: <code>(</code><var>x</var><code>&nbsp;</code><var>y</var><code>)</code><!-- /@w -->.  If
<code>(&gt;&nbsp;(abs&nbsp;</code><var>x</var><code>)&nbsp;(abs&nbsp;</code><var>y</var><code>))</code><!-- /@w -->, then the text will be
arrayed horizontally; otherwise vertically.  The direction in which
characters are arrayed is determined by the sign of the major axis:
positive <var>x</var> being left-to-right; positive <var>y</var> being
top-to-bottom. 
</p></blockquote></div>

<h4 class="subheading">Aggregating Objects</h4>

<div class="defun">
&mdash; Function: <b>solid:center-row-of</b><var> number solid spacing<a name="index-solid_003acenter_002drow_002dof-819"></a></var><br>
<blockquote><p>Returns a row of <var>number</var> <var>solid</var> objects spaced evenly <var>spacing</var> apart. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:center-array-of</b><var> number-a number-b solid spacing-a spacing-b<a name="index-solid_003acenter_002darray_002dof-820"></a></var><br>
<blockquote><p>Returns <var>number-b</var> rows, <var>spacing-b</var> apart, of <var>number-a</var> <var>solid</var> objects <var>spacing-a</var> apart. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:center-pile-of</b><var> number-a number-b number-c solid spacing-a spacing-b spacing-c<a name="index-solid_003acenter_002dpile_002dof-821"></a></var><br>
<blockquote><p>Returns <var>number-c</var> planes, <var>spacing-c</var> apart, of <var>number-b</var> rows, <var>spacing-b</var> apart, of <var>number-a</var> <var>solid</var> objects <var>spacing-a</var> apart. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:arrow</b><var> center<a name="index-solid_003aarrow-822"></a></var><br>
<blockquote>
       <p><var>center</var> must be a list or vector of three numbers.  Returns an upward
pointing metallic arrow centered at <var>center</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:arrow</b><var><a name="index-solid_003aarrow-823"></a></var><br>
<blockquote><p>Returns an upward pointing metallic arrow centered at the origin. 
</p></blockquote></div>

<h4 class="subheading">Spatial Transformations</h4>

<div class="defun">
&mdash; Function: <b>solid:translation</b><var> center solid <small class="dots">...</small><a name="index-solid_003atranslation-824"></a></var><br>
<blockquote><p><var>center</var> must be a list or vector of three numbers.  <code>solid:translation</code> Returns an
aggregate of <var>solids</var>, <small class="dots">...</small> with their origin moved to <var>center</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:scale</b><var> scale solid <small class="dots">...</small><a name="index-solid_003ascale-825"></a></var><br>
<blockquote><p><var>scale</var> must be a number or a list or vector of three numbers.  <code>solid:scale</code>
Returns an aggregate of <var>solids</var>, <small class="dots">...</small> scaled per <var>scale</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solid:rotation</b><var> axis angle solid <small class="dots">...</small><a name="index-solid_003arotation-826"></a></var><br>
<blockquote><p><var>axis</var> must be a list or vector of three numbers.  <code>solid:rotation</code> Returns an
aggregate of <var>solids</var>, <small class="dots">...</small> rotated <var>angle</var> degrees around the axis <var>axis</var>. 
</p></blockquote></div>

<div class="node">
<a name="Color"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Root-Finding">Root Finding</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Solid-Modeling">Solid Modeling</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.11 Color</h3>

<p><a href="http://people.csail.mit.edu/jaffer/Color">http://people.csail.mit.edu/jaffer/Color</a>

<p class="noindent">The goals of this package are to provide methods to specify, compute,
and transform colors in a core set of additive color spaces.  The color
spaces supported should be sufficient for working with the color data
encountered in practice and the literature.

<ul class="menu">
<li><a accesskey="1" href="#Color-Data_002dType">Color Data-Type</a>:              'color
<li><a accesskey="2" href="#Color-Spaces">Color Spaces</a>:                 XYZ, L*a*b*, L*u*v*, L*C*h, RGB709, sRGB
<li><a accesskey="3" href="#Spectra">Spectra</a>:                      Color Temperatures and CIEXYZ(1931)
<li><a accesskey="4" href="#Color-Difference-Metrics">Color Difference Metrics</a>:     Society of Dyers and Colorists
<li><a accesskey="5" href="#Color-Conversions">Color Conversions</a>:            Low-level
<li><a accesskey="6" href="#Color-Names">Color Names</a>:                  in relational databases
<li><a accesskey="7" href="#Daylight">Daylight</a>:                     Sunlight and sky colors
</ul>

<div class="node">
<a name="Color-Data-Type"></a>
<a name="Color-Data_002dType"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Color-Spaces">Color Spaces</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Color">Color</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Color">Color</a>

</div>

<h4 class="subsection">5.11.1 Color Data-Type</h4>

<p><code>(require 'color)</code>

<div class="defun">
&mdash; Function: <b>color?</b><var> obj<a name="index-color_003f-827"></a></var><br>
<blockquote><p>Returns #t if <var>obj</var> is a color. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color?</b><var> obj typ<a name="index-color_003f-828"></a></var><br>
<blockquote><p>Returns #t if <var>obj</var> is a color of color-space <var>typ</var>.  The symbol
<var>typ</var> must be one of:

          <ul>
<li>CIEXYZ
<li>RGB709
<li>L*a*b*
<li>L*u*v*
<li>sRGB
<li>e-sRGB
<li>L*C*h
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-color</b><var> space arg <small class="dots">...</small><a name="index-make_002dcolor-829"></a></var><br>
<blockquote><p>Returns a color of type <var>space</var>.

          <ul>
<li>For <var>space</var> arguments <code>CIEXYZ</code>, <code>RGB709</code>, and
<code>sRGB</code>, the sole <var>arg</var> is a list of three numbers. 
<li>For <var>space</var> arguments <code>L*a*b*</code>, <code>L*u*v*</code>, and
<code>L*C*h</code>, <var>arg</var> is a list of three numbers optionally followed
by a whitepoint. 
<li>For <code>xRGB</code>, <var>arg</var> is an integer. 
<li>For <code>e-sRGB</code>, the arguments are as for <code>e-sRGB-&gt;color</code>. 
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-space</b><var> color<a name="index-color_002dspace-830"></a></var><br>
<blockquote><p>Returns the symbol for the color-space in which <var>color</var> is embedded. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-precision</b><var> color<a name="index-color_002dprecision-831"></a></var><br>
<blockquote><p>For colors in digital color-spaces, <code>color-precision</code> returns the
number of bits used for each of the R, G, and B channels of the
encoding.  Otherwise, <code>color-precision</code> returns #f
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-white-point</b><var> color<a name="index-color_002dwhite_002dpoint-832"></a></var><br>
<blockquote><p>Returns the white-point of <var>color</var> in all color-spaces except CIEXYZ. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>convert-color</b><var> color space white-point<a name="index-convert_002dcolor-833"></a></var><br>
&mdash; Function: <b>convert-color</b><var> color space<a name="index-convert_002dcolor-834"></a></var><br>
&mdash; Function: <b>convert-color</b><var> color e-sRGB precision<a name="index-convert_002dcolor-835"></a></var><br>
<blockquote><p>Converts <var>color</var> into <var>space</var> at optional <var>white-point</var>. 
</p></blockquote></div>

<h5 class="subsubsection">5.11.1.1 External Representation</h5>

<p class="noindent">Each color encoding has an external, case-insensitive representation. 
To ensure portability, the white-point for all color strings is D65. 
<a rel="footnote" href="#fn-5" name="fnd-5"><sup>5</sup></a>

  <p><table summary=""><tr align="left"><td valign="top" width="33%">Color Space
</td><td valign="top" width="66%">External Representation
<br></td></tr><tr align="left"><td valign="top" width="33%">CIEXYZ
</td><td valign="top" width="66%">CIEXYZ:<i>&lt;X&gt;</i>/<i>&lt;Y&gt;</i>/<i>&lt;Z&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">RGB709
</td><td valign="top" width="66%">RGBi:<i>&lt;R&gt;</i>/<i>&lt;G&gt;</i>/<i>&lt;B&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">L*a*b*
</td><td valign="top" width="66%">CIELAB:<i>&lt;L&gt;</i>/<i>&lt;a&gt;</i>/<i>&lt;b&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">L*u*v*
</td><td valign="top" width="66%">CIELuv:<i>&lt;L&gt;</i>/<i>&lt;u&gt;</i>/<i>&lt;v&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">L*C*h
</td><td valign="top" width="66%">CIELCh:<i>&lt;L&gt;</i>/<i>&lt;C&gt;</i>/<i>&lt;h&gt;</i>
  <br></td></tr></table>

<p class="noindent">The <var>X</var>, <var>Y</var>, <var>Z</var>, <var>L</var>, <var>a</var>, <var>b</var>, <var>u</var>,
<var>v</var>, <var>C</var>, <var>h</var>, <var>R</var>, <var>G</var>, and <var>B</var> fields are
(Scheme) real numbers within the appropriate ranges.

  <p><table summary=""><tr align="left"><td valign="top" width="33%">Color Space
</td><td valign="top" width="66%">External Representation
<br></td></tr><tr align="left"><td valign="top" width="33%">sRGB
</td><td valign="top" width="66%">sRGB:<i>&lt;R&gt;</i>/<i>&lt;G&gt;</i>/<i>&lt;B&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">e-sRGB10
</td><td valign="top" width="66%">e-sRGB10:<i>&lt;R&gt;</i>/<i>&lt;G&gt;</i>/<i>&lt;B&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">e-sRGB12
</td><td valign="top" width="66%">e-sRGB12:<i>&lt;R&gt;</i>/<i>&lt;G&gt;</i>/<i>&lt;B&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">e-sRGB16
</td><td valign="top" width="66%">e-sRGB16:<i>&lt;R&gt;</i>/<i>&lt;G&gt;</i>/<i>&lt;B&gt;</i>
  <br></td></tr></table>

<p class="noindent">The <var>R</var>, <var>G</var>, and <var>B</var>, fields are non-negative exact decimal
integers within the appropriate ranges.

<p class="noindent">Several additional syntaxes are supported by <code>string-&gt;color</code>:

  <p><table summary=""><tr align="left"><td valign="top" width="33%">Color Space
</td><td valign="top" width="66%">External Representation
<br></td></tr><tr align="left"><td valign="top" width="33%">sRGB
</td><td valign="top" width="66%">sRGB:<i>&lt;RRGGBB&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">sRGB
</td><td valign="top" width="66%">#<i>&lt;RRGGBB&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">sRGB
</td><td valign="top" width="66%">0x<i>&lt;RRGGBB&gt;</i>
<br></td></tr><tr align="left"><td valign="top" width="33%">sRGB
</td><td valign="top" width="66%">#x<i>&lt;RRGGBB&gt;</i>
  <br></td></tr></table>

  <p>Where <var>RRGGBB</var> is a non-negative six-digit hexadecimal number.

<div class="defun">
&mdash; Function: <b>color-&gt;string</b><var> color<a name="index-color_002d_003estring-836"></a></var><br>
<blockquote><p>Returns a string representation of <var>color</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-&gt;color</b><var> string<a name="index-string_002d_003ecolor-837"></a></var><br>
<blockquote><p>Returns the color represented by <var>string</var>.  If <var>string</var> is not a
syntactically valid notation for a color, then <code>string-&gt;color</code>
returns #f. 
</p></blockquote></div>

<h5 class="subsubsection">5.11.1.2 White</h5>

<p class="noindent">We experience color relative to the illumination around us. 
CIEXYZ coordinates, although subject to uniform scaling, are
objective.  Thus other color spaces are specified relative to a
<a name="index-white-point-838"></a><dfn>white point</dfn> in CIEXYZ coordinates. 
<a name="index-white-point-839"></a>
The white point for digital color spaces is set to D65.  For the other
spaces a <var>white-point</var> argument can be specified.  The default if
none is specified is the white-point with which the color was created
or last converted; and D65 if none has been specified.

<div class="defun">
&mdash; Constant: <b>D65</b><var><a name="index-D65-840"></a></var><br>
<blockquote><p>Is the color of 6500.K (blackbody) illumination.  D65 is close
to the average color of daylight. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>D50</b><var><a name="index-D50-841"></a></var><br>
<blockquote><p>Is the color of 5000.K (blackbody) illumination.  D50 is the color of
indoor lighting by incandescent bulbs, whose filaments have
temperatures around 5000.K. 
</p></blockquote></div>

<div class="node">
<a name="Color-Spaces"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Spectra">Spectra</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Color-Data_002dType">Color Data-Type</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Color">Color</a>

</div>

<h4 class="subsection">5.11.2 Color Spaces</h4>

<h5 class="subsubheading">Measurement-based Color Spaces</h5>

<p class="noindent"><a name="index-tristimulus-842"></a>The <dfn>tristimulus</dfn> color spaces are those whose component values
<a name="index-tristimulus-843"></a>are proportional measurements of light intensity.  The CIEXYZ(1931)
system provides 3 sets of spectra to dot-product with a spectrum of
interest.  The result of those dot-products is coordinates in CIEXYZ
space.  All tristimuls color spaces are related to CIEXYZ by linear
transforms, namely matrix multiplication.  Of the color spaces listed
here, CIEXYZ and RGB709 are tristimulus spaces.

<div class="defun">
&mdash; Color Space: <b>CIEXYZ</b><var><a name="index-CIEXYZ-844"></a></var><br>
<blockquote><p>The CIEXYZ color space covers the full <dfn>gamut</dfn>. 
<a name="index-gamut-845"></a>It is the basis for color-space conversions.

       <p>CIEXYZ is a list of three inexact numbers between 0.0 and 1.1. 
'(0. 0. 0.) is black; '(1. 1. 1.) is white. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ciexyz-&gt;color</b><var> xyz<a name="index-ciexyz_002d_003ecolor-846"></a></var><br>
<blockquote>
       <p><var>xyz</var> must be a list of 3 numbers.  If <var>xyz</var> is valid CIEXYZ coordinates,
then <code>ciexyz-&gt;color</code> returns the color specified by <var>xyz</var>; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:ciexyz</b><var> x y z<a name="index-color_003aciexyz-847"></a></var><br>
<blockquote>
       <p>Returns the CIEXYZ color composed of <var>x</var>, <var>y</var>, <var>z</var>.  If the
coordinates do not encode a valid CIEXYZ color, then an error is
signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;ciexyz</b><var> color<a name="index-color_002d_003eciexyz-848"></a></var><br>
<blockquote><p>Returns the list of 3 numbers encoding <var>color</var> in CIEXYZ. 
</p></blockquote></div>

<div class="defun">
&mdash; Color Space: <b>RGB709</b><var><a name="index-RGB709-849"></a></var><br>
<blockquote><p>BT.709-4 (03/00) <cite>Parameter values for the HDTV standards for
production and international programme exchange</cite> specifies parameter
values for chromaticity, sampling, signal format, frame rates, etc., of
high definition television signals.

       <p>An RGB709 color is represented by a list of three inexact numbers
between 0.0 and 1.0.  '(0. 0. 0.) is black '(1. 1. 1.) is white. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>rgb709-&gt;color</b><var> rgb<a name="index-rgb709_002d_003ecolor-850"></a></var><br>
<blockquote>
       <p><var>rgb</var> must be a list of 3 numbers.  If <var>rgb</var> is valid RGB709 coordinates,
then <code>rgb709-&gt;color</code> returns the color specified by <var>rgb</var>; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:rgb709</b><var> r g b<a name="index-color_003argb709-851"></a></var><br>
<blockquote>
       <p>Returns the RGB709 color composed of <var>r</var>, <var>g</var>, <var>b</var>.  If the
coordinates do not encode a valid RGB709 color, then an error is
signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;rgb709</b><var> color<a name="index-color_002d_003ergb709-852"></a></var><br>
<blockquote><p>Returns the list of 3 numbers encoding <var>color</var> in RGB709. 
</p></blockquote></div>

<h5 class="subsubheading">Perceptual Uniformity</h5>

<p class="noindent">Although properly encoding the chromaticity, tristimulus spaces do not
match the logarithmic response of human visual systems to intensity. 
Minimum detectable differences between colors correspond to a smaller
range of distances (6:1) in the L*a*b* and L*u*v* spaces than in
tristimulus spaces (80:1).  For this reason, color distances are
computed in L*a*b* (or L*C*h).

<div class="defun">
&mdash; Color Space: <b>L*a*b*</b><var><a name="index-L_002aa_002ab_002a-853"></a></var><br>
<blockquote><p>Is a CIE color space which better matches the human visual system's
perception of color.  It is a list of three numbers:

          <ul>
<li>0 &lt;= L* &lt;= 100 (CIE <dfn>Lightness</dfn>)
<a name="index-Lightness-854"></a>
<li>-500 &lt;= a* &lt;= 500
<li>-200 &lt;= b* &lt;= 200
</ul>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>l*a*b*-&gt;color</b><var> L*a*b* white-point<a name="index-l_002aa_002ab_002a_002d_003ecolor-855"></a></var><br>
<blockquote>
       <p><var>L*a*b*</var> must be a list of 3 numbers.  If <var>L*a*b*</var> is valid L*a*b* coordinates,
then <code>l*a*b*-&gt;color</code> returns the color specified by <var>L*a*b*</var>; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:l*a*b*</b><var> L* a* b* white-point<a name="index-color_003al_002aa_002ab_002a-856"></a></var><br>
<blockquote>
       <p>Returns the L*a*b* color composed of <var>L*</var>, <var>a*</var>, <var>b*</var> with <var>white-point</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color:l*a*b*</b><var> L* a* b*<a name="index-color_003al_002aa_002ab_002a-857"></a></var><br>
<blockquote><p>Returns the L*a*b* color composed of <var>L*</var>, <var>a*</var>, <var>b*</var>.  If the coordinates
do not encode a valid L*a*b* color, then an error is signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;l*a*b*</b><var> color white-point<a name="index-color_002d_003el_002aa_002ab_002a-858"></a></var><br>
<blockquote>
       <p>Returns the list of 3 numbers encoding <var>color</var> in L*a*b* with <var>white-point</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;l*a*b*</b><var> color<a name="index-color_002d_003el_002aa_002ab_002a-859"></a></var><br>
<blockquote><p>Returns the list of 3 numbers encoding <var>color</var> in L*a*b*. 
</p></blockquote></div>

<div class="defun">
&mdash; Color Space: <b>L*u*v*</b><var><a name="index-L_002au_002av_002a-860"></a></var><br>
<blockquote><p>Is another CIE encoding designed to better match the human visual
system's perception of color. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>l*u*v*-&gt;color</b><var> L*u*v* white-point<a name="index-l_002au_002av_002a_002d_003ecolor-861"></a></var><br>
<blockquote>
       <p><var>L*u*v*</var> must be a list of 3 numbers.  If <var>L*u*v*</var> is valid L*u*v* coordinates,
then <code>l*u*v*-&gt;color</code> returns the color specified by <var>L*u*v*</var>; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:l*u*v*</b><var> L* u* v* white-point<a name="index-color_003al_002au_002av_002a-862"></a></var><br>
<blockquote>
       <p>Returns the L*u*v* color composed of <var>L*</var>, <var>u*</var>, <var>v*</var> with <var>white-point</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color:l*u*v*</b><var> L* u* v*<a name="index-color_003al_002au_002av_002a-863"></a></var><br>
<blockquote><p>Returns the L*u*v* color composed of <var>L*</var>, <var>u*</var>, <var>v*</var>.  If the coordinates
do not encode a valid L*u*v* color, then an error is signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;l*u*v*</b><var> color white-point<a name="index-color_002d_003el_002au_002av_002a-864"></a></var><br>
<blockquote>
       <p>Returns the list of 3 numbers encoding <var>color</var> in L*u*v* with <var>white-point</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;l*u*v*</b><var> color<a name="index-color_002d_003el_002au_002av_002a-865"></a></var><br>
<blockquote><p>Returns the list of 3 numbers encoding <var>color</var> in L*u*v*. 
</p></blockquote></div>

<h5 class="subsubheading">Cylindrical Coordinates</h5>

<p class="noindent">HSL (Hue Saturation Lightness), HSV (Hue Saturation Value), HSI (Hue
Saturation Intensity) and HCI (Hue Chroma Intensity) are cylindrical
color spaces (with angle hue).  But these spaces are all defined in
terms device-dependent RGB spaces.

<p class="noindent">One might wonder if there is some fundamental reason why intuitive
specification of color must be device-dependent.  But take heart!  A
cylindrical system can be based on L*a*b* and is used for predicting how
close colors seem to observers.

<div class="defun">
&mdash; Color Space: <b>L*C*h</b><var><a name="index-L_002aC_002ah-866"></a></var><br>
<blockquote><p>Expresses the *a and b* of L*a*b* in polar coordinates.  It is a list of
three numbers:

          <ul>
<li>0 &lt;= L* &lt;= 100 (CIE <dfn>Lightness</dfn>)
<a name="index-Lightness-867"></a>
<li>C* (CIE <dfn>Chroma</dfn>) is the distance from the neutral (gray) axis. 
<a name="index-Chroma-868"></a><li>0 &lt;= h &lt;= 360 (CIE <dfn>Hue</dfn>) is the angle. 
<a name="index-Hue-869"></a></ul>

       <p>The colors by quadrant of h are:

       <p><table summary=""><tr align="left"><td valign="top" width="20%">0 </td><td valign="top" width="60%">red, orange, yellow </td><td valign="top" width="20%">90
<br></td></tr><tr align="left"><td valign="top" width="20%">90 </td><td valign="top" width="60%">yellow, yellow-green, green </td><td valign="top" width="20%">180
<br></td></tr><tr align="left"><td valign="top" width="20%">180 </td><td valign="top" width="60%">green, cyan (blue-green), blue </td><td valign="top" width="20%">270
<br></td></tr><tr align="left"><td valign="top" width="20%">270 </td><td valign="top" width="60%">blue, purple, magenta </td><td valign="top" width="20%">360
       <br></td></tr></table>

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>l*c*h-&gt;color</b><var> L*C*h white-point<a name="index-l_002ac_002ah_002d_003ecolor-870"></a></var><br>
<blockquote>
       <p><var>L*C*h</var> must be a list of 3 numbers.  If <var>L*C*h</var> is valid L*C*h coordinates,
then <code>l*c*h-&gt;color</code> returns the color specified by <var>L*C*h</var>; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:l*c*h</b><var> L* C* h white-point<a name="index-color_003al_002ac_002ah-871"></a></var><br>
<blockquote>
       <p>Returns the L*C*h color composed of <var>L*</var>, <var>C*</var>, <var>h</var> with <var>white-point</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color:l*c*h</b><var> L* C* h<a name="index-color_003al_002ac_002ah-872"></a></var><br>
<blockquote><p>Returns the L*C*h color composed of <var>L*</var>, <var>C*</var>, <var>h</var>.  If the coordinates
do not encode a valid L*C*h color, then an error is signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;l*c*h</b><var> color white-point<a name="index-color_002d_003el_002ac_002ah-873"></a></var><br>
<blockquote>
       <p>Returns the list of 3 numbers encoding <var>color</var> in L*C*h with <var>white-point</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;l*c*h</b><var> color<a name="index-color_002d_003el_002ac_002ah-874"></a></var><br>
<blockquote><p>Returns the list of 3 numbers encoding <var>color</var> in L*C*h. 
</p></blockquote></div>

<h5 class="subsubheading">Digital Color Spaces</h5>

<p class="noindent">The color spaces discussed so far are impractical for image data because
of numerical precision and computational requirements.  In 1998 the IEC
adopted <cite>A Standard Default Color Space for the Internet - sRGB</cite>
(<a href="http://www.w3.org/Graphics/Color/sRGB">http://www.w3.org/Graphics/Color/sRGB</a>).  sRGB was cleverly
designed to employ the 24-bit (256x256x256) color encoding already in
widespread use; and the 2.2 gamma intrinsic to CRT monitors.

<p class="noindent">Conversion from CIEXYZ to digital (sRGB) color spaces is accomplished by
conversion first to a RGB709 tristimulus space with D65 white-point;
then each coordinate is individually subjected to the same non-linear
mapping.  Inverse operations in the reverse order create the inverse
transform.

<div class="defun">
&mdash; Color Space: <b>sRGB</b><var><a name="index-sRGB-875"></a></var><br>
<blockquote><p>Is "A Standard Default Color Space for the Internet".  Most display
monitors will work fairly well with sRGB directly.  Systems using ICC
profiles
<a name="index-ICC-Profile-876"></a><a rel="footnote" href="#fn-6" name="fnd-6"><sup>6</sup></a>
should work very well with sRGB.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>srgb-&gt;color</b><var> rgb<a name="index-srgb_002d_003ecolor-877"></a></var><br>
<blockquote>
       <p><var>rgb</var> must be a list of 3 numbers.  If <var>rgb</var> is valid sRGB coordinates,
then <code>srgb-&gt;color</code> returns the color specified by <var>rgb</var>; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:srgb</b><var> r g b<a name="index-color_003asrgb-878"></a></var><br>
<blockquote>
       <p>Returns the sRGB color composed of <var>r</var>, <var>g</var>, <var>b</var>.  If the
coordinates do not encode a valid sRGB color, then an error is
signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Color Space: <b>xRGB</b><var><a name="index-xRGB-879"></a></var><br>
<blockquote><p>Represents the equivalent sRGB color with a single 24-bit integer.  The
most significant 8 bits encode red, the middle 8 bits blue, and the
least significant 8 bits green. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;srgb</b><var> color<a name="index-color_002d_003esrgb-880"></a></var><br>
<blockquote>
       <p>Returns the list of 3 integers encoding <var>color</var> in sRGB. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;xrgb</b><var> color<a name="index-color_002d_003exrgb-881"></a></var><br>
<blockquote><p>Returns the 24-bit integer encoding <var>color</var> in sRGB. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>xrgb-&gt;color</b><var> k<a name="index-xrgb_002d_003ecolor-882"></a></var><br>
<blockquote>
       <p>Returns the sRGB color composed of the 24-bit integer <var>k</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Color Space: <b>e-sRGB</b><var><a name="index-e_002dsRGB-883"></a></var><br>
<blockquote><p>Is "Photography - Electronic still picture imaging - Extended sRGB color
encoding" (PIMA 7667:2001).  It extends the gamut of sRGB; and its
higher precision numbers provide a larger dynamic range.

       <p>A triplet of integers represent e-sRGB colors.  Three precisions are
supported:

          <dl>
<dt><span class="roman">e-sRGB10</span><dd>0 to 1023
<br><dt><span class="roman">e-sRGB12</span><dd>0 to 4095
<br><dt><span class="roman">e-sRGB16</span><dd>0 to 65535
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>e-srgb-&gt;color</b><var> precision rgb<a name="index-e_002dsrgb_002d_003ecolor-884"></a></var><br>
<blockquote><p><var>precision</var> must be the integer 10, 12, or 16.  <var>rgb</var> must be a list of 3
numbers.  If <var>rgb</var> is valid e-sRGB coordinates, then <code>e-srgb-&gt;color</code> returns the color
specified by <var>rgb</var>; otherwise returns #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:e-srgb</b><var> 10 r g b<a name="index-color_003ae_002dsrgb-885"></a></var><br>
<blockquote>
       <p>Returns the e-sRGB10 color composed of integers <var>r</var>, <var>g</var>, <var>b</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color:e-srgb</b><var> 12 r g b<a name="index-color_003ae_002dsrgb-886"></a></var><br>
<blockquote><p>Returns the e-sRGB12 color composed of integers <var>r</var>, <var>g</var>, <var>b</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color:e-srgb</b><var> 16 r g b<a name="index-color_003ae_002dsrgb-887"></a></var><br>
<blockquote><p>Returns the e-sRGB16 color composed of integers <var>r</var>, <var>g</var>, <var>b</var>. 
If the coordinates do not encode a valid e-sRGB color, then an error
is signaled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-&gt;e-srgb</b><var> precision color<a name="index-color_002d_003ee_002dsrgb-888"></a></var><br>
<blockquote><p><var>precision</var> must be the integer 10, 12, or 16.  <code>color-&gt;e-srgb</code> returns the list of 3
integers encoding <var>color</var> in sRGB10, sRGB12, or sRGB16. 
</p></blockquote></div>

<div class="node">
<a name="Spectra"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Color-Difference-Metrics">Color Difference Metrics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Color-Spaces">Color Spaces</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Color">Color</a>

</div>

<h4 class="subsection">5.11.3 Spectra</h4>

<p class="noindent">The following functions compute colors from spectra, scale color
luminance, and extract chromaticity.  XYZ is used in the names of
procedures for unnormalized colors; the coordinates of CIEXYZ colors are
constrained as described in <a href="#Color-Spaces">Color Spaces</a>.

  <p><code>(require 'color-space)</code>

<p class="noindent">A spectrum may be represented as:

     <ul>
<li>A procedure of one argument accepting real numbers from 380e-9 to
780e-9, the wavelength in meters; or
<li>A vector of real numbers representing intensity samples evenly spaced
over some range of wavelengths overlapping the range 380e-9 to 780e-9. 
</ul>

<p class="noindent">CIEXYZ values are calculated as dot-product with the X, Y (Luminance),
and Z <dfn>Spectral Tristimulus Values</dfn>.  The files <samp><span class="file">cie1931.xyz</span></samp>
and <samp><span class="file">cie1964.xyz</span></samp> in the distribution contain these CIE-defined
values. 
<a name="index-Spectral-Tristimulus-Values-889"></a>

<div class="defun">
&mdash; Feature: <b>cie1964</b><var><a name="index-cie1964-890"></a></var><br>
<blockquote><p><a name="index-cie1964-891"></a>Loads the Spectral Tristimulus Values
<cite>CIE 1964 Supplementary Standard Colorimetric Observer</cite>,
defining <var>cie:x-bar</var>, <var>cie:y-bar</var>, and <var>cie:z-bar</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Feature: <b>cie1931</b><var><a name="index-cie1931-892"></a></var><br>
<blockquote><p><a name="index-cie1931-893"></a>Loads the Spectral Tristimulus Values
<cite>CIE 1931 Supplementary Standard Colorimetric Observer</cite>,
defining <var>cie:x-bar</var>, <var>cie:y-bar</var>, and <var>cie:z-bar</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Feature: <b>ciexyz</b><var><a name="index-ciexyz-894"></a></var><br>
<blockquote><p><a name="index-ciexyz-895"></a>Requires Spectral Tristimulus Values, defaulting to cie1931,
defining <var>cie:x-bar</var>, <var>cie:y-bar</var>, and <var>cie:z-bar</var>. 
</p></blockquote></div>

<p class="noindent"><code>(require 'cie1964)</code> or <code>(require 'cie1931)</code> will
<a name="index-load_002dciexyz-896"></a><code>load-ciexyz</code> specific values used by the following spectrum
conversion procedures.  The spectrum conversion procedures
<code>(require 'ciexyz)</code> to assure that a set is loaded.

<div class="defun">
&mdash; Function: <b>read-cie-illuminant</b><var> path<a name="index-read_002dcie_002dilluminant-897"></a></var><br>
<blockquote><p><var>path</var> must be a string naming a file consisting of 107 numbers
for 5.nm intervals from 300.nm to 830.nm.  <code>read-cie-illuminant</code>
reads (using Scheme <code>read</code>) these numbers and returns a length
107 vector filled with them. 
</p></blockquote></div>

<pre class="example">     (define CIE:SI-D65
       (read-CIE-illuminant (in-vicinity (library-vicinity) "ciesid65.dat")))
     (spectrum-&gt;XYZ CIE:SI-D65 300e-9 830e-9)
     &rArr; (25.108569422374994 26.418013465625001 28.764075683374993)
</pre>
  <div class="defun">
&mdash; Function: <b>read-normalized-illuminant</b><var> path<a name="index-read_002dnormalized_002dilluminant-898"></a></var><br>
<blockquote><p><var>path</var> must be a string naming a file consisting of 107 numbers
for 5.nm intervals from 300.nm to 830.nm. 
<code>read-normalized-illuminant</code> reads (using Scheme <code>read</code>)
these numbers and returns a length 107 vector filled with them,
normalized so that <code>spectrum-&gt;XYZ</code> of the illuminant returns its
whitepoint. 
</p></blockquote></div>

  <p>CIE Standard Illuminants A and D65 are included with SLIB:

<pre class="example">     (define CIE:SI-A
       (read-normalized-illuminant (in-vicinity (library-vicinity) "ciesia.dat")))
     (define CIE:SI-D65
       (read-normalized-illuminant (in-vicinity (library-vicinity) "ciesid65.dat")))
     (spectrum-&gt;XYZ CIE:SI-A 300e-9 830e-9)
     &rArr; (1.098499460820401 999.9999999999998e-3 355.8173930654951e-3)
     (CIEXYZ-&gt;sRGB (spectrum-&gt;XYZ CIE:SI-A 300e-9 830e-9))
     &rArr; (255 234 133)
     (spectrum-&gt;XYZ CIE:SI-D65 300e-9 830e-9)
     &rArr; (950.4336673552745e-3 1.0000000000000002 1.0888053986649182)
     (CIEXYZ-&gt;sRGB (spectrum-&gt;XYZ CIE:SI-D65 300e-9 830e-9))
     &rArr; (255 255 255)
</pre>
  <div class="defun">
&mdash; Function: <b>illuminant-map</b><var> proc siv<a name="index-illuminant_002dmap-899"></a></var><br>
<blockquote><p><var>siv</var> must be a one-dimensional array or vector of 107 numbers. 
<code>illuminant-map</code> returns a vector of length 107 containing the
result of applying <var>proc</var> to each element of <var>siv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>illuminant-map-&gt;XYZ</b><var> proc siv<a name="index-illuminant_002dmap_002d_003eXYZ-900"></a></var><br>
<blockquote><p><code>(spectrum-&gt;XYZ (illuminant-map </code><var>proc</var> <var>siv</var><code>) 300e-9 830e-9)</code>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>spectrum-&gt;XYZ</b><var> proc<a name="index-spectrum_002d_003eXYZ-901"></a></var><br>
<blockquote><p><var>proc</var> must be a function of one argument.  <code>spectrum-&gt;XYZ</code>
computes the CIEXYZ(1931) values for the spectrum returned by <var>proc</var>
when called with arguments from 380e-9 to 780e-9, the wavelength in
meters. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>spectrum-&gt;XYZ</b><var> spectrum x1 x2<a name="index-spectrum_002d_003eXYZ-902"></a></var><br>
<blockquote><p><var>x1</var> and <var>x2</var> must be positive real numbers specifying the
wavelengths (in meters) corresponding to the zeroth and last elements of
vector or list <var>spectrum</var>.  <code>spectrum-&gt;XYZ</code> returns the
CIEXYZ(1931) values for a light source with spectral values proportional
to the elements of <var>spectrum</var> at evenly spaced wavelengths between
<var>x1</var> and <var>x2</var>.

       <p>Compute the colors of 6500.K and 5000.K blackbody radiation:

     <pre class="example">          (require 'color-space)
          (define xyz (spectrum-&gt;XYZ (blackbody-spectrum 6500)))
          (define y_n (cadr xyz))
          (map (lambda (x) (/ x y_n)) xyz)
              &rArr; (0.9687111145512467 1.0 1.1210875945303613)
          
          (define xyz (spectrum-&gt;XYZ (blackbody-spectrum 5000)))
          (map (lambda (x) (/ x y_n)) xyz)
              &rArr; (0.2933441826889158 0.2988931825387761 0.25783646831201573)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>spectrum-&gt;chromaticity</b><var> proc<a name="index-spectrum_002d_003echromaticity-903"></a></var><br>
&mdash; Function: <b>spectrum-&gt;chromaticity</b><var> spectrum x1 x2<a name="index-spectrum_002d_003echromaticity-904"></a></var><br>
<blockquote><p>Computes the chromaticity for the given spectrum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>wavelength-&gt;XYZ</b><var> w<a name="index-wavelength_002d_003eXYZ-905"></a></var><br>
<blockquote><p><var>w</var> must be a number between 380e-9 to 780e-9. 
<code>wavelength-&gt;XYZ</code> returns (unnormalized) XYZ values for a
monochromatic light source with wavelength <var>w</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>wavelength-&gt;chromaticity</b><var> w<a name="index-wavelength_002d_003echromaticity-906"></a></var><br>
<blockquote><p><var>w</var> must be a number between 380e-9 to 780e-9. 
<code>wavelength-&gt;chromaticity</code> returns the chromaticity for a
monochromatic light source with wavelength <var>w</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>blackbody-spectrum</b><var> temp<a name="index-blackbody_002dspectrum-907"></a></var><br>
&mdash; Function: <b>blackbody-spectrum</b><var> temp span<a name="index-blackbody_002dspectrum-908"></a></var><br>
<blockquote><p>Returns a procedure of one argument (wavelength in meters), which
returns the radiance of a black body at <var>temp</var>.

       <p>The optional argument <var>span</var> is the wavelength analog of bandwidth. 
With the default <var>span</var> of 1.nm (1e-9.m), the values returned by the
procedure correspond to the power of the photons with wavelengths
<var>w</var> to <var>w</var>+1e-9. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>temperature-&gt;XYZ</b><var> x<a name="index-temperature_002d_003eXYZ-909"></a></var><br>
<blockquote><p>The positive number <var>x</var> is a temperature in degrees kelvin. 
<code>temperature-&gt;XYZ</code> computes the unnormalized CIEXYZ(1931) values
for the spectrum of a black body at temperature <var>x</var>.

       <p>Compute the chromaticities of 6500.K and 5000.K blackbody radiation:

     <pre class="example">          (require 'color-space)
          (XYZ-&gt;chromaticity (temperature-&gt;XYZ 6500))
              &rArr; (0.3135191660557008 0.3236456786200268)
          
          (XYZ-&gt;chromaticity (temperature-&gt;XYZ 5000))
              &rArr; (0.34508082841161052 0.3516084965163377)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>temperature-&gt;chromaticity</b><var> x<a name="index-temperature_002d_003echromaticity-910"></a></var><br>
<blockquote><p>The positive number <var>x</var> is a temperature in degrees kelvin. 
<code>temperature-&gt;cromaticity</code> computes the chromaticity for the
spectrum of a black body at temperature <var>x</var>.

       <p>Compute the chromaticities of 6500.K and 5000.K blackbody radiation:

     <pre class="example">          (require 'color-space)
          (temperature-&gt;chromaticity 6500)
              &rArr; (0.3135191660557008 0.3236456786200268)
          
          (temperature-&gt;chromaticity 5000)
              &rArr; (0.34508082841161052 0.3516084965163377)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>XYZ-&gt;chromaticity</b><var> xyz<a name="index-XYZ_002d_003echromaticity-911"></a></var><br>
<blockquote><p>Returns a two element list: the x and y components of <var>xyz</var>
normalized to 1 (= <var>x</var> + <var>y</var> + <var>z</var>). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>chromaticity-&gt;CIEXYZ</b><var> x y<a name="index-chromaticity_002d_003eCIEXYZ-912"></a></var><br>
<blockquote><p>Returns the list of <var>x</var>, and <var>y</var>, 1 - <var>y</var> - <var>x</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>chromaticity-&gt;whitepoint</b><var> x y<a name="index-chromaticity_002d_003ewhitepoint-913"></a></var><br>
<blockquote><p>Returns the CIEXYZ(1931) values having luminosity 1 and chromaticity
<var>x</var> and <var>y</var>. 
</p></blockquote></div>

  <p><a name="index-xyY-914"></a>Many color datasets are expressed in <dfn>xyY</dfn> format; chromaticity with
CIE luminance (Y).  But xyY is not a CIE standard like CIEXYZ, CIELAB,
and CIELUV.  Although chrominance is well defined, the luminance
component is sometimes scaled to 1, sometimes to 100, but usually has no
obvious range.  With no given whitepoint, the only reasonable course is
to ascertain the luminance range of a dataset and normalize the values
to lie from 0 to 1.

<div class="defun">
&mdash; Function: <b>XYZ-&gt;xyY</b><var> xyz<a name="index-XYZ_002d_003exyY-915"></a></var><br>
<blockquote><p>Returns a three element list: the <var>x</var> and <var>y</var> components of
<var>XYZ</var> normalized to 1, and CIE luminance <var>Y</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>xyY-&gt;XYZ</b><var> xyY<a name="index-xyY_002d_003eXYZ-916"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>xyY:normalize-colors</b><var> colors<a name="index-xyY_003anormalize_002dcolors-917"></a></var><br>
<blockquote><p><var>colors</var> is a list of xyY triples.  <code>xyY:normalize-colors</code>
scales each chromaticity so it sums to 1 or less; and divides the
<var>Y</var> values by the maximum <var>Y</var> in the dataset, so all lie between
0 and 1. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>xyY:normalize-colors</b><var> colors n<a name="index-xyY_003anormalize_002dcolors-918"></a></var><br>
<blockquote><p>If <var>n</var> is positive real, then <code>xyY:normalize-colors</code> divides
the <var>Y</var> values by <var>n</var> times the maximum <var>Y</var> in the dataset.

       <p>If <var>n</var> is an exact non-positive integer, then
<code>xyY:normalize-colors</code> divides the <var>Y</var> values by the maximum of
the <var>Y</var>s in the dataset excepting the -<var>n</var> largest <var>Y</var>
values.

       <p>In all cases, returned <var>Y</var> values are limited to lie from 0 to 1. 
</p></blockquote></div>

<p class="noindent">Why would one want to normalize to other than 1?  If the sun or its
reflection is the brightest object in a scene, then normalizing to its
luminance will tend to make the rest of the scene very dark.  As with
photographs, limiting the specular highlights looks better than
darkening everything else.

<p class="noindent">The results of measurements being what they are,
<code>xyY:normalize-colors</code> is extremely tolerant.  Negative numbers are
replaced with zero, and chromaticities with sums greater than one are
scaled to sum to one.

<div class="node">
<a name="Color-Difference-Metrics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Color-Conversions">Color Conversions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Spectra">Spectra</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Color">Color</a>

</div>

<h4 class="subsection">5.11.4 Color Difference Metrics</h4>

<p><code>(require 'color-space)</code>

  <p>The low-level metric functions operate on lists of 3 numbers, lab1,
lab2, lch1, or lch2.

  <p><code>(require 'color)</code>

  <p>The wrapped functions operate on objects of type color, color1 and
color2 in the function entries.

<div class="defun">
&mdash; Function: <b>L*a*b*:DE*</b><var> lab1 lab2<a name="index-L_002aa_002ab_002a_003aDE_002a-919"></a></var><br>
<blockquote><p>Returns the Euclidean distance between <var>lab1</var> and <var>lab2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>CIE:DE*</b><var> color1 color2 white-point<a name="index-CIE_003aDE_002a-920"></a></var><br>
&mdash; Function: <b>CIE:DE*</b><var> color1 color2<a name="index-CIE_003aDE_002a-921"></a></var><br>
<blockquote><p>Returns the Euclidean distance in L*a*b* space between <var>color1</var> and
<var>color2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>L*a*b*:DE*94</b><var> lab1 lab2 parametric-factors<a name="index-L_002aa_002ab_002a_003aDE_002a94-922"></a></var><br>
&mdash; Function: <b>L*a*b*:DE*94</b><var> lab1 lab2<a name="index-L_002aa_002ab_002a_003aDE_002a94-923"></a></var><br>

  &mdash; Function: <b>CIE:DE*94</b><var> color1 color2 parametric-factors<a name="index-CIE_003aDE_002a94-924"></a></var><br>
&mdash; Function: <b>CIE:DE*94</b><var> color1 color2<a name="index-CIE_003aDE_002a94-925"></a></var><br>
<blockquote>
       <p>Measures distance in the L*a*b* color-space.  The three axes are
individually scaled in their contributions to the total distance.

       <p><code>DE*94</code> is not symmetrical in its arguments.  <var>lab1</var> is the
&ldquo;reference&rdquo; color and <var>lab2</var> is the &ldquo;sample&rdquo; color.

       <p>The CIE has defined reference conditions under which the metric with
default parameters can be expected to perform well.  These are:

          <ul>
<li>The specimens are homogeneous in colour. 
<li>The colour difference (CIELAB) is &lt;= 5 units. 
<li>They are placed in direct edge contact. 
<li>Each specimen subtends an angle of &gt;4 degrees to the assessor, whose
colour vision is normal. 
<li>They are illuminated at 1000 lux, and viewed against a background of
uniform grey, with L* of 50, under illumination simulating D65. 
</ul>

       <p>The <var>parametric-factors</var> argument is a list of 3 quantities kL, kC
and kH.  <var>parametric-factors</var> independently adjust each
colour-difference term to account for any deviations from the reference
viewing conditions.  Under the reference conditions explained above, the
default is kL = kC = kH = 1. 
</p></blockquote></div>

<p class="noindent">The Color Measurement Committee of The Society of Dyers and Colorists in
Great Britain created a more sophisticated color-distance function for
use in judging the consistency of dye lots.  With CMC:DE* it is possible
to use a single value pass/fail tolerance for all shades.

<div class="defun">
&mdash; Function: <b>CMC-DE</b><var> lch1 lch2 parametric-factors<a name="index-CMC_002dDE-926"></a></var><br>
&mdash; Function: <b>CMC-DE</b><var> lch1 lch2 l c<a name="index-CMC_002dDE-927"></a></var><br>
&mdash; Function: <b>CMC-DE</b><var> lch1 lch2 l<a name="index-CMC_002dDE-928"></a></var><br>
&mdash; Function: <b>CMC-DE</b><var> lch1 lch2<a name="index-CMC_002dDE-929"></a></var><br>

  &mdash; Function: <b>CMC:DE*</b><var> color1 color2 l c<a name="index-CMC_003aDE_002a-930"></a></var><br>
&mdash; Function: <b>CMC:DE*</b><var> color1 color2<a name="index-CMC_003aDE_002a-931"></a></var><br>
<blockquote>
       <p><code>CMC:DE</code> is a L*C*h metric.  The <var>parametric-factors</var>
argument is a list of 2 numbers <var>l</var> and <var>c</var>.  <var>l</var> and
<var>c</var> parameterize this metric.  1 and 1 are recommended for
perceptibility; the default, 2 and 1, for acceptability. 
</p></blockquote></div>

<div class="node">
<a name="Color-Conversions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Color-Names">Color Names</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Color-Difference-Metrics">Color Difference Metrics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Color">Color</a>

</div>

<h4 class="subsection">5.11.5 Color Conversions</h4>

<p class="noindent">This package contains the low-level color conversion and color metric
routines operating on lists of 3 numbers.  There is no type or range
checking.

  <p><code>(require 'color-space)</code>

<div class="defun">
&mdash; Constant: <b>CIEXYZ:D65</b><var><a name="index-CIEXYZ_003aD65-932"></a></var><br>
<blockquote><p>Is the color of 6500.K (blackbody) illumination.  D65 is close to the
average color of daylight. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>CIEXYZ:D50</b><var><a name="index-CIEXYZ_003aD50-933"></a></var><br>
<blockquote><p>Is the color of 5000.K (blackbody) illumination.  D50 is the color of
indoor lighting by incandescent bulbs. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>CIEXYZ:A</b><var><a name="index-CIEXYZ_003aA-934"></a></var><br>
&mdash; Constant: <b>CIEXYZ:B</b><var><a name="index-CIEXYZ_003aB-935"></a></var><br>
&mdash; Constant: <b>CIEXYZ:C</b><var><a name="index-CIEXYZ_003aC-936"></a></var><br>
&mdash; Constant: <b>CIEXYZ:E</b><var><a name="index-CIEXYZ_003aE-937"></a></var><br>
<blockquote><p>CIE 1931 illuminants normalized to 1 = y. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color:linear-transform</b><var> matrix row<a name="index-color_003alinear_002dtransform-938"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>CIEXYZ-&gt;RGB709</b><var> xyz<a name="index-CIEXYZ_002d_003eRGB709-939"></a></var><br>
&mdash; Function: <b>RGB709-&gt;CIEXYZ</b><var> srgb<a name="index-RGB709_002d_003eCIEXYZ-940"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>CIEXYZ-&gt;L*u*v*</b><var> xyz white-point<a name="index-CIEXYZ_002d_003eL_002au_002av_002a-941"></a></var><br>
&mdash; Function: <b>CIEXYZ-&gt;L*u*v*</b><var> xyz<a name="index-CIEXYZ_002d_003eL_002au_002av_002a-942"></a></var><br>
&mdash; Function: <b>L*u*v*-&gt;CIEXYZ</b><var> L*u*v* white-point<a name="index-L_002au_002av_002a_002d_003eCIEXYZ-943"></a></var><br>
&mdash; Function: <b>L*u*v*-&gt;CIEXYZ</b><var> L*u*v*<a name="index-L_002au_002av_002a_002d_003eCIEXYZ-944"></a></var><br>
<blockquote><p>The <var>white-point</var> defaults to CIEXYZ:D65. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>CIEXYZ-&gt;L*a*b*</b><var> xyz white-point<a name="index-CIEXYZ_002d_003eL_002aa_002ab_002a-945"></a></var><br>
&mdash; Function: <b>CIEXYZ-&gt;L*a*b*</b><var> xyz<a name="index-CIEXYZ_002d_003eL_002aa_002ab_002a-946"></a></var><br>
&mdash; Function: <b>L*a*b*-&gt;CIEXYZ</b><var> L*a*b* white-point<a name="index-L_002aa_002ab_002a_002d_003eCIEXYZ-947"></a></var><br>
&mdash; Function: <b>L*a*b*-&gt;CIEXYZ</b><var> L*a*b*<a name="index-L_002aa_002ab_002a_002d_003eCIEXYZ-948"></a></var><br>
<blockquote><p>The XYZ <var>white-point</var> defaults to CIEXYZ:D65. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>L*a*b*-&gt;L*C*h</b><var> L*a*b*<a name="index-L_002aa_002ab_002a_002d_003eL_002aC_002ah-949"></a></var><br>
&mdash; Function: <b>L*C*h-&gt;L*a*b*</b><var> L*C*h<a name="index-L_002aC_002ah_002d_003eL_002aa_002ab_002a-950"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>CIEXYZ-&gt;sRGB</b><var> xyz<a name="index-CIEXYZ_002d_003esRGB-951"></a></var><br>
&mdash; Function: <b>sRGB-&gt;CIEXYZ</b><var> srgb<a name="index-sRGB_002d_003eCIEXYZ-952"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>CIEXYZ-&gt;xRGB</b><var> xyz<a name="index-CIEXYZ_002d_003exRGB-953"></a></var><br>
&mdash; Function: <b>xRGB-&gt;CIEXYZ</b><var> srgb<a name="index-xRGB_002d_003eCIEXYZ-954"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>sRGB-&gt;xRGB</b><var> xyz<a name="index-sRGB_002d_003exRGB-955"></a></var><br>
&mdash; Function: <b>xRGB-&gt;sRGB</b><var> srgb<a name="index-xRGB_002d_003esRGB-956"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>CIEXYZ-&gt;e-sRGB</b><var> n xyz<a name="index-CIEXYZ_002d_003ee_002dsRGB-957"></a></var><br>
&mdash; Function: <b>e-sRGB-&gt;CIEXYZ</b><var> n srgb<a name="index-e_002dsRGB_002d_003eCIEXYZ-958"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>sRGB-&gt;e-sRGB</b><var> n srgb<a name="index-sRGB_002d_003ee_002dsRGB-959"></a></var><br>
&mdash; Function: <b>e-sRGB-&gt;sRGB</b><var> n srgb<a name="index-e_002dsRGB_002d_003esRGB-960"></a></var><br>
<blockquote><p>The integer <var>n</var> must be 10, 12, or 16.  Because sRGB and e-sRGB use
the same RGB709 chromaticities, conversion between them is simpler than
conversion through CIEXYZ. 
</p></blockquote></div>

<p class="noindent">Do not convert e-sRGB precision through <code>e-sRGB-&gt;sRGB</code> then
<code>sRGB-&gt;e-sRGB</code> &ndash; values would be truncated to 8-bits!

<div class="defun">
&mdash; Function: <b>e-sRGB-&gt;e-sRGB</b><var> n1 srgb n2<a name="index-e_002dsRGB_002d_003ee_002dsRGB-961"></a></var><br>
<blockquote><p>The integers <var>n1</var> and <var>n2</var> must be 10, 12, or 16. 
<code>e-sRGB-&gt;e-sRGB</code> converts <var>srgb</var> to e-sRGB of precision
<var>n2</var>. 
</p></blockquote></div>

<div class="node">
<a name="Color-Names"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Daylight">Daylight</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Color-Conversions">Color Conversions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Color">Color</a>

</div>

<h4 class="subsection">5.11.6 Color Names</h4>

<p><code>(require 'color-names)</code>
<a name="index-color_002dnames-962"></a>
Rather than ballast the color dictionaries with numbered grays,
<code>file-&gt;color-dictionary</code> discards them.  They are provided
through the <code>grey</code> procedure:

<div class="defun">
&mdash; Function: <b>grey</b><var> k<a name="index-grey-963"></a></var><br>
<blockquote>
       <p>Returns <code>(inexact-&gt;exact (round (* k 2.55)))</code>, the X11 color
grey<i>&lt;k&gt;</i>. 
</p></blockquote></div>

<p class="noindent">A color dictionary is a database table relating <dfn>canonical</dfn>
<a name="index-canonical-964"></a>color-names to color-strings
(see <a href="#Color-Data_002dType">External Representation</a>).

<p class="noindent">The column names in a color dictionary are unimportant; the first
field is the key, and the second is the color-string.

<div class="defun">
&mdash; Function: <b>color-name:canonicalize</b><var> name<a name="index-color_002dname_003acanonicalize-965"></a></var><br>
<blockquote><p>Returns a downcased copy of the string or symbol <var>name</var> with
&lsquo;<samp><span class="samp">_</span></samp>&rsquo;, &lsquo;<samp><span class="samp">-</span></samp>&rsquo;, and whitespace removed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-name-&gt;color</b><var> name table1 table2 <small class="dots">...</small><a name="index-color_002dname_002d_003ecolor-966"></a></var><br>
<blockquote>
       <p><var>table1</var>, <var>table2</var>, <small class="dots">...</small> must be color-dictionary tables.  <code>color-name-&gt;color</code> searches for the
canonical form of <var>name</var> in <var>table1</var>, <var>table2</var>, <small class="dots">...</small> in order; returning the
color-string of the first matching record; #f otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-dictionaries-&gt;lookup</b><var> table1 table2 <small class="dots">...</small><a name="index-color_002ddictionaries_002d_003elookup-967"></a></var><br>
<blockquote>
       <p><var>table1</var>, <var>table2</var>, <small class="dots">...</small> must be color-dictionary tables.  <code>color-dictionaries-&gt;lookup</code> returns a
procedure which searches for the canonical form of its string argument
in <var>table1</var>, <var>table2</var>, <small class="dots">...</small>; returning the color-string of the first matching
record; and #f otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>color-dictionary</b><var> name rdb base-table-type<a name="index-color_002ddictionary-968"></a></var><br>
<blockquote>
       <p><var>rdb</var> must be a string naming a relational database file; and the symbol
<var>name</var> a table therein.  The database will be opened as
<var>base-table-type</var>.  <code>color-dictionary</code> returns the read-only table <var>name</var> in database
<var>name</var> if it exists; #f otherwise.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>color-dictionary</b><var> name rdb<a name="index-color_002ddictionary-969"></a></var><br>
<blockquote>
       <p><var>rdb</var> must be an open relational database or a string naming a relational
database file; and the symbol <var>name</var> a table therein.  <code>color-dictionary</code> returns the
read-only table <var>name</var> in database <var>name</var> if it exists; #f otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>load-color-dictionary</b><var> name rdb base-table-type<a name="index-load_002dcolor_002ddictionary-970"></a></var><br>

  &mdash; Function: <b>load-color-dictionary</b><var> name rdb<a name="index-load_002dcolor_002ddictionary-971"></a></var><br>
<blockquote>
       <p><var>rdb</var> must be a string naming a relational database file; and the symbol
<var>name</var> a table therein.  If the symbol <var>base-table-type</var> is provided, the database will
be opened as <var>base-table-type</var>.  <code>load-color-dictionary</code> creates a top-level definition of the symbol <var>name</var>
to a lookup procedure for the color dictionary <var>name</var> in <var>rdb</var>.

       <p>The value returned by <code>load-color-dictionary</code> is unspecified. 
</p></blockquote></div>

<h5 class="subsubheading">Dictionary Creation</h5>

<p><code>(require 'color-database)</code>
<a name="index-color_002ddatabase-972"></a>

<div class="defun">
&mdash; Function: <b>file-&gt;color-dictionary</b><var> file table-name rdb base-table-type<a name="index-file_002d_003ecolor_002ddictionary-973"></a></var><br>

  &mdash; Function: <b>file-&gt;color-dictionary</b><var> file table-name rdb<a name="index-file_002d_003ecolor_002ddictionary-974"></a></var><br>
<blockquote>
       <p><var>rdb</var> must be an open relational database or a string naming a relational
database file, <var>table-name</var> a symbol, and the string <var>file</var> must name an existing
file with colornames and their corresponding xRGB (6-digit hex)
values.  <code>file-&gt;color-dictionary</code> creates a table <var>table-name</var> in <var>rdb</var> and enters the associations found
in <var>file</var> into it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>url-&gt;color-dictionary</b><var> url table-name rdb base-table-type<a name="index-url_002d_003ecolor_002ddictionary-975"></a></var><br>

  &mdash; Function: <b>url-&gt;color-dictionary</b><var> url table-name rdb<a name="index-url_002d_003ecolor_002ddictionary-976"></a></var><br>
<blockquote>
       <p><var>rdb</var> must be an open relational database or a string naming a relational
database file and <var>table-name</var> a symbol.  <code>url-&gt;color-dictionary</code> retrieves the resource named by the
string <var>url</var> using the <dfn>wget</dfn> program; then calls
<a name="index-wget-977"></a><code>file-&gt;color-dictionary</code> to enter its associations in <var>table-name</var> in <var>url</var>. 
</p></blockquote></div>

<p class="noindent">This section has detailed the procedures for creating and loading
color dictionaries.  So where are the dictionaries to load?

  <p><a href="http://people.csail.mit.edu/jaffer/Color/Dictionaries.html">http://people.csail.mit.edu/jaffer/Color/Dictionaries.html</a>

<p class="noindent">Describes and evaluates several color-name dictionaries on the web. 
The following procedure creates a database containing two of these
dictionaries.

<div class="defun">
&mdash; Function: <b>make-slib-color-name-db</b><var><a name="index-make_002dslib_002dcolor_002dname_002ddb-978"></a></var><br>
<blockquote>
       <p>Creates an <span class="roman">alist-table</span> relational database in <span class="roman">library-vicinity</span>
containing the <dfn>Resene</dfn> and <dfn>saturate</dfn> color-name
<a name="index-Resene-979"></a><a name="index-saturate-980"></a>dictionaries.

       <p>If the files <samp><span class="file">resenecolours.txt</span></samp>, <samp><span class="file">nbs-iscc.txt</span></samp>, and
<samp><span class="file">saturate.txt</span></samp> exist in the <span class="roman">library-vicinity</span>, then they
used as the source of color-name data.  Otherwise, <code>make-slib-color-name-db</code> calls
url-&gt;color-dictionary with the URLs of appropriate source files. 
</p></blockquote></div>

<h5 class="subsubheading">The Short List</h5>

<p><code>(require 'saturate)</code>
<a name="index-saturate-981"></a>

<div class="defun">
&mdash; Function: <b>saturate</b><var> name<a name="index-saturate-982"></a></var><br>
<blockquote><p>Looks for <var>name</var> among the 19 saturated colors from
<cite>Approximate Colors on CIE Chromaticity Diagram</cite>:

       <p><table summary=""><tr align="left"><td valign="top" width="25%">reddish orange  </td><td valign="top" width="25%">orange        </td><td valign="top" width="25%">yellowish orange </td><td valign="top" width="25%">yellow
<br></td></tr><tr align="left"><td valign="top" width="25%">greenish yellow </td><td valign="top" width="25%">yellow green  </td><td valign="top" width="25%">yellowish green  </td><td valign="top" width="25%">green
<br></td></tr><tr align="left"><td valign="top" width="25%">bluish green    </td><td valign="top" width="25%">blue green    </td><td valign="top" width="25%">greenish blue    </td><td valign="top" width="25%">blue
<br></td></tr><tr align="left"><td valign="top" width="25%">purplish blue   </td><td valign="top" width="25%">bluish purple </td><td valign="top" width="25%">purple           </td><td valign="top" width="25%">reddish purple
<br></td></tr><tr align="left"><td valign="top" width="25%">red purple      </td><td valign="top" width="25%">purplish red  </td><td valign="top" width="25%">red
       <br></td></tr></table>

       <p>(<a href="http://people.csail.mit.edu/jaffer/Color/saturate.pdf">http://people.csail.mit.edu/jaffer/Color/saturate.pdf</a>).  If
<var>name</var> is found, the corresponding color is returned.  Otherwise #f
is returned.  Use saturate only for light source colors. 
</p></blockquote></div>

<p class="noindent">Resene Paints Limited, New Zealand's largest privately-owned and
operated paint manufacturing company, has generously made their
<cite>Resene RGB Values List</cite> available.

  <p><code>(require 'resene)</code>
<a name="index-resene-983"></a>

<div class="defun">
&mdash; Function: <b>resene</b><var> name<a name="index-resene-984"></a></var><br>
<blockquote><p>Looks for <var>name</var> among the 1300 entries in the Resene color-name
dictionary (<a href="http://people.csail.mit.edu/jaffer/Color/resene.pdf">http://people.csail.mit.edu/jaffer/Color/resene.pdf</a>). 
If <var>name</var> is found, the corresponding color is returned.  Otherwise
#f is returned.  The <cite>Resene RGB Values List</cite> is an excellent
source for surface colors. 
</p></blockquote></div>

<p class="noindent">If you include the <dfn>Resene RGB Values List</dfn> in binary form in a
program, then you must include its license with your program:

  <blockquote>
Resene RGB Values List<br>
For further information refer to http://www.resene.co.nz<br>
Copyright Resene Paints Ltd 2001

  <p>Permission to copy this dictionary, to modify it, to redistribute it,
to distribute modified versions, and to use it for any purpose is
granted, subject to the following restrictions and understandings.

     <ol type=1 start=1>
<li>Any text copy made of this dictionary must include this copyright
notice in full.

     <li>Any redistribution in binary form must reproduce this copyright
notice in the documentation or other materials provided with the
distribution.

     <li>Resene Paints Ltd makes no warranty or representation that this
dictionary is error-free, and is under no obligation to provide any
services, by way of maintenance, update, or otherwise.

     <li>There shall be no use of the name of Resene or Resene Paints Ltd
in any advertising, promotional, or sales literature without prior
written consent in each case.

     <li>These RGB colour formulations may not be used to the detriment of
Resene Paints Ltd.
       </ol>
</blockquote>

<div class="node">
<a name="Daylight"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Color-Names">Color Names</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Color">Color</a>

</div>

<h4 class="subsection">5.11.7 Daylight</h4>

<p><code>(require 'daylight)</code>
<a name="index-daylight-985"></a><a name="index-sunlight-986"></a><a name="index-sun-987"></a><a name="index-sky-988"></a>
This package calculates the colors of sky as detailed in:<br>
<a href="http://www.cs.utah.edu/vissim/papers/sunsky/sunsky.pdf">http://www.cs.utah.edu/vissim/papers/sunsky/sunsky.pdf</a><br>
<cite>A Practical Analytic Model for Daylight</cite><br>
A. J. Preetham, Peter Shirley, Brian Smits

<div class="defun">
&mdash; Function: <b>solar-hour</b><var> julian-day hour<a name="index-solar_002dhour-989"></a></var><br>
<blockquote>
       <p>Returns the solar-time in hours given the integer <var>julian-day</var> in the range 1 to
366, and the local time in hours.

       <p>To be meticulous, subtract 4 minutes for each degree of longitude west
of the standard meridian of your time zone. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solar-declination</b><var> julian-day<a name="index-solar_002ddeclination-990"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>solar-polar</b><var> declination latitude solar-hour<a name="index-solar_002dpolar-991"></a></var><br>
<blockquote><p>Returns a list of <var>theta_s</var>, the solar angle from the
zenith, and <var>phi_s</var>, the solar azimuth.  0 &lt;= <var>theta_s</var>
measured in degrees.  <var>phi_s</var> is measured in degrees from due
south; west of south being positive. 
</p></blockquote></div>

<p class="noindent">In the following procedures, the number 0 &lt;= <var>theta_s</var> &lt;= 90 is
the solar angle from the zenith in degrees.

  <p><a name="index-turbidity-992"></a>Turbidity is a measure of the fraction of scattering due to haze as
opposed to molecules.  This is a convenient quantity because it can be
estimated based on visibility of distant objects.  This model fails
for turbidity values less than 1.3.

<pre class="example">         _______________________________________________________________
     512|-:                                                             |
        | * pure-air                                                    |
     256|-:**                                                           |
        | : ** exceptionally-clear                                      |
     128|-:   *                                                         |
        | :    **                                                       |
      64|-:      *                                                      |
        | :       ** very-clear                                         |
      32|-:         **                                                  |
        | :           **                                                |
      16|-:             *** clear                                       |
        | :               ****                                          |
       8|-:                  ****                                       |
        | :                     **** light-haze                         |
       4|-:                         ****                                |
        | :                             ******                          |
       2|-:                                  ******** haze         thin-|
        | :                                          ***********    fog |
       1|-:----------------------------------------------------*******--|
        |_:____.____:____.____:____.____:____.____:____.____:____.____:_|
          1         2         4         8        16        32        64
                   Meterorological range (km) versus Turbidity
</pre>
  <div class="defun">
&mdash; Function: <b>sunlight-spectrum</b><var> turbidity theta_s<a name="index-sunlight_002dspectrum-993"></a></var><br>
<blockquote><p>Returns a vector of 41 values, the spectrum of sunlight from
380.nm to 790.nm for a given <var>turbidity</var> and <var>theta_s</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sunlight-chromaticity</b><var> turbidity theta_s<a name="index-sunlight_002dchromaticity-994"></a></var><br>
<blockquote><p>Given <var>turbidity</var> and <var>theta_s</var>, <code>sunlight-chromaticity</code> returns the CIEXYZ triple for color of
sunlight scaled to be just inside the RGB709 gamut. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>zenith-xyy</b><var> turbidity theta_s<a name="index-zenith_002dxyy-995"></a></var><br>
<blockquote><p>Returns the xyY (chromaticity and luminance) at the zenith.  The
Luminance has units kcd/m^2. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>overcast-sky-color-xyy</b><var> turbidity theta_s<a name="index-overcast_002dsky_002dcolor_002dxyy-996"></a></var><br>
<blockquote><p><var>turbidity</var> is a positive real number expressing the amount of light
scattering.  The real number <var>theta_s</var> is the solar angle from the zenith in
degrees.

       <p><code>overcast-sky-color-xyy</code> returns a function of one angle <var>theta</var>, the angle from the
zenith of the viewing direction (in degrees); and returning the xyY
value for light coming from that elevation of the sky. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>clear-sky-color-xyy</b><var> turbidity theta_s phi_s<a name="index-clear_002dsky_002dcolor_002dxyy-997"></a></var><br>
&mdash; Function: <b>sky-color-xyy</b><var> turbidity theta_s phi_s<a name="index-sky_002dcolor_002dxyy-998"></a></var><br>
<blockquote><p><var>turbidity</var> is a positive real number expressing the amount of light
scattering.  The real number <var>theta_s</var> is the solar angle from the zenith in
degrees.  The real number <var>phi_s</var> is the solar angle from south.

       <p><code>clear-sky-color-xyy</code> returns a function of two angles, <var>theta</var> and <var>phi</var> which
specify the angles from the zenith and south meridian of the viewing
direction (in degrees); returning the xyY value for light coming from
that direction of the sky.

       <p><code>sky-color-xyY</code> calls <code>overcast-sky-color-xyY</code> for
<var>turbidity</var> &lt;= 20; otherwise the <code>clear-sky-color-xyy</code> function. 
</p></blockquote></div>

<div class="node">
<a name="Root-Finding"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Minimizing">Minimizing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Color">Color</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.12 Root Finding</h3>

<p><code>(require 'root)</code>
<a name="index-root-999"></a>
In the Newton method, divide the <var>df/dx</var> argument by the
multiplicity of the desired root in order to preserve quadratic
convergence.

<div class="defun">
&mdash; Function: <b>newton:find-integer-root</b><var> f df/dx x0<a name="index-newton_003afind_002dinteger_002droot-1000"></a></var><br>
<blockquote><p>Given integer valued procedure <var>f</var>, its derivative (with respect to
its argument) <var>df/dx</var>, and initial integer value <var>x0</var> for which
<var>df/dx</var>(<var>x0</var>) is non-zero, returns an integer <var>x</var> for which
<var>f</var>(<var>x</var>) is closer to zero than either of the integers adjacent
to <var>x</var>; or returns <code>#f</code> if such an integer can't be found.

       <p>To find the closest integer to a given integer's square root:

     <pre class="example">          (define (integer-sqrt y)
            (newton:find-integer-root
             (lambda (x) (- (* x x) y))
             (lambda (x) (* 2 x))
             (ash 1 (quotient (integer-length y) 2))))
          
          (integer-sqrt 15) &rArr; 4
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>newton:find-root</b><var> f df/dx x0 prec<a name="index-newton_003afind_002droot-1001"></a></var><br>
<blockquote><p>Given real valued procedures <var>f</var>, <var>df/dx</var> of one (real)
argument, initial real value <var>x0</var> for which <var>df/dx</var>(<var>x0</var>) is
non-zero, and positive real number <var>prec</var>, returns a real <var>x</var>
for which <code>abs</code>(<var>f</var>(<var>x</var>)) is less than <var>prec</var>; or
returns <code>#f</code> if such a real can't be found.

       <p>If <var>prec</var> is instead a negative integer, <code>newton:find-root</code>
returns the result of -<var>prec</var> iterations. 
</p></blockquote></div>

<p class="noindent">H. J. Orchard, <cite>The Laguerre Method for Finding the Zeros of
Polynomials</cite>, IEEE Transactions on Circuits and Systems, Vol. 36,
No. 11, November 1989, pp 1377-1381.

  <blockquote>
There are 2 errors in Orchard's Table II.  Line k=2 for starting
value of 1000+j0 should have Z_k of 1.0475 + j4.1036 and line k=2
for starting value of 0+j1000 should have Z_k of 1.0988 + j4.0833. 
</blockquote>

<div class="defun">
&mdash; Function: <b>laguerre:find-root</b><var> f df/dz ddf/dz^2 z0 prec<a name="index-laguerre_003afind_002droot-1002"></a></var><br>
<blockquote><p>Given complex valued procedure <var>f</var> of one (complex) argument, its
derivative (with respect to its argument) <var>df/dx</var>, its second
derivative <var>ddf/dz^2</var>, initial complex value <var>z0</var>, and positive
real number <var>prec</var>, returns a complex number <var>z</var> for which
<code>magnitude</code>(<var>f</var>(<var>z</var>)) is less than <var>prec</var>; or returns
<code>#f</code> if such a number can't be found.

       <p>If <var>prec</var> is instead a negative integer, <code>laguerre:find-root</code>
returns the result of -<var>prec</var> iterations. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>laguerre:find-polynomial-root</b><var> deg f df/dz ddf/dz^2 z0 prec<a name="index-laguerre_003afind_002dpolynomial_002droot-1003"></a></var><br>
<blockquote><p>Given polynomial procedure <var>f</var> of integer degree <var>deg</var> of one
argument, its derivative (with respect to its argument) <var>df/dx</var>, its
second derivative <var>ddf/dz^2</var>, initial complex value <var>z0</var>, and
positive real number <var>prec</var>, returns a complex number <var>z</var> for
which <code>magnitude</code>(<var>f</var>(<var>z</var>)) is less than <var>prec</var>; or
returns <code>#f</code> if such a number can't be found.

       <p>If <var>prec</var> is instead a negative integer,
<code>laguerre:find-polynomial-root</code> returns the result of -<var>prec</var>
iterations. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>secant:find-root</b><var> f x0 x1 prec<a name="index-secant_003afind_002droot-1004"></a></var><br>
&mdash; Function: <b>secant:find-bracketed-root</b><var> f x0 x1 prec<a name="index-secant_003afind_002dbracketed_002droot-1005"></a></var><br>
<blockquote><p>Given a real valued procedure <var>f</var> and two real valued starting
points <var>x0</var> and <var>x1</var>, returns a real <var>x</var> for which
<code>(abs (f x))</code> is less than <var>prec</var>; or returns
<code>#f</code> if such a real can't be found.

       <p>If <var>x0</var> and <var>x1</var> are chosen such that they bracket a root, that is
     <pre class="example">          (or (&lt; (f x0) 0 (f x1))
              (&lt; (f x1) 0 (f x0)))
</pre>
       <p>then the root returned will be between <var>x0</var> and <var>x1</var>, and
<var>f</var> will not be passed an argument outside of that interval.

       <p><code>secant:find-bracketed-root</code> will return <code>#f</code> unless <var>x0</var>
and <var>x1</var> bracket a root.

       <p>The secant method is used until a bracketing interval is found, at which point
a modified <i>regula falsi</i> method is used.

       <p>If <var>prec</var> is instead a negative integer, <code>secant:find-root</code>
returns the result of -<var>prec</var> iterations.

       <p>If <var>prec</var> is a procedure it should accept 5 arguments: <var>x0</var>
<var>f0</var> <var>x1</var> <var>f1</var> and <var>count</var>, where <var>f0</var> will be
<code>(f x0)</code>, <var>f1</var> <code>(f x1)</code>, and <var>count</var> the number of
iterations performed so far.  <var>prec</var> should return non-false
if the iteration should be stopped. 
</p></blockquote></div>

<div class="node">
<a name="Minimizing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-Limit">The Limit</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Root-Finding">Root Finding</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.13 Minimizing</h3>

<p><code>(require 'minimize)</code>
<a name="index-minimize-1006"></a><a name="index-minimize-1007"></a>

<p class="noindent">The Golden Section Search
<a rel="footnote" href="#fn-7" name="fnd-7"><sup>7</sup></a>
algorithm finds minima of functions which
are expensive to compute or for which derivatives are not available. 
Although optimum for the general case, convergence is slow,
requiring nearly 100 iterations for the example (x^3-2x-5).

<p class="noindent">If the derivative is available, Newton-Raphson is probably a better
choice.  If the function is inexpensive to compute, consider
approximating the derivative.

<div class="defun">
&mdash; Function: <b>golden-section-search</b><var> f x0 x1 prec<a name="index-golden_002dsection_002dsearch-1008"></a></var><br>
<blockquote>
       <p><var>x_0</var> are <var>x_1</var> real numbers.  The (single argument)
procedure <var>f</var> is unimodal over the open interval (<var>x_0</var>,
<var>x_1</var>).  That is, there is exactly one point in the interval for
which the derivative of <var>f</var> is zero.

       <p><code>golden-section-search</code> returns a pair (<var>x</var> . <var>f</var>(<var>x</var>)) where <var>f</var>(<var>x</var>)
is the minimum.  The <var>prec</var> parameter is the stop criterion.  If
<var>prec</var> is a positive number, then the iteration continues until
<var>x</var> is within <var>prec</var> from the true value.  If <var>prec</var> is
a negative integer, then the procedure will iterate <var>-prec</var>
times or until convergence.  If <var>prec</var> is a procedure of seven
arguments, <var>x0</var>, <var>x1</var>, <var>a</var>, <var>b</var>, <var>fa</var>, <var>fb</var>,
and <var>count</var>, then the iterations will stop when the procedure
returns <code>#t</code>.

       <p>Analytically, the minimum of x^3-2x-5 is 0.816497.
     <pre class="example">          (define func (lambda (x) (+ (* x (+ (* x x) -2)) -5)))
          (golden-section-search func 0 1 (/ 10000))
                ==&gt; (816.4883855245578e-3 . -6.0886621077391165)
          (golden-section-search func 0 1 -5)
                ==&gt; (819.6601125010515e-3 . -6.088637561916407)
          (golden-section-search func 0 1
                                 (lambda (a b c d e f g ) (= g 500)))
                ==&gt; (816.4965933140557e-3 . -6.088662107903635)
</pre>
       </blockquote></div>

<div class="node">
<a name="The-Limit"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Commutative-Rings">Commutative Rings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Minimizing">Minimizing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.14 The Limit</h3>

<div class="defun">
&mdash; library procedure: <b>limit</b><var> proc x1 x2 k<a name="index-limit-1009"></a></var><br>
&mdash; library procedure: <b>limit</b><var> proc x1 x2<a name="index-limit-1010"></a></var><br>
<blockquote>
       <p><var>Proc</var> must be a procedure taking a single inexact real argument. 
<var>K</var> is the number of points on which <var>proc</var> will be called; it
defaults to 8.

       <p>If <var>x1</var> is finite, then <var>Proc</var> must be continuous on the
half-open interval:

       <p>( <var>x1</var> .. <var>x1</var>+<var>x2</var> ]

       <p>And <var>x2</var> should be chosen small enough so that <var>proc</var> is
expected to be monotonic or constant on arguments between <var>x1</var> and
<var>x1</var> + <var>x2</var>.

       <p><code>Limit</code> computes the limit of <var>proc</var> as its argument
approaches <var>x1</var> from <var>x1</var> + <var>x2</var>. 
<code>Limit</code> returns a real number or real infinity or &lsquo;<samp><span class="samp">#f</span></samp>&rsquo;.

       <p>If <var>x1</var> is not finite, then <var>x2</var> must be a finite nonzero real
with the same sign as <var>x1</var>; in which case <code>limit</code> returns:

       <p><code>(limit (lambda (x) (proc (/ x))) 0.0 (/ </code><var>x2</var><code>) </code><var>k</var><code>)</code>

       <p><code>Limit</code> examines the magnitudes of the differences between
successive values returned by <var>proc</var> called with a succession of
numbers from <var>x1</var>+<var>x2</var>/<var>k</var> to <var>x1</var>.

       <p>If the magnitudes of differences are monotonically decreasing, then
then the limit is extrapolated from the degree n polynomial passing
through the samples returned by <var>proc</var>.

       <p>If the magnitudes of differences are increasing as fast or faster than
a hyperbola matching at <var>x1</var>+<var>x2</var>, then a real infinity with
sign the same as the differences is returned.

       <p>If the magnitudes of differences are increasing more slowly than the
hyperbola matching at <var>x1</var>+<var>x2</var>, then the limit is
extrapolated from the quadratic passing through the three samples
closest to <var>x1</var>.

       <p>If the magnitudes of differences are not monotonic or are not
completely within one of the above categories, then #f is returned. 
</p></blockquote></div>

<pre class="example">     ;; constant
     (limit (lambda (x) (/ x x)) 0 1.0e-9)           ==&gt; 1.0
     (limit (lambda (x) (expt 0 x)) 0 1.0e-9)        ==&gt; 0.0
     (limit (lambda (x) (expt 0 x)) 0 -1.0e-9)       ==&gt; +inf.0
     ;; linear
     (limit + 0 976.5625e-6)                         ==&gt; 0.0
     (limit - 0 976.5625e-6)                         ==&gt; 0.0
     ;; vertical point of inflection
     (limit sqrt 0 1.0e-18)                          ==&gt; 0.0
     (limit (lambda (x) (* x (log x))) 0 1.0e-9)     ==&gt; -102.70578127633066e-12
     (limit (lambda (x) (/ x (log x))) 0 1.0e-9)     ==&gt; 96.12123142321669e-15
     ;; limits tending to infinity
     (limit + +inf.0 1.0e9)                          ==&gt; +inf.0
     (limit + -inf.0 -1.0e9)                         ==&gt; -inf.0
     (limit / 0 1.0e-9)                              ==&gt; +inf.0
     (limit / 0 -1.0e-9)                             ==&gt; -inf.0
     (limit (lambda (x) (/ (log x) x)) 0 1.0e-9)     ==&gt; -inf.0
     (limit (lambda (x) (/ (magnitude (log x)) x)) 0 -1.0e-9)
                                                     ==&gt; -inf.0
     ;; limit doesn't exist
     (limit sin +inf.0 1.0e9)                        ==&gt; #f
     (limit (lambda (x) (sin (/ x))) 0 1.0e-9)       ==&gt; #f
     (limit (lambda (x) (sin (/ x))) 0 -1.0e-9)      ==&gt; #f
     (limit (lambda (x) (/ (log x) x)) 0 -1.0e-9)    ==&gt; #f
     ;; conditionally convergent - return #f
     (limit (lambda (x) (/ (sin x) x)) +inf.0 1.0e222)
                                                     ==&gt; #f
     ;; asymptotes
     (limit / -inf.0 -1.0e222)                       ==&gt; 0.0
     (limit / +inf.0 1.0e222)                        ==&gt; 0.0
     (limit (lambda (x) (expt x x)) 0 1.0e-18)       ==&gt; 1.0
     (limit (lambda (x) (sin (/ x))) +inf.0 1.0e222) ==&gt; 0.0
     (limit (lambda (x) (/ (+ (exp (/ x)) 1))) 0 1.0e-9)
                                                     ==&gt; 0.0
     (limit (lambda (x) (/ (+ (exp (/ x)) 1))) 0 -1.0e-9)
                                                     ==&gt; 1.0
     (limit (lambda (x) (real-part (expt (tan x) (cos x)))) (/ pi 2) 1.0e-9)
                                                     ==&gt; 1.0
     ;; This example from the 1979 Macsyma manual grows so rapidly
     ;;  that x2 must be less than 41.  It correctly returns e^2.
     (limit (lambda (x) (expt (+ x (exp x) (exp (* 2 x))) (/ x))) +inf.0 40)
                                                     ==&gt; 7.3890560989306504
     ;; LIMIT can calculate the proper answer when evaluation
     ;; of the function at the limit point does not:
     (tan (atan +inf.0))                             ==&gt; 16.331778728383844e15
     (limit tan (atan +inf.0) -1.0e-15)              ==&gt; +inf.0
     (tan (atan +inf.0))                             ==&gt; 16.331778728383844e15
     (limit tan (atan +inf.0) 1.0e-15)               ==&gt; -inf.0
     ((lambda (x) (expt (exp (/ -1 x)) x)) 0)        ==&gt; 1.0
     (limit (lambda (x) (expt (exp (/ -1 x)) x)) 0 1.0e-9)
                                                     ==&gt; 0.0
</pre>
  <div class="node">
<a name="Commutative-Rings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Matrix-Algebra">Matrix Algebra</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-Limit">The Limit</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.15 Commutative Rings</h3>

<p>Scheme provides a consistent and capable set of numeric functions. 
Inexacts implement a field; integers a commutative ring (and Euclidean
domain).  This package allows one to use basic Scheme numeric functions
with symbols and non-numeric elements of commutative rings.

  <p><code>(require 'commutative-ring)</code>
<a name="index-commutative_002dring-1011"></a><a name="index-ring_002c-commutative-1012"></a>
The <dfn>commutative-ring</dfn> package makes the procedures <code>+</code>,
<code>-</code>, <code>*</code>, <code>/</code>, and <code>^</code> <dfn>careful</dfn> in the sense
<a name="index-careful-1013"></a>that any non-numeric arguments they do not reduce appear in the
expression output.  In order to see what working with this package is
like, self-set all the single letter identifiers (to their corresponding
symbols). 
<a name="index-self_002dset-1014"></a>
<pre class="example">     (define a 'a)
     ...
     (define z 'z)
</pre>
  <p>Or just <code>(require 'self-set)</code>.  Now try some sample expressions:
<a name="index-self_002dset-1015"></a>
<pre class="example">     (+ (+ a b) (- a b)) &rArr; (* a 2)
     (* (+ a b) (+ a b)) &rArr; (^ (+ a b) 2)
     (* (+ a b) (- a b)) &rArr; (* (+ a b) (- a b))
     (* (- a b) (- a b)) &rArr; (^ (- a b) 2)
     (* (- a b) (+ a b)) &rArr; (* (+ a b) (- a b))
     (/ (+ a b) (+ c d)) &rArr; (/ (+ a b) (+ c d))
     (^ (+ a b) 3) &rArr; (^ (+ a b) 3)
     (^ (+ a 2) 3) &rArr; (^ (+ 2 a) 3)
</pre>
  <p>Associative rules have been applied and repeated addition and
multiplication converted to multiplication and exponentiation.

  <p>We can enable distributive rules, thus expanding to sum of products
form:
<pre class="example">     (set! *ruleset* (combined-rulesets distribute* distribute/))
     
     (* (+ a b) (+ a b)) &rArr; (+ (* 2 a b) (^ a 2) (^ b 2))
     (* (+ a b) (- a b)) &rArr; (- (^ a 2) (^ b 2))
     (* (- a b) (- a b)) &rArr; (- (+ (^ a 2) (^ b 2)) (* 2 a b))
     (* (- a b) (+ a b)) &rArr; (- (^ a 2) (^ b 2))
     (/ (+ a b) (+ c d)) &rArr; (+ (/ a (+ c d)) (/ b (+ c d)))
     (/ (+ a b) (- c d)) &rArr; (+ (/ a (- c d)) (/ b (- c d)))
     (/ (- a b) (- c d)) &rArr; (- (/ a (- c d)) (/ b (- c d)))
     (/ (- a b) (+ c d)) &rArr; (- (/ a (+ c d)) (/ b (+ c d)))
     (^ (+ a b) 3) &rArr; (+ (* 3 a (^ b 2)) (* 3 b (^ a 2)) (^ a 3) (^ b 3))
     (^ (+ a 2) 3) &rArr; (+ 8 (* a 12) (* (^ a 2) 6) (^ a 3))
</pre>
  <p>Use of this package is not restricted to simple arithmetic expressions:

<pre class="example">     (require 'determinant)
     
     (determinant '((a b c) (d e f) (g h i))) &rArr;
     (- (+ (* a e i) (* b f g) (* c d h)) (* a f h) (* b d i) (* c e g))
</pre>
  <p>Currently, only <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, and <code>^</code>
support non-numeric elements.  Expressions with <code>-</code> are converted
to equivalent expressions without <code>-</code>, so behavior for <code>-</code> is
not defined separately.  <code>/</code> expressions are handled similarly.

  <p>This list might be extended to include <code>quotient</code>, <code>modulo</code>,
<code>remainder</code>, <code>lcm</code>, and <code>gcd</code>; but these work only for
the more restrictive Euclidean (Unique Factorization) Domain. 
<a name="index-Unique-Factorization-1016"></a><a name="index-Euclidean-Domain-1017"></a>

<h3 class="section">5.16 Rules and Rulesets</h3>

<p>The <dfn>commutative-ring</dfn> package allows control of ring properties
through the use of <dfn>rulesets</dfn>.

<div class="defun">
&mdash; Variable: <b>*ruleset*</b><var><a name="index-g_t_002aruleset_002a-1018"></a></var><br>
<blockquote><p>Contains the set of rules currently in effect.  Rules defined by
<code>cring:define-rule</code> are stored within the value of *ruleset* at the
time <code>cring:define-rule</code> is called.  If <var>*ruleset*</var> is
<code>#f</code>, then no rules apply. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-ruleset</b><var> rule1 <small class="dots">...</small><a name="index-make_002druleset-1019"></a></var><br>
&mdash; Function: <b>make-ruleset</b><var> name rule1 <small class="dots">...</small><a name="index-make_002druleset-1020"></a></var><br>
<blockquote><p>Returns a new ruleset containing the rules formed by applying
<code>cring:define-rule</code> to each 4-element list argument <var>rule</var>.  If
the first argument to <code>make-ruleset</code> is a symbol, then the database
table created for the new ruleset will be named <var>name</var>.  Calling
<code>make-ruleset</code> with no rule arguments creates an empty ruleset. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>combined-rulesets</b><var> ruleset1 <small class="dots">...</small><a name="index-combined_002drulesets-1021"></a></var><br>
&mdash; Function: <b>combined-rulesets</b><var> name ruleset1 <small class="dots">...</small><a name="index-combined_002drulesets-1022"></a></var><br>
<blockquote><p>Returns a new ruleset containing the rules contained in each ruleset
argument <var>ruleset</var>.  If the first argument to
<code>combined-ruleset</code> is a symbol, then the database table created for
the new ruleset will be named <var>name</var>.  Calling
<code>combined-ruleset</code> with no ruleset arguments creates an empty
ruleset. 
</p></blockquote></div>

  <p>Two rulesets are defined by this package.

<div class="defun">
&mdash; Constant: <b>distribute*</b><var><a name="index-distribute_002a-1023"></a></var><br>
<blockquote><p>Contains the ruleset to distribute multiplication over addition and
subtraction. 
</p></blockquote></div>

<div class="defun">
&mdash; Constant: <b>distribute/</b><var><a name="index-distribute_002f-1024"></a></var><br>
<blockquote><p>Contains the ruleset to distribute division over addition and
subtraction.

       <p>Take care when using both <var>distribute*</var> and <var>distribute/</var>
simultaneously.  It is possible to put <code>/</code> into an infinite loop. 
</p></blockquote></div>

  <p>You can specify how sum and product expressions containing non-numeric
elements simplify by specifying the rules for <code>+</code> or <code>*</code> for
cases where expressions involving objects reduce to numbers or to
expressions involving different non-numeric elements.

<div class="defun">
&mdash; Function: <b>cring:define-rule</b><var> op sub-op1 sub-op2 reduction<a name="index-cring_003adefine_002drule-1025"></a></var><br>
<blockquote><p>Defines a rule for the case when the operation represented by symbol
<var>op</var> is applied to lists whose <code>car</code>s are <var>sub-op1</var> and
<var>sub-op2</var>, respectively.  The argument <var>reduction</var> is a
procedure accepting 2 arguments which will be lists whose <code>car</code>s
are <var>sub-op1</var> and <var>sub-op2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cring:define-rule</b><var> op sub-op1 'identity reduction<a name="index-cring_003adefine_002drule-1026"></a></var><br>
<blockquote><p>Defines a rule for the case when the operation represented by symbol
<var>op</var> is applied to a list whose <code>car</code> is <var>sub-op1</var>, and
some other argument.  <var>Reduction</var> will be called with the list whose
<code>car</code> is <var>sub-op1</var> and some other argument.

       <p>If <var>reduction</var> returns <code>#f</code>, the reduction has failed and other
reductions will be tried.  If <var>reduction</var> returns a non-false value,
that value will replace the two arguments in arithmetic (<code>+</code>,
<code>-</code>, and <code>*</code>) calculations involving non-numeric elements.

       <p>The operations <code>+</code> and <code>*</code> are assumed commutative; hence both
orders of arguments to <var>reduction</var> will be tried if necessary.

       <p>The following rule is the definition for distributing <code>*</code> over
<code>+</code>.

     <pre class="example">          (cring:define-rule
           '* '+ 'identity
           (lambda (exp1 exp2)
             (apply + (map (lambda (trm) (* trm exp2)) (cdr exp1))))))
</pre>
       </blockquote></div>

<h3 class="section">5.17 How to Create a Commutative Ring</h3>

<p>The first step in creating your commutative ring is to write procedures
to create elements of the ring.  A non-numeric element of the ring must
be represented as a list whose first element is a symbol or string. 
This first element identifies the type of the object.  A convenient and
clear convention is to make the type-identifying element be the same
symbol whose top-level value is the procedure to create it.

<pre class="example">     (define (n . list1)
       (cond ((and (= 2 (length list1))
                   (eq? (car list1) (cadr list1)))
              0)
             ((not (term&lt; (first list1) (last1 list1)))
              (apply n (reverse list1)))
             (else (cons 'n list1))))
     
     (define (s x y) (n x y))
     
     (define (m . list1)
       (cond ((neq? (first list1) (term_min list1))
              (apply m (cyclicrotate list1)))
             ((term&lt; (last1 list1) (cadr list1))
              (apply m (reverse (cyclicrotate list1))))
             (else (cons 'm list1))))
</pre>
  <p>Define a procedure to multiply 2 non-numeric elements of the ring. 
Other multiplicatons are handled automatically.  Objects for which rules
have <em>not</em> been defined are not changed.

<pre class="example">     (define (n*n ni nj)
       (let ((list1 (cdr ni)) (list2 (cdr nj)))
         (cond ((null? (intersection list1 list2)) #f)
               ((and (eq? (last1 list1) (first list2))
                     (neq? (first list1) (last1 list2)))
                (apply n (splice list1 list2)))
               ((and (eq? (first list1) (first list2))
                     (neq? (last1 list1) (last1 list2)))
                (apply n (splice (reverse list1) list2)))
               ((and (eq? (last1 list1) (last1 list2))
                     (neq? (first list1) (first list2)))
                (apply n (splice list1 (reverse list2))))
               ((and (eq? (last1 list1) (first list2))
                     (eq? (first list1) (last1 list2)))
                (apply m (cyclicsplice list1 list2)))
               ((and (eq? (first list1) (first list2))
                     (eq? (last1 list1) (last1 list2)))
                (apply m (cyclicsplice (reverse list1) list2)))
               (else #f))))
</pre>
  <p>Test the procedures to see if they work.

<pre class="example">     ;;; where cyclicrotate(list) is cyclic rotation of the list one step
     ;;; by putting the first element at the end
     (define (cyclicrotate list1)
       (append (rest list1) (list (first list1))))
     ;;; and where term_min(list) is the element of the list which is
     ;;; first in the term ordering.
     (define (term_min list1)
       (car (sort list1 term&lt;)))
     (define (term&lt; sym1 sym2)
       (string&lt;? (symbol-&gt;string sym1) (symbol-&gt;string sym2)))
     (define first car)
     (define rest cdr)
     (define (last1 list1) (car (last-pair list1)))
     (define (neq? obj1 obj2) (not (eq? obj1 obj2)))
     ;;; where splice is the concatenation of list1 and list2 except that their
     ;;; common element is not repeated.
     (define (splice list1 list2)
       (cond ((eq? (last1 list1) (first list2))
              (append list1 (cdr list2)))
             (else (slib:error 'splice list1 list2))))
     ;;; where cyclicsplice is the result of leaving off the last element of
     ;;; splice(list1,list2).
     (define (cyclicsplice list1 list2)
       (cond ((and (eq? (last1 list1) (first list2))
                   (eq? (first list1) (last1 list2)))
              (butlast (splice list1 list2) 1))
             (else (slib:error 'cyclicsplice list1 list2))))
     
     (N*N (S a b) (S a b)) &rArr; (m a b)
</pre>
  <p>Then register the rule for multiplying type N objects by type N objects.

<pre class="example">     (cring:define-rule '* 'N 'N N*N))
</pre>
  <p>Now we are ready to compute!

<pre class="example">     (define (t)
       (define detM
         (+ (* (S g b)
               (+ (* (S f d)
                     (- (* (S a f) (S d g)) (* (S a g) (S d f))))
                  (* (S f f)
                     (- (* (S a g) (S d d)) (* (S a d) (S d g))))
                  (* (S f g)
                     (- (* (S a d) (S d f)) (* (S a f) (S d d))))))
            (* (S g d)
               (+ (* (S f b)
                     (- (* (S a g) (S d f)) (* (S a f) (S d g))))
                  (* (S f f)
                     (- (* (S a b) (S d g)) (* (S a g) (S d b))))
                  (* (S f g)
                     (- (* (S a f) (S d b)) (* (S a b) (S d f))))))
            (* (S g f)
               (+ (* (S f b)
                     (- (* (S a d) (S d g)) (* (S a g) (S d d))))
                  (* (S f d)
                     (- (* (S a g) (S d b)) (* (S a b) (S d g))))
                  (* (S f g)
                     (- (* (S a b) (S d d)) (* (S a d) (S d b))))))
            (* (S g g)
               (+ (* (S f b)
                     (- (* (S a f) (S d d)) (* (S a d) (S d f))))
                  (* (S f d)
                     (- (* (S a b) (S d f)) (* (S a f) (S d b))))
                  (* (S f f)
                     (- (* (S a d) (S d b)) (* (S a b) (S d d))))))))
       (* (S b e) (S c a) (S e c)
          detM
          ))
     (pretty-print (t))
     -|
     (- (+ (m a c e b d f g)
           (m a c e b d g f)
           (m a c e b f d g)
           (m a c e b f g d)
           (m a c e b g d f)
           (m a c e b g f d))
        (* 2 (m a b e c) (m d f g))
        (* (m a c e b d) (m f g))
        (* (m a c e b f) (m d g))
        (* (m a c e b g) (m d f)))
</pre>
  <div class="node">
<a name="Matrix-Algebra"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Commutative-Rings">Commutative Rings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Mathematical-Packages">Mathematical Packages</a>

</div>

<h3 class="section">5.18 Matrix Algebra</h3>

<p><code>(require 'determinant)</code>
<a name="index-determinant-1027"></a>
A Matrix can be either a list of lists (rows) or an array. 
Unlike linear-algebra texts, this package uses 0-based coordinates.

<div class="defun">
&mdash; Function: <b>matrix-&gt;lists</b><var> matrix<a name="index-matrix_002d_003elists-1028"></a></var><br>
<blockquote>
       <p>Returns the list-of-lists form of <var>matrix</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>matrix-&gt;array</b><var> matrix<a name="index-matrix_002d_003earray-1029"></a></var><br>
<blockquote>
       <p>Returns the array form of <var>matrix</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>determinant</b><var> matrix<a name="index-determinant-1030"></a></var><br>
<blockquote>
       <p><var>matrix</var> must be a square matrix. 
<code>determinant</code> returns the determinant of <var>matrix</var>.

     <pre class="example">          (require 'determinant)
          (determinant '((1 2) (3 4))) &rArr; -2
          (determinant '((1 2 3) (4 5 6) (7 8 9))) &rArr; 0
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>transpose</b><var> matrix<a name="index-transpose-1031"></a></var><br>
<blockquote>
       <p>Returns a copy of <var>matrix</var> flipped over the diagonal containing the 1,1
element. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>matrix:sum</b><var> m1 m2<a name="index-matrix_003asum-1032"></a></var><br>
<blockquote>
       <p>Returns the element-wise sum of matricies <var>m1</var> and <var>m2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>matrix:difference</b><var> m1 m2<a name="index-matrix_003adifference-1033"></a></var><br>
<blockquote>
       <p>Returns the element-wise difference of matricies <var>m1</var> and <var>m2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>matrix:product</b><var> m1 m2<a name="index-matrix_003aproduct-1034"></a></var><br>
<blockquote>
       <p>Returns the product of matrices <var>m1</var> and <var>m2</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>matrix:product</b><var> m1 z<a name="index-matrix_003aproduct-1035"></a></var><br>
<blockquote><p>Returns matrix <var>m1</var> times scalar <var>z</var>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>matrix:product</b><var> z m1<a name="index-matrix_003aproduct-1036"></a></var><br>
<blockquote><p>Returns matrix <var>m1</var> times scalar <var>z</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>matrix:inverse</b><var> matrix<a name="index-matrix_003ainverse-1037"></a></var><br>
<blockquote>
       <p><var>matrix</var> must be a square matrix. 
If <var>matrix</var> is singular, then <code>matrix:inverse</code> returns #f; otherwise <code>matrix:inverse</code> returns the
<code>matrix:product</code> inverse of <var>matrix</var>. 
</p></blockquote></div>

<div class="node">
<a name="Database-Packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Other-Packages">Other Packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Mathematical-Packages">Mathematical Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">6 Database Packages</h2>

<ul class="menu">
<li><a accesskey="1" href="#Relational-Database">Relational Database</a>:          'relational-database
<li><a accesskey="2" href="#Relational-Infrastructure">Relational Infrastructure</a>
<li><a accesskey="3" href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a>:        'wt-tree
</ul>

<div class="node">
<a name="Relational-Database"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Relational-Infrastructure">Relational Infrastructure</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Database-Packages">Database Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Database-Packages">Database Packages</a>

</div>

<h3 class="section">6.1 Relational Database</h3>

<p><code>(require 'relational-database)</code>
<a name="index-relational_002ddatabase-1038"></a>
This package implements a database system inspired by the Relational
Model (<cite>E. F. Codd, A Relational Model of Data for Large Shared
Data Banks</cite>).  An SLIB relational database implementation can be created
from any <a href="#Base-Table">Base Table</a> implementation.

  <p>Why relational database?  For motivations and design issues see<br>
<a href="http://people.csail.mit.edu/jaffer/DBManifesto.html">http://people.csail.mit.edu/jaffer/DBManifesto.html</a>.

<ul class="menu">
<li><a accesskey="1" href="#Using-Databases">Using Databases</a>:              'databases
<li><a accesskey="2" href="#Table-Operations">Table Operations</a>
<li><a accesskey="3" href="#Database-Interpolation">Database Interpolation</a>:       'database-interpolate
<li><a accesskey="4" href="#Embedded-Commands">Embedded Commands</a>:            'database-commands
<li><a accesskey="5" href="#Database-Macros">Database Macros</a>:              'within-database
<li><a accesskey="6" href="#Database-Browser">Database Browser</a>:             'database-browse
</ul>

<div class="node">
<a name="Using-Databases"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Table-Operations">Table Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Relational-Database">Relational Database</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Database">Relational Database</a>

</div>

<h4 class="subsection">6.1.1 Using Databases</h4>

<p><code>(require 'databases)</code>
<a name="index-databases-1039"></a>
This enhancement wraps a utility layer on <code>relational-database</code>
which provides:

     <ul>
<li>Identification of open databases by filename. 
<li>Automatic sharing of open (immutable) databases. 
<li>Automatic loading of base-table package when creating a database. 
<li>Detection and automatic loading of the appropriate base-table package
when opening a database. 
<li>Table and data definition from Scheme lists. 
</ul>

<h5 class="subsubheading">Database Sharing</h5>

<p class="noindent"><dfn>Auto-sharing</dfn> refers to a call to the procedure
<a name="index-Auto_002dsharing-1040"></a><code>open-database</code> returning an already open database (procedure),
rather than opening the database file a second time.

  <blockquote>
<em>Note:</em> Databases returned by <code>open-database</code> do not include
wrappers applied by packages like <a href="#Embedded-Commands">Embedded Commands</a>.  But
wrapped databases do work as arguments to these functions. 
</blockquote>

<p class="noindent">When a database is created, it is mutable by the creator and not
auto-sharable.  A database opened mutably is also not auto-sharable. 
But any number of readers can (open) share a non-mutable database file.

<p class="noindent">This next set of procedures mirror the whole-database methods in
<a href="#Database-Operations">Database Operations</a>.  Except for <code>create-database</code>, each
procedure will accept either a filename or database procedure for its
first argument.

<div class="defun">
&mdash; Function: <b>create-database</b><var> filename base-table-type<a name="index-create_002ddatabase-1041"></a></var><br>
<blockquote>
       <p><var>filename</var> should be a string naming a file; or <code>#f</code>.  <var>base-table-type</var> must be a
symbol naming a feature which can be passed to <code>require</code>.  <code>create-database</code>
returns a new, open relational database (with base-table type <var>base-table-type</var>)
associated with <var>filename</var>, or a new ephemeral database if <var>filename</var> is <code>#f</code>.

       <p><code>create-database</code> is the only run-time use of require in SLIB
which crosses module boundaries.  When <var>base-table-type</var> is <code>require</code>d by <code>create-database</code>; it
adds an association of <var>base-table-type</var> with its <dfn>relational-system</dfn> procedure
<a name="index-relational_002dsystem-1042"></a>to <var>mdbm:*databases*</var>.

       <p>alist-table is the default base-table type:

     <pre class="example">          (require 'databases)
          (define my-rdb (create-database "my.db" 'alist-table))
</pre>
       </blockquote></div>

<p class="noindent">Only <code>alist-table</code> and base-table modules which have been
<code>require</code>d will dispatch correctly from the
<code>open-database</code> procedures.  Therefore, either pass two
arguments to <code>open-database</code>, or require the base-table of your
database file uses before calling <code>open-database</code> with one
argument.

<div class="defun">
&mdash; Procedure: <b>open-database!</b><var> rdb base-table-type<a name="index-open_002ddatabase_0021-1043"></a></var><br>
<blockquote>
       <p>Returns <em>mutable</em> open relational database or #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-database</b><var> rdb base-table-type<a name="index-open_002ddatabase-1044"></a></var><br>
<blockquote>
       <p>Returns an open relational database associated with <var>rdb</var>.  The
database will be opened with base-table type <var>base-table-type</var>).

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>open-database</b><var> rdb<a name="index-open_002ddatabase-1045"></a></var><br>
<blockquote><p>Returns an open relational database associated with <var>rdb</var>. 
<code>open-database</code> will attempt to deduce the correct base-table-type. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>write-database</b><var> rdb filename<a name="index-write_002ddatabase-1046"></a></var><br>
<blockquote>
       <p>Writes the mutable relational-database <var>rdb</var> to <var>filename</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sync-database</b><var> rdb<a name="index-sync_002ddatabase-1047"></a></var><br>
<blockquote>
       <p>Writes the mutable relational-database <var>rdb</var> to the filename it was
opened with. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>solidify-database</b><var> rdb<a name="index-solidify_002ddatabase-1048"></a></var><br>
<blockquote>
       <p>Syncs <var>rdb</var> and makes it immutable. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>close-database</b><var> rdb<a name="index-close_002ddatabase-1049"></a></var><br>
<blockquote>
       <p><var>rdb</var> will only be closed when the count of <code>open-database</code> - <code>close-database</code>
calls for <var>rdb</var> (and its filename) is 0.  <code>close-database</code> returns #t if successful;
and #f otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>mdbm:report</b><var><a name="index-mdbm_003areport-1050"></a></var><br>
<blockquote>
       <p>Prints a table of open database files.  The columns are the
base-table type, number of opens, &lsquo;<samp><span class="samp">!</span></samp>&rsquo; for mutable, the
filename, and the lock certificate (if locked). 
</p></blockquote></div>

<pre class="example">     (mdbm:report)
     -|
       alist-table 003   /usr/local/lib/slib/clrnamdb.scm
       alist-table 001 ! sdram.db jaffer@aubrey.jaffer.3166:1038628199
</pre>
  <h5 class="subsubheading">Opening Tables</h5>

<div class="defun">
&mdash; Function: <b>open-table</b><var> rdb table-name<a name="index-open_002dtable-1051"></a></var><br>
<blockquote>
       <p><var>rdb</var> must be a relational database and <var>table-name</var> a symbol.

       <p><code>open-table</code> returns a "methods" procedure for an existing relational table in
<var>rdb</var> if it exists and can be opened for reading, otherwise returns
<code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>open-table!</b><var> rdb table-name<a name="index-open_002dtable_0021-1052"></a></var><br>
<blockquote>
       <p><var>rdb</var> must be a relational database and <var>table-name</var> a symbol.

       <p><code>open-table!</code> returns a "methods" procedure for an existing relational table in
<var>rdb</var> if it exists and can be opened in mutable mode, otherwise returns
<code>#f</code>. 
</p></blockquote></div>

<h5 class="subsubheading">Defining Tables</h5>

<div class="defun">
&mdash; Function: <b>define-domains</b><var> rdb row5 <small class="dots">...</small><a name="index-define_002ddomains-1053"></a></var><br>
<blockquote>
       <p>Adds the domain rows <var>row5</var> <small class="dots">...</small> to the &lsquo;<samp><span class="samp">*domains-data*</span></samp>&rsquo; table
in <var>rdb</var>.  The format of the row is given in <a href="#Catalog-Representation">Catalog Representation</a>.

     <pre class="example">          (define-domains rdb '(permittivity #f complex? c64 #f))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>add-domain</b><var> rdb row5<a name="index-add_002ddomain-1054"></a></var><br>
<blockquote>
       <p>Use <code>define-domains</code> instead. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>define-tables</b><var> rdb spec-0 <small class="dots">...</small><a name="index-define_002dtables-1055"></a></var><br>
<blockquote>
       <p>Adds tables as specified in <var>spec-0</var> <small class="dots">...</small> to the open
relational-database <var>rdb</var>.  Each <var>spec</var> has the form:

     <pre class="lisp">          (<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;descriptor-name&gt;</span> <span class="roman">&lt;descriptor-name&gt;</span> <span class="roman">&lt;rows&gt;</span>)
</pre>
       <p>or
     <pre class="lisp">          (<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;primary-key-fields&gt;</span> <span class="roman">&lt;other-fields&gt;</span> <span class="roman">&lt;rows&gt;</span>)
</pre>
       <p>where <span class="roman">&lt;name&gt;</span> is the table name, <span class="roman">&lt;descriptor-name&gt;</span> is the symbol
name of a descriptor table, <span class="roman">&lt;primary-key-fields&gt;</span> and
<span class="roman">&lt;other-fields&gt;</span> describe the primary keys and other fields
respectively, and <span class="roman">&lt;rows&gt;</span> is a list of data rows to be added to the
table.

       <p><span class="roman">&lt;primary-key-fields&gt;</span> and <span class="roman">&lt;other-fields&gt;</span> are lists of field
descriptors of the form:

     <pre class="lisp">          (<span class="roman">&lt;column-name&gt;</span> <span class="roman">&lt;domain&gt;</span>)
</pre>
       <p>or
     <pre class="lisp">          (<span class="roman">&lt;column-name&gt;</span> <span class="roman">&lt;domain&gt;</span> <span class="roman">&lt;column-integrity-rule&gt;</span>)
</pre>
       <p>where <span class="roman">&lt;column-name&gt;</span> is the column name, <span class="roman">&lt;domain&gt;</span> is the domain
of the column, and <span class="roman">&lt;column-integrity-rule&gt;</span> is an expression whose
value is a procedure of one argument (which returns <code>#f</code> to signal
an error).

       <p>If <span class="roman">&lt;domain&gt;</span> is not a defined domain name and it matches the name of
this table or an already defined (in one of <var>spec-0</var> <small class="dots">...</small>) single
key field table, a foreign-key domain will be created for it. 
</p></blockquote></div>

<h5 class="subsubheading">Listing Tables</h5>

<div class="defun">
&mdash; Function: <b>list-table-definition</b><var> rdb table-name<a name="index-list_002dtable_002ddefinition-1056"></a></var><br>
<blockquote>
       <p>If symbol <var>table-name</var> exists in the open relational-database
<var>rdb</var>, then returns a list of the table-name, its primary key names
and domains, its other key names and domains, and the table's records
(as lists).  Otherwise, returns #f.

       <p>The list returned by <code>list-table-definition</code>, when passed as an
argument to <code>define-tables</code>, will recreate the table. 
</p></blockquote></div>

<div class="node">
<a name="Table-Operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Database-Interpolation">Database Interpolation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-Databases">Using Databases</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Database">Relational Database</a>

</div>

<h4 class="subsection">6.1.2 Table Operations</h4>

<p class="noindent">These are the descriptions of the methods available from an open
relational table.  A method is retrieved from a table by calling
the table with the symbol name of the operation.  For example:

<pre class="example">     ((plat 'get 'processor) 'djgpp) &rArr; i386
</pre>
  <p class="noindent">Some operations described below require primary key arguments.  Primary
keys arguments are denoted <var>key1</var> <var>key2</var> <small class="dots">...</small>.  It is an
error to call an operation for a table which takes primary key arguments
with the wrong number of primary keys for that table.

<div class="defun">
&mdash; Operation on relational-table: <b>get</b><var> column-name<a name="index-get-on-relational_002dtable-1057"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
returns the value for the <var>column-name</var> column of the row associated
with primary keys <var>key1</var>, <var>key2</var> <small class="dots">...</small> if that row exists in
the table, or <code>#f</code> otherwise.

     <pre class="example">          ((plat 'get 'processor) 'djgpp) &rArr; i386
          ((plat 'get 'processor) 'be-os) &rArr; #f
</pre>
       </blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#Single-Row-Operations">Single Row Operations</a>
<li><a accesskey="2" href="#Match_002dKeys">Match-Keys</a>
<li><a accesskey="3" href="#Multi_002dRow-Operations">Multi-Row Operations</a>
<li><a accesskey="4" href="#Indexed-Sequential-Access-Methods">Indexed Sequential Access Methods</a>
<li><a accesskey="5" href="#Sequential-Index-Operations">Sequential Index Operations</a>
<li><a accesskey="6" href="#Table-Administration">Table Administration</a>
</ul>

<div class="node">
<a name="Single-Row-Operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Match_002dKeys">Match-Keys</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Table-Operations">Table Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Table-Operations">Table Operations</a>

</div>

<h5 class="subsubsection">6.1.2.1 Single Row Operations</h5>

<p class="noindent">The term <dfn>row</dfn> used below refers to a Scheme list of values (one for
each column) in the order specified in the descriptor (table) for this
table.  Missing values appear as <code>#f</code>.  Primary keys must not
be missing.

<div class="defun">
&mdash; Operation on relational-table: <b>row:insert</b><var><a name="index-row_003ainsert-on-relational_002dtable-1058"></a></var><br>
<blockquote><p>Adds the row <var>row</var> to this table.  If a row for the primary key(s)
specified by <var>row</var> already exists in this table an error is
signaled.  The value returned is unspecified. 
</p></blockquote></div>

<pre class="example">     (define telephone-table-desc
             ((my-database 'create-table) 'telephone-table-desc))
     (define ndrp (telephone-table-desc 'row:insert))
     (ndrp '(1 #t name #f string))
     (ndrp '(2 #f telephone
               (lambda (d)
                 (and (string? d) (&gt; (string-length d) 2)
                      (every
                       (lambda (c)
                         (memv c '(#\0 #\1 #\2 #\3 #\4 #\5 #\6 #\7 #\8 #\9
                                       #\+ #\( #\space #\) #\-)))
                       (string-&gt;list d))))
               string))
</pre>
  <div class="defun">
&mdash; Operation on relational-table: <b>row:update</b><var><a name="index-row_003aupdate-on-relational_002dtable-1059"></a></var><br>
<blockquote><p>Returns a procedure of one argument, <var>row</var>, which adds the row,
<var>row</var>, to this table.  If a row for the primary key(s) specified by
<var>row</var> already exists in this table, it will be overwritten.  The
value returned is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>row:retrieve</b><var><a name="index-row_003aretrieve-on-relational_002dtable-1060"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
returns the row associated with primary keys <var>key1</var>, <var>key2</var>
<small class="dots">...</small> if it exists, or <code>#f</code> otherwise. 
</p></blockquote></div>

<pre class="example">     ((plat 'row:retrieve) 'linux) &rArr; (linux i386 linux gcc)
     ((plat 'row:retrieve) 'multics) &rArr; #f
</pre>
  <div class="defun">
&mdash; Operation on relational-table: <b>row:remove</b><var><a name="index-row_003aremove-on-relational_002dtable-1061"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
removes and returns the row associated with primary keys <var>key1</var>,
<var>key2</var> <small class="dots">...</small> if it exists, or <code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>row:delete</b><var><a name="index-row_003adelete-on-relational_002dtable-1062"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
deletes the row associated with primary keys <var>key1</var>, <var>key2</var>
<small class="dots">...</small> if it exists.  The value returned is unspecified. 
</p></blockquote></div>

<div class="node">
<a name="Match-Keys"></a>
<a name="Match_002dKeys"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multi_002dRow-Operations">Multi-Row Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Single-Row-Operations">Single Row Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Table-Operations">Table Operations</a>

</div>

<h5 class="subsubsection">6.1.2.2 Match-Keys</h5>

<p class="noindent"><a name="index-match_002dkeys-1063"></a>The (optional) <var>match-key1</var> <small class="dots">...</small> arguments are used to restrict
actions of a whole-table operation to a subset of that table.  Those
procedures (returned by methods) which accept match-key arguments will
accept any number of match-key arguments between zero and the number of
primary keys in the table.  Any unspecified <var>match-key</var> arguments
default to <code>#f</code>.

<p class="noindent">The <var>match-key1</var> <small class="dots">...</small> restrict the actions of the table command
to those records whose primary keys each satisfy the corresponding
<var>match-key</var> argument.  The arguments and their actions are:

  <blockquote>
     <dl>
<dt><code>#f</code><dd>The false value matches any key in the corresponding position. 
<br><dt>an object of type procedure<dd>This procedure must take a single argument, the key in the corresponding
position.  Any key for which the procedure returns a non-false value is
a match; Any key for which the procedure returns a <code>#f</code> is not. 
<br><dt>other values<dd>Any other value matches only those keys <code>equal?</code> to it. 
</dl>
</blockquote>

<div class="defun">
&mdash; Operation on relational-table: <b>get*</b><var> column-name<a name="index-get_002a-on-relational_002dtable-1064"></a></var><br>
<blockquote><p>Returns a procedure of optional arguments <var>match-key1</var> <small class="dots">...</small> which
returns a list of the values for the specified column for all rows in
this table.  The optional <var>match-key1</var> <small class="dots">...</small> arguments restrict
actions to a subset of the table.

     <pre class="example">          ((plat 'get* 'processor)) &rArr;
          (i386 i8086 i386 i8086 i386 i386 i8086 m68000
           m68000 m68000 m68000 m68000 powerpc)
          
          ((plat 'get* 'processor) #f) &rArr;
          (i386 i8086 i386 i8086 i386 i386 i8086 m68000
           m68000 m68000 m68000 m68000 powerpc)
          
          (define (a-key? key)
             (char=? #\a (string-ref (symbol-&gt;string key) 0)))
          
          ((plat 'get* 'processor) a-key?) &rArr;
          (m68000 m68000 m68000 m68000 m68000 powerpc)
          
          ((plat 'get* 'name) a-key?) &rArr;
          (atari-st-turbo-c atari-st-gcc amiga-sas/c-5.10
           amiga-aztec amiga-dice-c aix)
</pre>
       </blockquote></div>

<div class="node">
<a name="Multi-Row-Operations"></a>
<a name="Multi_002dRow-Operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Indexed-Sequential-Access-Methods">Indexed Sequential Access Methods</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Match_002dKeys">Match-Keys</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Table-Operations">Table Operations</a>

</div>

<h5 class="subsubsection">6.1.2.3 Multi-Row Operations</h5>

<div class="defun">
&mdash; Operation on relational-table: <b>row:retrieve*</b><var><a name="index-row_003aretrieve_002a-on-relational_002dtable-1065"></a></var><br>
<blockquote><p>Returns a procedure of optional arguments <var>match-key1</var> <small class="dots">...</small>
which returns a list of all rows in this table.  The optional
<var>match-key1</var> <small class="dots">...</small> arguments restrict actions to a subset of the
table.  For details see See <a href="#Match_002dKeys">Match-Keys</a>. 
</p></blockquote></div>

<pre class="example">     ((plat 'row:retrieve*) a-key?) &rArr;
     ((atari-st-turbo-c m68000 atari turbo-c)
      (atari-st-gcc m68000 atari gcc)
      (amiga-sas/c-5.10 m68000 amiga sas/c)
      (amiga-aztec m68000 amiga aztec)
      (amiga-dice-c m68000 amiga dice-c)
      (aix powerpc aix -))
</pre>
  <div class="defun">
&mdash; Operation on relational-table: <b>row:remove*</b><var><a name="index-row_003aremove_002a-on-relational_002dtable-1066"></a></var><br>
<blockquote><p>Returns a procedure of optional arguments <var>match-key1</var> <small class="dots">...</small> which
removes and returns a list of all rows in this table.  The optional
<var>match-key1</var> <small class="dots">...</small> arguments restrict actions to a subset of the
table. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>row:delete*</b><var><a name="index-row_003adelete_002a-on-relational_002dtable-1067"></a></var><br>
<blockquote><p>Returns a procedure of optional arguments <var>match-key1</var> <small class="dots">...</small>
which Deletes all rows from this table.  The optional <var>match-key1</var>
<small class="dots">...</small> arguments restrict deletions to a subset of the table.  The
value returned is unspecified.  The descriptor table and catalog entry
for this table are not affected. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>for-each-row</b><var><a name="index-for_002deach_002drow-on-relational_002dtable-1068"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>proc</var> <var>match-key1</var> <small class="dots">...</small>
which calls <var>proc</var> with each <var>row</var> in this table.  The
optional <var>match-key1</var> <small class="dots">...</small> arguments restrict actions to a
subset of the table.  For details see See <a href="#Match_002dKeys">Match-Keys</a>. 
</p></blockquote></div>

<p class="noindent">Note that <code>row:insert*</code> and <code>row:update*</code> do <em>not</em> use
match-keys.

<div class="defun">
&mdash; Operation on relational-table: <b>row:insert*</b><var><a name="index-row_003ainsert_002a-on-relational_002dtable-1069"></a></var><br>
<blockquote><p>Returns a procedure of one argument, <var>rows</var>, which adds each row in
the list of rows, <var>rows</var>, to this table.  If a row for the primary
key specified by an element of <var>rows</var> already exists in this table,
an error is signaled.  The value returned is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>row:update*</b><var><a name="index-row_003aupdate_002a-on-relational_002dtable-1070"></a></var><br>
<blockquote><p>Returns a procedure of one argument, <var>rows</var>, which adds each row in
the list of rows, <var>rows</var>, to this table.  If a row for the primary
key specified by an element of <var>rows</var> already exists in this table,
it will be overwritten.  The value returned is unspecified. 
</p></blockquote></div>

<div class="node">
<a name="Indexed-Sequential-Access-Methods"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Sequential-Index-Operations">Sequential Index Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multi_002dRow-Operations">Multi-Row Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Table-Operations">Table Operations</a>

</div>

<h5 class="subsubsection">6.1.2.4 Indexed Sequential Access Methods</h5>

<p class="noindent"><a name="index-ISAM-1071"></a><dfn>Indexed Sequential Access Methods</dfn> are a way of arranging
database information so that records can be accessed both by key and
by key sequence (ordering).  <dfn>ISAM</dfn> is not part of Codd's
relational model.

<p class="noindent">Associative memory in B-Trees is an example of a database
implementation which can support a native key ordering.  SLIB's
<code>alist-table</code> implementation uses <code>sort</code> to implement
<code>for-each-row-in-order</code>, but does not support <code>isam-next</code>
and <code>isam-prev</code>.

<p class="noindent">The multi-primary-key ordering employed by these operations is the
lexicographic collation of those primary-key fields in their given
order.  For example:

<pre class="example">     (12 a 34) &lt; (12 a 36) &lt; (12 b 1) &lt; (13 a 0)
</pre>
  <div class="node">
<a name="Sequential-Index-Operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Table-Administration">Table Administration</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Indexed-Sequential-Access-Methods">Indexed Sequential Access Methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Table-Operations">Table Operations</a>

</div>

<h5 class="subsubsection">6.1.2.5 Sequential Index Operations</h5>

<p class="noindent">The following procedures are individually optional depending on the
base-table implememtation.  If an operation is <em>not</em> supported,
then calling the table with that operation symbol will return false.

<div class="defun">
&mdash; Operation on relational-table: <b>for-each-row-in-order</b><var><a name="index-for_002deach_002drow_002din_002dorder-on-relational_002dtable-1072"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>proc</var> <var>match-key1</var> <small class="dots">...</small>
which calls <var>proc</var> with each <var>row</var> in this table in the
(implementation-dependent) natural, repeatable ordering for rows.  The
optional <var>match-key1</var> <small class="dots">...</small> arguments restrict actions to a
subset of the table.  For details see See <a href="#Match_002dKeys">Match-Keys</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>isam-next</b><var><a name="index-isam_002dnext-on-relational_002dtable-1073"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
returns the key-list identifying the lowest record higher than
<var>key1</var> <var>key2</var> <small class="dots">...</small> which is stored in the relational-table;
or false if no higher record is present. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>isam-next</b><var> column-name<a name="index-isam_002dnext-on-relational_002dtable-1074"></a></var><br>
<blockquote><p>The symbol <var>column-name</var> names a key field.  In the list returned
by <code>isam-next</code>, that field, or a field to its left, will be
changed.  This allows one to skip over less significant key fields. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>isam-prev</b><var><a name="index-isam_002dprev-on-relational_002dtable-1075"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
returns the key-list identifying the highest record less than
<var>key1</var> <var>key2</var> <small class="dots">...</small> which is stored in the relational-table;
or false if no lower record is present. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>isam-prev</b><var> column-name<a name="index-isam_002dprev-on-relational_002dtable-1076"></a></var><br>
<blockquote><p>The symbol <var>column-name</var> names a key field.  In the list returned
by <code>isam-next</code>, that field, or a field to its left, will be
changed.  This allows one to skip over less significant key fields. 
</p></blockquote></div>

  <p>For example, if a table has key fields:
<pre class="example">     (col1 col2)
     (9 5)
     (9 6)
     (9 7)
     (9 8)
     (12 5)
     (12 6)
     (12 7)
</pre>
  <p>Then:
<pre class="example">     ((table 'isam-next)       '(9 5))       &rArr; (9 6)
     ((table 'isam-next 'col2) '(9 5))       &rArr; (9 6)
     ((table 'isam-next 'col1) '(9 5))       &rArr; (12 5)
     ((table 'isam-prev)       '(12 7))      &rArr; (12 6)
     ((table 'isam-prev 'col2) '(12 7))      &rArr; (12 6)
     ((table 'isam-prev 'col1) '(12 7))      &rArr; (9 8)
</pre>
  <div class="node">
<a name="Table-Administration"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Sequential-Index-Operations">Sequential Index Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Table-Operations">Table Operations</a>

</div>

<h5 class="subsubsection">6.1.2.6 Table Administration</h5>

<div class="defun">
&mdash; Operation on relational-table: <b>column-names</b><var><a name="index-column_002dnames-on-relational_002dtable-1077"></a></var><br>
&mdash; Operation on relational-table: <b>column-foreigns</b><var><a name="index-column_002dforeigns-on-relational_002dtable-1078"></a></var><br>
&mdash; Operation on relational-table: <b>column-domains</b><var><a name="index-column_002ddomains-on-relational_002dtable-1079"></a></var><br>
&mdash; Operation on relational-table: <b>column-types</b><var><a name="index-column_002dtypes-on-relational_002dtable-1080"></a></var><br>
<blockquote><p>Return a list of the column names, foreign-key table names, domain
names, or type names respectively for this table.  These 4 methods are
different from the others in that the list is returned, rather than a
procedure to obtain the list. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>primary-limit</b><var><a name="index-primary_002dlimit-on-relational_002dtable-1081"></a></var><br>
<blockquote><p>Returns the number of primary keys fields in the relations in this
table. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-table: <b>close-table</b><var><a name="index-close_002dtable-on-relational_002dtable-1082"></a></var><br>
<blockquote><p>Subsequent operations to this table will signal an error. 
</p></blockquote></div>

<div class="node">
<a name="Database-Interpolation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Embedded-Commands">Embedded Commands</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Table-Operations">Table Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Database">Relational Database</a>

</div>

<h4 class="subsection">6.1.3 Database Interpolation</h4>

<p><code>(require 'database-interpolate)</code>

<p class="noindent">Indexed sequential access methods allow finding the keys (having
associations) closest to a given value.  This facilitates the
interpolation of associations between those in the table.

<div class="defun">
&mdash; Function: <b>interpolate-from-table</b><var> table column<a name="index-interpolate_002dfrom_002dtable-1083"></a></var><br>
<blockquote><p><var>Table</var> should be a relational table with one numeric primary key
field which supports the <code>isam-prev</code> and <code>isam-next</code>
operations.  <var>column</var> should be a symbol or exact positive integer
designating a numerically valued column of <var>table</var>.

       <p><code>interpolate-from-table</code> calculates and returns a value
proportionally intermediate between its values in the next and
previous key records contained in <var>table</var>.  For keys larger than
all the stored keys the value associated with the largest stored key
is used.  For keys smaller than all the stored keys the value
associated with the smallest stored key is used. 
</p></blockquote></div>

<div class="node">
<a name="Embedded-Commands"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Database-Macros">Database Macros</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Database-Interpolation">Database Interpolation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Database">Relational Database</a>

</div>

<h4 class="subsection">6.1.4 Embedded Commands</h4>

<p><code>(require 'database-commands)</code>

<p class="noindent">This enhancement wraps a utility layer on <code>relational-database</code>
which provides:

     <ul>
<li>Automatic execution of initialization commands stored in database. 
<li>Transparent execution of database commands stored in <code>*commands*</code>
table in database. 
</ul>

  <p>When an enhanced relational-database is called with a symbol which
matches a <var>name</var> in the <code>*commands*</code> table, the associated
procedure expression is evaluated and applied to the enhanced
relational-database.  A procedure should then be returned which the user
can invoke on (optional) arguments.

  <p>The command <code>*initialize*</code> is special.  If present in the
<code>*commands*</code> table, <code>open-database</code> or <code>open-database!</code>
will return the value of the <code>*initialize*</code> command.  Notice that
arbitrary code can be run when the <code>*initialize*</code> procedure is
automatically applied to the enhanced relational-database.

  <p>Note also that if you wish to shadow or hide from the user
relational-database methods described in <a href="#Database-Operations">Database Operations</a>, this
can be done by a dispatch in the closure returned by the
<code>*initialize*</code> expression rather than by entries in the
<code>*commands*</code> table if it is desired that the underlying methods
remain accessible to code in the <code>*commands*</code> table.

<ul class="menu">
<li><a accesskey="1" href="#Database-Extension">Database Extension</a>
<li><a accesskey="2" href="#Command-Intrinsics">Command Intrinsics</a>
<li><a accesskey="3" href="#Define_002dtables-Example">Define-tables Example</a>
<li><a accesskey="4" href="#The-_002acommands_002a-Table">The *commands* Table</a>
<li><a accesskey="5" href="#Command-Service">Command Service</a>
<li><a accesskey="6" href="#Command-Example">Command Example</a>
</ul>

<div class="node">
<a name="Database-Extension"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Command-Intrinsics">Command Intrinsics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Embedded-Commands">Embedded Commands</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Embedded-Commands">Embedded Commands</a>

</div>

<h5 class="subsubsection">6.1.4.1 Database Extension</h5>

<div class="defun">
&mdash; Function: <b>wrap-command-interface</b><var> rdb<a name="index-wrap_002dcommand_002dinterface-1084"></a></var><br>
<blockquote><p>Returns relational database <var>rdb</var> wrapped with additional commands
defined in its *commands* table. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>add-command-tables</b><var> rdb<a name="index-add_002dcommand_002dtables-1085"></a></var><br>
<blockquote><p>The relational database <var>rdb</var> must be mutable. 
<var>add-command-tables</var> adds a *command* table to <var>rdb</var>; then
returns <code>(wrap-command-interface </code><var>rdb</var><code>)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>define-*commands*</b><var> rdb spec-0 <small class="dots">...</small><a name="index-define_002d_002acommands_002a-1086"></a></var><br>
<blockquote>
       <p>Adds commands to the <code>*commands*</code> table as specified in
<var>spec-0</var> <small class="dots">...</small> to the open relational-database <var>rdb</var>.  Each
<var>spec</var> has the form:

     <pre class="lisp">          ((<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;rdb&gt;</span>) <span class="roman">"comment"</span> <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span> ...)
</pre>
       <p>or
     <pre class="lisp">          ((<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;rdb&gt;</span>) <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span> ...)
</pre>
       <p>where <span class="roman">&lt;name&gt;</span> is the command name, <span class="roman">&lt;rdb&gt;</span> is a formal passed the
calling relational database, <span class="roman">"comment"</span> describes the
command, and <span class="roman">&lt;expression1&gt;</span>, <span class="roman">&lt;expression1&gt;</span>, <small class="dots">...</small> are the
body of the procedure.

       <p><code>define-*commands*</code> adds to the <code>*commands*</code> table a command
<span class="roman">&lt;name&gt;</span>:

     <pre class="lisp">          (lambda (<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;rdb&gt;</span>) <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span> ...)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>open-command-database</b><var> filename<a name="index-open_002dcommand_002ddatabase-1087"></a></var><br>
&mdash; Function: <b>open-command-database</b><var> filename base-table-type<a name="index-open_002dcommand_002ddatabase-1088"></a></var><br>
<blockquote><p>Returns an open enhanced relational database associated with
<var>filename</var>.  The database will be opened with base-table type
<var>base-table-type</var>) if supplied.  If <var>base-table-type</var> is not
supplied, <code>open-command-database</code> will attempt to deduce the correct
base-table-type.  If the database can not be opened or if it lacks the
<code>*commands*</code> table, <code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-command-database!</b><var> filename<a name="index-open_002dcommand_002ddatabase_0021-1089"></a></var><br>
&mdash; Function: <b>open-command-database!</b><var> filename base-table-type<a name="index-open_002dcommand_002ddatabase_0021-1090"></a></var><br>
<blockquote><p>Returns <em>mutable</em> open enhanced relational database <small class="dots">...</small>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-command-database</b><var> database<a name="index-open_002dcommand_002ddatabase-1091"></a></var><br>
<blockquote><p>Returns <var>database</var> if it is an immutable relational database; #f
otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-command-database!</b><var> database<a name="index-open_002dcommand_002ddatabase_0021-1092"></a></var><br>
<blockquote><p>Returns <var>database</var> if it is a mutable relational database; #f
otherwise. 
</p></blockquote></div>

<div class="node">
<a name="Command-Intrinsics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Define_002dtables-Example">Define-tables Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Database-Extension">Database Extension</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Embedded-Commands">Embedded Commands</a>

</div>

<h5 class="subsubsection">6.1.4.2 Command Intrinsics</h5>

<p>Some commands are defined in all extended relational-databases.  The are
called just like <a href="#Database-Operations">Database Operations</a>.

<div class="defun">
&mdash; Operation on relational-database: <b>add-domain</b><var> domain-row<a name="index-add_002ddomain-on-relational_002ddatabase-1093"></a></var><br>
<blockquote><p>Adds <var>domain-row</var> to the <dfn>domains</dfn> table if there is no row in
the domains table associated with key <code>(car </code><var>domain-row</var><code>)</code> and
returns <code>#t</code>.  Otherwise returns <code>#f</code>.

       <p>For the fields and layout of the domain table,
See <a href="#Catalog-Representation">Catalog Representation</a>.  Currently, these fields are
          <ul>
<li>domain-name
<li>foreign-table
<li>domain-integrity-rule
<li>type-id
<li>type-param
</ul>

       <p>The following example adds 3 domains to the &lsquo;<samp><span class="samp">build</span></samp>&rsquo; database. 
&lsquo;<samp><span class="samp">Optstring</span></samp>&rsquo; is either a string or <code>#f</code>.  <code>filename</code> is a
string and <code>build-whats</code> is a symbol.

     <pre class="example">          (for-each (build 'add-domain)
                    '((optstring #f
                                 (lambda (x) (or (not x) (string? x)))
                                 string
                                 #f)
                      (filename #f #f string #f)
                      (build-whats #f #f symbol #f)))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>delete-domain</b><var> domain-name<a name="index-delete_002ddomain-on-relational_002ddatabase-1094"></a></var><br>
<blockquote><p>Removes and returns the <var>domain-name</var> row from the <dfn>domains</dfn>
table. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>domain-checker</b><var> domain<a name="index-domain_002dchecker-on-relational_002ddatabase-1095"></a></var><br>
<blockquote><p>Returns a procedure to check an argument for conformance to domain
<var>domain</var>. 
</p></blockquote></div>

<div class="node">
<a name="Define-tables-Example"></a>
<a name="Define_002dtables-Example"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-_002acommands_002a-Table">The *commands* Table</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Command-Intrinsics">Command Intrinsics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Embedded-Commands">Embedded Commands</a>

</div>

<h5 class="subsubsection">6.1.4.3 Define-tables Example</h5>

<p class="noindent">The following example shows a new database with the name of
<samp><span class="file">foo.db</span></samp> being created with tables describing processor families
and processor/os/compiler combinations.  The database is then
solidified; saved and changed to immutable.

<pre class="example">     (require 'databases)
     <a name="index-databases-1096"></a>(define my-rdb (create-database "foo.db" 'alist-table))
     (define-tables my-rdb
       '(processor-family
         ((family    atom))
         ((also-ran  processor-family))
         ((m68000           #f)
          (m68030           m68000)
          (i386             i8086)
          (i8086            #f)
          (powerpc          #f)))
     
       '(platform
         ((name      symbol))
         ((processor processor-family)
          (os        symbol)
          (compiler  symbol))
         ((aix              powerpc aix     -)
          (amiga-dice-c     m68000  amiga   dice-c)
          (amiga-aztec      m68000  amiga   aztec)
          (amiga-sas/c-5.10 m68000  amiga   sas/c)
          (atari-st-gcc     m68000  atari   gcc)
          (atari-st-turbo-c m68000  atari   turbo-c)
          (borland-c-3.1    i8086   ms-dos  borland-c)
          (djgpp            i386    ms-dos  gcc)
          (linux            i386    linux   gcc)
          (microsoft-c      i8086   ms-dos  microsoft-c)
          (os/2-emx         i386    os/2    gcc)
          (turbo-c-2        i8086   ms-dos  turbo-c)
          (watcom-9.0       i386    ms-dos  watcom))))
     
     (solidify-database my-rdb)
</pre>
  <div class="node">
<a name="The-*commands*-Table"></a>
<a name="The-_002acommands_002a-Table"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Command-Service">Command Service</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Define_002dtables-Example">Define-tables Example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Embedded-Commands">Embedded Commands</a>

</div>

<h5 class="subsubsection">6.1.4.4 The *commands* Table</h5>

<p class="noindent">The table <code>*commands*</code> in an <dfn>enhanced</dfn> relational-database has
the fields (with domains):
<pre class="example">     PRI name        symbol
         parameters  parameter-list
         procedure   expression
         documentation string
</pre>
  <p>The <code>parameters</code> field is a foreign key (domain
<code>parameter-list</code>) of the <code>*catalog-data*</code> table and should
have the value of a table described by <code>*parameter-columns*</code>.  This
<code>parameter-list</code> table describes the arguments suitable for passing
to the associated command.  The intent of this table is to be of a form
such that different user-interfaces (for instance, pull-down menus or
plain-text queries) can operate from the same table.  A
<code>parameter-list</code> table has the following fields:
<pre class="example">     PRI index       ordinal
         name        symbol
         arity       parameter-arity
         domain      domain
         defaulter   expression
         expander    expression
         documentation string
</pre>
  <p>The <code>arity</code> field can take the values:

     <dl>
<dt><code>single</code><dd>Requires a single parameter of the specified domain. 
<br><dt><code>optional</code><dd>A single parameter of the specified domain or zero parameters is
acceptable. 
<br><dt><code>boolean</code><dd>A single boolean parameter or zero parameters (in which case <code>#f</code>
is substituted) is acceptable. 
<br><dt><code>nary</code><dd>Any number of parameters of the specified domain are acceptable.  The
argument passed to the command function is always a list of the
parameters. 
<br><dt><code>nary1</code><dd>One or more of parameters of the specified domain are acceptable.  The
argument passed to the command function is always a list of the
parameters. 
</dl>

  <p>The <code>domain</code> field specifies the domain which a parameter or
parameters in the <code>index</code>th field must satisfy.

  <p>The <code>defaulter</code> field is an expression whose value is either
<code>#f</code> or a procedure of one argument (the parameter-list) which
returns a <em>list</em> of the default value or values as appropriate. 
Note that since the <code>defaulter</code> procedure is called every time a
default parameter is needed for this column, <dfn>sticky</dfn> defaults can
be implemented using shared state with the domain-integrity-rule.

<div class="node">
<a name="Command-Service"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Command-Example">Command Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-_002acommands_002a-Table">The *commands* Table</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Embedded-Commands">Embedded Commands</a>

</div>

<h5 class="subsubsection">6.1.4.5 Command Service</h5>

<div class="defun">
&mdash; Function: <b>make-command-server</b><var> rdb table-name<a name="index-make_002dcommand_002dserver-1097"></a></var><br>
<blockquote><p>Returns a procedure of 2 arguments, a (symbol) command and a call-back
procedure.  When this returned procedure is called, it looks up
<var>command</var> in table <var>table-name</var> and calls the call-back
procedure with arguments:
          <dl>
<dt><var>command</var><dd>The <var>command</var>
<br><dt><var>command-value</var><dd>The result of evaluating the expression in the <var>procedure</var> field of
<var>table-name</var> and calling it with <var>rdb</var>. 
<br><dt><var>parameter-name</var><dd>A list of the <dfn>official</dfn> name of each parameter.  Corresponds to the
<code>name</code> field of the <var>command</var>'s parameter-table. 
<br><dt><var>positions</var><dd>A list of the positive integer index of each parameter.  Corresponds to
the <code>index</code> field of the <var>command</var>'s parameter-table. 
<br><dt><var>arities</var><dd>A list of the arities of each parameter.  Corresponds to the
<code>arity</code> field of the <var>command</var>'s parameter-table.  For a
description of <code>arity</code> see table above. 
<br><dt><var>types</var><dd>A list of the type name of each parameter.  Correspnds to the
<code>type-id</code> field of the contents of the <code>domain</code> of the
<var>command</var>'s parameter-table. 
<br><dt><var>defaulters</var><dd>A list of the defaulters for each parameter.  Corresponds to
the <code>defaulters</code> field of the <var>command</var>'s parameter-table. 
<br><dt><var>domain-integrity-rules</var><dd>A list of procedures (one for each parameter) which tests whether a
value for a parameter is acceptable for that parameter.  The procedure
should be called with each datum in the list for <code>nary</code> arity
parameters. 
<br><dt><var>aliases</var><dd>A list of lists of <code>(</code><span class="roman">alias</span> <span class="roman">parameter-name</span><code>)</code>.  There can be
more than one alias per <var>parameter-name</var>. 
</dl>
       </p></blockquote></div>

  <p>For information about parameters, See <a href="#Parameter-lists">Parameter lists</a>.

<div class="node">
<a name="Command-Example"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Command-Service">Command Service</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Embedded-Commands">Embedded Commands</a>

</div>

<h5 class="subsubsection">6.1.4.6 Command Example</h5>

<p>Here is an example of setting up a command with arguments and parsing
those arguments from a <code>getopt</code> style argument list
(see <a href="#Getopt">Getopt</a>).

<pre class="example">     (require 'database-commands)
     <a name="index-database_002dcommands-1098"></a>(require 'databases)
     <a name="index-databases-1099"></a>(require 'getopt-parameters)
     <a name="index-getopt_002dparameters-1100"></a>(require 'parameters)
     <a name="index-parameters-1101"></a>(require 'getopt)
     <a name="index-getopt-1102"></a>(require 'fluid-let)
     (require 'printf)
     
     (define my-rdb (add-command-tables (create-database #f 'alist-table)))
     
     (define-tables my-rdb
       '(foo-params
         *parameter-columns*
         *parameter-columns*
         ((1 single-string single string
             (lambda (pl) '("str")) #f "single string")
          (2 nary-symbols nary symbol
             (lambda (pl) '()) #f "zero or more symbols")
          (3 nary1-symbols nary1 symbol
             (lambda (pl) '(symb)) #f "one or more symbols")
          (4 optional-number optional ordinal
             (lambda (pl) '()) #f "zero or one number")
          (5 flag boolean boolean
             (lambda (pl) '(#f)) #f "a boolean flag")))
       '(foo-pnames
         ((name string))
         ((parameter-index ordinal))
         (("s" 1)
          ("single-string" 1)
          ("n" 2)
          ("nary-symbols" 2)
          ("N" 3)
          ("nary1-symbols" 3)
          ("o" 4)
          ("optional-number" 4)
          ("f" 5)
          ("flag" 5)))
       '(my-commands
         ((name symbol))
         ((parameters parameter-list)
          (parameter-names parameter-name-translation)
          (procedure expression)
          (documentation string))
         ((foo
           foo-params
           foo-pnames
           (lambda (rdb) (lambda args (print args)))
           "test command arguments"))))
     
     (define (dbutil:serve-command-line rdb command-table command argv)
       (set! *argv* (if (vector? argv) (vector-&gt;list argv) argv))
       ((make-command-server rdb command-table)
        command
        (lambda (comname comval options positions
                         arities types defaulters dirs aliases)
          (apply comval (getopt-&gt;arglist options positions
                         arities types defaulters dirs aliases)))))
     
     (define (cmd . opts)
       (fluid-let ((*optind* 1))
         (printf "%-34s &rArr; "
                 (call-with-output-string
                  (lambda (pt) (write (cons 'cmd opts) pt))))
         (set! opts (cons "cmd" opts))
         (force-output)
         (dbutil:serve-command-line
          my-rdb 'my-commands 'foo (length opts) opts)))
     
     (cmd)                              &rArr; ("str" () (symb) () #f)
     (cmd "-f")                         &rArr; ("str" () (symb) () #t)
     (cmd "--flag")                     &rArr; ("str" () (symb) () #t)
     (cmd "-o177")                      &rArr; ("str" () (symb) (177) #f)
     (cmd "-o" "177")                   &rArr; ("str" () (symb) (177) #f)
     (cmd "--optional" "621")           &rArr; ("str" () (symb) (621) #f)
     (cmd "--optional=621")             &rArr; ("str" () (symb) (621) #f)
     (cmd "-s" "speciality")            &rArr; ("speciality" () (symb) () #f)
     (cmd "-sspeciality")               &rArr; ("speciality" () (symb) () #f)
     (cmd "--single" "serendipity")     &rArr; ("serendipity" () (symb) () #f)
     (cmd "--single=serendipity")       &rArr; ("serendipity" () (symb) () #f)
     (cmd "-n" "gravity" "piety")       &rArr; ("str" () (piety gravity) () #f)
     (cmd "-ngravity" "piety")          &rArr; ("str" () (piety gravity) () #f)
     (cmd "--nary" "chastity")          &rArr; ("str" () (chastity) () #f)
     (cmd "--nary=chastity" "")         &rArr; ("str" () ( chastity) () #f)
     (cmd "-N" "calamity")              &rArr; ("str" () (calamity) () #f)
     (cmd "-Ncalamity")                 &rArr; ("str" () (calamity) () #f)
     (cmd "--nary1" "surety")           &rArr; ("str" () (surety) () #f)
     (cmd "--nary1=surety")             &rArr; ("str" () (surety) () #f)
     (cmd "-N" "levity" "fealty")       &rArr; ("str" () (fealty levity) () #f)
     (cmd "-Nlevity" "fealty")          &rArr; ("str" () (fealty levity) () #f)
     (cmd "--nary1" "surety" "brevity") &rArr; ("str" () (brevity surety) () #f)
     (cmd "--nary1=surety" "brevity")   &rArr; ("str" () (brevity surety) () #f)
     (cmd "-?")
     -|
     Usage: cmd [OPTION ARGUMENT ...] ...
     
       -f, --flag
       -o, --optional[=]&lt;number&gt;
       -n, --nary[=]&lt;symbols&gt; ...
       -N, --nary1[=]&lt;symbols&gt; ...
       -s, --single[=]&lt;string&gt;
     
     ERROR: getopt-&gt;parameter-list "unrecognized option" "-?"
</pre>
  <div class="node">
<a name="Database-Macros"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Database-Browser">Database Browser</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Embedded-Commands">Embedded Commands</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Database">Relational Database</a>

</div>

<h4 class="subsection">6.1.5 Database Macros</h4>

<p><code>(require 'within-database)</code>

  <p>The object-oriented programming interface to SLIB relational databases
has failed to support clear, understandable, and modular code-writing
for database applications.

  <p>This seems to be a failure of the object-oriented paradigm where the
type of an object is not manifest (or even traceable) in source code.

  <p><code>within-database</code>, along with the &lsquo;<samp><span class="samp">databases</span></samp>&rsquo; package,
reorganizes high-level database functions toward a more declarative
style.  Using this package, one can tag database table and command
declarations for emacs:

<pre class="example">     etags -lscheme -r'/ *(define-\(command\|table\) (\([^; \t]+\)/\2/' \
           source1.scm ...
</pre>
  <!-- )) -->
<ul class="menu">
<li><a accesskey="1" href="#Within_002ddatabase">Within-database</a>
<li><a accesskey="2" href="#Within_002ddatabase-Example">Within-database Example</a>
</ul>

<div class="node">
<a name="Within-database"></a>
<a name="Within_002ddatabase"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Within_002ddatabase-Example">Within-database Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Database-Macros">Database Macros</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Database-Macros">Database Macros</a>

</div>

<h5 class="subsubsection">6.1.5.1 Within-database</h5>

<div class="defun">
&mdash; Function: <b>within-database</b><var> database statement-1 <small class="dots">...</small><a name="index-within_002ddatabase-1103"></a></var><br>
<blockquote>
       <p><code>within-database</code> creates a lexical scope in which the commands
<code>define-table</code> and <code>define-command</code> create tables and
<code>*commands*</code>-table entries respectively in open relational
database <var>database</var>.  The expressions in `within-database' form
are executed in order.

       <p><code>within-database</code> Returns <var>database</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>define-command</b> (<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;rdb&gt;</span>) <span class="roman">"comment"</span> <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span><var> <small class="dots">...</small><a name="index-define_002dcommand-1104"></a></var><br>
&mdash; Syntax: <b>define-command</b> (<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;rdb&gt;</span>) <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span><var> <small class="dots">...</small><a name="index-define_002dcommand-1105"></a></var><br>
<blockquote>
       <p>Adds to the <code>*commands*</code> table a command
<span class="roman">&lt;name&gt;</span>:

     <pre class="lisp">          (lambda (<span class="roman">&lt;name&gt;</span> <span class="roman">&lt;rdb&gt;</span>) <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span> ...)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Syntax: <b>define-table</b> <span class="roman">&lt;name&gt;</span> <span class="roman">&lt;descriptor-name&gt;</span> <span class="roman">&lt;descriptor-name&gt;</span> <span class="roman">&lt;rows&gt;</span><var><a name="index-define_002dtable-1106"></a></var><br>
&mdash; Syntax: <b>define-table</b> <span class="roman">&lt;name&gt;</span> <span class="roman">&lt;primary-key-fields&gt;</span> <span class="roman">&lt;other-fields&gt;</span> <span class="roman">&lt;rows&gt;</span><var><a name="index-define_002dtable-1107"></a></var><br>
<blockquote>
       <p>where <span class="roman">&lt;name&gt;</span> is the table name, <span class="roman">&lt;descriptor-name&gt;</span> is the symbol
name of a descriptor table, <span class="roman">&lt;primary-key-fields&gt;</span> and
<span class="roman">&lt;other-fields&gt;</span> describe the primary keys and other fields
respectively, and <span class="roman">&lt;rows&gt;</span> is a list of data rows to be added to the
table.

       <p><span class="roman">&lt;primary-key-fields&gt;</span> and <span class="roman">&lt;other-fields&gt;</span> are lists of field
descriptors of the form:

     <pre class="lisp">          (<span class="roman">&lt;column-name&gt;</span> <span class="roman">&lt;domain&gt;</span>)
</pre>
       <p>or
     <pre class="lisp">          (<span class="roman">&lt;column-name&gt;</span> <span class="roman">&lt;domain&gt;</span> <span class="roman">&lt;column-integrity-rule&gt;</span>)
</pre>
       <p>where <span class="roman">&lt;column-name&gt;</span> is the column name, <span class="roman">&lt;domain&gt;</span> is the domain
of the column, and <span class="roman">&lt;column-integrity-rule&gt;</span> is an expression whose
value is a procedure of one argument (which returns <code>#f</code> to signal
an error).

       <p>If <span class="roman">&lt;domain&gt;</span> is not a defined domain name and it matches the name of
this table or an already defined (in one of <var>spec-0</var> <small class="dots">...</small>) single
key field table, a foreign-key domain will be created for it.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>add-macro-support</b><var> database<a name="index-add_002dmacro_002dsupport-1108"></a></var><br>
<blockquote><p>The relational database <var>database</var> must be mutable. 
<code>add-macro-support</code> adds a <code>*macros*</code> table and
<code>define-macro</code> macro to <var>database</var>; then <var>database</var> is
returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>define-macro</b> (<span class="roman">&lt;name&gt;</span> <span class="roman">arg1</span><var> <small class="dots">...</small></var>) <span class="roman">"comment"</span> <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span><var> <small class="dots">...</small><a name="index-define_002dmacro-1109"></a></var><br>
&mdash; Syntax: <b>define-macro</b> (<span class="roman">&lt;name&gt;</span> <span class="roman">arg1</span><var> <small class="dots">...</small></var>) <span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span><var> <small class="dots">...</small><a name="index-define_002dmacro-1110"></a></var><br>
<blockquote><p>Adds a macro <span class="roman">&lt;name&gt;</span> to the <code>*macros*</code>.

       <p><em>Note:</em> <code>within-database</code> creates lexical scope where not
only <code>define-command</code> and <code>define-table</code>, but every command
and macro are defined, ie.:

     <pre class="example">          (within-database my-rdb
            (define-command (message rdb)
              (lambda (msg)
                (display "message: ")
                (display msg)
                (newline)))
            (message "Defining FOO...")
            ;; ... defining FOO ...
            (message "Defining BAR...")
            ;; ... defining BAR ...
            )
</pre>
       </blockquote></div>

<div class="node">
<a name="Within-database-Example"></a>
<a name="Within_002ddatabase-Example"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Within_002ddatabase">Within-database</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Database-Macros">Database Macros</a>

</div>

<h5 class="subsubsection">6.1.5.2 Within-database Example</h5>

<p class="noindent">Here is an example of <code>within-database</code> macros:

<pre class="example">     (require 'within-database)
     
     (define my-rdb
       (add-command-tables
        (create-database "foo.db" 'alist-table)))
     
     (within-database my-rdb
       (define-command (*initialize* rdb)
         "Print Welcome"
         (display "Welcome")
         (newline)
         rdb)
       (define-command (without-documentation rdb)
         (display "without-documentation called")
         (newline))
       (define-table (processor-family
                      ((family   atom))
                      ((also-ran processor-family)))
         (m68000  #f)
         (m68030  m68000)
         (i386    i8086)
         (i8086   #f)
         (powerpc #f))
       (define-table (platform
                      ((name symbol))
                      ((processor processor-family)
                       (os        symbol)
                       (compiler  symbol)))
         (aix              powerpc aix     -)
         ;; ...
         (amiga-aztec      m68000  amiga   aztec)
         (amiga-sas/c-5.10 m68000  amiga   sas/c)
         (atari-st-gcc     m68000  atari   gcc)
         ;; ...
         (watcom-9.0       i386    ms-dos  watcom))
       (define-command (get-processor rdb)
         "Get processor for given platform."
         (((rdb 'open-table) 'platform #f) 'get 'processor)))
     
     (close-database my-rdb)
     
     (set! my-rdb (open-command-database! "foo.db"))
     -|
     Welcome
     
     (my-rdb 'without-documentation)
     -|
     without-documentation called
     
     ((my-rdb 'get-processor) 'amiga-sas/c-5.10)
     &rArr; m68000
     
     (close-database my-rdb)
</pre>
  <div class="node">
<a name="Database-Browser"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Database-Macros">Database Macros</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Database">Relational Database</a>

</div>

<h4 class="subsection">6.1.6 Database Browser</h4>

<p>(require 'database-browse)

<div class="defun">
&mdash; Procedure: <b>browse</b><var> database<a name="index-browse-1111"></a></var><br>
<blockquote>
       <p>Prints the names of all the tables in <var>database</var> and sets browse's
default to <var>database</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>browse</b><var><a name="index-browse-1112"></a></var><br>
<blockquote>
       <p>Prints the names of all the tables in the default database. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>browse</b><var> table-name<a name="index-browse-1113"></a></var><br>
<blockquote>
       <p>For each record of the table named by the symbol <var>table-name</var>,
prints a line composed of all the field values. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>browse</b><var> pathname<a name="index-browse-1114"></a></var><br>
<blockquote>
       <p>Opens the database named by the string <var>pathname</var>, prints the names
of all its tables, and sets browse's default to the database. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>browse</b><var> database table-name<a name="index-browse-1115"></a></var><br>
<blockquote>
       <p>Sets browse's default to <var>database</var> and prints the records of the
table named by the symbol <var>table-name</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>browse</b><var> pathname table-name<a name="index-browse-1116"></a></var><br>
<blockquote>
       <p>Opens the database named by the string <var>pathname</var> and sets browse's
default to it; <code>browse</code> prints the records of the table named by
the symbol <var>table-name</var>. 
</p></blockquote></div>

<div class="node">
<a name="Relational-Infrastructure"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Relational-Database">Relational Database</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Database-Packages">Database Packages</a>

</div>

<h3 class="section">6.2 Relational Infrastructure</h3>

<ul class="menu">
<li><a accesskey="1" href="#Base-Table">Base Table</a>
<li><a accesskey="2" href="#Catalog-Representation">Catalog Representation</a>
<li><a accesskey="3" href="#Relational-Database-Objects">Relational Database Objects</a>
<li><a accesskey="4" href="#Database-Operations">Database Operations</a>
</ul>

<div class="node">
<a name="Base-Table"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Catalog-Representation">Catalog Representation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Relational-Infrastructure">Relational Infrastructure</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Infrastructure">Relational Infrastructure</a>

</div>

<h4 class="subsection">6.2.1 Base Table</h4>

<p><a name="index-base_002dtable-1117"></a>A <dfn>base-table</dfn> is the primitive database layer upon which SLIB
relational databases are built.  At the minimum, it must support the
types integer, symbol, string, and boolean.  The base-table may restrict
the size of integers, symbols, and strings it supports.

  <p>A base table implementation is available as the value of the identifier
naming it (eg. <var>alist-table</var>) after requiring the symbol of that
name.

<div class="defun">
&mdash; Feature: <b>alist-table</b><var><a name="index-alist_002dtable-1118"></a></var><br>
<blockquote><p><code>(require 'alist-table)</code>
<a name="index-alist_002dtable-1119"></a>
Association-list base tables support all Scheme types and are suitable
for small databases.  In order to be retrieved after being written to a
file, the data stored should include only objects which are readable and
writeable in the Scheme implementation.

       <p>The <dfn>alist-table</dfn> base-table implementation is included in the
SLIB distribution. 
</p></blockquote></div>

  <p><dfn>WB</dfn> is a B-tree database package with SCM interfaces.  Being
disk-based, WB databases readily store and access hundreds of
megabytes of data.  WB comes with two base-table embeddings.

<div class="defun">
&mdash; Feature: <b>wb-table</b><var><a name="index-wb_002dtable-1120"></a></var><br>
<blockquote><p><code>(require 'wb-table)</code>
<a name="index-wb_002dtable-1121"></a>
<a name="index-WB-1122"></a><code>wb-table</code> supports scheme expressions for keys and values whose
text representations are less than 255 characters in length. 
See <a href="wb.html#wb_002dtable">wb-table</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Feature: <b>rwb-isam</b><var><a name="index-rwb_002disam-1123"></a></var><br>
<blockquote><p><code>(require 'rwb-isam)</code>
<a name="index-rwb_002disam-1124"></a>
<dfn>rwb-isam</dfn> is a sophisticated base-table implementation built on
WB and SCM which uses binary numerical formats for key and non-key
fields.  It supports IEEE floating-point and fixed-precision integer
keys with the correct numerical collation order. 
</p></blockquote></div>

  <p>This rest of this section documents the interface for a base table
implementation from which the <a href="#Relational-Database">Relational Database</a> package
constructs a Relational system.  It will be of interest primarily to
those wishing to port or write new base-table implementations.

<div class="defun">
&mdash; Variable: <b>*base-table-implementations*</b><var><a name="index-g_t_002abase_002dtable_002dimplementations_002a-1125"></a></var><br>
<blockquote><p>To support automatic dispatch for <code>open-database</code>, each base-table
module adds an association to <var>*base-table-implementations*</var> when
loaded.  This association is the list of the base-table symbol and the
value returned by <code>(make-relational-system </code><var>base-table</var><code>)</code>. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#The-Base">The Base</a>
<li><a accesskey="2" href="#Base-Tables">Base Tables</a>
<li><a accesskey="3" href="#Base-Field-Types">Base Field Types</a>
<li><a accesskey="4" href="#Composite-Keys">Composite Keys</a>
<li><a accesskey="5" href="#Base-Record-Operations">Base Record Operations</a>
<li><a accesskey="6" href="#Match-Keys">Match Keys</a>
<li><a accesskey="7" href="#Aggregate-Base-Operations">Aggregate Base Operations</a>
<li><a accesskey="8" href="#Base-ISAM-Operations">Base ISAM Operations</a>
</ul>

<div class="node">
<a name="The-Base"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Base-Tables">Base Tables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Base-Table">Base Table</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.1 The Base</h5>

<p>All of these functions are accessed through a single procedure by
calling that procedure with the symbol name of the operation.  A
procedure will be returned if that operation is supported and <code>#f</code>
otherwise.  For example:

<pre class="example">     (require 'alist-table)
     <a name="index-alist_002dtable-1126"></a><a name="index-alist_002dtable-1127"></a>(define my-base (alist-table 'make-base))
     my-base         &rArr; *a procedure*
     (define foo (alist-table 'foo))
     foo             &rArr; #f
</pre>
  <div class="defun">
&mdash; Operation on base-table: <b>make-base</b><var> filename key-dimension column-types<a name="index-make_002dbase-on-base_002dtable-1128"></a></var><br>
<blockquote><p>Returns a new, open, low-level database (collection of tables)
associated with <var>filename</var>.  This returned database has an empty
table associated with <var>catalog-id</var>.  The positive integer
<var>key-dimension</var> is the number of keys composed to make a
<var>primary-key</var> for the catalog table.  The list of symbols
<var>column-types</var> describes the types of each column for that table. 
If the database cannot be created as specified, <code>#f</code> is returned.

       <p>Calling the <code>close-base</code> method on this database and possibly other
operations will cause <var>filename</var> to be written to.  If
<var>filename</var> is <code>#f</code> a temporary, non-disk based database will be
created if such can be supported by the base table implelentation. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>open-base</b><var> filename mutable<a name="index-open_002dbase-on-base_002dtable-1129"></a></var><br>
<blockquote><p>Returns an open low-level database associated with <var>filename</var>.  If
<var>mutable</var> is <code>#t</code>, this database will have methods capable of
effecting change to the database.  If <var>mutable</var> is <code>#f</code>, only
methods for inquiring the database will be available.  If the database
cannot be opened as specified <code>#f</code> is returned.

       <p>Calling the <code>close-base</code> (and possibly other) method on a
<var>mutable</var> database will cause <var>filename</var> to be written to. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>write-base</b><var> lldb filename<a name="index-write_002dbase-on-base_002dtable-1130"></a></var><br>
<blockquote><p>Causes the low-level database <var>lldb</var> to be written to
<var>filename</var>.  If the write is successful, also causes <var>lldb</var> to
henceforth be associated with <var>filename</var>.  Calling the
<code>close-database</code> (and possibly other) method on <var>lldb</var> may
cause <var>filename</var> to be written to.  If <var>filename</var> is <code>#f</code>
this database will be changed to a temporary, non-disk based database if
such can be supported by the underlying base table implelentation.  If
the operations completed successfully, <code>#t</code> is returned. 
Otherwise, <code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>sync-base</b><var> lldb<a name="index-sync_002dbase-on-base_002dtable-1131"></a></var><br>
<blockquote><p>Causes the file associated with the low-level database <var>lldb</var> to be
updated to reflect its current state.  If the associated filename is
<code>#f</code>, no action is taken and <code>#f</code> is returned.  If this
operation completes successfully, <code>#t</code> is returned.  Otherwise,
<code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>close-base</b><var> lldb<a name="index-close_002dbase-on-base_002dtable-1132"></a></var><br>
<blockquote><p>Causes the low-level database <var>lldb</var> to be written to its associated
file (if any).  If the write is successful, subsequent operations to
<var>lldb</var> will signal an error.  If the operations complete
successfully, <code>#t</code> is returned.  Otherwise, <code>#f</code> is returned. 
</p></blockquote></div>

<div class="node">
<a name="Base-Tables"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Base-Field-Types">Base Field Types</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-Base">The Base</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.2 Base Tables</h5>

<div class="defun">
&mdash; Operation on base-table: <b>make-table</b><var> lldb key-dimension column-types<a name="index-make_002dtable-on-base_002dtable-1133"></a></var><br>
<blockquote><p>Returns the ordinal <var>base-id</var> for a new base table, otherwise
returns <code>#f</code>.  The base table can then be opened using
<code>(open-table </code><var>lldb</var> <var>base-id</var><code>)</code>.  The positive integer
<var>key-dimension</var> is the number of keys composed to make a
<var>primary-key</var> for this table.  The list of symbols
<var>column-types</var> describes the types of each column. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>open-table</b><var> lldb base-id key-dimension column-types<a name="index-open_002dtable-on-base_002dtable-1134"></a></var><br>
<blockquote><p>Returns a <var>handle</var> for an existing base table in the low-level
database <var>lldb</var> if that table exists and can be opened in the mode
indicated by <var>mutable</var>, otherwise returns <code>#f</code>.

       <p>As with <code>make-table</code>, the positive integer <var>key-dimension</var> is
the number of keys composed to make a <var>primary-key</var> for this table. 
The list of symbols <var>column-types</var> describes the types of each
column. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>kill-table</b><var> lldb base-id key-dimension column-types<a name="index-kill_002dtable-on-base_002dtable-1135"></a></var><br>
<blockquote><p>Returns <code>#t</code> if the base table associated with <var>base-id</var> was
removed from the low level database <var>lldb</var>, and <code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>catalog-id</b><var><a name="index-catalog_002did-on-base_002dtable-1136"></a></var><br>
<blockquote><p>A constant <var>base-id</var> ordinal suitable for passing as a parameter to
<code>open-table</code>.  <var>catalog-id</var> will be used as the base table for
the system catalog. 
</p></blockquote></div>

<div class="node">
<a name="Base-Field-Types"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Composite-Keys">Composite Keys</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Base-Tables">Base Tables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.3 Base Field Types</h5>

<div class="defun">
&mdash; Operation on base-table: <b>supported-type?</b><var> symbol<a name="index-supported_002dtype_003f-on-base_002dtable-1137"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>symbol</var> names a type allowed as a column
value by the implementation, and <code>#f</code> otherwise.  At a minimum,
an implementation must support the types <code>integer</code>,
<code>ordinal</code>, <code>symbol</code>, <code>string</code>, and <code>boolean</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>supported-key-type?</b><var> symbol<a name="index-supported_002dkey_002dtype_003f-on-base_002dtable-1138"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>symbol</var> names a type allowed as a key value
by the implementation, and <code>#f</code> otherwise.  At a minimum, an
implementation must support the types <code>ordinal</code>, and
<code>symbol</code>. 
</p></blockquote></div>

<p class="noindent">An <dfn>ordinal</dfn> is an exact positive integer.  The other types are
standard Scheme.

<div class="node">
<a name="Composite-Keys"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Base-Record-Operations">Base Record Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Base-Field-Types">Base Field Types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.4 Composite Keys</h5>

<div class="defun">
&mdash; Operation on base-table: <b>make-keyifier-1</b><var> type<a name="index-make_002dkeyifier_002d1-on-base_002dtable-1139"></a></var><br>
<blockquote><p>Returns a procedure which accepts a single argument which must be of
type <var>type</var>.  This returned procedure returns an object suitable for
being a <var>key</var> argument in the functions whose descriptions follow.

       <p>Any 2 arguments of the supported type passed to the returned function
which are not <code>equal?</code> must result in returned values which are not
<code>equal?</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>make-list-keyifier</b><var> key-dimension types<a name="index-make_002dlist_002dkeyifier-on-base_002dtable-1140"></a></var><br>
<blockquote><p>The list of symbols <var>types</var> must have at least <var>key-dimension</var>
elements.  Returns a procedure which accepts a list of length
<var>key-dimension</var> and whose types must corresopond to the types named
by <var>types</var>.  This returned procedure combines the elements of its
list argument into an object suitable for being a <var>key</var> argument in
the functions whose descriptions follow.

       <p>Any 2 lists of supported types (which must at least include symbols and
non-negative integers) passed to the returned function which are not
<code>equal?</code> must result in returned values which are not
<code>equal?</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>make-key-extractor</b><var> key-dimension types column-number<a name="index-make_002dkey_002dextractor-on-base_002dtable-1141"></a></var><br>
<blockquote><p>Returns a procedure which accepts objects produced by application of the
result of <code>(make-list-keyifier </code><var>key-dimension</var> <var>types</var><code>)</code>. 
This procedure returns a <var>key</var> which is <code>equal?</code> to the
<var>column-number</var>th element of the list which was passed to create
<var>composite-key</var>.  The list <var>types</var> must have at least
<var>key-dimension</var> elements. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>make-key-&gt;list</b><var> key-dimension types<a name="index-make_002dkey_002d_003elist-on-base_002dtable-1142"></a></var><br>
<blockquote><p>Returns a procedure which accepts objects produced by application of
the result of <code>(make-list-keyifier </code><var>key-dimension</var>
<var>types</var><code>)</code>.  This procedure returns a list of <var>key</var>s which are
elementwise <code>equal?</code> to the list which was passed to create
<var>composite-key</var>. 
</p></blockquote></div>

<div class="node">
<a name="Base-Record-Operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Match-Keys">Match Keys</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Composite-Keys">Composite Keys</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.5 Base Record Operations</h5>

<p class="noindent">In the following functions, the <var>key</var> argument can always be assumed
to be the value returned by a call to a <em>keyify</em> routine.

<div class="defun">
&mdash; Operation on base-table: <b>present?</b><var> handle key<a name="index-present_003f-on-base_002dtable-1143"></a></var><br>
<blockquote><p>Returns a non-<code>#f</code> value if there is a row associated with
<var>key</var> in the table opened in <var>handle</var> and <code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>make-getter</b><var> key-dimension types<a name="index-make_002dgetter-on-base_002dtable-1144"></a></var><br>
<blockquote><p>Returns a procedure which takes arguments <var>handle</var> and <var>key</var>. 
This procedure returns a list of the non-primary values of the relation
(in the base table opened in <var>handle</var>) whose primary key is
<var>key</var> if it exists, and <code>#f</code> otherwise. 
</p></blockquote></div>

<p class="noindent"><code>make-getter-1</code> is a new operation.  The relational-database
module works with older base-table implementations by using
<code>make-getter</code>.

<div class="defun">
&mdash; Operation on base-table: <b>make-getter-1</b><var> key-dimension types index<a name="index-make_002dgetter_002d1-on-base_002dtable-1145"></a></var><br>
<blockquote><p>Returns a procedure which takes arguments <var>handle</var> and <var>key</var>. 
This procedure returns the value of the <var>index</var>th field (in the
base table opened in <var>handle</var>) whose primary key is <var>key</var> if
it exists, and <code>#f</code> otherwise.

       <p><var>index</var> must be larger than <var>key-dimension</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>make-putter</b><var> key-dimension types<a name="index-make_002dputter-on-base_002dtable-1146"></a></var><br>
<blockquote><p>Returns a procedure which takes arguments <var>handle</var> and <var>key</var> and
<var>value-list</var>.  This procedure associates the primary key <var>key</var>
with the values in <var>value-list</var> (in the base table opened in
<var>handle</var>) and returns an unspecified value. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>delete</b><var> handle key<a name="index-delete-on-base_002dtable-1147"></a></var><br>
<blockquote><p>Removes the row associated with <var>key</var> from the table opened in
<var>handle</var>.  An unspecified value is returned. 
</p></blockquote></div>

<div class="node">
<a name="Match-Keys"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Aggregate-Base-Operations">Aggregate Base Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Base-Record-Operations">Base Record Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.6 Match Keys</h5>

<p class="noindent"><a name="index-match_002dkeys-1148"></a><a name="index-match-1149"></a><a name="index-wild_002dcard-1150"></a>A <var>match-keys</var> argument is a list of length equal to
the number of primary keys.  The <var>match-keys</var> restrict the actions
of the table command to those records whose primary keys all satisfy the
corresponding element of the <var>match-keys</var> list.  The elements and
their actions are:

  <blockquote>
     <dl>
<dt><code>#f</code><dd>The false value matches any key in the corresponding position. 
<br><dt>an object of type procedure<dd>This procedure must take a single argument, the key in the corresponding
position.  Any key for which the procedure returns a non-false value is
a match; Any key for which the procedure returns a <code>#f</code> is not. 
<br><dt>other values<dd>Any other value matches only those keys <code>equal?</code> to it. 
</dl>
</blockquote>

<div class="node">
<a name="Aggregate-Base-Operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Base-ISAM-Operations">Base ISAM Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Match-Keys">Match Keys</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.7 Aggregate Base Operations</h5>

<p class="noindent">The <var>key-dimension</var> and <var>column-types</var> arguments are needed to
decode the composite-keys for matching with <var>match-keys</var>.

<div class="defun">
&mdash; Operation on base-table: <b>delete*</b><var> handle key-dimension column-types match-keys<a name="index-delete_002a-on-base_002dtable-1151"></a></var><br>
<blockquote><p>Removes all rows which satisfy <var>match-keys</var> from the table opened in
<var>handle</var>.  An unspecified value is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>for-each-key</b><var> handle procedure key-dimension column-types match-keys<a name="index-for_002deach_002dkey-on-base_002dtable-1152"></a></var><br>
<blockquote><p>Calls <var>procedure</var> once with each <var>key</var> in the table opened in
<var>handle</var> which satisfy <var>match-keys</var> in an unspecified order. 
An unspecified value is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>map-key</b><var> handle procedure key-dimension column-types match-keys<a name="index-map_002dkey-on-base_002dtable-1153"></a></var><br>
<blockquote><p>Returns a list of the values returned by calling <var>procedure</var> once
with each <var>key</var> in the table opened in <var>handle</var> which satisfy
<var>match-keys</var> in an unspecified order. 
</p></blockquote></div>

<div class="node">
<a name="Base-ISAM-Operations"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Aggregate-Base-Operations">Aggregate Base Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Base-Table">Base Table</a>

</div>

<h5 class="subsubsection">6.2.1.8 Base ISAM Operations</h5>

<p class="noindent">These operations are optional for a Base-Table implementation.

<div class="defun">
&mdash; Operation on base-table: <b>ordered-for-each-key</b><var> handle procedure key-dimension column-types match-keys<a name="index-ordered_002dfor_002deach_002dkey-on-base_002dtable-1154"></a></var><br>
<blockquote><p>Calls <var>procedure</var> once with each <var>key</var> in the table opened in
<var>handle</var> which satisfy <var>match-keys</var> in the natural order for
the types of the primary key fields of that table.  An unspecified value
is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>make-nexter</b><var> handle key-dimension column-types index<a name="index-make_002dnexter-on-base_002dtable-1155"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
returns the key-list identifying the lowest record higher than
<var>key1</var> <var>key2</var> <small class="dots">...</small> which is stored in the base-table and
which differs in column <var>index</var> or a lower indexed key; or false
if no higher record is present. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on base-table: <b>make-prever</b><var> handle key-dimension column-types index<a name="index-make_002dprever-on-base_002dtable-1156"></a></var><br>
<blockquote><p>Returns a procedure of arguments <var>key1</var> <var>key2</var> <small class="dots">...</small> which
returns the key-list identifying the highest record less than
<var>key1</var> <var>key2</var> <small class="dots">...</small> which is stored in the base-table and
which differs in column <var>index</var> or a lower indexed key; or false
if no higher record is present. 
</p></blockquote></div>

<div class="node">
<a name="Catalog-Representation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Relational-Database-Objects">Relational Database Objects</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Base-Table">Base Table</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Infrastructure">Relational Infrastructure</a>

</div>

<h4 class="subsection">6.2.2 Catalog Representation</h4>

<p class="noindent">Each database (in an implementation) has a <dfn>system catalog</dfn> which
describes all the user accessible tables in that database (including
itself).

<p class="noindent">The system catalog base table has the following fields.  <code>PRI</code>
indicates a primary key for that table.

<pre class="example">     PRI table-name
         column-limit            the highest column number
         coltab-name             descriptor table name
         bastab-id               data base table identifier
         user-integrity-rule
         view-procedure          A scheme thunk which, when called,
                                 produces a handle for the view.  coltab
                                 and bastab are specified if and only if
                                 view-procedure is not.
</pre>
  <p class="noindent">Descriptors for base tables (not views) are tables (pointed to by
system catalog).  Descriptor (base) tables have the fields:

<pre class="example">     PRI column-number           sequential integers from 1
         primary-key?            boolean TRUE for primary key components
         column-name
         column-integrity-rule
         domain-name
</pre>
  <p class="noindent">A <dfn>primary key</dfn> is any column marked as <code>primary-key?</code> in the
corresponding descriptor table.  All the <code>primary-key?</code> columns
must have lower column numbers than any non-<code>primary-key?</code> columns. 
Every table must have at least one primary key.  Primary keys must be
sufficient to distinguish all rows from each other in the table.  All of
the system defined tables have a single primary key.

<p class="noindent">A <dfn>domain</dfn> is a category describing the allowable values to occur in
a column.  It is described by a (base) table with the fields:

<pre class="example">     PRI domain-name
         foreign-table
         domain-integrity-rule
         type-id
         type-param
</pre>
  <p class="noindent">The <dfn>type-id</dfn> field value is a symbol.  This symbol may be used by
the underlying base table implementation in storing that field.

<p class="noindent">If the <code>foreign-table</code> field is non-<code>#f</code> then that field names
a table from the catalog.  The values for that domain must match a
primary key of the table referenced by the <var>type-param</var> (or
<code>#f</code>, if allowed).  This package currently does not support
composite foreign-keys.

<p class="noindent">The types for which support is planned are:
<pre class="example">         atom
         symbol
         string                  [&lt;length&gt;]
         number                  [&lt;base&gt;]
         money                   &lt;currency&gt;
         date-time
         boolean
     
         foreign-key             &lt;table-name&gt;
         expression
         virtual                 &lt;expression&gt;
</pre>
  <div class="node">
<a name="Relational-Database-Objects"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Database-Operations">Database Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Catalog-Representation">Catalog Representation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Infrastructure">Relational Infrastructure</a>

</div>

<h4 class="subsection">6.2.3 Relational Database Objects</h4>

<p class="noindent">This object-oriented interface is deprecated for typical database
applications; <a href="#Using-Databases">Using Databases</a> provides an application programmer
interface which is easier to understand and use.

<div class="defun">
&mdash; Function: <b>make-relational-system</b><var> base-table-implementation<a name="index-make_002drelational_002dsystem-1157"></a></var><br>
<blockquote>
       <p>Returns a procedure implementing a relational database using the
<var>base-table-implementation</var>.

       <p>All of the operations of a base table implementation are accessed
through a procedure defined by <code>require</code>ing that implementation. 
Similarly, all of the operations of the relational database
implementation are accessed through the procedure returned by
<code>make-relational-system</code>.  For instance, a new relational database
could be created from the procedure returned by
<code>make-relational-system</code> by:

     <pre class="example">          (require 'alist-table)
          <a name="index-alist_002dtable-1158"></a>(define relational-alist-system
                  (make-relational-system alist-table))
          (define create-alist-database
                  (relational-alist-system 'create-database))
          (define my-database
                  (create-alist-database "mydata.db"))
</pre>
       </blockquote></div>

<p class="noindent">What follows are the descriptions of the methods available from
relational system returned by a call to <code>make-relational-system</code>.

<div class="defun">
&mdash; Operation on relational-system: <b>create-database</b><var> filename<a name="index-create_002ddatabase-on-relational_002dsystem-1159"></a></var><br>
<blockquote>
       <p>Returns an open, nearly empty relational database associated with
<var>filename</var>.  The only tables defined are the system catalog and
domain table.  Calling the <code>close-database</code> method on this database
and possibly other operations will cause <var>filename</var> to be written
to.  If <var>filename</var> is <code>#f</code> a temporary, non-disk based database
will be created if such can be supported by the underlying base table
implelentation.  If the database cannot be created as specified
<code>#f</code> is returned.  For the fields and layout of descriptor tables,
<a href="#Catalog-Representation">Catalog Representation</a>
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-system: <b>open-database</b><var> filename mutable?<a name="index-open_002ddatabase-on-relational_002dsystem-1160"></a></var><br>
<blockquote>
       <p>Returns an open relational database associated with <var>filename</var>.  If
<var>mutable?</var> is <code>#t</code>, this database will have methods capable of
effecting change to the database.  If <var>mutable?</var> is <code>#f</code>, only
methods for inquiring the database will be available.  Calling the
<code>close-database</code> (and possibly other) method on a <var>mutable?</var>
database will cause <var>filename</var> to be written to.  If the database
cannot be opened as specified <code>#f</code> is returned. 
</p></blockquote></div>

<div class="node">
<a name="Database-Operations"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Relational-Database-Objects">Relational Database Objects</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Relational-Infrastructure">Relational Infrastructure</a>

</div>

<h4 class="subsection">6.2.4 Database Operations</h4>

<p class="noindent">This object-oriented interface is deprecated for typical database
applications; <a href="#Using-Databases">Using Databases</a> provides an application programmer
interface which is easier to understand and use.

<p class="noindent">These are the descriptions of the methods available from an open
relational database.  A method is retrieved from a database by calling
the database with the symbol name of the operation.  For example:

<pre class="example">     (define my-database
             (create-alist-database "mydata.db"))
     (define telephone-table-desc
             ((my-database 'create-table) 'telephone-table-desc))
</pre>
  <div class="defun">
&mdash; Operation on relational-database: <b>close-database</b><var><a name="index-close_002ddatabase-on-relational_002ddatabase-1161"></a></var><br>
<blockquote><p>Causes the relational database to be written to its associated file (if
any).  If the write is successful, subsequent operations to this
database will signal an error.  If the operations completed
successfully, <code>#t</code> is returned.  Otherwise, <code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>write-database</b><var> filename<a name="index-write_002ddatabase-on-relational_002ddatabase-1162"></a></var><br>
<blockquote><p>Causes the relational database to be written to <var>filename</var>.  If the
write is successful, also causes the database to henceforth be
associated with <var>filename</var>.  Calling the <code>close-database</code> (and
possibly other) method on this database will cause <var>filename</var> to be
written to.  If <var>filename</var> is <code>#f</code> this database will be
changed to a temporary, non-disk based database if such can be supported
by the underlying base table implelentation.  If the operations
completed successfully, <code>#t</code> is returned.  Otherwise, <code>#f</code> is
returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>sync-database</b><var><a name="index-sync_002ddatabase-on-relational_002ddatabase-1163"></a></var><br>
<blockquote><p>Causes any pending updates to the database file to be written out.  If
the operations completed successfully, <code>#t</code> is returned. 
Otherwise, <code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>solidify-database</b><var><a name="index-solidify_002ddatabase-on-relational_002ddatabase-1164"></a></var><br>
<blockquote><p>Causes any pending updates to the database file to be written out.  If
the writes completed successfully, then the database is changed to be
immutable and <code>#t</code> is returned.  Otherwise, <code>#f</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>table-exists?</b><var> table-name<a name="index-table_002dexists_003f-on-relational_002ddatabase-1165"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>table-name</var> exists in the system catalog,
otherwise returns <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>open-table</b><var> table-name mutable?<a name="index-open_002dtable-on-relational_002ddatabase-1166"></a></var><br>
<blockquote><p>Returns a <dfn>methods</dfn> procedure for an existing relational table in
this database if it exists and can be opened in the mode indicated by
<var>mutable?</var>, otherwise returns <code>#f</code>. 
</p></blockquote></div>

<p class="noindent">These methods will be present only in mutable databases.

<div class="defun">
&mdash; Operation on relational-database: <b>delete-table</b><var> table-name<a name="index-delete_002dtable-on-relational_002ddatabase-1167"></a></var><br>
<blockquote><p>Removes and returns the <var>table-name</var> row from the system catalog if
the table or view associated with <var>table-name</var> gets removed from the
database, and <code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>create-table</b><var> table-desc-name<a name="index-create_002dtable-on-relational_002ddatabase-1168"></a></var><br>
<blockquote><p>Returns a methods procedure for a new (open) relational table for
describing the columns of a new base table in this database, otherwise
returns <code>#f</code>.  For the fields and layout of descriptor tables,
See <a href="#Catalog-Representation">Catalog Representation</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>create-table</b><var> table-name table-desc-name<a name="index-create_002dtable-on-relational_002ddatabase-1169"></a></var><br>
<blockquote><p>Returns a methods procedure for a new (open) relational table with
columns as described by <var>table-desc-name</var>, otherwise returns
<code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Operation on relational-database: <b>create-view</b><var> ??<a name="index-create_002dview-on-relational_002ddatabase-1170"></a></var><br>
&mdash; Operation on relational-database: <b>project-table</b><var> ??<a name="index-project_002dtable-on-relational_002ddatabase-1171"></a></var><br>
&mdash; Operation on relational-database: <b>restrict-table</b><var> ??<a name="index-restrict_002dtable-on-relational_002ddatabase-1172"></a></var><br>
&mdash; Operation on relational-database: <b>cart-prod-tables</b><var> ??<a name="index-cart_002dprod_002dtables-on-relational_002ddatabase-1173"></a></var><br>
<blockquote><p>Not yet implemented. 
</p></blockquote></div>

<div class="node">
<a name="Weight-Balanced-Trees"></a>
<a name="Weight_002dBalanced-Trees"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Relational-Infrastructure">Relational Infrastructure</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Database-Packages">Database Packages</a>

</div>

<h3 class="section">6.3 Weight-Balanced Trees</h3>

<p><code>(require 'wt-tree)</code>
<a name="index-wt_002dtree-1174"></a>
<a name="index-trees_002c-balanced-binary-1175"></a><a name="index-balanced-binary-trees-1176"></a><a name="index-binary-trees-1177"></a><a name="index-weight_002dbalanced-binary-trees-1178"></a>Balanced binary trees are a useful data structure for maintaining large
sets of ordered objects or sets of associations whose keys are ordered. 
MIT Scheme has an comprehensive implementation of weight-balanced binary
trees which has several advantages over the other data structures for
large aggregates:

     <ul>
<li>In addition to the usual element-level operations like insertion,
deletion and lookup, there is a full complement of collection-level
operations, like set intersection, set union and subset test, all of
which are implemented with good orders of growth in time and space. 
This makes weight balanced trees ideal for rapid prototyping of
functionally derived specifications.

     <li>An element in a tree may be indexed by its position under the ordering
of the keys, and the ordinal position of an element may be determined,
both with reasonable efficiency.

     <li>Operations to find and remove minimum element make weight balanced trees
simple to use for priority queues.

     <li>The implementation is <em>functional</em> rather than <em>imperative</em>. 
This means that operations like `inserting' an association in a tree do
not destroy the old tree, in much the same way that <code>(+ 1 x)</code>
modifies neither the constant 1 nor the value bound to <code>x</code>.  The
trees are referentially transparent thus the programmer need not worry
about copying the trees.  Referential transparency allows space
efficiency to be achieved by sharing subtrees.

  </ul>

  <p>These features make weight-balanced trees suitable for a wide range of
applications, especially those that
require large numbers of sets or discrete maps.  Applications that have
a few global databases and/or concentrate on element-level operations like
insertion and lookup are probably better off using hash-tables or
red-black trees.

  <p>The <em>size</em> of a tree is the number of associations that it
contains.  Weight balanced binary trees are balanced to keep the sizes
of the subtrees of each node within a constant factor of each other. 
This ensures logarithmic times for single-path operations (like lookup
and insertion).  A weight balanced tree takes space that is proportional
to the number of associations in the tree.  For the current
implementation, the constant of proportionality is six words per
association.

  <p><a name="index-binary-trees_002c-as-sets-1179"></a><a name="index-binary-trees_002c-as-discrete-maps-1180"></a><a name="index-sets_002c-using-binary-trees-1181"></a><a name="index-discrete-maps_002c-using-binary-trees-1182"></a>Weight balanced trees can be used as an implementation for either
discrete sets or discrete maps (associations).  Sets are implemented by
ignoring the datum that is associated with the key.  Under this scheme
if an associations exists in the tree this indicates that the key of the
association is a member of the set.  Typically a value such as
<code>()</code>, <code>#t</code> or <code>#f</code> is associated with the key.

  <p>Many operations can be viewed as computing a result that, depending on
whether the tree arguments are thought of as sets or maps, is known by
two different names.  An example is <code>wt-tree/member?</code>, which, when
regarding the tree argument as a set, computes the set membership
operation, but, when regarding the tree as a discrete map,
<code>wt-tree/member?</code> is the predicate testing if the map is defined at
an element in its domain.  Most names in this package have been chosen
based on interpreting the trees as sets, hence the name
<code>wt-tree/member?</code> rather than <code>wt-tree/defined-at?</code>.

  <p><a name="index-run_002dtime_002dloadable-option-1183"></a><a name="index-option_002c-run_002dtime_002dloadable-1184"></a>The weight balanced tree implementation is a run-time-loadable option. 
To use weight balanced trees, execute

<pre class="example">     (load-option 'wt-tree)
</pre>
  <p><a name="index-load_002doption-1185"></a>
once before calling any of the procedures defined here.

<ul class="menu">
<li><a accesskey="1" href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a>
<li><a accesskey="2" href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a>
<li><a accesskey="3" href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a>
<li><a accesskey="4" href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a>
</ul>

<div class="node">
<a name="Construction-of-Weight-Balanced-Trees"></a>
<a name="Construction-of-Weight_002dBalanced-Trees"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a>

</div>

<h4 class="subsection">6.3.1 Construction of Weight-Balanced Trees</h4>

<p>Binary trees require there to be a total order on the keys used to
arrange the elements in the tree.  Weight balanced trees are organized
by <em>types</em>, where the type is an object encapsulating the ordering
relation.  Creating a tree is a two-stage process.  First a tree type
must be created from the predicate which gives the ordering.  The tree
type is then used for making trees, either empty or singleton trees or
trees from other aggregate structures like association lists.  Once
created, a tree `knows' its type and the type is used to test
compatibility between trees in operations taking two trees.  Usually a
small number of tree types are created at the beginning of a program and
used many times throughout the program's execution.

<div class="defun">
&mdash; procedure+: <b>make-wt-tree-type</b><var> key&lt;?<a name="index-make_002dwt_002dtree_002dtype-1186"></a></var><br>
<blockquote><p>This procedure creates and returns a new tree type based on the ordering
predicate <var>key&lt;?</var>. 
<var>Key&lt;?</var> must be a total ordering, having the property that for all
key values <code>a</code>, <code>b</code> and <code>c</code>:

     <pre class="example">          (key&lt;? a a)                         &rArr; #f
          (and (key&lt;? a b) (key&lt;? b a))       &rArr; #f
          (if (and (key&lt;? a b) (key&lt;? b c))
              (key&lt;? a c)
              #t)                             &rArr; #t
</pre>
       <p class="noindent">Two key values are assumed to be equal if neither is less than the other
by <var>key&lt;?</var>.

       <p>Each call to <code>make-wt-tree-type</code> returns a distinct value, and
trees are only compatible if their tree types are <code>eq?</code>.  A
consequence is that trees that are intended to be used in binary tree
operations must all be created with a tree type originating from the
same call to <code>make-wt-tree-type</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; variable+: <b>number-wt-type</b><var><a name="index-number_002dwt_002dtype-1187"></a></var><br>
<blockquote><p>A standard tree type for trees with numeric keys.  <code>Number-wt-type</code>
could have been defined by

     <pre class="example">          (define number-wt-type (make-wt-tree-type  &lt;))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; variable+: <b>string-wt-type</b><var><a name="index-string_002dwt_002dtype-1188"></a></var><br>
<blockquote><p>A standard tree type for trees with string keys.  <code>String-wt-type</code>
could have been defined by

     <pre class="example">          (define string-wt-type (make-wt-tree-type  string&lt;?))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; procedure+: <b>make-wt-tree</b><var> wt-tree-type<a name="index-make_002dwt_002dtree-1189"></a></var><br>
<blockquote><p>This procedure creates and returns a newly allocated weight balanced
tree.  The tree is empty, i.e. it contains no associations. 
<var>Wt-tree-type</var> is a weight balanced tree type obtained by calling
<code>make-wt-tree-type</code>; the returned tree has this type. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>singleton-wt-tree</b><var> wt-tree-type key datum<a name="index-singleton_002dwt_002dtree-1190"></a></var><br>
<blockquote><p>This procedure creates and returns a newly allocated weight balanced
tree.  The tree contains a single association, that of <var>datum</var> with
<var>key</var>.  <var>Wt-tree-type</var> is a weight balanced tree type obtained
by calling <code>make-wt-tree-type</code>; the returned tree has this type. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>alist-&gt;wt-tree</b><var> tree-type alist<a name="index-alist_002d_003ewt_002dtree-1191"></a></var><br>
<blockquote><p>Returns a newly allocated weight-balanced tree that contains the same
associations as <var>alist</var>.  This procedure is equivalent to:

     <pre class="example">          (lambda (type alist)
            (let ((tree (make-wt-tree type)))
              (for-each (lambda (association)
                          (wt-tree/add! tree
                                        (car association)
                                        (cdr association)))
                        alist)
              tree))
</pre>
       </blockquote></div>

<div class="node">
<a name="Basic-Operations-on-Weight-Balanced-Trees"></a>
<a name="Basic-Operations-on-Weight_002dBalanced-Trees"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a>

</div>

<h4 class="subsection">6.3.2 Basic Operations on Weight-Balanced Trees</h4>

<p>This section describes the basic tree operations on weight balanced
trees.  These operations are the usual tree operations for insertion,
deletion and lookup, some predicates and a procedure for determining the
number of associations in a tree.

<!-- @deffn {procedure+} wt-tree? object -->
<!-- Returns @code{#t} if @var{object} is a weight-balanced tree, otherwise -->
<!-- returns @code{#f}. -->
<!-- @end deffn -->
<div class="defun">
&mdash; procedure+: <b>wt-tree/empty?</b><var> wt-tree<a name="index-wt_002dtree_002fempty_003f-1192"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>wt-tree</var> contains no associations, otherwise
returns <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/size</b><var> wt-tree<a name="index-wt_002dtree_002fsize-1193"></a></var><br>
<blockquote><p>Returns the number of associations in <var>wt-tree</var>, an exact
non-negative integer.  This operation takes constant time. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/add</b><var> wt-tree key datum<a name="index-wt_002dtree_002fadd-1194"></a></var><br>
<blockquote><p>Returns a new tree containing all the associations in <var>wt-tree</var> and
the association of <var>datum</var> with <var>key</var>.  If <var>wt-tree</var> already
had an association for <var>key</var>, the new association overrides the old. 
The average and worst-case times required by this operation are
proportional to the logarithm of the number of associations in
<var>wt-tree</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/add!</b><var> wt-tree key datum<a name="index-wt_002dtree_002fadd_0021-1195"></a></var><br>
<blockquote><p>Associates <var>datum</var> with <var>key</var> in <var>wt-tree</var> and returns an
unspecified value.  If <var>wt-tree</var> already has an association for
<var>key</var>, that association is replaced.  The average and worst-case
times required by this operation are proportional to the logarithm of
the number of associations in <var>wt-tree</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/member?</b><var> key wt-tree<a name="index-wt_002dtree_002fmember_003f-1196"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>wt-tree</var> contains an association for
<var>key</var>, otherwise returns <code>#f</code>.  The average and worst-case
times required by this operation are proportional to the logarithm of
the number of associations in <var>wt-tree</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/lookup</b><var> wt-tree key default<a name="index-wt_002dtree_002flookup-1197"></a></var><br>
<blockquote><p>Returns the datum associated with <var>key</var> in <var>wt-tree</var>.  If
<var>wt-tree</var> doesn't contain an association for <var>key</var>,
<var>default</var> is returned.  The average and worst-case times required by
this operation are proportional to the logarithm of the number of
associations in <var>wt-tree</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/delete</b><var> wt-tree key<a name="index-wt_002dtree_002fdelete-1198"></a></var><br>
<blockquote><p>Returns a new tree containing all the associations in <var>wt-tree</var>,
except that if <var>wt-tree</var> contains an association for <var>key</var>, it
is removed from the result.  The average and worst-case times required
by this operation are proportional to the logarithm of the number of
associations in <var>wt-tree</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/delete!</b><var> wt-tree key<a name="index-wt_002dtree_002fdelete_0021-1199"></a></var><br>
<blockquote><p>If <var>wt-tree</var> contains an association for <var>key</var> the association
is removed.  Returns an unspecified value.  The average and worst-case
times required by this operation are proportional to the logarithm of
the number of associations in <var>wt-tree</var>. 
</p></blockquote></div>

<div class="node">
<a name="Advanced-Operations-on-Weight-Balanced-Trees"></a>
<a name="Advanced-Operations-on-Weight_002dBalanced-Trees"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a>

</div>

<h4 class="subsection">6.3.3 Advanced Operations on Weight-Balanced Trees</h4>

<p>In the following the <em>size</em> of a tree is the number of associations
that the tree contains, and a <em>smaller</em> tree contains fewer
associations.

<div class="defun">
&mdash; procedure+: <b>wt-tree/split&lt;</b><var> wt-tree bound<a name="index-wt_002dtree_002fsplit_003c-1200"></a></var><br>
<blockquote><p>Returns a new tree containing all and only the associations in
<var>wt-tree</var> which have a key that is less than <var>bound</var> in the
ordering relation of the tree type of <var>wt-tree</var>.  The average and
worst-case times required by this operation are proportional to the
logarithm of the size of <var>wt-tree</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/split&gt;</b><var> wt-tree bound<a name="index-wt_002dtree_002fsplit_003e-1201"></a></var><br>
<blockquote><p>Returns a new tree containing all and only the associations in
<var>wt-tree</var> which have a key that is greater than <var>bound</var> in the
ordering relation of the tree type of <var>wt-tree</var>.  The average and
worst-case times required by this operation are proportional to the
logarithm of size of <var>wt-tree</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/union</b><var> wt-tree-1 wt-tree-2<a name="index-wt_002dtree_002funion-1202"></a></var><br>
<blockquote><p>Returns a new tree containing all the associations from both trees. 
This operation is asymmetric: when both trees have an association for
the same key, the returned tree associates the datum from <var>wt-tree-2</var>
with the key.  Thus if the trees are viewed as discrete maps then
<code>wt-tree/union</code> computes the map override of <var>wt-tree-1</var> by
<var>wt-tree-2</var>.  If the trees are viewed as sets the result is the set
union of the arguments. 
The worst-case time required by this operation
is proportional to the sum of the sizes of both trees. 
If the minimum key of one tree is greater than the maximum key of
the other tree then the time required is at worst proportional to
the logarithm of the size of the larger tree. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/intersection</b><var> wt-tree-1 wt-tree-2<a name="index-wt_002dtree_002fintersection-1203"></a></var><br>
<blockquote><p>Returns a new tree containing all and only those associations from
<var>wt-tree-1</var> which have keys appearing as the key of an association
in <var>wt-tree-2</var>.  Thus the associated data in the result are those
from <var>wt-tree-1</var>.  If the trees are being used as sets the result is
the set intersection of the arguments.  As a discrete map operation,
<code>wt-tree/intersection</code> computes the domain restriction of
<var>wt-tree-1</var> to (the domain of) <var>wt-tree-2</var>. 
The time required by this operation is never worse that proportional to
the sum of the sizes of the trees. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/difference</b><var> wt-tree-1 wt-tree-2<a name="index-wt_002dtree_002fdifference-1204"></a></var><br>
<blockquote><p>Returns a new tree containing all and only those associations from
<var>wt-tree-1</var> which have keys that <em>do not</em> appear as the key of
an association in <var>wt-tree-2</var>.  If the trees are viewed as sets the
result is the asymmetric set difference of the arguments.  As a discrete
map operation, it computes the domain restriction of <var>wt-tree-1</var> to
the complement of (the domain of) <var>wt-tree-2</var>. 
The time required by this operation is never worse that proportional to
the sum of the sizes of the trees. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/subset?</b><var> wt-tree-1 wt-tree-2<a name="index-wt_002dtree_002fsubset_003f-1205"></a></var><br>
<blockquote><p>Returns <code>#t</code> iff the key of each association in <var>wt-tree-1</var> is
the key of some association in <var>wt-tree-2</var>, otherwise returns <code>#f</code>. 
Viewed as a set operation, <code>wt-tree/subset?</code> is the improper subset
predicate. 
A proper subset predicate can be constructed:

     <pre class="example">          (define (proper-subset? s1 s2)
            (and (wt-tree/subset? s1 s2)
                 (&lt; (wt-tree/size s1) (wt-tree/size s2))))
</pre>
       <p>As a discrete map operation, <code>wt-tree/subset?</code> is the subset
test on the domain(s) of the map(s).  In the worst-case the time
required by this operation is proportional to the size of
<var>wt-tree-1</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/set-equal?</b><var> wt-tree-1 wt-tree-2<a name="index-wt_002dtree_002fset_002dequal_003f-1206"></a></var><br>
<blockquote><p>Returns <code>#t</code> iff for every association in <var>wt-tree-1</var> there is
an association in <var>wt-tree-2</var> that has the same key, and <em>vice
versa</em>.

       <p>Viewing the arguments as sets <code>wt-tree/set-equal?</code> is the set
equality predicate.  As a map operation it determines if two maps are
defined on the same domain.

       <p>This procedure is equivalent to

     <pre class="example">          (lambda (wt-tree-1 wt-tree-2)
            (and (wt-tree/subset? wt-tree-1 wt-tree-2
                 (wt-tree/subset? wt-tree-2 wt-tree-1)))
</pre>
       <p>In the worst-case the time required by this operation is proportional to
the size of the smaller tree. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/fold</b><var> combiner initial wt-tree<a name="index-wt_002dtree_002ffold-1207"></a></var><br>
<blockquote><p>This procedure reduces <var>wt-tree</var> by combining all the associations,
using an reverse in-order traversal, so the associations are visited in
reverse order.  <var>Combiner</var> is a procedure of three arguments: a key,
a datum and the accumulated result so far.  Provided <var>combiner</var>
takes time bounded by a constant, <code>wt-tree/fold</code> takes time
proportional to the size of <var>wt-tree</var>.

       <p>A sorted association list can be derived simply:

     <pre class="example">          (wt-tree/fold  (lambda (key datum list)
                           (cons (cons key datum) list))
                         '()
                         <var>wt-tree</var>))
</pre>
       <p>The data in the associations can be summed like this:

     <pre class="example">          (wt-tree/fold  (lambda (key datum sum) (+ sum datum))
                         0
                         <var>wt-tree</var>)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/for-each</b><var> action wt-tree<a name="index-wt_002dtree_002ffor_002deach-1208"></a></var><br>
<blockquote><p>This procedure traverses the tree in-order, applying <var>action</var> to
each association. 
The associations are processed in increasing order of their keys. 
<var>Action</var> is a procedure of two arguments which take the key and
datum respectively of the association. 
Provided <var>action</var> takes time bounded by a constant,
<code>wt-tree/for-each</code> takes time proportional to in the size of
<var>wt-tree</var>. 
The example prints the tree:

     <pre class="example">          (wt-tree/for-each (lambda (key value)
                              (display (list key value)))
                            <var>wt-tree</var>))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/union-merge</b><var> wt-tree-1 wt-tree-2 merge<a name="index-wt_002dtree_002funion_002dmerge-1209"></a></var><br>
<blockquote><p>Returns a new tree containing all the associations from both trees.  If
both trees have an association for the same key, the datum associated
with that key in the result tree is computed by applying the procedure
<var>merge</var> to the key, the value from <var>wt-tree-1</var> and the value
from <var>wt-tree-2</var>.  <var>Merge</var> is of the form

     <pre class="example">          (lambda (<var>key</var> <var>datum-1</var> <var>datum-2</var>) ...)
</pre>
       <p>If some key occurs only in one tree, that association will appear in the
result tree without being processed by <var>merge</var>, so for this
operation to make sense, either <var>merge</var> must have both a right and
left identity that correspond to the association being absent in one of
the trees, or some guarantee must be made, for example, all the keys in
one tree are known to occur in the other.

       <p>These are all reasonable procedures for <var>merge</var>

     <pre class="example">          (lambda (key val1 val2) (+ val1 val2))
          (lambda (key val1 val2) (append val1 val2))
          (lambda (key val1 val2) (wt-tree/union val1 val2))
</pre>
       <p>However, a procedure like

     <pre class="example">          (lambda (key val1 val2) (- val1 val2))
</pre>
       <p>would result in a subtraction of the data for all associations with keys
occuring in both trees but associations with keys occuring in only the
second tree would be copied, not negated, as is presumably be intent. 
The programmer might ensure that this never happens.

       <p>This procedure has the same time behavior as <code>wt-tree/union</code> but
with a slightly worse constant factor.  Indeed, <code>wt-tree/union</code>
might have been defined like this:

     <pre class="example">          (define (wt-tree/union tree1 tree2)
            (wt-tree/union-merge tree1 tree2
                                 (lambda (key val1 val2) val2)))
</pre>
       </blockquote></div>

  <p>The <var>merge</var> procedure takes the <var>key</var> as a parameter in case the
data are not independent of the key.

<div class="node">
<a name="Indexing-Operations-on-Weight-Balanced-Trees"></a>
<a name="Indexing-Operations-on-Weight_002dBalanced-Trees"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a>

</div>

<h4 class="subsection">6.3.4 Indexing Operations on Weight-Balanced Trees</h4>

<p>Weight balanced trees support operations that view the tree as sorted
sequence of associations.  Elements of the sequence can be accessed by
position, and the position of an element in the sequence can be
determined, both in logarthmic time.

<div class="defun">
&mdash; procedure+: <b>wt-tree/index</b><var> wt-tree index<a name="index-wt_002dtree_002findex-1210"></a></var><br>
&mdash; procedure+: <b>wt-tree/index-datum</b><var> wt-tree index<a name="index-wt_002dtree_002findex_002ddatum-1211"></a></var><br>
&mdash; procedure+: <b>wt-tree/index-pair</b><var> wt-tree index<a name="index-wt_002dtree_002findex_002dpair-1212"></a></var><br>
<blockquote><p>Returns the 0-based <var>index</var>th association of <var>wt-tree</var> in the
sorted sequence under the tree's ordering relation on the keys. 
<code>wt-tree/index</code> returns the <var>index</var>th key,
<code>wt-tree/index-datum</code> returns the datum associated with the
<var>index</var>th key and <code>wt-tree/index-pair</code> returns a new pair
<code>(</code><var>key</var><code> . </code><var>datum</var><code>)</code> which is the <code>cons</code> of the
<var>index</var>th key and its datum.  The average and worst-case times
required by this operation are proportional to the logarithm of the
number of associations in the tree.

       <p>These operations signal an error if the tree is empty, if
<var>index</var><code>&lt;0</code>, or if <var>index</var> is greater than or equal to the
number of associations in the tree.

       <p>Indexing can be used to find the median and maximum keys in the tree as
follows:
</p></blockquote></div>

<pre class="example">     median:  (wt-tree/index <var>wt-tree</var> (quotient (wt-tree/size <var>wt-tree</var>) 2))
     
     maximum: (wt-tree/index <var>wt-tree</var> (-1+ (wt-tree/size <var>wt-tree</var>)))
</pre>
  <div class="defun">
&mdash; procedure+: <b>wt-tree/rank</b><var> wt-tree key<a name="index-wt_002dtree_002frank-1213"></a></var><br>
<blockquote><p>Determines the 0-based position of <var>key</var> in the sorted sequence of
the keys under the tree's ordering relation, or <code>#f</code> if the tree
has no association with for <var>key</var>.  This procedure returns either an
exact non-negative integer or <code>#f</code>.  The average and worst-case
times required by this operation are proportional to the logarithm of
the number of associations in the tree. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/min</b><var> wt-tree<a name="index-wt_002dtree_002fmin-1214"></a></var><br>
&mdash; procedure+: <b>wt-tree/min-datum</b><var> wt-tree<a name="index-wt_002dtree_002fmin_002ddatum-1215"></a></var><br>
&mdash; procedure+: <b>wt-tree/min-pair</b><var> wt-tree<a name="index-wt_002dtree_002fmin_002dpair-1216"></a></var><br>
<blockquote><p>Returns the association of <var>wt-tree</var> that has the least key under
the tree's ordering relation.  <code>wt-tree/min</code> returns the least key,
<code>wt-tree/min-datum</code> returns the datum associated with the least key
and <code>wt-tree/min-pair</code> returns a new pair <code>(key . datum)</code>
which is the <code>cons</code> of the minimum key and its datum.  The average
and worst-case times required by this operation are proportional to the
logarithm of the number of associations in the tree.

       <p>These operations signal an error if the tree is empty. 
They could be written
     <pre class="example">          (define (wt-tree/min tree)        (wt-tree/index tree 0))
          (define (wt-tree/min-datum tree)  (wt-tree/index-datum tree 0))
          (define (wt-tree/min-pair tree)   (wt-tree/index-pair tree 0))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/delete-min</b><var> wt-tree<a name="index-wt_002dtree_002fdelete_002dmin-1217"></a></var><br>
<blockquote><p>Returns a new tree containing all of the associations in <var>wt-tree</var>
except the association with the least key under the <var>wt-tree</var>'s
ordering relation.  An error is signalled if the tree is empty.  The
average and worst-case times required by this operation are proportional
to the logarithm of the number of associations in the tree.  This
operation is equivalent to

     <pre class="example">          (wt-tree/delete <var>wt-tree</var> (wt-tree/min <var>wt-tree</var>))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; procedure+: <b>wt-tree/delete-min!</b><var> wt-tree<a name="index-wt_002dtree_002fdelete_002dmin_0021-1218"></a></var><br>
<blockquote><p>Removes the association with the least key under the <var>wt-tree</var>'s
ordering relation.  An error is signalled if the tree is empty.  The
average and worst-case times required by this operation are proportional
to the logarithm of the number of associations in the tree.  This
operation is equivalent to

     <pre class="example">          (wt-tree/delete! <var>wt-tree</var> (wt-tree/min <var>wt-tree</var>))
</pre>
       </blockquote></div>

<div class="node">
<a name="Other-Packages"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#About-SLIB">About SLIB</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Database-Packages">Database Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">7 Other Packages</h2>

<ul class="menu">
<li><a accesskey="1" href="#Data-Structures">Data Structures</a>:              Various data structures. 
<li><a accesskey="2" href="#Sorting-and-Searching">Sorting and Searching</a>
<li><a accesskey="3" href="#Procedures">Procedures</a>:                   Miscellaneous utility procedures. 
<li><a accesskey="4" href="#Standards-Support">Standards Support</a>:            Support for Scheme Standards. 
<li><a accesskey="5" href="#Session-Support">Session Support</a>:              REPL and Debugging. 
<li><a accesskey="6" href="#System-Interface">System Interface</a>:             'system, 'getenv, and other programs. 
<li><a accesskey="7" href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a>:          Outside the envelope. 
</ul>

<div class="node">
<a name="Data-Structures"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Sorting-and-Searching">Sorting and Searching</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-Packages">Other Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Packages">Other Packages</a>

</div>

<h3 class="section">7.1 Data Structures</h3>

<ul class="menu">
<li><a accesskey="1" href="#Arrays">Arrays</a>:                       'array
<li><a accesskey="2" href="#Subarrays">Subarrays</a>:                    'subarray
<li><a accesskey="3" href="#Array-Mapping">Array Mapping</a>:                'array-for-each
<li><a accesskey="4" href="#Array-Interpolation">Array Interpolation</a>:          'array-interpolate
<li><a accesskey="5" href="#Association-Lists">Association Lists</a>:            'alist
<li><a accesskey="6" href="#Byte">Byte</a>:                         'byte
<li><a accesskey="7" href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a>:      'byte-number
<li><a accesskey="8" href="#MAT_002dFile-Format">MAT-File Format</a>:              'matfile
<li><a accesskey="9" href="#Portable-Image-Files">Portable Image Files</a>:         'pnm
<li><a href="#Collections">Collections</a>:                  'collect
<li><a href="#Dynamic-Data-Type">Dynamic Data Type</a>:            'dynamic
<li><a href="#Hash-Tables">Hash Tables</a>:                  'hash-table
<li><a href="#Object">Object</a>:                       'object
<li><a href="#Priority-Queues">Priority Queues</a>:              'priority-queue
<li><a href="#Queues">Queues</a>:                       'queue
<li><a href="#Records">Records</a>:                      'record
</ul>

<div class="node">
<a name="Arrays"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Subarrays">Subarrays</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Data-Structures">Data Structures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.1 Arrays</h4>

<p><code>(require 'array)</code> or <code>(require 'srfi-63)</code>
<a name="index-array-1219"></a>

<div class="defun">
&mdash; Function: <b>array?</b><var> obj<a name="index-array_003f-1220"></a></var><br>
<blockquote>
       <p>Returns <code>#t</code> if the <var>obj</var> is an array, and <code>#f</code> if not. 
</p></blockquote></div>

<p class="noindent"><em>Note:</em> Arrays are not disjoint from other Scheme types. 
Vectors and possibly strings also satisfy <code>array?</code>. 
A disjoint array predicate can be written:

<pre class="example">     (define (strict-array? obj)
       (and (array? obj) (not (string? obj)) (not (vector? obj))))
</pre>
  <div class="defun">
&mdash; Function: <b>equal?</b><var> obj1 obj2<a name="index-equal_003f-1221"></a></var><br>
<blockquote>
       <p>Returns <code>#t</code> if <var>obj1</var> and <var>obj2</var> have the same rank and dimensions and the
corresponding elements of <var>obj1</var> and <var>obj2</var> are <code>equal?</code>.

       <p><code>equal?</code> recursively compares the contents of pairs, vectors, strings, and
<em>arrays</em>, applying <code>eqv?</code> on other objects such as numbers
and symbols.  A rule of thumb is that objects are generally <code>equal?</code> if
they print the same.  <code>equal?</code> may fail to terminate if its arguments are
circular data structures.

     <pre class="example">          (equal? 'a 'a)                             &rArr;  #t
          (equal? '(a) '(a))                         &rArr;  #t
          (equal? '(a (b) c)
                  '(a (b) c))                        &rArr;  #t
          (equal? "abc" "abc")                       &rArr;  #t
          (equal? 2 2)                               &rArr;  #t
          (equal? (make-vector 5 'a)
                  (make-vector 5 'a))                &rArr;  #t
          (equal? (make-array (A:fixN32b 4) 5 3)
                  (make-array (A:fixN32b 4) 5 3))    &rArr;  #t
          (equal? (make-array '#(foo) 3 3)
                  (make-array '#(foo) 3 3))          &rArr;  #t
          (equal? (lambda (x) x)
                  (lambda (y) y))                    &rArr;  <em>unspecified</em>
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>array-rank</b><var> obj<a name="index-array_002drank-1222"></a></var><br>
<blockquote>
       <p>Returns the number of dimensions of <var>obj</var>.  If <var>obj</var> is not an array, 0 is
returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>array-dimensions</b><var> array<a name="index-array_002ddimensions-1223"></a></var><br>
<blockquote>
       <p>Returns a list of dimensions.

     <pre class="example">          (array-dimensions (make-array '#() 3 5))
             &rArr; (3 5)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>make-array</b><var> prototype k1 <small class="dots">...</small><a name="index-make_002darray-1224"></a></var><br>
<blockquote>
       <p>Creates and returns an array of type <var>prototype</var> with dimensions <var>k1</var>, <small class="dots">...</small>
and filled with elements from <var>prototype</var>.  <var>prototype</var> must be an array, vector, or
string.  The implementation-dependent type of the returned array
will be the same as the type of <var>prototype</var>; except if that would be a vector
or string with rank not equal to one, in which case some variety of
array will be returned.

       <p>If the <var>prototype</var> has no elements, then the initial contents of the returned
array are unspecified.  Otherwise, the returned array will be filled
with the element at the origin of <var>prototype</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>create-array</b><var> prototype k1 <small class="dots">...</small><a name="index-create_002darray-1225"></a></var><br>
<blockquote>
       <p><code>create-array</code> is an alias for <code>make-array</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-shared-array</b><var> array mapper k1 <small class="dots">...</small><a name="index-make_002dshared_002darray-1226"></a></var><br>
<blockquote>
       <p><code>make-shared-array</code> can be used to create shared subarrays of other
arrays.  The <var>mapper</var> is a function that translates coordinates in
the new array into coordinates in the old array.  A <var>mapper</var> must be
linear, and its range must stay within the bounds of the old array, but
it can be otherwise arbitrary.  A simple example:

     <pre class="example">          (define fred (make-array '#(#f) 8 8))
          (define freds-diagonal
            (make-shared-array fred (lambda (i) (list i i)) 8))
          (array-set! freds-diagonal 'foo 3)
          (array-ref fred 3 3)
             &rArr; FOO
          (define freds-center
            (make-shared-array fred (lambda (i j) (list (+ 3 i) (+ 3 j)))
                               2 2))
          (array-ref freds-center 0 0)
             &rArr; FOO
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>list-&gt;array</b><var> rank proto list<a name="index-list_002d_003earray-1227"></a></var><br>
<blockquote>
       <p><var>list</var> must be a rank-nested list consisting of all the elements, in
row-major order, of the array to be created.

       <p><code>list-&gt;array</code> returns an array of rank <var>rank</var> and type <var>proto</var> consisting of all the
elements, in row-major order, of <var>list</var>.  When <var>rank</var> is 0, <var>list</var> is the lone
array element; not necessarily a list.

     <pre class="example">          (list-&gt;array 2 '#() '((1 2) (3 4)))
                          &rArr; #2A((1 2) (3 4))
          (list-&gt;array 0 '#() 3)
                          &rArr; #0A 3
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>array-&gt;list</b><var> array<a name="index-array_002d_003elist-1228"></a></var><br>
<blockquote>
       <p>Returns a rank-nested list consisting of all the elements, in
row-major order, of <var>array</var>.  In the case of a rank-0 array, <code>array-&gt;list</code> returns
the single element.

     <pre class="example">          (array-&gt;list #2A((ho ho ho) (ho oh oh)))
                          &rArr; ((ho ho ho) (ho oh oh))
          (array-&gt;list #0A ho)
                          &rArr; ho
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>vector-&gt;array</b><var> vect proto dim1 <small class="dots">...</small><a name="index-vector_002d_003earray-1229"></a></var><br>
<blockquote>
       <p><var>vect</var> must be a vector of length equal to the product of exact
nonnegative integers <var>dim1</var>, <small class="dots">...</small>.

       <p><code>vector-&gt;array</code> returns an array of type <var>proto</var> consisting of all the elements, in
row-major order, of <var>vect</var>.  In the case of a rank-0 array, <var>vect</var> has a
single element.

     <pre class="example">          (vector-&gt;array #(1 2 3 4) #() 2 2)
                          &rArr; #2A((1 2) (3 4))
          (vector-&gt;array '#(3) '#())
                          &rArr; #0A 3
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>array-&gt;vector</b><var> array<a name="index-array_002d_003evector-1230"></a></var><br>
<blockquote>
       <p>Returns a new vector consisting of all the elements of <var>array</var> in
row-major order.

     <pre class="example">          (array-&gt;vector #2A ((1 2)( 3 4)))
                          &rArr; #(1 2 3 4)
          (array-&gt;vector #0A ho)
                          &rArr; #(ho)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>array-in-bounds?</b><var> array index1 <small class="dots">...</small><a name="index-array_002din_002dbounds_003f-1231"></a></var><br>
<blockquote>
       <p>Returns <code>#t</code> if its arguments would be acceptable to
<code>array-ref</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>array-ref</b><var> array k1 <small class="dots">...</small><a name="index-array_002dref-1232"></a></var><br>
<blockquote>
       <p>Returns the (<var>k1</var>, <small class="dots">...</small>) element of <var>array</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>array-set!</b><var> array obj k1 <small class="dots">...</small><a name="index-array_002dset_0021-1233"></a></var><br>
<blockquote>
       <p>Stores <var>obj</var> in the (<var>k1</var>, <small class="dots">...</small>) element of <var>array</var>.  The value returned
by <code>array-set!</code> is unspecified. 
</p></blockquote></div>

<p class="noindent">These functions return a prototypical uniform-array enclosing the
optional argument (which must be of the correct type).  If the
uniform-array type is supported by the implementation, then it is
returned; defaulting to the next larger precision type; resorting
finally to vector.

<div class="defun">
&mdash; Function: <b>A:floC128b</b><var> z<a name="index-A_003afloC128b-1234"></a></var><br>
&mdash; Function: <b>A:floC128b</b><var><a name="index-A_003afloC128b-1235"></a></var><br>
<blockquote><p>Returns an inexact 128.bit flonum complex uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floC64b</b><var> z<a name="index-A_003afloC64b-1236"></a></var><br>
&mdash; Function: <b>A:floC64b</b><var><a name="index-A_003afloC64b-1237"></a></var><br>
<blockquote><p>Returns an inexact 64.bit flonum complex uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floC32b</b><var> z<a name="index-A_003afloC32b-1238"></a></var><br>
&mdash; Function: <b>A:floC32b</b><var><a name="index-A_003afloC32b-1239"></a></var><br>
<blockquote><p>Returns an inexact 32.bit flonum complex uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floC16b</b><var> z<a name="index-A_003afloC16b-1240"></a></var><br>
&mdash; Function: <b>A:floC16b</b><var><a name="index-A_003afloC16b-1241"></a></var><br>
<blockquote><p>Returns an inexact 16.bit flonum complex uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floR128b</b><var> x<a name="index-A_003afloR128b-1242"></a></var><br>
&mdash; Function: <b>A:floR128b</b><var><a name="index-A_003afloR128b-1243"></a></var><br>
<blockquote><p>Returns an inexact 128.bit flonum real uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floR64b</b><var> x<a name="index-A_003afloR64b-1244"></a></var><br>
&mdash; Function: <b>A:floR64b</b><var><a name="index-A_003afloR64b-1245"></a></var><br>
<blockquote><p>Returns an inexact 64.bit flonum real uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floR32b</b><var> x<a name="index-A_003afloR32b-1246"></a></var><br>
&mdash; Function: <b>A:floR32b</b><var><a name="index-A_003afloR32b-1247"></a></var><br>
<blockquote><p>Returns an inexact 32.bit flonum real uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floR16b</b><var> x<a name="index-A_003afloR16b-1248"></a></var><br>
&mdash; Function: <b>A:floR16b</b><var><a name="index-A_003afloR16b-1249"></a></var><br>
<blockquote><p>Returns an inexact 16.bit flonum real uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floR128d</b><var> q<a name="index-A_003afloR128d-1250"></a></var><br>
&mdash; Function: <b>A:floR128d</b><var><a name="index-A_003afloR128d-1251"></a></var><br>
<blockquote><p>Returns an exact 128.bit decimal flonum rational uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floR64d</b><var> q<a name="index-A_003afloR64d-1252"></a></var><br>
&mdash; Function: <b>A:floR64d</b><var><a name="index-A_003afloR64d-1253"></a></var><br>
<blockquote><p>Returns an exact 64.bit decimal flonum rational uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:floR32d</b><var> q<a name="index-A_003afloR32d-1254"></a></var><br>
&mdash; Function: <b>A:floR32d</b><var><a name="index-A_003afloR32d-1255"></a></var><br>
<blockquote><p>Returns an exact 32.bit decimal flonum rational uniform-array prototype. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixZ64b</b><var> n<a name="index-A_003afixZ64b-1256"></a></var><br>
&mdash; Function: <b>A:fixZ64b</b><var><a name="index-A_003afixZ64b-1257"></a></var><br>
<blockquote><p>Returns an exact binary fixnum uniform-array prototype with at least
64 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixZ32b</b><var> n<a name="index-A_003afixZ32b-1258"></a></var><br>
&mdash; Function: <b>A:fixZ32b</b><var><a name="index-A_003afixZ32b-1259"></a></var><br>
<blockquote><p>Returns an exact binary fixnum uniform-array prototype with at least
32 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixZ16b</b><var> n<a name="index-A_003afixZ16b-1260"></a></var><br>
&mdash; Function: <b>A:fixZ16b</b><var><a name="index-A_003afixZ16b-1261"></a></var><br>
<blockquote><p>Returns an exact binary fixnum uniform-array prototype with at least
16 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixZ8b</b><var> n<a name="index-A_003afixZ8b-1262"></a></var><br>
&mdash; Function: <b>A:fixZ8b</b><var><a name="index-A_003afixZ8b-1263"></a></var><br>
<blockquote><p>Returns an exact binary fixnum uniform-array prototype with at least
8 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixN64b</b><var> k<a name="index-A_003afixN64b-1264"></a></var><br>
&mdash; Function: <b>A:fixN64b</b><var><a name="index-A_003afixN64b-1265"></a></var><br>
<blockquote><p>Returns an exact non-negative binary fixnum uniform-array prototype with at
least 64 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixN32b</b><var> k<a name="index-A_003afixN32b-1266"></a></var><br>
&mdash; Function: <b>A:fixN32b</b><var><a name="index-A_003afixN32b-1267"></a></var><br>
<blockquote><p>Returns an exact non-negative binary fixnum uniform-array prototype with at
least 32 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixN16b</b><var> k<a name="index-A_003afixN16b-1268"></a></var><br>
&mdash; Function: <b>A:fixN16b</b><var><a name="index-A_003afixN16b-1269"></a></var><br>
<blockquote><p>Returns an exact non-negative binary fixnum uniform-array prototype with at
least 16 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:fixN8b</b><var> k<a name="index-A_003afixN8b-1270"></a></var><br>
&mdash; Function: <b>A:fixN8b</b><var><a name="index-A_003afixN8b-1271"></a></var><br>
<blockquote><p>Returns an exact non-negative binary fixnum uniform-array prototype with at
least 8 bits of precision. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>A:bool</b><var> bool<a name="index-A_003abool-1272"></a></var><br>
&mdash; Function: <b>A:bool</b><var><a name="index-A_003abool-1273"></a></var><br>
<blockquote><p>Returns a boolean uniform-array prototype. 
</p></blockquote></div>

<div class="node">
<a name="Subarrays"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Array-Mapping">Array Mapping</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Arrays">Arrays</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.2 Subarrays</h4>

<p><code>(require 'subarray)</code>
<a name="index-subarray-1274"></a>

<div class="defun">
&mdash; Function: <b>subarray</b><var> array select <small class="dots">...</small><a name="index-subarray-1275"></a></var><br>
<blockquote>
       <p>selects a subset of an array.  For 0 &lt;= <i>j</i> &lt; n, <var>select</var><i>j</i> is either
an integer, a list of two integers within the range for the <i>j</i>th
index, or #f.

       <p>When <var>select</var><i>j</i> is a list of two integers, then the <i>j</i>th index is
restricted to that subrange in the returned array.

       <p>When <var>select</var><i>j</i> is #f, then the full range of the <i>j</i>th index is
accessible in the returned array.  An elided argument is equivalent to #f.

       <p>When <var>select</var><i>j</i> is an integer, then the rank of the returned array is
less than <var>array</var>, and only elements whose <i>j</i>th index equals <var>select</var><i>j</i> are
shared.

     <pre class="example">          &gt; (define ra '#2A((a b c) (d e f)))
          #&lt;unspecified&gt;
          &gt; (subarray ra 0 #f)
          #1A(a b c)
          &gt; (subarray ra 1 #f)
          #1A(d e f)
          &gt; (subarray ra #f 1)
          #1A(b e)
          &gt; (subarray ra '(0 1) #f)
          #2A((a b c) (d e f))
          &gt; (subarray ra #f '(0 1))
          #2A((a b) (d e))
          &gt; (subarray ra #f '(1 2))
          #2A((b c) (e f))
          &gt; (subarray ra #f '(2 1))
          #2A((c b) (f e))
</pre>
       <p>Arrays can be reflected (reversed) using <code>subarray</code>:

     <pre class="example">          &gt; (subarray '#1A(a b c d e) '(4 0))
          #1A(e d c b a)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>array-trim</b><var> array trim <small class="dots">...</small><a name="index-array_002dtrim-1276"></a></var><br>
<blockquote>
       <p>Returns a subarray sharing contents with <var>array</var> except for slices removed
from either side of each dimension.  Each of the <var>trims</var> is an exact
integer indicating how much to trim.  A positive <var>s</var> trims the
data from the lower end and reduces the upper bound of the result; a
negative <var>s</var> trims from the upper end and increases the lower
bound.

       <p>For example:
     <pre class="example">          (array-trim '#(0 1 2 3 4) 1)  &rArr; #1A(1 2 3 4)
          (array-trim '#(0 1 2 3 4) -1) &rArr; #1A(0 1 2 3)
          
          (require 'array-for-each)
          (define (centered-difference ra)
            (array-map ra - (array-trim ra 1) (array-trim ra -1)))
          
          (centered-difference '#(0 1 3 5 9 22))
            &rArr; #(1 2 2 4 13)
</pre>
       </blockquote></div>

<div class="node">
<a name="Array-Mapping"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Array-Interpolation">Array Interpolation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Subarrays">Subarrays</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.3 Array Mapping</h4>

<p><code>(require 'array-for-each)</code>
<a name="index-array_002dfor_002deach-1277"></a>

<div class="defun">
&mdash; Procedure: <b>array-map!</b><var> array0 proc array1 <small class="dots">...</small><a name="index-array_002dmap_0021-1278"></a></var><br>
<blockquote>
       <p><var>array1</var>, <small class="dots">...</small> must have the same number of dimensions as
<var>array0</var> and have a range for each index which includes the range
for the corresponding index in <var>array0</var>.  <var>proc</var> is applied to
each tuple of elements of <var>array1</var> <small class="dots">...</small> and the result is stored
as the corresponding element in <var>array0</var>.  The value returned is
unspecified.  The order of application is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>array-map</b><var> prototype proc array1 array2 <small class="dots">...</small><a name="index-array_002dmap-1279"></a></var><br>
<blockquote>
       <p><var>array2</var>, <small class="dots">...</small> must have the same number of dimensions as
<var>array1</var> and have a range for each index which includes the
range for the corresponding index in <var>array1</var>.  <var>proc</var> is
applied to each tuple of elements of <var>array1</var>, <var>array2</var>,
<small class="dots">...</small> and the result is stored as the corresponding element in a
new array of type <var>prototype</var>.  The new array is returned.  The
order of application is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>array-for-each</b><var> proc array0 <small class="dots">...</small><a name="index-array_002dfor_002deach-1280"></a></var><br>
<blockquote>
       <p><var>proc</var> is applied to each tuple of elements of <var>array0</var> <small class="dots">...</small>
in row-major order.  The value returned is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>array-indexes</b><var> array<a name="index-array_002dindexes-1281"></a></var><br>
<blockquote>
       <p>Returns an array of lists of indexes for <var>array</var> such that, if
<var>li</var> is a list of indexes for which <var>array</var> is defined,
(equal?  <var>li</var> (apply array-ref (array-indexes <var>array</var>)
<var>li</var>)). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>array-index-for-each</b><var> array proc<a name="index-array_002dindex_002dfor_002deach-1282"></a></var><br>
<blockquote>
       <p>applies <var>proc</var> to the indices of each element of <var>array</var> in
turn.  The value returned and the order of application are
unspecified.

       <p>One can implement <var>array-index-map!</var> as
     <pre class="example">          (define (array-index-map! ra fun)
            (array-index-for-each
             ra
             (lambda is (apply array-set! ra (apply fun is) is))))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>array-index-map!</b><var> array proc<a name="index-array_002dindex_002dmap_0021-1283"></a></var><br>
<blockquote>
       <p>applies <var>proc</var> to the indices of each element of <var>array</var> in
turn, storing the result in the corresponding element.  The value
returned and the order of application are unspecified.

       <p>One can implement <var>array-indexes</var> as
     <pre class="example">          (define (array-indexes array)
              (let ((ra (apply make-array '#() (array-dimensions array))))
                (array-index-map! ra (lambda x x))
                ra))
</pre>
       <p>Another example:
     <pre class="example">          (define (apl:index-generator n)
              (let ((v (make-vector n 1)))
                (array-index-map! v (lambda (i) i))
                v))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>array:copy!</b><var> destination source<a name="index-array_003acopy_0021-1284"></a></var><br>
<blockquote>
       <p>Copies every element from vector or array <var>source</var> to the
corresponding element of <var>destination</var>.  <var>destination</var> must
have the same rank as <var>source</var>, and be at least as large in each
dimension.  The order of copying is unspecified. 
</p></blockquote></div>

<div class="node">
<a name="Array-Interpolation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Association-Lists">Association Lists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Array-Mapping">Array Mapping</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.4 Array Interpolation</h4>

<p><code>(require 'array-interpolate)</code>

<div class="defun">
&mdash; Function: <b>interpolate-array-ref</b><var> ra x1 <small class="dots">...</small> xj<a name="index-interpolate_002darray_002dref-1285"></a></var><br>
<blockquote>
       <p><var>ra</var> must be an array of rank j containing numbers.  <code>interpolate-array-ref</code> returns a
value interpolated from the nearest j-dimensional cube of elements
of <var>ra</var>.

     <pre class="example">          (interpolate-array-ref '#2A:fixZ32b((1 2 3) (4 5 6)) 1 0.1)
                                        ==&gt; 4.1
          (interpolate-array-ref '#2A:fixZ32b((1 2 3) (4 5 6)) 0.5 0.25)
                                        ==&gt; 2.75
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>resample-array!</b><var> ra1 ra2<a name="index-resample_002darray_0021-1286"></a></var><br>
<blockquote>
       <p><var>ra1</var> and <var>ra2</var> must be numeric arrays of equal rank.  <code>resample-array!</code> sets <var>ra1</var> to
values interpolated from <var>ra2</var> such that the values of elements at the
corners of <var>ra1</var> and <var>ra2</var> are equal.

     <pre class="example">          (define ra (make-array (A:fixZ32b) 2 2))
          (resample-array! ra '#2A:fixZ32b((1 2 3) (4 5 6)))
          ra              ==&gt;  #2A:fixZ32b((1 3) (4 6))
          (define ra (make-array (A:floR64b) 3 2))
          (resample-array! ra '#2A:fixZ32b((1 2 3) (4 5 6)))
          ra              ==&gt;  #2A:floR64b((1.0 3.0) (2.5 4.5) (4.0 6.0))
</pre>
       </blockquote></div>

<div class="node">
<a name="Association-Lists"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Byte">Byte</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Array-Interpolation">Array Interpolation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.5 Association Lists</h4>

<p><code>(require 'alist)</code>
<a name="index-alist-1287"></a>
Alist functions provide utilities for treating a list of key-value pairs
as an associative database.  These functions take an equality predicate,
<var>pred</var>, as an argument.  This predicate should be repeatable,
symmetric, and transitive.

  <p>Alist functions can be used with a secondary index method such as hash
tables for improved performance.

<div class="defun">
&mdash; Function: <b>predicate-&gt;asso</b><var> pred<a name="index-predicate_002d_003easso-1288"></a></var><br>
<blockquote>
       <p>Returns an <dfn>association function</dfn> (like <code>assq</code>, <code>assv</code>, or
<a name="index-association-function-1289"></a><code>assoc</code>) corresponding to <var>pred</var>.  The returned function
returns a key-value pair whose key is <code>pred</code>-equal to its first
argument or <code>#f</code> if no key in the alist is <var>pred</var>-equal to the
first argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>alist-inquirer</b><var> pred<a name="index-alist_002dinquirer-1290"></a></var><br>
<blockquote>
       <p>Returns a procedure of 2 arguments, <var>alist</var> and <var>key</var>, which
returns the value associated with <var>key</var> in <var>alist</var> or <code>#f</code> if
<var>key</var> does not appear in <var>alist</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>alist-associator</b><var> pred<a name="index-alist_002dassociator-1291"></a></var><br>
<blockquote>
       <p>Returns a procedure of 3 arguments, <var>alist</var>, <var>key</var>, and
<var>value</var>, which returns an alist with <var>key</var> and <var>value</var>
associated.  Any previous value associated with <var>key</var> will be
lost.  This returned procedure may or may not have side effects on its
<var>alist</var> argument.  An example of correct usage is:

     <pre class="lisp">          (define put (alist-associator string-ci=?))
          (define alist '())
          (set! alist (put alist "Foo" 9))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>alist-remover</b><var> pred<a name="index-alist_002dremover-1292"></a></var><br>
<blockquote>
       <p>Returns a procedure of 2 arguments, <var>alist</var> and <var>key</var>, which
returns an alist with an association whose <var>key</var> is key removed. 
This returned procedure may or may not have side effects on its
<var>alist</var> argument.  An example of correct usage is:

     <pre class="lisp">          (define rem (alist-remover string-ci=?))
          (set! alist (rem alist "foo"))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>alist-map</b><var> proc alist<a name="index-alist_002dmap-1293"></a></var><br>
<blockquote>
       <p>Returns a new association list formed by mapping <var>proc</var> over the
keys and values of <var>alist</var>.   <var>proc</var> must be a function of 2
arguments which returns the new value part. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>alist-for-each</b><var> proc alist<a name="index-alist_002dfor_002deach-1294"></a></var><br>
<blockquote>
       <p>Applies <var>proc</var> to each pair of keys and values of <var>alist</var>. 
<var>proc</var> must be a function of 2 arguments.  The returned value is
unspecified. 
</p></blockquote></div>

<div class="node">
<a name="Byte"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Association-Lists">Association Lists</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.6 Byte</h4>

<p><code>(require 'byte)</code>
<a name="index-byte-1295"></a>
Some algorithms are expressed in terms of arrays of small integers. 
Using Scheme strings to implement these arrays is not portable vis-a-vis
the correspondence between integers and characters and non-ascii
character sets.  These functions abstract the notion of a <dfn>byte</dfn>. 
<a name="index-byte-1296"></a><a name="index-byte-1297"></a>

<div class="defun">
&mdash; Function: <b>byte-ref</b><var> bytes k<a name="index-byte_002dref-1298"></a></var><br>
<blockquote>
       <p><var>k</var> must be a valid index of <var>bytes</var>.  <code>byte-ref</code> returns byte <var>k</var> of <var>bytes</var> using
zero-origin indexing. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>byte-set!</b><var> bytes k byte<a name="index-byte_002dset_0021-1299"></a></var><br>
<blockquote>
       <p><var>k</var> must be a valid index of <var>bytes</var>, and <var>byte</var> must be a small
nonnegative integer.  <code>byte-set!</code> stores <var>byte</var> in element <var>k</var> of <var>bytes</var> and
returns an unspecified value.  <!-- <!> -->
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-bytes</b><var> k byte<a name="index-make_002dbytes-1300"></a></var><br>

  &mdash; Function: <b>make-bytes</b><var> k<a name="index-make_002dbytes-1301"></a></var><br>
<blockquote><p><code>make-bytes</code> returns a newly allocated byte-array of length <var>k</var>.  If <var>byte</var> is
given, then all elements of the byte-array are initialized to <var>byte</var>,
otherwise the contents of the byte-array are unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bytes-length</b><var> bytes<a name="index-bytes_002dlength-1302"></a></var><br>
<blockquote>
       <p><code>bytes-length</code> returns length of byte-array <var>bytes</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bytes</b><var> byte <small class="dots">...</small><a name="index-bytes-1303"></a></var><br>
<blockquote>
       <p>Returns a newly allocated byte-array composed of the small
nonnegative arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>list-&gt;bytes</b><var> bytes<a name="index-list_002d_003ebytes-1304"></a></var><br>
<blockquote>
       <p><code>list-&gt;bytes</code> returns a newly allocated byte-array formed from the small
nonnegative integers in the list <var>bytes</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bytes-&gt;list</b><var> bytes<a name="index-bytes_002d_003elist-1305"></a></var><br>
<blockquote>
       <p><code>bytes-&gt;list</code> returns a newly allocated list of the bytes that make up the
given byte-array. 
</p></blockquote></div>

<p class="noindent"><code>Bytes-&gt;list</code> and <code>list-&gt;bytes</code> are inverses so far as
<code>equal?</code> is concerned. 
<a name="index-equal_003f-1306"></a>

<div class="defun">
&mdash; Function: <b>bytes-&gt;string</b><var> bytes<a name="index-bytes_002d_003estring-1307"></a></var><br>
<blockquote>
       <p>Returns a new string formed from applying <code>integer-&gt;char</code> to
each byte in <code>bytes-&gt;string</code>.  Note that this may signal an error for bytes
having values between 128 and 255. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-&gt;bytes</b><var> string<a name="index-string_002d_003ebytes-1308"></a></var><br>
<blockquote>
       <p>Returns a new byte-array formed from applying <code>char-&gt;integer</code>
to each character in <code>string-&gt;bytes</code>.  Note that this may signal an error if an
integer is larger than 255. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bytes-copy</b><var> bytes<a name="index-bytes_002dcopy-1309"></a></var><br>
<blockquote>
       <p>Returns a newly allocated copy of the given <var>bytes</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytes</b><var> bytes start end<a name="index-subbytes-1310"></a></var><br>
<blockquote>
       <p><var>bytes</var> must be a bytes, and <var>start</var> and <var>end</var>
must be exact integers satisfying

     <div align="center">0 &lt;= <var>start</var> &lt;= <var>end</var> &lt;= <tt>(bytes-length&nbsp;</tt><var>bytes</var><tt>)</tt><span class="roman">.</span><!-- /@w --></div>

       <p><code>subbytes</code> returns a newly allocated bytes formed from the bytes of
<var>bytes</var> beginning with index <var>start</var> (inclusive) and ending with index
<var>end</var> (exclusive). 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>bytes-reverse!</b><var> bytes<a name="index-bytes_002dreverse_0021-1311"></a></var><br>
<blockquote>
       <p>Reverses the order of byte-array <var>bytes</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bytes-reverse</b><var> bytes<a name="index-bytes_002dreverse-1312"></a></var><br>
<blockquote>
       <p>Returns a newly allocated bytes-array consisting of the elements of
<var>bytes</var> in reverse order. 
</p></blockquote></div>

<p class="noindent"><a name="index-binary-1313"></a>Input and output of bytes should be with ports opened in <dfn>binary</dfn>
<a name="index-binary-1314"></a>mode (see <a href="#Input_002fOutput">Input/Output</a>).  Calling <code>open-file</code> with <span class="roman">'rb</span> or
<a name="index-open_002dfile-1315"></a><span class="roman">'wb</span> modes argument will return a binary port if the Scheme
implementation supports it.

<div class="defun">
&mdash; Function: <b>write-byte</b><var> byte port<a name="index-write_002dbyte-1316"></a></var><br>

  &mdash; Function: <b>write-byte</b><var> byte<a name="index-write_002dbyte-1317"></a></var><br>
<blockquote><p>Writes the byte <var>byte</var> (not an external representation of the byte) to
the given <var>port</var> and returns an unspecified value.  The <var>port</var> argument may
be omitted, in which case it defaults to the value returned by
<code>current-output-port</code>. 
<a name="index-current_002doutput_002dport-1318"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>read-byte</b><var> port<a name="index-read_002dbyte-1319"></a></var><br>

  &mdash; Function: <b>read-byte</b><var><a name="index-read_002dbyte-1320"></a></var><br>
<blockquote><p>Returns the next byte available from the input <var>port</var>, updating the <var>port</var>
to point to the following byte.  If no more bytes are available, an
end-of-file object is returned.  <var>port</var> may be omitted, in which case it
defaults to the value returned by <code>current-input-port</code>. 
<a name="index-current_002dinput_002dport-1321"></a></p></blockquote></div>

<p class="noindent">When reading and writing binary numbers with <code>read-bytes</code> and
<code>write-bytes</code>, the sign of the length argument determines the
endianness (order) of bytes.  Positive treats them as big-endian,
the first byte input or output is highest order.  Negative treats
them as little-endian, the first byte input or output is the lowest
order.

<p class="noindent">Once read in, SLIB treats byte sequences as big-endian.  The
multi-byte sequences produced and used by number conversion routines
see <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a> are always big-endian.

<div class="defun">
&mdash; Function: <b>read-bytes</b><var> n port<a name="index-read_002dbytes-1322"></a></var><br>

  &mdash; Function: <b>read-bytes</b><var> n<a name="index-read_002dbytes-1323"></a></var><br>
<blockquote><p><code>read-bytes</code> returns a newly allocated bytes-array filled with
<code>(abs </code><var>n</var><code>)</code> bytes read from <var>port</var>.  If <var>n</var> is positive, then
the first byte read is stored at index 0; otherwise the last byte
read is stored at index 0.  Note that the length of the returned
byte-array will be less than <code>(abs </code><var>n</var><code>)</code> if <var>port</var> reaches
end-of-file.

       <p><var>port</var> may be omitted, in which case it defaults to the value returned
by <code>current-input-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>write-bytes</b><var> bytes n port<a name="index-write_002dbytes-1324"></a></var><br>

  &mdash; Function: <b>write-bytes</b><var> bytes n<a name="index-write_002dbytes-1325"></a></var><br>
<blockquote><p><code>write-bytes</code> writes <code>(abs </code><var>n</var><code>)</code> bytes to output-port <var>port</var>.  If <var>n</var> is
positive, then the first byte written is index 0 of <var>bytes</var>; otherwise
the last byte written is index 0 of <var>bytes</var>.  <code>write-bytes</code> returns an unspecified
value.

       <p><var>port</var> may be omitted, in which case it defaults to the value returned
by <code>current-output-port</code>. 
</p></blockquote></div>

<p class="noindent"><code>subbytes-read!</code> and <code>subbytes-write</code> provide
lower-level procedures for reading and writing blocks of bytes.  The
relative size of <var>start</var> and <var>end</var> determines the order of
writing.

<div class="defun">
&mdash; Procedure: <b>subbytes-read!</b><var> bts start end port<a name="index-subbytes_002dread_0021-1326"></a></var><br>

  &mdash; Procedure: <b>subbytes-read!</b><var> bts start end<a name="index-subbytes_002dread_0021-1327"></a></var><br>
<blockquote><p>Fills <var>bts</var> with up to <code>(abs (- </code><var>start</var> <var>end</var><code>))</code> bytes
read from <var>port</var>.  The first byte read is stored at index <var>bts</var>. 
<code>subbytes-read!</code> returns the number of bytes read.

       <p><var>port</var> may be omitted, in which case it defaults to the value returned
by <code>current-input-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytes-write</b><var> bts start end port<a name="index-subbytes_002dwrite-1328"></a></var><br>

  &mdash; Function: <b>subbytes-write</b><var> bts start end<a name="index-subbytes_002dwrite-1329"></a></var><br>
<blockquote><p><code>subbytes-write</code> writes <code>(abs (- </code><var>start</var> <var>end</var><code>))</code> bytes to
output-port <var>port</var>.  The first byte written is index <var>start</var> of <var>bts</var>.  <code>subbytes-write</code>
returns the number of bytes written.

       <p><var>port</var> may be omitted, in which case it defaults to the value returned
by <code>current-output-port</code>. 
</p></blockquote></div>

<div class="node">
<a name="Byte%2fNumber-Conversions"></a>
<a name="Byte_002fNumber-Conversions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#MAT_002dFile-Format">MAT-File Format</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Byte">Byte</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.7 Byte/Number Conversions</h4>

<p><code>(require 'byte-number)</code>
<a name="index-byte_002dnumber-1330"></a>
The multi-byte sequences produced and used by numeric conversion
routines are always big-endian.  Endianness can be changed during
reading and writing bytes using <code>read-bytes</code> and
<code>write-bytes</code> See <a href="#Byte">read-bytes</a>.

<p class="noindent">The sign of the length argument to bytes/integer conversion
procedures determines the signedness of the number.

<div class="defun">
&mdash; Function: <b>bytes-&gt;integer</b><var> bytes n<a name="index-bytes_002d_003einteger-1331"></a></var><br>
<blockquote>
       <p>Converts the first <code>(abs </code><var>n</var><code>)</code> bytes of big-endian <var>bytes</var> array
to an integer.  If <var>n</var> is negative then the integer coded by the
bytes are treated as two's-complement (can be negative).

     <pre class="example">          (bytes-&gt;integer (bytes   0   0   0  15) -4)   &rArr;          15
          (bytes-&gt;integer (bytes   0   0   0  15)  4)   &rArr;          15
          (bytes-&gt;integer (bytes 255 255 255 255) -4)   &rArr;          -1
          (bytes-&gt;integer (bytes 255 255 255 255)  4)   &rArr;  4294967295
          (bytes-&gt;integer (bytes 128   0   0   0) -4)   &rArr; -2147483648
          (bytes-&gt;integer (bytes 128   0   0   0)  4)   &rArr;  2147483648
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-&gt;bytes</b><var> n len<a name="index-integer_002d_003ebytes-1332"></a></var><br>
<blockquote>
       <p>Converts the integer <var>n</var> to a byte-array of <code>(abs </code><var>n</var><code>)</code>
bytes.  If <var>n</var> and <var>len</var> are both negative, then the bytes in the
returned array are coded two's-complement.

     <pre class="example">          (bytes-&gt;list (integer-&gt;bytes          15 -4))   &rArr; (0 0 0 15)
          (bytes-&gt;list (integer-&gt;bytes          15  4))   &rArr; (0 0 0 15)
          (bytes-&gt;list (integer-&gt;bytes          -1 -4))   &rArr; (255 255 255 255)
          (bytes-&gt;list (integer-&gt;bytes  4294967295  4))   &rArr; (255 255 255 255)
          (bytes-&gt;list (integer-&gt;bytes -2147483648 -4))   &rArr; (128 0 0 0)
          (bytes-&gt;list (integer-&gt;bytes  2147483648  4))   &rArr; (128 0 0 0)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>bytes-&gt;ieee-float</b><var> bytes<a name="index-bytes_002d_003eieee_002dfloat-1333"></a></var><br>
<blockquote>
       <p><var>bytes</var> must be a 4-element byte-array.  <code>bytes-&gt;ieee-float</code> calculates and returns the
value of <var>bytes</var> interpreted as a big-endian IEEE 4-byte (32-bit) number. 
</p></blockquote></div>

<pre class="example">     (bytes-&gt;ieee-float (bytes    0    0 0 0))  &rArr;  0.0
     (bytes-&gt;ieee-float (bytes #x80    0 0 0))  &rArr; -0.0
     (bytes-&gt;ieee-float (bytes #x40    0 0 0))  &rArr;  2.0
     (bytes-&gt;ieee-float (bytes #x40 #xd0 0 0))  &rArr;  6.5
     (bytes-&gt;ieee-float (bytes #xc0 #xd0 0 0))  &rArr; -6.5
     
     (bytes-&gt;ieee-float (bytes    0 #x80 0 0))  &rArr; 11.754943508222875e-39
     (bytes-&gt;ieee-float (bytes    0 #x40 0 0))  &rArr;  5.877471754111437e-39
     (bytes-&gt;ieee-float (bytes    0    0 0 1))  &rArr;  1.401298464324817e-45
     
     (bytes-&gt;ieee-float (bytes #xff #x80 0 0))  &rArr; -inf.0
     (bytes-&gt;ieee-float (bytes #x7f #x80 0 0))  &rArr; +inf.0
     (bytes-&gt;ieee-float (bytes #x7f #x80 0 1))  &rArr;  0/0
     (bytes-&gt;ieee-float (bytes #x7f #xc0 0 0))  &rArr;  0/0
</pre>
  <div class="defun">
&mdash; Function: <b>bytes-&gt;ieee-double</b><var> bytes<a name="index-bytes_002d_003eieee_002ddouble-1334"></a></var><br>
<blockquote>
       <p><var>bytes</var> must be a 8-element byte-array.  <code>bytes-&gt;ieee-double</code> calculates and returns the
value of <var>bytes</var> interpreted as a big-endian IEEE 8-byte (64-bit) number. 
</p></blockquote></div>

<pre class="example">     (bytes-&gt;ieee-double (bytes    0    0 0 0 0 0 0 0))  &rArr;  0.0
     (bytes-&gt;ieee-double (bytes #x80    0 0 0 0 0 0 0))  &rArr; -0.0
     (bytes-&gt;ieee-double (bytes #x40    0 0 0 0 0 0 0))  &rArr;  2.0
     (bytes-&gt;ieee-double (bytes #x40 #x1A 0 0 0 0 0 0))  &rArr;  6.5
     (bytes-&gt;ieee-double (bytes #xC0 #x1A 0 0 0 0 0 0))  &rArr; -6.5
     
     (bytes-&gt;ieee-double (bytes 0 8 0 0 0 0 0 0)) &rArr; 11.125369292536006e-309
     (bytes-&gt;ieee-double (bytes 0 4 0 0 0 0 0 0)) &rArr;  5.562684646268003e-309
     (bytes-&gt;ieee-double (bytes 0 0 0 0 0 0 0 1)) &rArr;  4.0e-324
     
     (bytes-&gt;ieee-double (list-&gt;bytes '(127 239 255 255 255 255 255 255))) 179.76931348623157e306
     (bytes-&gt;ieee-double (bytes #xFF #xF0 0 0 0 0 0 0))  &rArr; -inf.0
     (bytes-&gt;ieee-double (bytes #x7F #xF0 0 0 0 0 0 0))  &rArr; +inf.0
     (bytes-&gt;ieee-double (bytes #x7F #xF8 0 0 0 0 0 0))  &rArr;  0/0
</pre>
  <div class="defun">
&mdash; Function: <b>ieee-float-&gt;bytes</b><var> x<a name="index-ieee_002dfloat_002d_003ebytes-1335"></a></var><br>
<blockquote>
       <p>Returns a 4-element byte-array encoding the IEEE single-precision
floating-point of <var>x</var>. 
</p></blockquote></div>

<pre class="example">     (bytes-&gt;list (ieee-float-&gt;bytes  0.0))                    &rArr; (0     0 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes -0.0))                    &rArr; (128   0 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes  2.0))                    &rArr; (64    0 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes  6.5))                    &rArr; (64  208 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes -6.5))                    &rArr; (192 208 0 0)
     
     (bytes-&gt;list (ieee-float-&gt;bytes 11.754943508222875e-39))  &rArr; (  0 128 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes  5.877471754111438e-39))  &rArr; (  0  64 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes  1.401298464324817e-45))  &rArr; (  0   0 0 1)
     
     (bytes-&gt;list (ieee-float-&gt;bytes -inf.0))                  &rArr; (255 128 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes +inf.0))                  &rArr; (127 128 0 0)
     (bytes-&gt;list (ieee-float-&gt;bytes  0/0))                    &rArr; (127 192 0 0)
</pre>
  <div class="defun">
&mdash; Function: <b>ieee-double-&gt;bytes</b><var> x<a name="index-ieee_002ddouble_002d_003ebytes-1336"></a></var><br>
<blockquote>
       <p>Returns a 8-element byte-array encoding the IEEE double-precision
floating-point of <var>x</var>. 
</p></blockquote></div>

<pre class="example">     (bytes-&gt;list (ieee-double-&gt;bytes  0.0)) &rArr; (0     0 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes -0.0)) &rArr; (128   0 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes  2.0)) &rArr; (64    0 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes  6.5)) &rArr; (64   26 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes -6.5)) &rArr; (192  26 0 0 0 0 0 0)
     
     (bytes-&gt;list (ieee-double-&gt;bytes 11.125369292536006e-309))
                                             &rArr; (  0   8 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes  5.562684646268003e-309))
                                             &rArr; (  0   4 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes  4.0e-324))
                                             &rArr; (  0   0 0 0 0 0 0 1)
     
     (bytes-&gt;list (ieee-double-&gt;bytes -inf.0)) &rArr; (255 240 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes +inf.0)) &rArr; (127 240 0 0 0 0 0 0)
     (bytes-&gt;list (ieee-double-&gt;bytes  0/0)) &rArr; (127 248 0 0 0 0 0 0)
</pre>
  <h5 class="subsubheading">Byte Collation Order</h5>

<p class="noindent">The <code>string&lt;?</code> ordering of big-endian byte-array
representations of fixed and IEEE floating-point numbers agrees with
the numerical ordering only when those numbers are non-negative.

<p class="noindent">Straighforward modification of these formats can extend the
byte-collating order to work for their entire ranges.  This
agreement enables the full range of numbers as keys in
<dfn>indexed-sequential-access-method</dfn> databases. 
<a name="index-indexed_002dsequential_002daccess_002dmethod-1337"></a>

<div class="defun">
&mdash; Procedure: <b>integer-byte-collate!</b><var> byte-vector<a name="index-integer_002dbyte_002dcollate_0021-1338"></a></var><br>
<blockquote>
       <p>Modifies sign bit of <var>byte-vector</var> so that <code>string&lt;?</code> ordering of
two's-complement byte-vectors matches numerical order.  <code>integer-byte-collate!</code> returns
<var>byte-vector</var> and is its own functional inverse. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-byte-collate</b><var> byte-vector<a name="index-integer_002dbyte_002dcollate-1339"></a></var><br>
<blockquote>
       <p>Returns copy of <var>byte-vector</var> with sign bit modified so that <code>string&lt;?</code>
ordering of two's-complement byte-vectors matches numerical order. 
<code>integer-byte-collate</code> is its own functional inverse. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>ieee-byte-collate!</b><var> byte-vector<a name="index-ieee_002dbyte_002dcollate_0021-1340"></a></var><br>
<blockquote>
       <p>Modifies <var>byte-vector</var> so that <code>string&lt;?</code> ordering of IEEE floating-point
byte-vectors matches numerical order.  <code>ieee-byte-collate!</code> returns <var>byte-vector</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>ieee-byte-decollate!</b><var> byte-vector<a name="index-ieee_002dbyte_002ddecollate_0021-1341"></a></var><br>
<blockquote>
       <p>Given <var>byte-vector</var> modified by <code>ieee-byte-collate!</code>, reverses the <var>byte-vector</var>
modifications. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ieee-byte-collate</b><var> byte-vector<a name="index-ieee_002dbyte_002dcollate-1342"></a></var><br>
<blockquote>
       <p>Returns copy of <var>byte-vector</var> encoded so that <code>string&lt;?</code> ordering of IEEE
floating-point byte-vectors matches numerical order. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ieee-byte-decollate</b><var> byte-vector<a name="index-ieee_002dbyte_002ddecollate-1343"></a></var><br>
<blockquote>
       <p>Given <var>byte-vector</var> returned by <code>ieee-byte-collate</code>, reverses the <var>byte-vector</var>
modifications. 
</p></blockquote></div>

<div class="node">
<a name="MAT-File-Format"></a>
<a name="MAT_002dFile-Format"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Portable-Image-Files">Portable Image Files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.8 MAT-File Format</h4>

<p><code>(require 'matfile)</code>
<a name="index-matfile-1344"></a><a name="index-matlab-1345"></a>
<a href="http://www.mathworks.com/access/helpdesk/help/pdf_doc/matlab/matfile_format.pdf">http://www.mathworks.com/access/helpdesk/help/pdf_doc/matlab/matfile_format.pdf</a>

<p class="noindent">This package reads MAT-File Format version 4 (MATLAB) binary data
files.  MAT-files written from big-endian or little-endian computers
having IEEE format numbers are currently supported.  Support for files
written from VAX or Cray machines could also be added.

<p class="noindent">The numeric and text matrix types handled; support for <dfn>sparse</dfn>
<a name="index-sparse-1346"></a>matrices awaits a sample file.

<div class="defun">
&mdash; Function: <b>matfile:read</b><var> filename<a name="index-matfile_003aread-1347"></a></var><br>
<blockquote><p><var>filename</var> should be a string naming an existing file containing a
MATLAB Version 4 MAT-File.  The <code>matfile:read</code> procedure reads matrices from the
file and returns a list of the results; a list of the name string and
array for each matrix. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>matfile:load</b><var> filename<a name="index-matfile_003aload-1348"></a></var><br>
<blockquote><p><var>filename</var> should be a string naming an existing file containing a
MATLAB Version 4 MAT-File.  The <code>matfile:load</code> procedure reads matrices from the
file and defines the <code>string-ci-&gt;symbol</code> for each matrix to its
corresponding array.  <code>matfile:load</code> returns a list of the symbols defined. 
</p></blockquote></div>

<div class="node">
<a name="Portable-Image-Files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Collections">Collections</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#MAT_002dFile-Format">MAT-File Format</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.9 Portable Image Files</h4>

<p><code>(require 'pnm)</code>
<a name="index-pnm-1349"></a>

<div class="defun">
&mdash; Function: <b>pnm:type-dimensions</b><var> path<a name="index-pnm_003atype_002ddimensions-1350"></a></var><br>
<blockquote>
       <p>The string <var>path</var> must name a <dfn>portable bitmap graphics</dfn> file. 
<a name="index-portable-bitmap-graphics-1351"></a><code>pnm:type-dimensions</code> returns a list of 4 items:
          <ol type=1 start=1>
<li>A symbol describing the type of the file named by <var>path</var>. 
<li>The image width in pixels. 
<li>The image height in pixels. 
<li>The maximum value of pixels assume in the file.
            </ol>

       <p>The current set of file-type symbols is:
          <dl>
<dt>pbm<dt>pbm-raw<dd><a name="index-pbm-1352"></a><a name="index-pbm_002draw-1353"></a>Black-and-White image; pixel values are 0 or 1. 
<br><dt>pgm<dt>pgm-raw<dd><a name="index-pgm-1354"></a><a name="index-pgm_002draw-1355"></a>Gray (monochrome) image; pixel values are from 0 to <var>maxval</var>
specified in file header. 
<br><dt>ppm<dt>ppm-raw<dd><a name="index-ppm-1356"></a><a name="index-ppm_002draw-1357"></a>RGB (full color) image; red, green, and blue interleaved pixel values
are from 0 to <var>maxval</var>
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pnm:image-file-&gt;array</b><var> path array<a name="index-pnm_003aimage_002dfile_002d_003earray-1358"></a></var><br>
<blockquote>
       <p>Reads the <dfn>portable bitmap graphics</dfn> file named by <var>path</var> into
<a name="index-portable-bitmap-graphics-1359"></a><var>array</var>.  <var>array</var> must be the correct size and type for
<var>path</var>.  <var>array</var> is returned.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>pnm:image-file-&gt;array</b><var> path<a name="index-pnm_003aimage_002dfile_002d_003earray-1360"></a></var><br>
<blockquote>
       <p><code>pnm:image-file-&gt;array</code> creates and returns an array with the
<dfn>portable bitmap graphics</dfn> file named by <var>path</var> read into it. 
<a name="index-portable-bitmap-graphics-1361"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pnm:array-write</b><var> type array maxval path comment <small class="dots">...</small><a name="index-pnm_003aarray_002dwrite-1362"></a></var><br>
<blockquote>
       <p>Writes the contents of <var>array</var> to a <var>type</var> image file named <var>path</var>.  The file
will have pixel values between 0 and <var>maxval</var>, which must be compatible
with <var>type</var>.  For &lsquo;<samp><span class="samp">pbm</span></samp>&rsquo; files, <var>maxval</var> must be &lsquo;<samp><span class="samp">1</span></samp>&rsquo;. 
<var>comment</var>s are included in the file header. 
</p></blockquote></div>

<div class="node">
<a name="Collections"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Dynamic-Data-Type">Dynamic Data Type</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Portable-Image-Files">Portable Image Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.10 Collections</h4>

<!-- Much of the documentation in this section was written by Dave Love -->
<!-- (d.love@dl.ac.uk) - don't blame Ken Dickey for its faults. -->
<!-- but we can blame him for not writing it! -->
<p><code>(require 'collect)</code>
<a name="index-collect-1363"></a>
Routines for managing collections.  Collections are aggregate data
structures supporting iteration over their elements, similar to the
Dylan(TM) language, but with a different interface.  They have
<dfn>elements</dfn> indexed by corresponding <dfn>keys</dfn>, although the keys
may be implicit (as with lists).

<p class="noindent">New types of collections may be defined as YASOS objects (see <a href="#Yasos">Yasos</a>). 
They must support the following operations:

     <ul>
<li><code>(collection? </code><var>self</var><code>)</code> (always returns <code>#t</code>);

     <li><code>(size </code><var>self</var><code>)</code> returns the number of elements in the collection;

     <li><code>(print </code><var>self</var> <var>port</var><code>)</code> is a specialized print operation
for the collection which prints a suitable representation on the given
<var>port</var> or returns it as a string if <var>port</var> is <code>#t</code>;

     <li><a name="index-gen_002delts-1364"></a><code>(gen-elts </code><var>self</var><code>)</code> returns a thunk which on successive
invocations yields elements of <var>self</var> in order or gives an error if
it is invoked more than <code>(size </code><var>self</var><code>)</code> times;

     <li><a name="index-gen_002dkeys-1365"></a><code>(gen-keys </code><var>self</var><code>)</code> is like <code>gen-elts</code>, but yields the
collection's keys in order. 
</ul>

<p class="noindent">They might support specialized <code>for-each-key</code> and
<code>for-each-elt</code> operations.

<div class="defun">
&mdash; Function: <b>collection?</b><var> obj<a name="index-collection_003f-1366"></a></var><br>
<blockquote><p>A predicate, true initially of lists, vectors and strings.  New sorts of
collections must answer <code>#t</code> to <code>collection?</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>map-elts</b><var> proc collection1 <small class="dots">...</small><a name="index-map_002delts-1367"></a></var><br>
&mdash; Procedure: <b>do-elts</b><var> proc collection1 <small class="dots">...</small><a name="index-do_002delts-1368"></a></var><br>
<blockquote><p><var>proc</var> is a procedure taking as many arguments as there are
<var>collections</var> (at least one).  The <var>collections</var> are iterated
over in their natural order and <var>proc</var> is applied to the elements
yielded by each iteration in turn.  The order in which the arguments are
supplied corresponds to te order in which the <var>collections</var> appear. 
<code>do-elts</code> is used when only side-effects of <var>proc</var> are of
interest and its return value is unspecified.  <code>map-elts</code> returns a
collection (actually a vector) of the results of the applications of
<var>proc</var>.

       <p>Example:
     <pre class="lisp">          (map-elts + (list 1 2 3) (vector 1 2 3))
             &rArr; #(2 4 6)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>map-keys</b><var> proc collection1 <small class="dots">...</small><a name="index-map_002dkeys-1369"></a></var><br>
&mdash; Procedure: <b>do-keys</b><var> proc collection1 <small class="dots">...</small><a name="index-do_002dkeys-1370"></a></var><br>
<blockquote><p>These are analogous to <code>map-elts</code> and <code>do-elts</code>, but each
iteration is over the <var>collections</var>' <em>keys</em> rather than their
elements.

       <p>Example:
     <pre class="lisp">          (map-keys + (list 1 2 3) (vector 1 2 3))
             &rArr; #(0 2 4)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>for-each-key</b><var> collection proc<a name="index-for_002deach_002dkey-1371"></a></var><br>
&mdash; Procedure: <b>for-each-elt</b><var> collection proc<a name="index-for_002deach_002delt-1372"></a></var><br>
<blockquote><p>These are like <code>do-keys</code> and <code>do-elts</code> but only for a single
collection; they are potentially more efficient. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>reduce</b><var> proc seed collection1 <small class="dots">...</small><a name="index-reduce-1373"></a></var><br>
<blockquote><p>A generalization of the list-based <code>reduce-init</code>
(see <a href="#Lists-as-sequences">Lists as sequences</a>) to collections.

       <p>Examples:
     <pre class="lisp">          (reduce + 0 (vector 1 2 3))
             &rArr; 6
          (reduce union '() '((a b c) (b c d) (d a)))
             &rArr; (c b d a).
</pre>
       <p><code>Reduce</code> called with two arguments will work as does the
procedure of the same name from See <a href="#Common-List-Functions">Common List Functions</a>. 
<a name="index-common_002dlist_002dfunctions-1374"></a></p></blockquote></div>

<div class="defun">
&mdash; Function: <b>any?</b><var> pred collection1 <small class="dots">...</small><a name="index-any_003f-1375"></a></var><br>
<blockquote><p>A generalization of the list-based <code>some</code>
(see <a href="#Lists-as-sequences">Lists as sequences</a>) to collections.

       <p>Example:
     <pre class="lisp">          (any? odd? (list 2 3 4 5))
             &rArr; #t
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>every?</b><var> pred collection1 <small class="dots">...</small><a name="index-every_003f-1376"></a></var><br>
<blockquote><p>A generalization of the list-based <code>every</code>
(see <a href="#Lists-as-sequences">Lists as sequences</a>) to collections.

       <p>Example:
     <pre class="lisp">          (every? collection? '((1 2) #(1 2)))
             &rArr; #t
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>empty?</b><var> collection<a name="index-empty_003f-1377"></a></var><br>
<blockquote><p>Returns <code>#t</code> iff there are no elements in <var>collection</var>.

       <p><code>(empty? </code><var>collection</var><code>) == (zero? (size </code><var>collection</var><code>))</code>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>size</b><var> collection<a name="index-size-1378"></a></var><br>
<blockquote><p>Returns the number of elements in <var>collection</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>Setter</b><var> list-ref<a name="index-Setter-1379"></a></var><br>
<blockquote><p>See <a href="#Setters">Setters</a> for a definition of <dfn>setter</dfn>.  N.B. 
<code>(setter list-ref)</code> doesn't work properly for element 0 of a
list. 
</p></blockquote></div>

  <p>Here is a sample collection: <code>simple-table</code> which is also a
<code>table</code>.
<pre class="lisp">     (define-predicate TABLE?)
     (define-operation (LOOKUP table key failure-object))
     (define-operation (ASSOCIATE! table key value)) ;; returns key
     (define-operation (REMOVE! table key))          ;; returns value
     
     (define (MAKE-SIMPLE-TABLE)
       (let ( (table (list)) )
         (object
          ;; table behaviors
          ((TABLE? self) #t)
          ((SIZE self) (size table))
          ((PRINT self port) (format port "#&lt;SIMPLE-TABLE&gt;"))
          ((LOOKUP self key failure-object)
           (cond
            ((assq key table) =&gt; cdr)
            (else failure-object)
            ))
          ((ASSOCIATE! self key value)
           (cond
            ((assq key table)
             =&gt; (lambda (bucket) (set-cdr! bucket value) key))
            (else
             (set! table (cons (cons key value) table))
             key)
            ))
          ((REMOVE! self key);; returns old value
           (cond
            ((null? table) (slib:error "TABLE:REMOVE! Key not found: " key))
            ((eq? key (caar table))
             (let ( (value (cdar table)) )
               (set! table (cdr table))
               value)
             )
            (else
             (let loop ( (last table) (this (cdr table)) )
               (cond
                ((null? this)
                 (slib:error "TABLE:REMOVE! Key not found: " key))
                ((eq? key (caar this))
                 (let ( (value (cdar this)) )
                   (set-cdr! last (cdr this))
                   value)
                 )
                (else
                 (loop (cdr last) (cdr this)))
                ) ) )
            ))
          ;; collection behaviors
          ((COLLECTION? self) #t)
          ((GEN-KEYS self) (collect:list-gen-elts (map car table)))
          ((GEN-ELTS self) (collect:list-gen-elts (map cdr table)))
          ((FOR-EACH-KEY self proc)
           (for-each (lambda (bucket) (proc (car bucket))) table)
           )
          ((FOR-EACH-ELT self proc)
           (for-each (lambda (bucket) (proc (cdr bucket))) table)
           ) ) ) )
</pre>
  <div class="node">
<a name="Dynamic-Data-Type"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Hash-Tables">Hash Tables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Collections">Collections</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.11 Dynamic Data Type</h4>

<p><code>(require 'dynamic)</code>
<a name="index-dynamic-1380"></a>

<div class="defun">
&mdash; Function: <b>make-dynamic</b><var> obj<a name="index-make_002ddynamic-1381"></a></var><br>
<blockquote><p>Create and returns a new <dfn>dynamic</dfn> whose global value is <var>obj</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>dynamic?</b><var> obj<a name="index-dynamic_003f-1382"></a></var><br>
<blockquote><p>Returns true if and only if <var>obj</var> is a dynamic.  No object
satisfying <code>dynamic?</code> satisfies any of the other standard type
predicates. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>dynamic-ref</b><var> dyn<a name="index-dynamic_002dref-1383"></a></var><br>
<blockquote><p>Return the value of the given dynamic in the current dynamic
environment. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>dynamic-set!</b><var> dyn obj<a name="index-dynamic_002dset_0021-1384"></a></var><br>
<blockquote><p>Change the value of the given dynamic to <var>obj</var> in the current
dynamic environment.  The returned value is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>call-with-dynamic-binding</b><var> dyn obj thunk<a name="index-call_002dwith_002ddynamic_002dbinding-1385"></a></var><br>
<blockquote><p>Invoke and return the value of the given thunk in a new, nested dynamic
environment in which the given dynamic has been bound to a new location
whose initial contents are the value <var>obj</var>.  This dynamic
environment has precisely the same extent as the invocation of the thunk
and is thus captured by continuations created within that invocation and
re-established by those continuations when they are invoked. 
</p></blockquote></div>

  <p>The <code>dynamic-bind</code> macro is not implemented.

<div class="node">
<a name="Hash-Tables"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Object">Object</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Dynamic-Data-Type">Dynamic Data Type</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.12 Hash Tables</h4>

<p><code>(require 'hash-table)</code>
<a name="index-hash_002dtable-1386"></a>

<div class="defun">
&mdash; Function: <b>predicate-&gt;hash</b><var> pred<a name="index-predicate_002d_003ehash-1387"></a></var><br>
<blockquote>
       <p>Returns a hash function (like <code>hashq</code>, <code>hashv</code>, or
<code>hash</code>) corresponding to the equality predicate <var>pred</var>. 
<var>pred</var> should be <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, <code>=</code>,
<code>char=?</code>, <code>char-ci=?</code>, <code>string=?</code>, or
<code>string-ci=?</code>. 
</p></blockquote></div>

<p class="noindent">A hash table is a vector of association lists.

<div class="defun">
&mdash; Function: <b>make-hash-table</b><var> k<a name="index-make_002dhash_002dtable-1388"></a></var><br>
<blockquote>
       <p>Returns a vector of <var>k</var> empty (association) lists. 
</p></blockquote></div>

<p class="noindent">Hash table functions provide utilities for an associative database. 
These functions take an equality predicate, <var>pred</var>, as an argument. 
<var>pred</var> should be <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, <code>=</code>,
<code>char=?</code>, <code>char-ci=?</code>, <code>string=?</code>, or
<code>string-ci=?</code>.

<div class="defun">
&mdash; Function: <b>predicate-&gt;hash-asso</b><var> pred<a name="index-predicate_002d_003ehash_002dasso-1389"></a></var><br>
<blockquote>
       <p>Returns a hash association function of 2 arguments, <var>key</var> and
<var>hashtab</var>, corresponding to <var>pred</var>.  The returned function
returns a key-value pair whose key is <var>pred</var>-equal to its first
argument or <code>#f</code> if no key in <var>hashtab</var> is <var>pred</var>-equal to
the first argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>hash-inquirer</b><var> pred<a name="index-hash_002dinquirer-1390"></a></var><br>
<blockquote>
       <p>Returns a procedure of 2 arguments, <var>hashtab</var> and <var>key</var>, which
returns the value associated with <var>key</var> in <var>hashtab</var> or
<code>#f</code> if <var>key</var> does not appear in <var>hashtab</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>hash-associator</b><var> pred<a name="index-hash_002dassociator-1391"></a></var><br>
<blockquote>
       <p>Returns a procedure of 3 arguments, <var>hashtab</var>, <var>key</var>, and
<var>value</var>, which modifies <var>hashtab</var> so that <var>key</var> and
<var>value</var> associated.  Any previous value associated with <var>key</var>
will be lost. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>hash-remover</b><var> pred<a name="index-hash_002dremover-1392"></a></var><br>
<blockquote>
       <p>Returns a procedure of 2 arguments, <var>hashtab</var> and <var>key</var>, which
modifies <var>hashtab</var> so that the association whose key is <var>key</var> is
removed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>hash-map</b><var> proc hash-table<a name="index-hash_002dmap-1393"></a></var><br>
<blockquote>
       <p>Returns a new hash table formed by mapping <var>proc</var> over the
keys and values of <var>hash-table</var>.  <var>proc</var> must be a function of 2
arguments which returns the new value part. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>hash-for-each</b><var> proc hash-table<a name="index-hash_002dfor_002deach-1394"></a></var><br>
<blockquote>
       <p>Applies <var>proc</var> to each pair of keys and values of <var>hash-table</var>. 
<var>proc</var> must be a function of 2 arguments.  The returned value is
unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>hash-rehasher</b><var> pred<a name="index-hash_002drehasher-1395"></a></var><br>
<blockquote>
       <p><code>hash-rehasher</code> accepts a hash table predicate and returns a function of two
arguments <var>hashtab</var> and <var>new-k</var> which is specialized for
that predicate.

       <p>This function is used for nondestrutively resizing a hash table. 
<var>hashtab</var> should be an existing hash-table using <var>pred</var>, <var>new-k</var>
is the size of a new hash table to be returned.  The new hash table
will have all of the associations of the old hash table. 
</p></blockquote></div>

<div class="node">
<a name="Object"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Priority-Queues">Priority Queues</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Hash-Tables">Hash Tables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.13 Macroless Object System</h4>

<p><code>(require 'object)</code>
<a name="index-object-1396"></a>
This is the Macroless Object System written by Wade Humeniuk
(whumeniu@datap.ca).  Conceptual Tributes: <a href="#Yasos">Yasos</a>, MacScheme's
%object, CLOS, Lack of R4RS macros.

<h4 class="subsection">7.1.14 Concepts</h4>

     <dl>
<dt>OBJECT<dd>An object is an ordered association-list (by <code>eq?</code>) of methods
(procedures).  Methods can be added (<code>make-method!</code>), deleted
(<code>unmake-method!</code>) and retrieved (<code>get-method</code>).  Objects may
inherit methods from other objects.  The object binds to the environment
it was created in, allowing closures to be used to hide private
procedures and data.

     <br><dt>GENERIC-METHOD<dd>A generic-method associates (in terms of <code>eq?</code>) object's method. 
This allows scheme function style to be used for objects.  The calling
scheme for using a generic method is <code>(generic-method object param1
param2 ...)</code>.

     <br><dt>METHOD<dd>A method is a procedure that exists in the object.  To use a method
get-method must be called to look-up the method.  Generic methods
implement the get-method functionality.  Methods may be added to an
object associated with any scheme obj in terms of eq?

     <br><dt>GENERIC-PREDICATE<dd>A generic method that returns a boolean value for any scheme obj.

     <br><dt>PREDICATE<dd>A object's method asscociated with a generic-predicate. Returns
<code>#t</code>. 
</dl>

<h4 class="subsection">7.1.15 Procedures</h4>

<div class="defun">
&mdash; Function: <b>make-object</b><var> ancestor <small class="dots">...</small><a name="index-make_002dobject-1397"></a></var><br>
<blockquote><p>Returns an object.  Current object implementation is a tagged vector. 
<var>ancestor</var>s are optional and must be objects in terms of object?. 
<var>ancestor</var>s methods are included in the object.  Multiple
<var>ancestor</var>s might associate the same generic-method with a method. 
In this case the method of the <var>ancestor</var> first appearing in the
list is the one returned by <code>get-method</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>object?</b><var> obj<a name="index-object_003f-1398"></a></var><br>
<blockquote><p>Returns boolean value whether <var>obj</var> was created by make-object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-generic-method</b><var> exception-procedure<a name="index-make_002dgeneric_002dmethod-1399"></a></var><br>
<blockquote><p>Returns a procedure which be associated with an object's methods.  If
<var>exception-procedure</var> is specified then it is used to process
non-objects. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-generic-predicate</b><var><a name="index-make_002dgeneric_002dpredicate-1400"></a></var><br>
<blockquote><p>Returns a boolean procedure for any scheme object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-method!</b><var> object generic-method method<a name="index-make_002dmethod_0021-1401"></a></var><br>
<blockquote><p>Associates <var>method</var> to the <var>generic-method</var> in the object.  The
<var>method</var> overrides any previous association with the
<var>generic-method</var> within the object.  Using <code>unmake-method!</code>
will restore the object's previous association with the
<var>generic-method</var>.  <var>method</var> must be a procedure. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-predicate!</b><var> object generic-preciate<a name="index-make_002dpredicate_0021-1402"></a></var><br>
<blockquote><p>Makes a predicate method associated with the <var>generic-predicate</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>unmake-method!</b><var> object generic-method<a name="index-unmake_002dmethod_0021-1403"></a></var><br>
<blockquote><p>Removes an object's association with a <var>generic-method</var> . 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>get-method</b><var> object generic-method<a name="index-get_002dmethod-1404"></a></var><br>
<blockquote><p>Returns the object's method associated (if any) with the
<var>generic-method</var>.  If no associated method exists an error is
flagged. 
</p></blockquote></div>

<h4 class="subsection">7.1.16 Examples</h4>

<pre class="example">     (require 'object)
     <a name="index-object-1405"></a>
     (define instantiate (make-generic-method))
     
     (define (make-instance-object . ancestors)
       (define self (apply make-object
                           (map (lambda (obj) (instantiate obj)) ancestors)))
       (make-method! self instantiate (lambda (self) self))
       self)
     
     (define who (make-generic-method))
     (define imigrate! (make-generic-method))
     (define emigrate! (make-generic-method))
     (define describe (make-generic-method))
     (define name (make-generic-method))
     (define address (make-generic-method))
     (define members (make-generic-method))
     
     (define society
       (let ()
         (define self (make-instance-object))
         (define population '())
         (make-method! self imigrate!
                       (lambda (new-person)
                         (if (not (eq? new-person self))
                             (set! population (cons new-person population)))))
         (make-method! self emigrate!
                       (lambda (person)
                         (if (not (eq? person self))
                             (set! population
                                   (comlist:remove-if (lambda (member)
                                                        (eq? member person))
                                                      population)))))
         (make-method! self describe
                       (lambda (self)
                         (map (lambda (person) (describe person)) population)))
         (make-method! self who
                       (lambda (self) (map (lambda (person) (name person))
                                           population)))
         (make-method! self members (lambda (self) population))
         self))
     
     (define (make-person %name %address)
       (define self (make-instance-object society))
       (make-method! self name (lambda (self) %name))
       (make-method! self address (lambda (self) %address))
       (make-method! self who (lambda (self) (name self)))
       (make-method! self instantiate
                     (lambda (self)
                       (make-person (string-append (name self) "-son-of")
                                    %address)))
       (make-method! self describe
                     (lambda (self) (list (name self) (address self))))
       (imigrate! self)
       self)
</pre>
<h5 class="subsubsection">7.1.16.1 Inverter Documentation</h5>

<p>Inheritance:
<pre class="lisp">             &lt;inverter&gt;::(&lt;number&gt; &lt;description&gt;)
</pre>
  <p>Generic-methods
<pre class="lisp">             &lt;inverter&gt;::value      &rArr; &lt;number&gt;::value
             &lt;inverter&gt;::set-value! &rArr; &lt;number&gt;::set-value!
             &lt;inverter&gt;::describe   &rArr; &lt;description&gt;::describe
             &lt;inverter&gt;::help
             &lt;inverter&gt;::invert
             &lt;inverter&gt;::inverter?
</pre>
  <h5 class="subsubsection">7.1.16.2 Number Documention</h5>

<p>Inheritance
<pre class="lisp">             &lt;number&gt;::()
</pre>
  <p>Slots
<pre class="lisp">             &lt;number&gt;::&lt;x&gt;
</pre>
  <p>Generic Methods
<pre class="lisp">             &lt;number&gt;::value
             &lt;number&gt;::set-value!
</pre>
  <h5 class="subsubsection">7.1.16.3 Inverter code</h5>

<pre class="example">     (require 'object)
     <a name="index-object-1406"></a>
     (define value (make-generic-method (lambda (val) val)))
     (define set-value! (make-generic-method))
     (define invert (make-generic-method
                     (lambda (val)
                       (if (number? val)
                           (/ 1 val)
                           (error "Method not supported:" val)))))
     (define noop (make-generic-method))
     (define inverter? (make-generic-predicate))
     (define describe (make-generic-method))
     (define help (make-generic-method))
     
     (define (make-number x)
       (define self (make-object))
       (make-method! self value (lambda (this) x))
       (make-method! self set-value!
                     (lambda (this new-value) (set! x new-value)))
       self)
     
     (define (make-description str)
       (define self (make-object))
       (make-method! self describe (lambda (this) str))
       (make-method! self help (lambda (this) "Help not available"))
       self)
     
     (define (make-inverter)
       (let* ((self (make-object
                     (make-number 1)
                     (make-description "A number which can be inverted")))
              (&lt;value&gt; (get-method self value)))
         (make-method! self invert (lambda (self) (/ 1 (&lt;value&gt; self))))
         (make-predicate! self inverter?)
         (unmake-method! self help)
         (make-method! self help
                       (lambda (self)
                         (display "Inverter Methods:") (newline)
                         (display "  (value inverter) ==&gt; n") (newline)))
         self))
     
     ;;;; Try it out
     
     (define invert! (make-generic-method))
     
     (define x (make-inverter))
     
     (make-method! x invert! (lambda (x) (set-value! x (/ 1 (value x)))))
     
     (value x)                       &rArr; 1
     (set-value! x 33)               &rArr; undefined
     (invert! x)                     &rArr; undefined
     (value x)                       &rArr; 1/33
     
     (unmake-method! x invert!)      &rArr; undefined
     
     (invert! x)                     error--&gt;  ERROR: Method not supported: x
</pre>
<div class="node">
<a name="Priority-Queues"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Queues">Queues</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Object">Object</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.17 Priority Queues</h4>

<p><code>(require 'priority-queue)</code>
<a name="index-priority_002dqueue-1407"></a>
This algorithm for priority queues is due to
<cite>Introduction to Algorithms</cite>
by T. Cormen, C. Leiserson, R. Rivest. 
1989 MIT Press.

<div class="defun">
&mdash; Function: <b>make-heap</b><var> pred&lt;?<a name="index-make_002dheap-1408"></a></var><br>
<blockquote>
       <p>Returns a binary heap suitable which can be used for priority queue
operations. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>heap-length</b><var> heap<a name="index-heap_002dlength-1409"></a></var><br>
<blockquote>
       <p>Returns the number of elements in <var>heap</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>heap-insert!</b><var> heap item<a name="index-heap_002dinsert_0021-1410"></a></var><br>
<blockquote>
       <p>Inserts <var>item</var> into <var>heap</var>.  <var>item</var> can be inserted multiple
times.  The value returned is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>heap-extract-max!</b><var> heap<a name="index-heap_002dextract_002dmax_0021-1411"></a></var><br>
<blockquote>
       <p>Returns the item which is larger than all others according to the
<var>pred&lt;?</var> argument to <code>make-heap</code>.  If there are no items in
<var>heap</var>, an error is signaled. 
</p></blockquote></div>

<div class="node">
<a name="Queues"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Records">Records</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Priority-Queues">Priority Queues</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.18 Queues</h4>

<p><code>(require 'queue)</code>
<a name="index-queue-1412"></a>
A <dfn>queue</dfn> is a list where elements can be added to both the front
<a name="index-queue-1413"></a>and rear, and removed from the front (i.e., they are what are often
called <dfn>dequeues</dfn>).  A queue may also be used like a stack. 
<a name="index-dequeues-1414"></a>

<div class="defun">
&mdash; Function: <b>make-queue</b><var><a name="index-make_002dqueue-1415"></a></var><br>
<blockquote>
       <p>Returns a new, empty queue. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>queue?</b><var> obj<a name="index-queue_003f-1416"></a></var><br>
<blockquote>
       <p>Returns <code>#t</code> if <var>obj</var> is a queue. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>queue-empty?</b><var> q<a name="index-queue_002dempty_003f-1417"></a></var><br>
<blockquote>
       <p>Returns <code>#t</code> if the queue <var>q</var> is empty. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>queue-push!</b><var> q datum<a name="index-queue_002dpush_0021-1418"></a></var><br>
<blockquote>
       <p>Adds <var>datum</var> to the front of queue <var>q</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>enqueue!</b><var> q datum<a name="index-enqueue_0021-1419"></a></var><br>
<blockquote>
       <p>Adds <var>datum</var> to the rear of queue <var>q</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>dequeue!</b><var> q<a name="index-dequeue_0021-1420"></a></var><br>

  &mdash; Procedure: <b>queue-pop!</b><var> q<a name="index-queue_002dpop_0021-1421"></a></var><br>
<blockquote><p>Both of these procedures remove and return the datum at the front of
the queue.  <code>queue-pop!</code> is used to suggest that the queue is
being used like a stack. 
</p></blockquote></div>

  <p>All of the following functions raise an error if the queue <var>q</var>
is empty.

<div class="defun">
&mdash; Procedure: <b>dequeue-all!</b><var> q<a name="index-dequeue_002dall_0021-1422"></a></var><br>
<blockquote>
       <p>Removes and returns (the list) of all contents of queue <var>q</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>queue-front</b><var> q<a name="index-queue_002dfront-1423"></a></var><br>
<blockquote>
       <p>Returns the datum at the front of the queue <var>q</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>queue-rear</b><var> q<a name="index-queue_002drear-1424"></a></var><br>
<blockquote>
       <p>Returns the datum at the rear of the queue <var>q</var>. 
</p></blockquote></div>

<div class="node">
<a name="Records"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Queues">Queues</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Data-Structures">Data Structures</a>

</div>

<h4 class="subsection">7.1.19 Records</h4>

<p><code>(require 'record)</code>
<a name="index-record-1425"></a>
The Record package provides a facility for user to define their own
record data types.

<div class="defun">
&mdash; Function: <b>make-record-type</b><var> type-name field-names<a name="index-make_002drecord_002dtype-1426"></a></var><br>
<blockquote><p>Returns a <dfn>record-type descriptor</dfn>, a value representing a new data
type disjoint from all others.  The <var>type-name</var> argument must be a
string, but is only used for debugging purposes (such as the printed
representation of a record of the new type).  The <var>field-names</var>
argument is a list of symbols naming the <dfn>fields</dfn> of a record of the
new type.  It is an error if the list contains any duplicates.  It is
unspecified how record-type descriptors are represented. 
</p></blockquote></div>

<!-- @defun make-record-sub-type type-name field-names rtd -->
<!-- Returns a @dfn{record-type descriptor}, a value representing a new data -->
<!-- type, disjoint from all others.  The @var{type-name} argument must be a -->
<!-- string.  The @var{field-names} argument is a list of symbols naming the -->
<!-- additional @dfn{fields} to be appended to @var{field-names} of -->
<!-- @var{rtd}.  It is an error if the combined list contains any -->
<!-- duplicates. -->
<!-- Record-modifiers and record-accessors for @var{rtd} work for the new -->
<!-- record-sub-type as well.  But record-modifiers and record-accessors for -->
<!-- the new record-sub-type will not neccessarily work for @var{rtd}. -->
<!-- @end defun -->
<div class="defun">
&mdash; Function: <b>record-constructor</b><var> rtd </var>[<var>field-names</var>]<var><a name="index-record_002dconstructor-1427"></a></var><br>
<blockquote><p>Returns a procedure for constructing new members of the type represented
by <var>rtd</var>.  The returned procedure accepts exactly as many arguments
as there are symbols in the given list, <var>field-names</var>; these are
used, in order, as the initial values of those fields in a new record,
which is returned by the constructor procedure.  The values of any
fields not named in that list are unspecified.  The <var>field-names</var>
argument defaults to the list of field names in the call to
<code>make-record-type</code> that created the type represented by <var>rtd</var>;
if the <var>field-names</var> argument is provided, it is an error if it
contains any duplicates or any symbols not in the default list. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>record-predicate</b><var> rtd<a name="index-record_002dpredicate-1428"></a></var><br>
<blockquote><p>Returns a procedure for testing membership in the type represented by
<var>rtd</var>.  The returned procedure accepts exactly one argument and
returns a true value if the argument is a member of the indicated record
type; it returns a false value otherwise. 
</p></blockquote></div>

<!-- @defun record-sub-predicate rtd -->
<!-- Returns a procedure for testing membership in the type represented by -->
<!-- @var{rtd} or its parents.  The returned procedure accepts exactly one -->
<!-- argument and returns a true value if the argument is a member of the -->
<!-- indicated record type or its parents; it returns a false value -->
<!-- otherwise. -->
<!-- @end defun -->
<div class="defun">
&mdash; Function: <b>record-accessor</b><var> rtd field-name<a name="index-record_002daccessor-1429"></a></var><br>
<blockquote><p>Returns a procedure for reading the value of a particular field of a
member of the type represented by <var>rtd</var>.  The returned procedure
accepts exactly one argument which must be a record of the appropriate
type; it returns the current value of the field named by the symbol
<var>field-name</var> in that record.  The symbol <var>field-name</var> must be a
member of the list of field-names in the call to <code>make-record-type</code>
that created the type represented by <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>record-modifier</b><var> rtd field-name<a name="index-record_002dmodifier-1430"></a></var><br>
<blockquote><p>Returns a procedure for writing the value of a particular field of a
member of the type represented by <var>rtd</var>.  The returned procedure
accepts exactly two arguments: first, a record of the appropriate type,
and second, an arbitrary Scheme value; it modifies the field named by
the symbol <var>field-name</var> in that record to contain the given value. 
The returned value of the modifier procedure is unspecified.  The symbol
<var>field-name</var> must be a member of the list of field-names in the call
to <code>make-record-type</code> that created the type represented by
<var>rtd</var>. 
</p></blockquote></div>

  <p>In May of 1996, as a product of discussion on the <code>rrrs-authors</code>
mailing list, I rewrote <samp><span class="file">record.scm</span></samp> to portably implement type
disjointness for record data types.

  <p>As long as an implementation's procedures are opaque and the
<code>record</code> code is loaded before other programs, this will give
disjoint record types which are unforgeable and incorruptible by R4RS
procedures.

  <p>As a consequence, the procedures <code>record?</code>,
<code>record-type-descriptor</code>, <code>record-type-name</code>.and
<code>record-type-field-names</code> are no longer supported.

<div class="node">
<a name="Sorting-and-Searching"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Procedures">Procedures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Data-Structures">Data Structures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Packages">Other Packages</a>

</div>

<h3 class="section">7.2 Sorting and Searching</h3>

<ul class="menu">
<li><a accesskey="1" href="#Common-List-Functions">Common List Functions</a>:        'common-list-functions
<li><a accesskey="2" href="#Tree-Operations">Tree Operations</a>:              'tree
<li><a accesskey="3" href="#Chapter-Ordering">Chapter Ordering</a>:             'chapter-order
<li><a accesskey="4" href="#Sorting">Sorting</a>:                      'sort
<li><a accesskey="5" href="#Topological-Sort">Topological Sort</a>:             Keep your socks on. 
<li><a accesskey="6" href="#Hashing">Hashing</a>:                      'hash
<li><a accesskey="7" href="#Space_002dFilling-Curves">Space-Filling Curves</a>:         'space-filling and 'sierpinski
<li><a accesskey="8" href="#Soundex">Soundex</a>:                      Dimension Reduction of Last Names
<li><a accesskey="9" href="#String-Search">String Search</a>:                Also Search from a Port. 
<li><a href="#Sequence-Comparison">Sequence Comparison</a>:          'diff and longest-common-subsequence
</ul>

<div class="node">
<a name="Common-List-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Tree-Operations">Tree Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Sorting-and-Searching">Sorting and Searching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.1 Common List Functions</h4>

<p><code>(require 'common-list-functions)</code>
<a name="index-common_002dlist_002dfunctions-1431"></a>
The procedures below follow the Common LISP equivalents apart from
optional arguments in some cases.

<ul class="menu">
<li><a accesskey="1" href="#List-construction">List construction</a>
<li><a accesskey="2" href="#Lists-as-sets">Lists as sets</a>
<li><a accesskey="3" href="#Lists-as-sequences">Lists as sequences</a>
<li><a accesskey="4" href="#Destructive-list-operations">Destructive list operations</a>
<li><a accesskey="5" href="#Non_002dList-functions">Non-List functions</a>
</ul>

<div class="node">
<a name="List-construction"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Lists-as-sets">Lists as sets</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Common-List-Functions">Common List Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Common-List-Functions">Common List Functions</a>

</div>

<h5 class="subsubsection">7.2.1.1 List construction</h5>

<div class="defun">
&mdash; Function: <b>make-list</b><var> k<a name="index-make_002dlist-1432"></a></var><br>
&mdash; Function: <b>make-list</b><var> k init<a name="index-make_002dlist-1433"></a></var><br>
<blockquote><p><code>make-list</code> creates and returns a list of <var>k</var> elements.  If
<var>init</var> is included, all elements in the list are initialized to
<var>init</var>.

       <p>Example:
     <pre class="lisp">          (make-list 3)
             &rArr; (#&lt;unspecified&gt; #&lt;unspecified&gt; #&lt;unspecified&gt;)
          (make-list 5 'foo)
             &rArr; (foo foo foo foo foo)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>list*</b><var> obj1 obj2 <small class="dots">...</small><a name="index-list_002a-1434"></a></var><br>
<blockquote><p>Works like <code>list</code> except that the cdr of the last pair is the last
argument unless there is only one argument, when the result is just that
argument.  Sometimes called <code>cons*</code>.  E.g.:

     <pre class="lisp">          (list* 1)
             &rArr; 1
          (list* 1 2 3)
             &rArr; (1 2 . 3)
          (list* 1 2 '(3 4))
             &rArr; (1 2 3 4)
          (list* <var>args</var> '())
             == (list <var>args</var>)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>copy-list</b><var> lst<a name="index-copy_002dlist-1435"></a></var><br>
<blockquote><p><code>copy-list</code> makes a copy of <var>lst</var> using new pairs and returns
it. Only the top level of the list is copied, i.e., pairs forming
elements of the copied list remain <code>eq?</code> to the corresponding
elements of the original; the copy is, however, not <code>eq?</code> to the
original, but is <code>equal?</code> to it.

       <p>Example:
     <pre class="lisp">          (copy-list '(foo foo foo))
             &rArr; (foo foo foo)
          (define q '(foo bar baz bang))
          (define p q)
          (eq? p q)
             &rArr; #t
          (define r (copy-list q))
          (eq? q r)
             &rArr; #f
          (equal? q r)
             &rArr; #t
          (define bar '(bar))
          (eq? bar (car (copy-list (list bar 'foo))))
          &rArr; #t
</pre>
       </blockquote></div>

<div class="node">
<a name="Lists-as-sets"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Lists-as-sequences">Lists as sequences</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#List-construction">List construction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Common-List-Functions">Common List Functions</a>

</div>

<h5 class="subsubsection">7.2.1.2 Lists as sets</h5>

<p><code>eqv?</code> is used to test for membership by procedures which treat
lists as sets.

<div class="defun">
&mdash; Function: <b>adjoin</b><var> e l<a name="index-adjoin-1436"></a></var><br>
<blockquote><p><code>adjoin</code> returns the adjoint of the element <var>e</var> and the list
<var>l</var>.  That is, if <var>e</var> is in <var>l</var>, <code>adjoin</code> returns
<var>l</var>, otherwise, it returns <code>(cons </code><var>e</var> <var>l</var><code>)</code>.

       <p>Example:
     <pre class="lisp">          (adjoin 'baz '(bar baz bang))
             &rArr; (bar baz bang)
          (adjoin 'foo '(bar baz bang))
             &rArr; (foo bar baz bang)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>union</b><var> l1 l2<a name="index-union-1437"></a></var><br>
<blockquote><p><code>union</code> returns a list of all elements that are in <var>l1</var> or
<var>l2</var>.  Duplicates between <var>l1</var> and <var>l2</var> are culled. 
Duplicates within <var>l1</var> or within <var>l2</var> may or may not be
removed.

       <p>Example:
     <pre class="lisp">          (union '(1 2 3 4) '(5 6 7 8))
             &rArr; (1 2 3 4 5 6 7 8)
          (union '(0 1 2 3 4) '(3 4 5 6))
             &rArr; (5 6 0 1 2 3 4)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>intersection</b><var> l1 l2<a name="index-intersection-1438"></a></var><br>
<blockquote><p><code>intersection</code> returns a list of all elements that are in both
<var>l1</var> and <var>l2</var>.

       <p>Example:
     <pre class="lisp">          (intersection '(1 2 3 4) '(3 4 5 6))
             &rArr; (3 4)
          (intersection '(1 2 3 4) '(5 6 7 8))
             &rArr; ()
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>set-difference</b><var> l1 l2<a name="index-set_002ddifference-1439"></a></var><br>
<blockquote><p><code>set-difference</code> returns a list of all elements that are in
<var>l1</var> but not in <var>l2</var>.

       <p>Example:
     <pre class="lisp">          (set-difference '(1 2 3 4) '(3 4 5 6))
             &rArr; (1 2)
          (set-difference '(1 2 3 4) '(1 2 3 4 5 6))
             &rArr; ()
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>subset?</b><var> list1 list2<a name="index-subset_003f-1440"></a></var><br>
<blockquote><p>Returns <code>#t</code> if every element of <var>list1</var> is <code>eqv?</code> an
element of <var>list2</var>; otherwise returns <code>#f</code>.

       <p>Example:
     <pre class="lisp">          (subset? '(1 2 3 4) '(3 4 5 6))
             &rArr; #f
          (subset? '(1 2 3 4) '(6 5 4 3 2 1 0))
             &rArr; #t
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>member-if</b><var> pred lst<a name="index-member_002dif-1441"></a></var><br>
<blockquote><p><code>member-if</code> returns the list headed by the first element of
<var>lst</var> to satisfy <code>(</code><var>pred</var> <var>element</var><code>)</code>. 
<code>Member-if</code> returns <code>#f</code> if <var>pred</var> returns <code>#f</code> for
every <var>element</var> in <var>lst</var>.

       <p>Example:
     <pre class="lisp">          (member-if vector? '(a 2 b 4))
             &rArr; #f
          (member-if number? '(a 2 b 4))
             &rArr; (2 b 4)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>some</b><var> pred lst1 lst2 <small class="dots">...</small><a name="index-some-1442"></a></var><br>
<blockquote><p><var>pred</var> is a boolean function of as many arguments as there are list
arguments to <code>some</code> i.e., <var>lst</var> plus any optional arguments. 
<var>pred</var> is applied to successive elements of the list arguments in
order.  <code>some</code> returns <code>#t</code> as soon as one of these
applications returns <code>#t</code>, and is <code>#f</code> if none returns
<code>#t</code>.  All the lists should have the same length.

       <p>Example:
     <pre class="lisp">          (some odd? '(1 2 3 4))
             &rArr; #t
          
          (some odd? '(2 4 6 8))
             &rArr; #f
          
          (some &gt; '(1 3) '(2 4))
             &rArr; #f
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>every</b><var> pred lst1 lst2 <small class="dots">...</small><a name="index-every-1443"></a></var><br>
<blockquote><p><code>every</code> is analogous to <code>some</code> except it returns <code>#t</code> if
every application of <var>pred</var> is <code>#t</code> and <code>#f</code>
otherwise.

       <p>Example:
     <pre class="lisp">          (every even? '(1 2 3 4))
             &rArr; #f
          
          (every even? '(2 4 6 8))
             &rArr; #t
          
          (every &gt; '(2 3) '(1 4))
             &rArr; #f
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>notany</b><var> pred lst1 <small class="dots">...</small><a name="index-notany-1444"></a></var><br>
<blockquote><p><code>notany</code> is analogous to <code>some</code> but returns <code>#t</code> if no
application of <var>pred</var> returns <code>#t</code> or <code>#f</code> as soon as any
one does. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>notevery</b><var> pred lst1 <small class="dots">...</small><a name="index-notevery-1445"></a></var><br>
<blockquote><p><code>notevery</code> is analogous to <code>some</code> but returns <code>#t</code> as soon
as an application of <var>pred</var> returns <code>#f</code>, and <code>#f</code>
otherwise.

       <p>Example:
     <pre class="lisp">          (notevery even? '(1 2 3 4))
             &rArr; #t
          
          (notevery even? '(2 4 6 8))
             &rArr; #f
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>list-of??</b><var> predicate<a name="index-list_002dof_003f_003f-1446"></a></var><br>
<blockquote><p>Returns a predicate which returns true if its argument is a list every
element of which satisfies <var>predicate</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>list-of??</b><var> predicate low-bound high-bound<a name="index-list_002dof_003f_003f-1447"></a></var><br>
<blockquote><p><var>low-bound</var> and <var>high-bound</var> are non-negative integers. 
<code>list-of??</code> returns a predicate which returns true if its argument
is a list of length between <var>low-bound</var> and <var>high-bound</var>
(inclusive); every element of which satisfies <var>predicate</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>list-of??</b><var> predicate bound<a name="index-list_002dof_003f_003f-1448"></a></var><br>
<blockquote><p><var>bound</var> is an integer.  If <var>bound</var> is negative, <code>list-of??</code>
returns a predicate which returns true if its argument is a list of
length greater than <code>(- </code><var>bound</var><code>)</code>; every element of which
satisfies <var>predicate</var>.  Otherwise, <code>list-of??</code>  returns a
predicate which returns true if its argument is a list of length less
than or equal to <var>bound</var>; every element of which satisfies
<var>predicate</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>find-if</b><var> pred lst<a name="index-find_002dif-1449"></a></var><br>
<blockquote><p><code>find-if</code> searches for the first <var>element</var> in <var>lst</var> such
that <code>(</code><var>pred</var> <var>element</var><code>)</code> returns <code>#t</code>.  If it finds
any such <var>element</var> in <var>lst</var>, <var>element</var> is returned. 
Otherwise, <code>#f</code> is returned.

       <p>Example:
     <pre class="lisp">          (find-if number? '(foo 1 bar 2))
             &rArr; 1
          
          (find-if number? '(foo bar baz bang))
             &rArr; #f
          
          (find-if symbol? '(1 2 foo bar))
             &rArr; foo
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>remove</b><var> elt lst<a name="index-remove-1450"></a></var><br>
<blockquote><p><code>remove</code> removes all occurrences of <var>elt</var> from <var>lst</var> using
<code>eqv?</code> to test for equality and returns everything that's left. 
N.B.: other implementations (Chez, Scheme-&gt;C and T, at least) use
<code>equal?</code> as the equality test.

       <p>Example:
     <pre class="lisp">          (remove 1 '(1 2 1 3 1 4 1 5))
             &rArr; (2 3 4 5)
          
          (remove 'foo '(bar baz bang))
             &rArr; (bar baz bang)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>remove-if</b><var> pred lst<a name="index-remove_002dif-1451"></a></var><br>
<blockquote><p><code>remove-if</code> removes all <var>element</var>s from <var>lst</var> where
<code>(</code><var>pred</var> <var>element</var><code>)</code> is <code>#t</code> and returns everything
that's left.

       <p>Example:
     <pre class="lisp">          (remove-if number? '(1 2 3 4))
             &rArr; ()
          
          (remove-if even? '(1 2 3 4 5 6 7 8))
             &rArr; (1 3 5 7)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>remove-if-not</b><var> pred lst<a name="index-remove_002dif_002dnot-1452"></a></var><br>
<blockquote><p><code>remove-if-not</code> removes all <var>element</var>s from <var>lst</var> for which
<code>(</code><var>pred</var> <var>element</var><code>)</code> is <code>#f</code> and returns everything that's
left.

       <p>Example:
     <pre class="lisp">          (remove-if-not number? '(foo bar baz))
             &rArr; ()
          (remove-if-not odd? '(1 2 3 4 5 6 7 8))
             &rArr; (1 3 5 7)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>has-duplicates?</b><var> lst<a name="index-has_002dduplicates_003f-1453"></a></var><br>
<blockquote><p>returns <code>#t</code> if 2 members of <var>lst</var> are <code>equal?</code>, <code>#f</code>
otherwise.

       <p>Example:
     <pre class="lisp">          (has-duplicates? '(1 2 3 4))
             &rArr; #f
          
          (has-duplicates? '(2 4 3 4))
             &rArr; #t
</pre>
       </blockquote></div>

  <p>The procedure <code>remove-duplicates</code> uses <code>member</code> (rather than
<code>memv</code>).

<div class="defun">
&mdash; Function: <b>remove-duplicates</b><var> lst<a name="index-remove_002dduplicates-1454"></a></var><br>
<blockquote><p>returns a copy of <var>lst</var> with its duplicate members removed. 
Elements are considered duplicate if they are <code>equal?</code>.

       <p>Example:
     <pre class="lisp">          (remove-duplicates '(1 2 3 4))
             &rArr; (1 2 3 4)
          
          (remove-duplicates '(2 4 3 4))
             &rArr; (2 4 3)
</pre>
       </blockquote></div>

<div class="node">
<a name="Lists-as-sequences"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Destructive-list-operations">Destructive list operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Lists-as-sets">Lists as sets</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Common-List-Functions">Common List Functions</a>

</div>

<h5 class="subsubsection">7.2.1.3 Lists as sequences</h5>

<div class="defun">
&mdash; Function: <b>position</b><var> obj lst<a name="index-position-1455"></a></var><br>
<blockquote><p><code>position</code> returns the 0-based position of <var>obj</var> in <var>lst</var>,
or <code>#f</code> if <var>obj</var> does not occur in <var>lst</var>.

       <p>Example:
     <pre class="lisp">          (position 'foo '(foo bar baz bang))
             &rArr; 0
          (position 'baz '(foo bar baz bang))
             &rArr; 2
          (position 'oops '(foo bar baz bang))
             &rArr; #f
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>reduce</b><var> p lst<a name="index-reduce-1456"></a></var><br>
<blockquote><p><code>reduce</code> combines all the elements of a sequence using a binary
operation (the combination is left-associative).  For example, using
<code>+</code>, one can add up all the elements.  <code>reduce</code> allows you to
apply a function which accepts only two arguments to more than 2
objects.  Functional programmers usually refer to this as <dfn>foldl</dfn>. 
<code>collect:reduce</code> (see <a href="#Collections">Collections</a>) provides a version of
<code>collect</code> generalized to collections.

       <p>Example:
     <pre class="lisp">          (reduce + '(1 2 3 4))
             &rArr; 10
          (define (bad-sum . l) (reduce + l))
          (bad-sum 1 2 3 4)
             == (reduce + (1 2 3 4))
             == (+ (+ (+ 1 2) 3) 4)
          &rArr; 10
          (bad-sum)
             == (reduce + ())
             &rArr; ()
          (reduce string-append '("hello" "cruel" "world"))
             == (string-append (string-append "hello" "cruel") "world")
             &rArr; "hellocruelworld"
          (reduce anything '())
             &rArr; ()
          (reduce anything '(x))
             &rArr; x
</pre>
       <p>What follows is a rather non-standard implementation of <code>reverse</code>
in terms of <code>reduce</code> and a combinator elsewhere called
<dfn>C</dfn>.

     <pre class="lisp">          ;;; Contributed by Jussi Piitulainen (jpiitula @ ling.helsinki.fi)
          
          (define commute
            (lambda (f)
              (lambda (x y)
                (f y x))))
          
          (define reverse
            (lambda (args)
              (reduce-init (commute cons) '() args)))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>reduce-init</b><var> p init lst<a name="index-reduce_002dinit-1457"></a></var><br>
<blockquote><p><code>reduce-init</code> is the same as reduce, except that it implicitly
inserts <var>init</var> at the start of the list.  <code>reduce-init</code> is
preferred if you want to handle the null list, the one-element, and
lists with two or more elements consistently.  It is common to use the
operator's idempotent as the initializer.  Functional programmers
usually call this <dfn>foldl</dfn>.

       <p>Example:
     <pre class="lisp">          (define (sum . l) (reduce-init + 0 l))
          (sum 1 2 3 4)
             == (reduce-init + 0 (1 2 3 4))
             == (+ (+ (+ (+ 0 1) 2) 3) 4)
             &rArr; 10
          (sum)
             == (reduce-init + 0 '())
             &rArr; 0
          
          (reduce-init string-append "@" '("hello" "cruel" "world"))
          ==
          (string-append (string-append (string-append "@" "hello")
                                         "cruel")
                         "world")
          &rArr; "@hellocruelworld"
</pre>
       <p>Given a differentiation of 2 arguments, <code>diff</code>, the following will
differentiate by any number of variables.
     <pre class="lisp">          (define (diff* exp . vars)
            (reduce-init diff exp vars))
</pre>
       <p>Example:
     <pre class="lisp">          ;;; Real-world example:  Insertion sort using reduce-init.
          
          (define (insert l item)
            (if (null? l)
                (list item)
                (if (&lt; (car l) item)
                    (cons (car l) (insert (cdr l) item))
                    (cons item l))))
          (define (insertion-sort l) (reduce-init insert '() l))
          
          (insertion-sort '(3 1 4 1 5)
             == (reduce-init insert () (3 1 4 1 5))
             == (insert (insert (insert (insert (insert () 3) 1) 4) 1) 5)
             == (insert (insert (insert (insert (3)) 1) 4) 1) 5)
             == (insert (insert (insert (1 3) 4) 1) 5)
             == (insert (insert (1 3 4) 1) 5)
             == (insert (1 1 3 4) 5)
             &rArr; (1 1 3 4 5)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>last</b><var> lst n<a name="index-last-1458"></a></var><br>
<blockquote><p><code>last</code> returns the last <var>n</var> elements of <var>lst</var>.  <var>n</var>
must be a non-negative integer.

       <p>Example:
     <pre class="lisp">          (last '(foo bar baz bang) 2)
             &rArr; (baz bang)
          (last '(1 2 3) 0)
             &rArr; ()
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>butlast</b><var> lst n<a name="index-butlast-1459"></a></var><br>
<blockquote><p><code>butlast</code> returns all but the last <var>n</var> elements of
<var>lst</var>.

       <p>Example:
     <pre class="lisp">          (butlast '(a b c d) 3)
             &rArr; (a)
          (butlast '(a b c d) 4)
             &rArr; ()
</pre>
       </blockquote></div>

<p class="noindent"><code>last</code> and <code>butlast</code> split a list into two parts when given
identical arguments.
<pre class="example">     (last '(a b c d e) 2)
        &rArr; (d e)
     (butlast '(a b c d e) 2)
        &rArr; (a b c)
</pre>
  <div class="defun">
&mdash; Function: <b>nthcdr</b><var> n lst<a name="index-nthcdr-1460"></a></var><br>
<blockquote><p><code>nthcdr</code> takes <var>n</var> <code>cdr</code>s of <var>lst</var> and returns the
result.  Thus <code>(nthcdr 3 </code><var>lst</var><code>)</code> == <code>(cdddr
</code><var>lst</var><code>)</code>

       <p>Example:
     <pre class="lisp">          (nthcdr 2 '(a b c d))
             &rArr; (c d)
          (nthcdr 0 '(a b c d))
             &rArr; (a b c d)
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>butnthcdr</b><var> n lst<a name="index-butnthcdr-1461"></a></var><br>
<blockquote><p><code>butnthcdr</code> returns all but the nthcdr <var>n</var> elements of
<var>lst</var>.

       <p>Example:
     <pre class="lisp">          (butnthcdr 3 '(a b c d))
             &rArr; (a b c)
          (butnthcdr 4 '(a b c d))
             &rArr; (a b c d)
</pre>
       </blockquote></div>

<p class="noindent"><code>nthcdr</code> and <code>butnthcdr</code> split a list into two parts when
given identical arguments.
<pre class="example">     (nthcdr 2 '(a b c d e))
        &rArr; (c d e)
     (butnthcdr 2 '(a b c d e))
        &rArr; (a b)
</pre>
  <div class="node">
<a name="Destructive-list-operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Non_002dList-functions">Non-List functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Lists-as-sequences">Lists as sequences</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Common-List-Functions">Common List Functions</a>

</div>

<h5 class="subsubsection">7.2.1.4 Destructive list operations</h5>

<p>These procedures may mutate the list they operate on, but any such
mutation is undefined.

<div class="defun">
&mdash; Procedure: <b>nconc</b><var> args<a name="index-nconc-1462"></a></var><br>
<blockquote><p><code>nconc</code> destructively concatenates its arguments.  (Compare this
with <code>append</code>, which copies arguments rather than destroying them.) 
Sometimes called <code>append!</code> (see <a href="#Rev2-Procedures">Rev2 Procedures</a>).

       <p>Example:  You want to find the subsets of a set.  Here's the obvious way:

     <pre class="lisp">          (define (subsets set)
            (if (null? set)
                '(())
                (append (map (lambda (sub) (cons (car set) sub))
                             (subsets (cdr set)))
                        (subsets (cdr set)))))
</pre>
       <p>But that does way more consing than you need.  Instead, you could
replace the <code>append</code> with <code>nconc</code>, since you don't have any
need for all the intermediate results.

       <p>Example:
     <pre class="lisp">          (define x '(a b c))
          (define y '(d e f))
          (nconc x y)
             &rArr; (a b c d e f)
          x
             &rArr; (a b c d e f)
</pre>
       <p><code>nconc</code> is the same as <code>append!</code> in <samp><span class="file">sc2.scm</span></samp>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>nreverse</b><var> lst<a name="index-nreverse-1463"></a></var><br>
<blockquote><p><code>nreverse</code> reverses the order of elements in <var>lst</var> by mutating
<code>cdr</code>s of the list.  Sometimes called <code>reverse!</code>.

       <p>Example:
     <pre class="lisp">          (define foo '(a b c))
          (nreverse foo)
             &rArr; (c b a)
          foo
             &rArr; (a)
</pre>
       <p>Some people have been confused about how to use <code>nreverse</code>,
thinking that it doesn't return a value.  It needs to be pointed out
that

     <pre class="lisp">          (set! lst (nreverse lst))
</pre>
       <p class="noindent">is the proper usage, not
     <pre class="lisp">          (nreverse lst)
</pre>
       <p>The example should suffice to show why this is the case. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>delete</b><var> elt lst<a name="index-delete-1464"></a></var><br>
&mdash; Procedure: <b>delete-if</b><var> pred lst<a name="index-delete_002dif-1465"></a></var><br>
&mdash; Procedure: <b>delete-if-not</b><var> pred lst<a name="index-delete_002dif_002dnot-1466"></a></var><br>
<blockquote><p>Destructive versions of <code>remove</code> <code>remove-if</code>, and
<code>remove-if-not</code>.

       <p>Example:
     <pre class="lisp">          (define lst (list 'foo 'bar 'baz 'bang))
          (delete 'foo lst)
             &rArr; (bar baz bang)
          lst
             &rArr; (foo bar baz bang)
          
          (define lst (list 1 2 3 4 5 6 7 8 9))
          (delete-if odd? lst)
             &rArr; (2 4 6 8)
          lst
             &rArr; (1 2 4 6 8)
</pre>
       <p>Some people have been confused about how to use <code>delete</code>,
<code>delete-if</code>, and <code>delete-if</code>, thinking that they don't return
a value.  It needs to be pointed out that

     <pre class="lisp">          (set! lst (delete el lst))
</pre>
       <p class="noindent">is the proper usage, not
     <pre class="lisp">          (delete el lst)
</pre>
       <p>The examples should suffice to show why this is the case. 
</p></blockquote></div>

<div class="node">
<a name="Non-List-functions"></a>
<a name="Non_002dList-functions"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Destructive-list-operations">Destructive list operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Common-List-Functions">Common List Functions</a>

</div>

<h5 class="subsubsection">7.2.1.5 Non-List functions</h5>

<div class="defun">
&mdash; Function: <b>and?</b><var> arg1 <small class="dots">...</small><a name="index-and_003f-1467"></a></var><br>
<blockquote><p><code>and?</code> checks to see if all its arguments are true.  If they are,
<code>and?</code> returns <code>#t</code>, otherwise, <code>#f</code>.  (In contrast to
<code>and</code>, this is a function, so all arguments are always evaluated
and in an unspecified order.)

       <p>Example:
     <pre class="lisp">          (and? 1 2 3)
             &rArr; #t
          (and #f 1 2)
             &rArr; #f
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>or?</b><var> arg1 <small class="dots">...</small><a name="index-or_003f-1468"></a></var><br>
<blockquote><p><code>or?</code> checks to see if any of its arguments are true.  If any is
true, <code>or?</code> returns <code>#t</code>, and <code>#f</code> otherwise.  (To
<code>or</code> as <code>and?</code> is to <code>and</code>.)

       <p>Example:
     <pre class="lisp">          (or? 1 2 #f)
             &rArr; #t
          (or? #f #f #f)
             &rArr; #f
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>atom?</b><var> object<a name="index-atom_003f-1469"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>object</var> is not a pair and <code>#f</code> if it is
pair.  (Called <code>atom</code> in Common LISP.)
     <pre class="lisp">          (atom? 1)
             &rArr; #t
          (atom? '(1 2))
             &rArr; #f
          (atom? #(1 2))   ; dubious!
             &rArr; #t
</pre>
       </blockquote></div>

<div class="node">
<a name="Tree-Operations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Chapter-Ordering">Chapter Ordering</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Common-List-Functions">Common List Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.2 Tree operations</h4>

<p><code>(require 'tree)</code>
<a name="index-tree-1470"></a>
These are operations that treat lists a representations of trees.

<div class="defun">
&mdash; Function: <b>subst</b><var> new old tree<a name="index-subst-1471"></a></var><br>
&mdash; Function: <b>substq</b><var> new old tree<a name="index-substq-1472"></a></var><br>
&mdash; Function: <b>substv</b><var> new old tree<a name="index-substv-1473"></a></var><br>

  &mdash; Function: <b>subst</b><var> new old tree equ?<a name="index-subst-1474"></a></var><br>
<blockquote><p><code>subst</code> makes a copy of <var>tree</var>, substituting <var>new</var> for
every subtree or leaf of <var>tree</var> which is <code>equal?</code> to <var>old</var>
and returns a modified tree.  The original <var>tree</var> is unchanged, but
may share parts with the result.

       <p><code>substq</code> and <code>substv</code> are similar, but test against <var>old</var>
using <code>eq?</code> and <code>eqv?</code> respectively.  If <code>subst</code> is
called with a fourth argument, <var>equ?</var> is the equality predicate.

       <p>Examples:
     <pre class="lisp">          (substq 'tempest 'hurricane '(shakespeare wrote (the hurricane)))
             &rArr; (shakespeare wrote (the tempest))
          (substq 'foo '() '(shakespeare wrote (twelfth night)))
             &rArr; (shakespeare wrote (twelfth night . foo) . foo)
          (subst '(a . cons) '(old . pair)
                 '((old . spice) ((old . shoes) old . pair) (old . pair)))
             &rArr; ((old . spice) ((old . shoes) a . cons) (a . cons))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>copy-tree</b><var> tree<a name="index-copy_002dtree-1475"></a></var><br>
<blockquote>
       <p>Makes a copy of the nested list structure <var>tree</var> using new pairs and
returns it.  All levels are copied, so that none of the pairs in the
tree are <code>eq?</code> to the original ones &ndash; only the leaves are.

       <p>Example:
     <pre class="lisp">          (define bar '(bar))
          (copy-tree (list bar 'foo))
             &rArr; ((bar) foo)
          (eq? bar (car (copy-tree (list bar 'foo))))
             &rArr; #f
</pre>
       </blockquote></div>

<div class="node">
<a name="Chapter-Ordering"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Sorting">Sorting</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Tree-Operations">Tree Operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.3 Chapter Ordering</h4>

<p><code>(require 'chapter-order)</code>
<a name="index-chapter_002dorder-1476"></a>
The &lsquo;<samp><span class="samp">chap:</span></samp>&rsquo; functions deal with strings which are ordered like
chapter numbers (or letters) in a book.  Each section of the string
consists of consecutive numeric or consecutive aphabetic characters of
like case.

<div class="defun">
&mdash; Function: <b>chap:string&lt;?</b><var> string1 string2<a name="index-chap_003astring_003c_003f-1477"></a></var><br>
<blockquote>
       <p>Returns #t if the first non-matching run of alphabetic upper-case or
the first non-matching run of alphabetic lower-case or the first
non-matching run of numeric characters of <var>string1</var> is
<code>string&lt;?</code> than the corresponding non-matching run of
characters of <var>string2</var>.

     <pre class="example">          (chap:string&lt;? "a.9" "a.10")                    &rArr; #t
          (chap:string&lt;? "4c" "4aa")                      &rArr; #t
          (chap:string&lt;? "Revised^{3.99}" "Revised^{4}")  &rArr; #t
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>chap:string&gt;?</b><var> string1 string2<a name="index-chap_003astring_003e_003f-1478"></a></var><br>
&mdash; Function: <b>chap:string&lt;=?</b><var> string1 string2<a name="index-chap_003astring_003c_003d_003f-1479"></a></var><br>
&mdash; Function: <b>chap:string&gt;=?</b><var> string1 string2<a name="index-chap_003astring_003e_003d_003f-1480"></a></var><br>
<blockquote>
       <p>Implement the corresponding chapter-order predicates. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>chap:next-string</b><var> string<a name="index-chap_003anext_002dstring-1481"></a></var><br>
<blockquote>
       <p>Returns the next string in the <em>chapter order</em>.  If <var>string</var>
has no alphabetic or numeric characters,
<code>(string-append </code><var>string</var><code> "0")</code> is returnd.  The argument to
chap:next-string will always be <code>chap:string&lt;?</code> than the result.

     <pre class="example">          (chap:next-string "a.9")                &rArr; "a.10"
          (chap:next-string "4c")                 &rArr; "4d"
          (chap:next-string "4z")                 &rArr; "4aa"
          (chap:next-string "Revised^{4}")        &rArr; "Revised^{5}"
          
</pre>
       </blockquote></div>

<div class="node">
<a name="Sorting"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Topological-Sort">Topological Sort</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Chapter-Ordering">Chapter Ordering</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.4 Sorting</h4>

<p><code>(require 'sort)</code> or <code>(require 'srfi-95)</code>
<a name="index-sort-1482"></a><a name="index-srfi_002d95-1483"></a>
[by Richard A. O'Keefe, 1991]

  <p>I am providing this source code with no restrictions at all on its use
(but please retain D.H.D.Warren's credit for the original idea).

  <p>The code of <code>merge</code> and <code>merge!</code> could have been quite a bit
simpler, but they have been coded to reduce the amount of work done per
iteration.  (For example, we only have one <code>null?</code> test per
iteration.)

  <p>I gave serious consideration to producing Common-LISP-compatible
functions.  However, Common LISP's <code>sort</code> is our <code>sort!</code>
(well, in fact Common LISP's <code>stable-sort</code> is our <code>sort!</code>;
merge sort is <em>fast</em> as well as stable!) so adapting CL code to
Scheme takes a bit of work anyway.  I did, however, appeal to CL to
determine the <em>order</em> of the arguments.

  <p>The standard functions <code>&lt;</code>, <code>&gt;</code>, <code>char&lt;?</code>, <code>char&gt;?</code>,
<code>char-ci&lt;?</code>, <code>char-ci&gt;?</code>, <code>string&lt;?</code>, <code>string&gt;?</code>,
<code>string-ci&lt;?</code>, and <code>string-ci&gt;?</code> are suitable for use as
comparison functions.  Think of <code>(less? x y)</code> as saying when
<code>x</code> must <em>not</em> precede <code>y</code>.

  <p>[Addendum by Aubrey Jaffer, 2006]

  <p>These procedures are stable when called with predicates which return
<code>#f</code> when applied to identical arguments.

  <p>The <code>sorted?</code>, <code>merge</code>, and <code>merge!</code> procedures consume
asymptotic time and space no larger than <i>O(N)</i>, where <i>N</i> is the
sum of the lengths of the sequence arguments. 
The <code>sort</code> and <code>sort!</code> procedures consume asymptotic time
and space no larger than <i>O(N*log(N))</i>, where <i>N</i> is the length of
the sequence argument.

  <p>All five functions take an optional <var>key</var> argument corresponding
to a CL-style &lsquo;<samp><span class="samp">&amp;key</span></samp>&rsquo; argument.  A <var>less?</var>  predicate with a
<var>key</var> argument behaves like:

<pre class="lisp">     (lambda (x y) (<var>less?</var> (<var>key</var> x) (<var>key</var> y)))
</pre>
  <p>All five functions will call the <var>key</var> argument at most once per
element.

  <p>The &lsquo;<samp><span class="samp">!</span></samp>&rsquo; variants sort in place; <code>sort!</code> returns its
<var>sequence</var> argument.

<div class="defun">
&mdash; Function: <b>sorted?</b><var> sequence less?<a name="index-sorted_003f-1484"></a></var><br>
&mdash; Function: <b>sorted?</b><var> sequence less? key<a name="index-sorted_003f-1485"></a></var><br>
<blockquote><p>Returns <code>#t</code> when the sequence argument is in non-decreasing
order according to <var>less?</var> (that is, there is no adjacent pair
<code>... x y ...</code> for which <code>(less? y x)</code>).

       <p>Returns <code>#f</code> when the sequence contains at least one out-of-order
pair.  It is an error if the sequence is not a list or array
(including vectors and strings). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>merge</b><var> list1 list2 less?<a name="index-merge-1486"></a></var><br>
&mdash; Function: <b>merge</b><var> list1 list2 less? key<a name="index-merge-1487"></a></var><br>
<blockquote><p>Merges two sorted lists, returning a freshly allocated list as its
result. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>merge!</b><var> list1 list2 less?<a name="index-merge_0021-1488"></a></var><br>
&mdash; Function: <b>merge!</b><var> list1 list2 less? key<a name="index-merge_0021-1489"></a></var><br>
<blockquote><p>Merges two sorted lists, re-using the pairs of <var>list1</var> and
<var>list2</var> to build the result.  The result will be either
<var>list1</var> or <var>list2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sort</b><var> sequence less?<a name="index-sort-1490"></a></var><br>
&mdash; Function: <b>sort</b><var> sequence less? key<a name="index-sort-1491"></a></var><br>
<blockquote><p>Accepts a list or array (including vectors and strings) for
<var>sequence</var>; and returns a completely new sequence which is sorted
according to <var>less?</var>.  The returned sequence is the same type as
the argument <var>sequence</var>.  Given valid arguments, it is always the
case that:

     <pre class="lisp">          (sorted? (sort <var>sequence</var> <var>less?</var>) <var>less?</var>) &rArr; #t
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>sort!</b><var> sequence less?<a name="index-sort_0021-1492"></a></var><br>
&mdash; Function: <b>sort!</b><var> sequence less? key<a name="index-sort_0021-1493"></a></var><br>
<blockquote><p>Returns list, array, vector, or string <var>sequence</var> which has been
mutated to order its elements according to <var>less?</var>.  Given valid
arguments, it is always the case that:

     <pre class="lisp">          (sorted? (sort! <var>sequence</var> <var>less?</var>) <var>less?</var>) &rArr; #t
</pre>
       </blockquote></div>

<div class="node">
<a name="Topological-Sort"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Hashing">Hashing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Sorting">Sorting</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.5 Topological Sort</h4>

<p><code>(require 'topological-sort)</code> or <code>(require 'tsort)</code>
<a name="index-topological_002dsort-1494"></a><a name="index-tsort-1495"></a>
The algorithm is inspired by Cormen, Leiserson and Rivest (1990)
<cite>Introduction to Algorithms</cite>, chapter 23.

<div class="defun">
&mdash; Function: <b>tsort</b><var> dag pred<a name="index-tsort-1496"></a></var><br>

  &mdash; Function: <b>topological-sort</b><var> dag pred<a name="index-topological_002dsort-1497"></a></var><br>
<blockquote><p>where
          <dl>
<dt><var>dag</var><dd>is a list of sublists.  The car of each sublist is a vertex.  The cdr is
the adjacency list of that vertex, i.e. a list of all vertices to which
there exists an edge from the car vertex. 
<br><dt><var>pred</var><dd>is one of <code>eq?</code>, <code>eqv?</code>, <code>equal?</code>, <code>=</code>,
<code>char=?</code>, <code>char-ci=?</code>, <code>string=?</code>, or <code>string-ci=?</code>. 
</dl>

       <p>Sort the directed acyclic graph <var>dag</var> so that for every edge from
vertex <var>u</var> to <var>v</var>, <var>u</var> will come before <var>v</var> in the
resulting list of vertices.

       <p>Time complexity: O (|V| + |E|)

       <p>Example (from Cormen):
<blockquote>
Prof. Bumstead topologically sorts his clothing when getting
dressed.  The first argument to <code>tsort</code> describes which
garments he needs to put on before others.  (For example,
Prof Bumstead needs to put on his shirt before he puts on his
tie or his belt.)  <code>tsort</code> gives the correct order of dressing:
</blockquote>

     <pre class="example">          (require 'tsort)
          <a name="index-tsort-1498"></a>(tsort '((shirt tie belt)
                   (tie jacket)
                   (belt jacket)
                   (watch)
                   (pants shoes belt)
                   (undershorts pants shoes)
                   (socks shoes))
                 eq?)
          &rArr;
          (socks undershorts pants shoes watch shirt belt tie jacket)
</pre>
       </blockquote></div>

<div class="node">
<a name="Hashing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Space_002dFilling-Curves">Space-Filling Curves</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Topological-Sort">Topological Sort</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.6 Hashing</h4>

<p><code>(require 'hash)</code>
<a name="index-hash-1499"></a>
These hashing functions are for use in quickly classifying objects. 
Hash tables use these functions.

<div class="defun">
&mdash; Function: <b>hashq</b><var> obj k<a name="index-hashq-1500"></a></var><br>
&mdash; Function: <b>hashv</b><var> obj k<a name="index-hashv-1501"></a></var><br>
&mdash; Function: <b>hash</b><var> obj k<a name="index-hash-1502"></a></var><br>
<blockquote><p>Returns an exact non-negative integer less than <var>k</var>.  For each
non-negative integer less than <var>k</var> there are arguments <var>obj</var> for
which the hashing functions applied to <var>obj</var> and <var>k</var> returns
that integer.

       <p>For <code>hashq</code>, <code>(eq? obj1 obj2)</code> implies <code>(= (hashq obj1 k)
(hashq obj2))</code>.

       <p>For <code>hashv</code>, <code>(eqv? obj1 obj2)</code> implies <code>(= (hashv obj1 k)
(hashv obj2))</code>.

       <p>For <code>hash</code>, <code>(equal? obj1 obj2)</code> implies <code>(= (hash obj1 k)
(hash obj2))</code>.

       <p><code>hash</code>, <code>hashv</code>, and <code>hashq</code> return in time bounded by a
constant.  Notice that items having the same <code>hash</code> implies the
items have the same <code>hashv</code> implies the items have the same
<code>hashq</code>. 
</p></blockquote></div>

<div class="node">
<a name="Space-Filling-Curves"></a>
<a name="Space_002dFilling-Curves"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Soundex">Soundex</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Hashing">Hashing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.7 Space-Filling Curves</h4>

<ul class="menu">
<li><a accesskey="1" href="#Multidimensional-Space_002dFilling-Curves">Multidimensional Space-Filling Curves</a>:   Includes Hilbert and Peano curves
<li><a accesskey="2" href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a>:             Legacy
<li><a accesskey="3" href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a>:               Legacy
<li><a accesskey="4" href="#Sierpinski-Curve">Sierpinski Curve</a>:                        Rank-2 to scalar
</ul>

<div class="node">
<a name="Multidimensional-Space-Filling-Curves"></a>
<a name="Multidimensional-Space_002dFilling-Curves"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Space_002dFilling-Curves">Space-Filling Curves</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Space_002dFilling-Curves">Space-Filling Curves</a>

</div>

<h5 class="subsubsection">7.2.7.1 Multidimensional Space-Filling Curves</h5>

<p><code>(require 'space-filling)</code>
<a name="index-space_002dfilling-1503"></a>
The algorithms and cell properties are described in
<a href="http://people.csail.mit.edu/jaffer/Geometry/RMDSFF.pdf">http://people.csail.mit.edu/jaffer/Geometry/RMDSFF.pdf</a>

<div class="defun">
&mdash; Function: <b>make-cell</b><var> type rank side precession<a name="index-make_002dcell-1504"></a></var><br>

  &mdash; Function: <b>make-cell</b><var> type rank side<a name="index-make_002dcell-1505"></a></var><br>

  &mdash; Function: <b>make-cell</b><var> type rank<a name="index-make_002dcell-1506"></a></var><br>
<blockquote>
       <p><var>type</var> must be the symbol <code>diagonal</code>, <code>adjacent</code>, or
<code>centered</code>.  <var>rank</var> must be an integer larger than 1.  <var>side</var>, if
present, must be an even integer larger than 1 if <var>type</var> is
<code>adjacent</code> or an odd integer larger than 2 otherwise; <var>side</var>
defaults to the smallest value.  <var>precession</var>, if present, must be an integer
between 0 and <var>side</var>^<var>rank</var>-1; it is relevant only when <var>type</var> is
<code>diagonal</code> or <code>centered</code>.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>make-cell</b><var> Hamiltonian-path-vector precession<a name="index-make_002dcell-1507"></a></var><br>

  &mdash; Function: <b>make-cell</b><var> Hamiltonian-path-vector<a name="index-make_002dcell-1508"></a></var><br>
<blockquote>
       <p><var>type</var> must be a vector of <var>side</var>^<var>rank</var> lists of <var>rank</var> of
integers encoding the coordinate positions of a Hamiltonian path on
the <var>rank</var>-dimensional grid of points starting and ending on
corners of the grid.  The starting corner must be the origin
(all-zero coordinates). If the side-length is even, then the ending
corner must be non-zero in only one coordinate; otherwise, the
ending corner must be the furthest diagonally opposite corner from
the origin.

       <p><code>make-cell</code> returns a data object suitable for passing as the
first argument to <code>integer-&gt;coordinates</code> or
<code>coordinates-&gt;integer</code>. 
</p></blockquote></div>

  <p>Hilbert, Peano, and centered Peano cells are generated
respectively by:
<pre class="example">     (make-cell 'adjacent <var>rank</var> 2)   ; Hilbert
     (make-cell 'diagonal <var>rank</var> 3)   ; Peano
     (make-cell 'centered <var>rank</var> 3)   ; centered Peano
</pre>
  <p>In the conversion procedures, if the cell is <code>diagonal</code> or
<code>adjacent</code>, then the coordinates and scalar must be nonnegative
integers.  If <code>centered</code>, then the integers can be negative.

<div class="defun">
&mdash; Function: <b>integer-&gt;coordinates</b><var> cell u<a name="index-integer_002d_003ecoordinates-1509"></a></var><br>
<blockquote>
       <p><code>integer-&gt;coordinates</code> converts the integer <var>u</var> to a list of coordinates according to <var>cell</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>coordinates-&gt;integer</b><var> cell v<a name="index-coordinates_002d_003einteger-1510"></a></var><br>
<blockquote>
       <p><code>coordinates-&gt;integer</code> converts the list of coordinates <var>v</var> to an integer according to <var>cell</var>. 
</p></blockquote></div>

  <p><var>coordinates-&gt;integer</var> and <var>integer-&gt;coordinates</var> are
inverse functions when passed the same <var>cell</var> argument.

<div class="node">
<a name="Hilbert-Space-Filling-Curve"></a>
<a name="Hilbert-Space_002dFilling-Curve"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multidimensional-Space_002dFilling-Curves">Multidimensional Space-Filling Curves</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Space_002dFilling-Curves">Space-Filling Curves</a>

</div>

<h5 class="subsubsection">7.2.7.2 Hilbert Space-Filling Curve</h5>

<p><code>(require 'hilbert-fill)</code>
<a name="index-hilbert_002dfill-1511"></a>
<a name="index-Hilbert-1512"></a><a name="index-Space_002dFilling-1513"></a>The <dfn>Hilbert Space-Filling Curve</dfn> is a one-to-one mapping
<a name="index-Hilbert-Space_002dFilling-Curve-1514"></a>between a unit line segment and an <var>n</var>-dimensional unit cube. 
This implementation treats the nonnegative integers either as
fractional bits of a given width or as nonnegative integers.

<p class="noindent">The integer procedures map the non-negative integers to an
arbitrarily large <var>n</var>-dimensional cube with its corner at the
origin and all coordinates are non-negative.

<p class="noindent">For any exact nonnegative integer <var>scalar</var> and exact integer
<var>rank</var> &gt; 2,

<pre class="example">     (= <var>scalar</var> (hilbert-coordinates-&gt;integer
                (integer-&gt;hilbert-coordinates <var>scalar</var> <var>rank</var>)))
                                            &rArr; #t
</pre>
  <p>When treating integers as <var>k</var> fractional bits,

<pre class="example">     (= <var>scalar</var> (hilbert-coordinates-&gt;integer
                (integer-&gt;hilbert-coordinates <var>scalar</var> <var>rank</var> <var>k</var>)) <var>k</var>)
                                            &rArr; #t
</pre>
  <div class="defun">
&mdash; Function: <b>integer-&gt;hilbert-coordinates</b><var> scalar rank<a name="index-integer_002d_003ehilbert_002dcoordinates-1515"></a></var><br>
<blockquote>
       <p>Returns a list of <var>rank</var> integer coordinates corresponding to exact
non-negative integer <var>scalar</var>.  The lists returned by <code>integer-&gt;hilbert-coordinates</code> for <var>scalar</var> arguments
0 and 1 will differ in the first element.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-&gt;hilbert-coordinates</b><var> scalar rank k<a name="index-integer_002d_003ehilbert_002dcoordinates-1516"></a></var><br>
<blockquote>
       <p><var>scalar</var> must be a nonnegative integer of no more than
<var>rank</var><code>*</code><var>k</var> bits.

       <p><code>integer-&gt;hilbert-coordinates</code> Returns a list of <var>rank</var> <var>k</var>-bit nonnegative integer
coordinates corresponding to exact non-negative integer <var>scalar</var>.  The
curves generated by <code>integer-&gt;hilbert-coordinates</code> have the same alignment independent of
<var>k</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>hilbert-coordinates-&gt;integer</b><var> coords<a name="index-hilbert_002dcoordinates_002d_003einteger-1517"></a></var><br>

  &mdash; Function: <b>hilbert-coordinates-&gt;integer</b><var> coords k<a name="index-hilbert_002dcoordinates_002d_003einteger-1518"></a></var><br>
<blockquote><p>Returns an exact non-negative integer corresponding to <var>coords</var>, a list
of non-negative integer coordinates. 
</p></blockquote></div>

<h5 class="subsubsection">7.2.7.3 Gray code</h5>

<p><a name="index-Gray-code-1519"></a>A <dfn>Gray code</dfn> is an ordering of non-negative integers in which
<a name="index-Gray-code-1520"></a>exactly one bit differs between each pair of successive elements.  There
are multiple Gray codings.  An n-bit Gray code corresponds to a
Hamiltonian cycle on an n-dimensional hypercube.

<p class="noindent">Gray codes find use communicating incrementally changing values between
asynchronous agents.  De-laminated Gray codes comprise the coordinates
of Hilbert space-filling curves.

<div class="defun">
&mdash; Function: <b>integer-&gt;gray-code</b><var> k<a name="index-integer_002d_003egray_002dcode-1521"></a></var><br>
<blockquote><p>Converts <var>k</var> to a Gray code of the same <code>integer-length</code> as
<var>k</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>gray-code-&gt;integer</b><var> k<a name="index-gray_002dcode_002d_003einteger-1522"></a></var><br>
<blockquote><p>Converts the Gray code <var>k</var> to an integer of the same
<code>integer-length</code> as <var>k</var>.

       <p>For any non-negative integer <var>k</var>,
     <pre class="example">          (eqv? k (gray-code-&gt;integer (integer-&gt;gray-code k)))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>=</b><var> k1 k2<a name="index-g_t_003d-1523"></a></var><br>
&mdash; Function: <b>gray-code&lt;?</b><var> k1 k2<a name="index-gray_002dcode_003c_003f-1524"></a></var><br>
&mdash; Function: <b>gray-code&gt;?</b><var> k1 k2<a name="index-gray_002dcode_003e_003f-1525"></a></var><br>
&mdash; Function: <b>gray-code&lt;=?</b><var> k1 k2<a name="index-gray_002dcode_003c_003d_003f-1526"></a></var><br>
&mdash; Function: <b>gray-code&gt;=?</b><var> k1 k2<a name="index-gray_002dcode_003e_003d_003f-1527"></a></var><br>
<blockquote><p>These procedures return #t if their Gray code arguments are
(respectively): equal, monotonically increasing, monotonically
decreasing, monotonically nondecreasing, or monotonically nonincreasing.

       <p>For any non-negative integers <var>k1</var> and <var>k2</var>, the Gray code
predicate of <code>(integer-&gt;gray-code k1)</code> and
<code>(integer-&gt;gray-code k2)</code> will return the same value as the
corresponding predicate of <var>k1</var> and <var>k2</var>. 
</p></blockquote></div>

<h5 class="subsubsection">7.2.7.4 Bitwise Lamination</h5>

<p><a name="index-lamination-1528"></a>

<div class="defun">
&mdash; Function: <b>delaminate-list</b><var> count ks<a name="index-delaminate_002dlist-1529"></a></var><br>
<blockquote>
       <p>Returns a list of <var>count</var> integers comprised of the <var>j</var>th
bit of the integers <var>ks</var> where <var>j</var> ranges from <var>count</var>-1
to 0.

     <pre class="example">          (map (lambda (k) (number-&gt;string k 2))
               (delaminate-list 4 '(7 6 5 4 0 0 0 0)))
              &rArr; ("0" "11110000" "11000000" "10100000")
</pre>
       <p><code>delaminate-list</code> is its own inverse:
     <pre class="example">          (delaminate-list 8 (delaminate-list 4 '(7 6 5 4 0 0 0 0)))
              &rArr; (7 6 5 4 0 0 0 0)
</pre>
       </blockquote></div>

<div class="node">
<a name="Peano-Space-Filling-Curve"></a>
<a name="Peano-Space_002dFilling-Curve"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Sierpinski-Curve">Sierpinski Curve</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Space_002dFilling-Curves">Space-Filling Curves</a>

</div>

<h5 class="subsubsection">7.2.7.5 Peano Space-Filling Curve</h5>

<p><code>(require 'peano-fill)</code>
<a name="index-peano_002dfill-1530"></a>

<div class="defun">
&mdash; Function: <b>natural-&gt;peano-coordinates</b><var> scalar rank<a name="index-natural_002d_003epeano_002dcoordinates-1531"></a></var><br>
<blockquote>
       <p>Returns a list of <var>rank</var> nonnegative integer coordinates corresponding
to exact nonnegative integer <var>scalar</var>.  The lists returned by <code>natural-&gt;peano-coordinates</code> for <var>scalar</var>
arguments 0 and 1 will differ in the first element. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>peano-coordinates-&gt;natural</b><var> coords<a name="index-peano_002dcoordinates_002d_003enatural-1532"></a></var><br>
<blockquote>
       <p>Returns an exact nonnegative integer corresponding to <var>coords</var>, a list of
nonnegative integer coordinates. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-&gt;peano-coordinates</b><var> scalar rank<a name="index-integer_002d_003epeano_002dcoordinates-1533"></a></var><br>
<blockquote>
       <p>Returns a list of <var>rank</var> integer coordinates corresponding to exact
integer <var>scalar</var>.  The lists returned by <code>integer-&gt;peano-coordinates</code> for <var>scalar</var> arguments 0 and 1 will
differ in the first element. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>peano-coordinates-&gt;integer</b><var> coords<a name="index-peano_002dcoordinates_002d_003einteger-1534"></a></var><br>
<blockquote>
       <p>Returns an exact integer corresponding to <var>coords</var>, a list of integer
coordinates. 
</p></blockquote></div>

<div class="node">
<a name="Sierpinski-Curve"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Space_002dFilling-Curves">Space-Filling Curves</a>

</div>

<h5 class="subsubsection">7.2.7.6 Sierpinski Curve</h5>

<p><code>(require 'sierpinski)</code>
<a name="index-sierpinski-1535"></a>

<div class="defun">
&mdash; Function: <b>make-sierpinski-indexer</b><var> max-coordinate<a name="index-make_002dsierpinski_002dindexer-1536"></a></var><br>
<blockquote><p>Returns a procedure (eg hash-function) of 2 numeric arguments which
preserves <em>nearness</em> in its mapping from NxN to N.

       <p><var>max-coordinate</var> is the maximum coordinate (a positive integer) of a
population of points.  The returned procedures is a function that takes
the x and y coordinates of a point, (non-negative integers) and returns
an integer corresponding to the relative position of that point along a
Sierpinski curve.  (You can think of this as computing a (pseudo-)
inverse of the Sierpinski spacefilling curve.)

       <p>Example use: Make an indexer (hash-function) for integer points lying in
square of integer grid points [0,99]x[0,99]:
     <pre class="example">          (define space-key (make-sierpinski-indexer 100))
</pre>
       <p>Now let's compute the index of some points:
     <pre class="example">          (space-key 24 78)               &rArr; 9206
          (space-key 23 80)               &rArr; 9172
</pre>
       <p>Note that locations (24, 78) and (23, 80) are near in index and
therefore, because the Sierpinski spacefilling curve is continuous, we
know they must also be near in the plane.  Nearness in the plane does
not, however, necessarily correspond to nearness in index, although it
<em>tends</em> to be so.

       <p>Example applications:
          <ul>
<li>Sort points by Sierpinski index to get heuristic solution to
<em>travelling salesman problem</em>.  For details of performance,
see L. Platzman and J. Bartholdi, "Spacefilling curves and the
Euclidean travelling salesman problem", JACM 36(4):719&ndash;737
(October 1989) and references therein.

          <li>Use Sierpinski index as key by which to store 2-dimensional data
in a 1-dimensional data structure (such as a table).  Then
locations that are near each other in 2-d space will tend to
be near each other in 1-d data structure; and locations that
are near in 1-d data structure will be near in 2-d space.  This
can significantly speed retrieval from secondary storage because
contiguous regions in the plane will tend to correspond to
contiguous regions in secondary storage.  (This is a standard
technique for managing CAD/CAM or geographic data.)

       </ul>
       </p></blockquote></div>

<div class="node">
<a name="Soundex"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#String-Search">String Search</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Space_002dFilling-Curves">Space-Filling Curves</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.8 Soundex</h4>

<p><code>(require 'soundex)</code>
<a name="index-soundex-1537"></a>

<div class="defun">
&mdash; Function: <b>soundex</b><var> name<a name="index-soundex-1538"></a></var><br>
<blockquote><p>Computes the <em>soundex</em> hash of <var>name</var>.  Returns a string of an
initial letter and up to three digits between 0 and 6.  Soundex
supposedly has the property that names that sound similar in normal
English pronunciation tend to map to the same key.

       <p>Soundex was a classic algorithm used for manual filing of personal
records before the advent of computers.  It performs adequately for
English names but has trouble with other languages.

       <p>See Knuth, Vol. 3 <cite>Sorting and searching</cite>, pp 391&ndash;2

       <p>To manage unusual inputs, <code>soundex</code> omits all non-alphabetic
characters.  Consequently, in this implementation:

     <pre class="example">          (soundex &lt;string of blanks&gt;)    &rArr; ""
          (soundex "")                    &rArr; ""
</pre>
       <p>Examples from Knuth:

     <pre class="example">          (map soundex '("Euler" "Gauss" "Hilbert" "Knuth"
                                 "Lloyd" "Lukasiewicz"))
                  &rArr; ("E460" "G200" "H416" "K530" "L300" "L222")
          
          (map soundex '("Ellery" "Ghosh" "Heilbronn" "Kant"
                                  "Ladd" "Lissajous"))
                  &rArr; ("E460" "G200" "H416" "K530" "L300" "L222")
</pre>
       <p>Some cases in which the algorithm fails (Knuth):

     <pre class="example">          (map soundex '("Rogers" "Rodgers"))     &rArr; ("R262" "R326")
          
          (map soundex '("Sinclair" "St. Clair")) &rArr; ("S524" "S324")
          
          (map soundex '("Tchebysheff" "Chebyshev")) &rArr; ("T212" "C121")
</pre>
       </blockquote></div>

<div class="node">
<a name="String-Search"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Sequence-Comparison">Sequence Comparison</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Soundex">Soundex</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.9 String Search</h4>

<p><code>(require 'string-search)</code>
<a name="index-string_002dsearch-1539"></a>

<div class="defun">
&mdash; Procedure: <b>string-index</b><var> string char<a name="index-string_002dindex-1540"></a></var><br>
&mdash; Procedure: <b>string-index-ci</b><var> string char<a name="index-string_002dindex_002dci-1541"></a></var><br>
<blockquote><p>Returns the index of the first occurence of <var>char</var> within
<var>string</var>, or <code>#f</code> if the <var>string</var> does not contain a
character <var>char</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>string-reverse-index</b><var> string char<a name="index-string_002dreverse_002dindex-1542"></a></var><br>
&mdash; Procedure: <b>string-reverse-index-ci</b><var> string char<a name="index-string_002dreverse_002dindex_002dci-1543"></a></var><br>
<blockquote><p>Returns the index of the last occurence of <var>char</var> within
<var>string</var>, or <code>#f</code> if the <var>string</var> does not contain a
character <var>char</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>substring?</b><var> pattern string<a name="index-substring_003f-1544"></a></var><br>
&mdash; Procedure: <b>substring-ci?</b><var> pattern string<a name="index-substring_002dci_003f-1545"></a></var><br>
<blockquote><p>Searches <var>string</var> to see if some substring of <var>string</var> is equal
to <var>pattern</var>.  <code>substring?</code> returns the index of the first
character of the first substring of <var>string</var> that is equal to
<var>pattern</var>; or <code>#f</code> if <var>string</var> does not contain
<var>pattern</var>.

     <pre class="example">          (substring? "rat" "pirate") &rArr;  2
          (substring? "rat" "outrage") &rArr;  #f
          (substring? "" any-string) &rArr;  0
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>find-string-from-port?</b><var> str in-port max-no-chars<a name="index-find_002dstring_002dfrom_002dport_003f-1546"></a></var><br>
<blockquote><p>Looks for a string <var>str</var> within the first <var>max-no-chars</var> chars
of the input port <var>in-port</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>find-string-from-port?</b><var> str in-port<a name="index-find_002dstring_002dfrom_002dport_003f-1547"></a></var><br>
<blockquote><p>When called with two arguments, the search span is limited by the end of
the input stream. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>find-string-from-port?</b><var> str in-port char<a name="index-find_002dstring_002dfrom_002dport_003f-1548"></a></var><br>
<blockquote><p>Searches up to the first occurrence of character <var>char</var> in
<var>str</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>find-string-from-port?</b><var> str in-port proc<a name="index-find_002dstring_002dfrom_002dport_003f-1549"></a></var><br>
<blockquote><p>Searches up to the first occurrence of the procedure <var>proc</var>
returning non-false when called with a character (from <var>in-port</var>)
argument.

       <p>When the <var>str</var> is found, <code>find-string-from-port?</code> returns the
number of characters it has read from the port, and the port is set to
read the first char after that (that is, after the <var>str</var>) The
function returns <code>#f</code> when the <var>str</var> isn't found.

       <p><code>find-string-from-port?</code> reads the port <em>strictly</em>
sequentially, and does not perform any buffering.  So
<code>find-string-from-port?</code> can be used even if the <var>in-port</var> is
open to a pipe or other communication channel. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-subst</b><var> txt old1 new1 <small class="dots">...</small><a name="index-string_002dsubst-1550"></a></var><br>
<blockquote><p>Returns a copy of string <var>txt</var> with all occurrences of string
<var>old1</var> in <var>txt</var> replaced with <var>new1</var>; then <var>old2</var>
replaced with <var>new2</var> <small class="dots">...</small>.  Matches are found from the left. 
Matches do not overlap. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>count-newlines</b><var> str<a name="index-count_002dnewlines-1551"></a></var><br>
<blockquote><p>Returns the number of &lsquo;<samp><span class="samp">#\newline</span></samp>&rsquo; characters in string <var>str</var>. 
</p></blockquote></div>

<div class="node">
<a name="Sequence-Comparison"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#String-Search">String Search</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Sorting-and-Searching">Sorting and Searching</a>

</div>

<h4 class="subsection">7.2.10 Sequence Comparison</h4>

<p><code>(require 'diff)</code>
<a name="index-diff-1552"></a><a name="index-Sequence-Comparison-1553"></a>

<p class="noindent"><code>diff:edit-length</code> implements the algorithm:

<p class="noindent">The values returned by <code>diff:edit-length</code> can be used to gauge
the degree of match between two sequences.

<p class="noindent"><code>diff:edits</code> and <code>diff:longest-common-subsequence</code> combine
the algorithm with the divide-and-conquer method outlined in:

<p class="noindent">If the items being sequenced are text lines, then the computed
edit-list is equivalent to the output of the <dfn>diff</dfn> utility
<a name="index-diff-1554"></a>program.  If the items being sequenced are words, then it is like the
lesser known <dfn>spiff</dfn> program. 
<a name="index-spiff-1555"></a>

<div class="defun">
&mdash; Function: <b>diff:longest-common-subsequence</b><var> array1 array2 p-lim<a name="index-diff_003alongest_002dcommon_002dsubsequence-1556"></a></var><br>

  &mdash; Function: <b>diff:longest-common-subsequence</b><var> array1 array2<a name="index-diff_003alongest_002dcommon_002dsubsequence-1557"></a></var><br>
<blockquote><p><var>array1</var> and <var>array2</var> are one-dimensional arrays.

       <p>The non-negative integer <var>p-lim</var>, if provided, is maximum number of
deletions of the shorter sequence to allow.  <code>diff:longest-common-subsequence</code> will return <code>#f</code>
if more deletions would be necessary.

       <p><code>diff:longest-common-subsequence</code> returns a one-dimensional array of length <code>(quotient (- (+
len1 len2) (diff:edit-length </code><var>array1</var> <var>array2</var><code>)) 2)</code> holding the longest sequence
common to both <var>array</var>s. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>diff:edits</b><var> array1 array2 p-lim<a name="index-diff_003aedits-1558"></a></var><br>

  &mdash; Function: <b>diff:edits</b><var> array1 array2<a name="index-diff_003aedits-1559"></a></var><br>
<blockquote><p><var>array1</var> and <var>array2</var> are one-dimensional arrays.

       <p>The non-negative integer <var>p-lim</var>, if provided, is maximum number of
deletions of the shorter sequence to allow.  <code>diff:edits</code> will return <code>#f</code>
if more deletions would be necessary.

       <p><code>diff:edits</code> returns a vector of length <code>(diff:edit-length </code><var>array1</var> <var>array2</var><code>)</code> composed
of a shortest sequence of edits transformaing <var>array1</var> to <var>array2</var>.

       <p>Each edit is an integer:
          <dl>
<dt><var>k</var> &gt; 0<dd>Inserts <code>(array-ref </code><var>array1</var><code> (+ -1 </code><var>j</var><code>))</code> into the sequence. 
<br><dt><var>k</var> &lt; 0<dd>Deletes <code>(array-ref </code><var>array2</var><code> (- -1 </code><var>k</var><code>))</code> from the sequence. 
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>diff:edit-length</b><var> array1 array2 p-lim<a name="index-diff_003aedit_002dlength-1560"></a></var><br>

  &mdash; Function: <b>diff:edit-length</b><var> array1 array2<a name="index-diff_003aedit_002dlength-1561"></a></var><br>
<blockquote><p><var>array1</var> and <var>array2</var> are one-dimensional arrays.

       <p>The non-negative integer <var>p-lim</var>, if provided, is maximum number of
deletions of the shorter sequence to allow.  <code>diff:edit-length</code> will return <code>#f</code>
if more deletions would be necessary.

       <p><code>diff:edit-length</code> returns the length of the shortest sequence of edits transformaing
<var>array1</var> to <var>array2</var>. 
</p></blockquote></div>

<pre class="example">     (diff:longest-common-subsequence "fghiejcklm" "fgehijkpqrlm")
     &rArr; "fghijklm"
     
     (diff:edit-length "fghiejcklm" "fgehijkpqrlm")
     &rArr; 6
     
     (diff:edits "fghiejcklm" "fgehijkpqrlm")
     &rArr; #A:fixZ32b(3 -5 -7 8 9 10)
            ; e  c  h p q  r
</pre>
  <div class="node">
<a name="Procedures"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Standards-Support">Standards Support</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Sorting-and-Searching">Sorting and Searching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Packages">Other Packages</a>

</div>

<h3 class="section">7.3 Procedures</h3>

<p>Anything that doesn't fall neatly into any of the other categories winds
up here.

<ul class="menu">
<li><a accesskey="1" href="#Type-Coercion">Type Coercion</a>:                'coerce
<li><a accesskey="2" href="#String_002dCase">String-Case</a>:                  'string-case
<li><a accesskey="3" href="#String-Ports">String Ports</a>:                 'string-port
<li><a accesskey="4" href="#Line-I_002fO">Line I/O</a>:                     'line-i/o
<li><a accesskey="5" href="#Multi_002dProcessing">Multi-Processing</a>:             'process
<li><a accesskey="6" href="#Metric-Units">Metric Units</a>:                 Portable manifest types for numeric values. 
</ul>

<div class="node">
<a name="Type-Coercion"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#String_002dCase">String-Case</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Procedures">Procedures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Procedures">Procedures</a>

</div>

<h4 class="subsection">7.3.1 Type Coercion</h4>

<p><code>(require 'coerce)</code>
<a name="index-coerce-1562"></a>

<div class="defun">
&mdash; Function: <b>type-of</b><var> obj<a name="index-type_002dof-1563"></a></var><br>
<blockquote>
       <p>Returns a symbol name for the type of <var>obj</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>coerce</b><var> obj result-type<a name="index-coerce-1564"></a></var><br>
<blockquote>
       <p>Converts and returns <var>obj</var> of type <code>char</code>, <code>number</code>,
<code>string</code>, <code>symbol</code>, <code>list</code>, or <code>vector</code> to
<var>result-type</var> (which must be one of these symbols). 
</p></blockquote></div>

<div class="node">
<a name="String-Case"></a>
<a name="String_002dCase"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#String-Ports">String Ports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Type-Coercion">Type Coercion</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Procedures">Procedures</a>

</div>

<h4 class="subsection">7.3.2 String-Case</h4>

<p><code>(require 'string-case)</code>
<a name="index-string_002dcase-1565"></a>

<div class="defun">
&mdash; Procedure: <b>string-upcase</b><var> str<a name="index-string_002dupcase-1566"></a></var><br>
&mdash; Procedure: <b>string-downcase</b><var> str<a name="index-string_002ddowncase-1567"></a></var><br>
&mdash; Procedure: <b>string-capitalize</b><var> str<a name="index-string_002dcapitalize-1568"></a></var><br>
<blockquote><p>The obvious string conversion routines.  These are non-destructive. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-upcase!</b><var> str<a name="index-string_002dupcase_0021-1569"></a></var><br>
&mdash; Function: <b>string-downcase!</b><var> str<a name="index-string_002ddowncase_0021-1570"></a></var><br>
&mdash; Function: <b>string-capitalize!</b><var> str<a name="index-string_002dcapitalize_0021-1571"></a></var><br>
<blockquote><p>The destructive versions of the functions above. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-ci-&gt;symbol</b><var> str<a name="index-string_002dci_002d_003esymbol-1572"></a></var><br>
<blockquote><p>Converts string <var>str</var> to a symbol having the same case as if the
symbol had been <code>read</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>symbol-append</b><var> obj1 <small class="dots">...</small><a name="index-symbol_002dappend-1573"></a></var><br>
<blockquote><p>Converts <var>obj1</var> <small class="dots">...</small> to strings, appends them, and converts to a
symbol which is returned.  Strings and numbers are converted to read's
symbol case; the case of symbol characters is not changed.  #f is
converted to the empty string (symbol). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>StudlyCapsExpand</b><var> str delimiter<a name="index-StudlyCapsExpand-1574"></a></var><br>
&mdash; Function: <b>StudlyCapsExpand</b><var> str<a name="index-StudlyCapsExpand-1575"></a></var><br>
<blockquote><p><var>delimiter</var> must be a string or character.  If absent,
<var>delimiter</var> defaults to &lsquo;<samp><span class="samp">-</span></samp>&rsquo;.  <code>StudlyCapsExpand</code> returns a
copy of <var>str</var> where <var>delimiter</var> is inserted between each
lower-case character immediately followed by an upper-case character;
and between two upper-case characters immediately followed by a
lower-case character.

     <pre class="example">          (StudlyCapsExpand "aX" " ")   &rArr; "a X"
          (StudlyCapsExpand "aX" "..")  &rArr; "a..X"
          (StudlyCapsExpand "AX")       &rArr; "AX"
          (StudlyCapsExpand "Ax")       &rArr; "Ax"
          (StudlyCapsExpand "AXLE")     &rArr; "AXLE"
          (StudlyCapsExpand "aAXACz")   &rArr; "a-AXA-Cz"
          (StudlyCapsExpand "AaXACz")   &rArr; "Aa-XA-Cz"
          (StudlyCapsExpand "AAaXACz")  &rArr; "A-Aa-XA-Cz"
          (StudlyCapsExpand "AAaXAC")   &rArr; "A-Aa-XAC"
</pre>
       </blockquote></div>

<div class="node">
<a name="String-Ports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Line-I_002fO">Line I/O</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#String_002dCase">String-Case</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Procedures">Procedures</a>

</div>

<h4 class="subsection">7.3.3 String Ports</h4>

<p><code>(require 'string-port)</code>
<a name="index-string_002dport-1576"></a>

<div class="defun">
&mdash; Procedure: <b>call-with-output-string</b><var> proc<a name="index-call_002dwith_002doutput_002dstring-1577"></a></var><br>
<blockquote><p><var>proc</var> must be a procedure of one argument.  This procedure calls
<var>proc</var> with one argument: a (newly created) output port.  When the
function returns, the string composed of the characters written into the
port is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>call-with-input-string</b><var> string proc<a name="index-call_002dwith_002dinput_002dstring-1578"></a></var><br>
<blockquote><p><var>proc</var> must be a procedure of one argument.  This procedure calls
<var>proc</var> with one argument: an (newly created) input port from which
<var>string</var>'s contents may be read.  When <var>proc</var> returns, the port
is closed and the value yielded by the procedure <var>proc</var> is
returned. 
</p></blockquote></div>

<div class="node">
<a name="Line-I%2fO"></a>
<a name="Line-I_002fO"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multi_002dProcessing">Multi-Processing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#String-Ports">String Ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Procedures">Procedures</a>

</div>

<h4 class="subsection">7.3.4 Line I/O</h4>

<p><code>(require 'line-i/o)</code>
<a name="index-line_002di-1579"></a>

<div class="defun">
&mdash; Function: <b>read-line</b><var><a name="index-read_002dline-1580"></a></var><br>

  &mdash; Function: <b>read-line</b><var> port<a name="index-read_002dline-1581"></a></var><br>
<blockquote><p>Returns a string of the characters up to, but not including a
newline or end of file, updating <var>port</var> to point to the
character following the newline.  If no characters are available, an
end of file object is returned.  The <var>port</var> argument may be
omitted, in which case it defaults to the value returned by
<code>current-input-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>read-line!</b><var> string<a name="index-read_002dline_0021-1582"></a></var><br>

  &mdash; Procedure: <b>read-line!</b><var> string port<a name="index-read_002dline_0021-1583"></a></var><br>
<blockquote><p>Fills <var>string</var> with characters up to, but not including a newline or end
of file, updating the <var>port</var> to point to the last character read
or following the newline if it was read.  If no characters are
available, an end of file object is returned.  If a newline or end
of file was found, the number of characters read is returned. 
Otherwise, <code>#f</code> is returned.  The <var>port</var> argument may be
omitted, in which case it defaults to the value returned by
<code>current-input-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>write-line</b><var> string<a name="index-write_002dline-1584"></a></var><br>

  &mdash; Function: <b>write-line</b><var> string port<a name="index-write_002dline-1585"></a></var><br>
<blockquote><p>Writes <var>string</var> followed by a newline to the given <var>port</var> and returns
an unspecified value.  The <var>Port</var> argument may be omitted, in
which case it defaults to the value returned by
<code>current-input-port</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>system-&gt;line</b><var> command tmp<a name="index-system_002d_003eline-1586"></a></var><br>

  &mdash; Function: <b>system-&gt;line</b><var> command<a name="index-system_002d_003eline-1587"></a></var><br>
<blockquote><p><var>command</var> must be a string.  The string <var>tmp</var>, if supplied, is a path to use as
a temporary file.  <code>system-&gt;line</code> calls <code>system</code> with <var>command</var> as argument,
redirecting stdout to file <var>tmp</var>.  <code>system-&gt;line</code> returns a string containing the
first line of output from <var>tmp</var>.

       <p><code>system-&gt;line</code> is intended to be a portable method for getting one-line results
from programs like <code>pwd</code>, <code>whoami</code>, <code>hostname</code>,
<code>which</code>, <code>identify</code>, and <code>cksum</code>.  Its behavior when
called with programs which generate lots of output is unspecified. 
</p></blockquote></div>

<div class="node">
<a name="Multi-Processing"></a>
<a name="Multi_002dProcessing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Metric-Units">Metric Units</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Line-I_002fO">Line I/O</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Procedures">Procedures</a>

</div>

<h4 class="subsection">7.3.5 Multi-Processing</h4>

<p><code>(require 'process)</code>
<a name="index-process-1588"></a>
This module implements asynchronous (non-polled) time-sliced
multi-processing in the SCM Scheme implementation using procedures
<code>alarm</code> and <code>alarm-interrupt</code>. 
<a name="index-alarm-1589"></a><a name="index-alarm_002dinterrupt-1590"></a>Until this is ported to another implementation, consider it an example
of writing schedulers in Scheme.

<div class="defun">
&mdash; Procedure: <b>add-process!</b><var> proc<a name="index-add_002dprocess_0021-1591"></a></var><br>
<blockquote><p>Adds proc, which must be a procedure (or continuation) capable of
accepting accepting one argument, to the <code>process:queue</code>.  The
value returned is unspecified.  The argument to <var>proc</var> should be
ignored.  If <var>proc</var> returns, the process is killed. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>process:schedule!</b><var><a name="index-process_003aschedule_0021-1592"></a></var><br>
<blockquote><p>Saves the current process on <code>process:queue</code> and runs the next
process from <code>process:queue</code>.  The value returned is
unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>kill-process!</b><var><a name="index-kill_002dprocess_0021-1593"></a></var><br>
<blockquote><p>Kills the current process and runs the next process from
<code>process:queue</code>.  If there are no more processes on
<code>process:queue</code>, <code>(slib:exit)</code> is called (see <a href="#System">System</a>). 
</p></blockquote></div>

<div class="node">
<a name="Metric-Units"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multi_002dProcessing">Multi-Processing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Procedures">Procedures</a>

</div>

<h4 class="subsection">7.3.6 Metric Units</h4>

<p><code>(require 'metric-units)</code>
<a name="index-metric_002dunits-1594"></a>
<a href="http://people.csail.mit.edu/jaffer/MIXF">http://people.csail.mit.edu/jaffer/MIXF</a>

  <p><dfn>Metric Interchange Format</dfn> is a character string encoding for
numerical values and units which:

     <ul>
<li>is unambiguous in all locales;

     <li>uses only [TOG] "Portable Character Set" characters matching "Basic
Latin" characters in Plane 0 of the Universal Character Set [UCS];

     <li>is transparent to [UTF-7] and [UTF-8] UCS transformation formats;

     <li>is human readable and writable;

     <li>is machine readable and writable;

     <li>incorporates SI prefixes and units;

     <li>incorporates [ISO 6093] numbers; and

     <li>incorporates [IEC 60027-2] binary prefixes. 
</ul>

  <p>In the expression for the value of a quantity, the unit symbol is placed
after the numerical value.  A dot (PERIOD, &lsquo;<samp><span class="samp">.</span></samp>&rsquo;) is placed between
the numerical value and the unit symbol.

  <p>Within a compound unit, each of the base and derived symbols can
optionally have an attached SI prefix.

  <p>Unit symbols formed from other unit symbols by multiplication are
indicated by means of a dot (PERIOD, &lsquo;<samp><span class="samp">.</span></samp>&rsquo;) placed between them.

  <p>Unit symbols formed from other unit symbols by division are indicated by
means of a SOLIDUS (&lsquo;<samp><span class="samp">/</span></samp>&rsquo;) or negative exponents.  The SOLIDUS must
not be repeated in the same compound unit unless contained within a
parenthesized subexpression.

  <p>The grouping formed by a prefix symbol attached to a unit symbol
constitutes a new inseparable symbol (forming a multiple or submultiple
of the unit concerned) which can be raised to a positive or negative
power and which can be combined with other unit symbols to form compound
unit symbols.

  <p>The grouping formed by surrounding compound unit symbols with
parentheses (&lsquo;<samp><span class="samp">(</span></samp>&rsquo; and &lsquo;<samp><span class="samp">)</span></samp>&rsquo;) constitutes a new inseparable symbol
which can be raised to a positive or negative power and which can be
combined with other unit symbols to form compound unit symbols.

  <p>Compound prefix symbols, that is, prefix symbols formed by the
juxtaposition of two or more prefix symbols, are not permitted.

  <p>Prefix symbols are not used with the time-related unit symbols min
(minute), h (hour), d (day).  No prefix symbol may be used with dB
(decibel).  Only submultiple prefix symbols may be used with the unit
symbols L (liter), Np (neper), o (degree), oC (degree Celsius), rad
(radian), and sr (steradian).  Submultiple prefix symbols may not be
used with the unit symbols t (metric ton), r (revolution), or Bd (baud).

  <p>A unit exponent follows the unit, separated by a CIRCUMFLEX (&lsquo;<samp><span class="samp">^</span></samp>&rsquo;). 
Exponents may be positive or negative.  Fractional exponents must be
parenthesized.

<h5 class="subsubsection">7.3.6.1 SI Prefixes</h5>

<pre class="example">            Factor     Name    Symbol  |  Factor     Name    Symbol
            ======     ====    ======  |  ======     ====    ======
             1e24      yotta      Y    |   1e-1      deci       d
             1e21      zetta      Z    |   1e-2      centi      c
             1e18      exa        E    |   1e-3      milli      m
             1e15      peta       P    |   1e-6      micro      u
             1e12      tera       T    |   1e-9      nano       n
             1e9       giga       G    |   1e-12     pico       p
             1e6       mega       M    |   1e-15     femto      f
             1e3       kilo       k    |   1e-18     atto       a
             1e2       hecto      h    |   1e-21     zepto      z
             1e1       deka       da   |   1e-24     yocto      y
</pre>
<h5 class="subsubsection">7.3.6.2 Binary Prefixes</h5>

<p>These binary prefixes are valid only with the units B (byte) and bit. 
However, decimal prefixes can also be used with bit; and decimal
multiple (not submultiple) prefixes can also be used with B (byte).

<pre class="example">                     Factor       (power-of-2)  Name  Symbol
                     ======       ============  ====  ======
            1.152921504606846976e18  (2^60)     exbi    Ei
               1.125899906842624e15  (2^50)     pebi    Pi
                  1.099511627776e12  (2^40)     tebi    Ti
                     1.073741824e9   (2^30)     gibi    Gi
                        1.048576e6   (2^20)     mebi    Mi
                           1.024e3   (2^10)     kibi    Ki
</pre>
  <h5 class="subsubsection">7.3.6.3 Unit Symbols</h5>

<pre class="example">         Type of Quantity      Name          Symbol   Equivalent
         ================      ====          ======   ==========
     time                      second           s
     time                      minute           min = 60.s
     time                      hour             h   = 60.min
     time                      day              d   = 24.h
     frequency                 hertz            Hz    s^-1
     signaling rate            baud             Bd    s^-1
     length                    meter            m
     volume                    liter            L     dm^3
     plane angle               radian           rad
     solid angle               steradian        sr    rad^2
     plane angle               revolution     * r   = 6.283185307179586.rad
     plane angle               degree         * o   = 2.777777777777778e-3.r
     information capacity      bit              bit
     information capacity      byte, octet      B   = 8.bit
     mass                      gram             g
     mass                      ton              t     Mg
     mass              unified atomic mass unit u   = 1.66053873e-27.kg
     amount of substance       mole             mol
     catalytic activity        katal            kat   mol/s
     thermodynamic temperature kelvin           K
     centigrade temperature    degree Celsius   oC
     luminous intensity        candela          cd
     luminous flux             lumen            lm    cd.sr
     illuminance               lux              lx    lm/m^2
     force                     newton           N     m.kg.s^-2
     pressure, stress          pascal           Pa    N/m^2
     energy, work, heat        joule            J     N.m
     energy                    electronvolt     eV  = 1.602176462e-19.J
     power, radiant flux       watt             W     J/s
     logarithm of power ratio  neper            Np
     logarithm of power ratio  decibel        * dB  = 0.1151293.Np
     electric current          ampere           A
     electric charge           coulomb          C     s.A
     electric potential, EMF   volt             V     W/A
     capacitance               farad            F     C/V
     electric resistance       ohm              Ohm   V/A
     electric conductance      siemens          S     A/V
     magnetic flux             weber            Wb    V.s
     magnetic flux density     tesla            T     Wb/m^2
     inductance                henry            H     Wb/A
     radionuclide activity     becquerel        Bq    s^-1
     absorbed dose energy      gray             Gy    m^2.s^-2
     dose equivalent           sievert          Sv    m^2.s^-2
</pre>
  <p>* The formulas are:

     <ul>
<li>r/rad = 8 * atan(1)
<li>o/r = 1 / 360
<li>db/Np = ln(10) / 20
</ul>

<div class="defun">
&mdash; Function: <b>si:conversion-factor</b><var> to-unit from-unit<a name="index-si_003aconversion_002dfactor-1595"></a></var><br>
<blockquote><p>If the strings <var>from-unit</var> and <var>to-unit</var> express valid unit
expressions for quantities of the same unit-dimensions, then the value
returned by <code>si:conversion-factor</code> will be such that multiplying a
numerical value expressed in <var>from-unit</var>s by the returned conversion
factor yields the numerical value expressed in <var>to-unit</var>s.

       <p>Otherwise, <code>si:conversion-factor</code> returns:

          <dl>
<dt>-3<dd>if neither <var>from-unit</var> nor <var>to-unit</var> is a syntactically valid
unit. 
<br><dt>-2<dd>if <var>from-unit</var> is not a syntactically valid unit. 
<br><dt>-1<dd>if <var>to-unit</var> is not a syntactically valid unit. 
<br><dt>0<dd>if linear conversion (by a factor) is not possible. 
</dl>

       </blockquote></div>

<pre class="example">     (si:conversion-factor "km/s" "m/s" ) &rArr; 0.001
     (si:conversion-factor "N"    "m/s" ) &rArr; 0
     (si:conversion-factor "moC"  "oC"  ) &rArr; 1000
     (si:conversion-factor "mK"   "oC"  ) &rArr; 0
     (si:conversion-factor "rad"  "o"   ) &rArr; 0.0174533
     (si:conversion-factor "K"    "o"   ) &rArr; 0
     (si:conversion-factor "K"    "K"   ) &rArr; 1
     (si:conversion-factor "oK"   "oK"  ) &rArr; -3
     (si:conversion-factor ""     "s/s" ) &rArr; 1
     (si:conversion-factor "km/h" "mph" ) &rArr; -2
</pre>
  <div class="node">
<a name="Standards-Support"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Session-Support">Session Support</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Procedures">Procedures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Packages">Other Packages</a>

</div>

<h3 class="section">7.4 Standards Support</h3>

<ul class="menu">
<li><a accesskey="1" href="#RnRS">RnRS</a>:                         Revised Reports on Scheme
<li><a accesskey="2" href="#With_002dFile">With-File</a>:                    'with-file
<li><a accesskey="3" href="#Transcripts">Transcripts</a>:                  'transcript
<li><a accesskey="4" href="#Rev2-Procedures">Rev2 Procedures</a>:              'rev2-procedures
<li><a accesskey="5" href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a>:     'rev4-optional-procedures
<li><a accesskey="6" href="#Multi_002dargument-_002f-and-_002d">Multi-argument / and -</a>:       'multiarg/and-
<li><a accesskey="7" href="#Multi_002dargument-Apply">Multi-argument Apply</a>:         'multiarg-apply
<li><a accesskey="8" href="#Rationalize">Rationalize</a>:                  'rationalize
<li><a accesskey="9" href="#Promises">Promises</a>:                     'delay
<li><a href="#Dynamic_002dWind">Dynamic-Wind</a>:                 'dynamic-wind
<li><a href="#Eval">Eval</a>:                         'eval
<li><a href="#Values">Values</a>:                       'values
<li><a href="#SRFI">SRFI</a>:                         'http://srfi.schemers.org/srfi-0/srfi-0.html
</ul>

<div class="node">
<a name="RnRS"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#With_002dFile">With-File</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Standards-Support">Standards Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.1 RnRS</h4>

<p class="noindent">The <code>r2rs</code>, <code>r3rs</code>, <code>r4rs</code>, and <code>r5rs</code> features
attempt to provide procedures and macros to bring a Scheme
implementation to the desired version of Scheme.

<div class="defun">
&mdash; Feature: <b>r2rs</b><var><a name="index-r2rs-1596"></a></var><br>
<blockquote><p><a name="index-r2rs-1597"></a>Requires features implementing procedures and optional procedures
specified by <cite>Revised^2 Report on the Algorithmic Language Scheme</cite>;
namely <code>rev3-procedures</code> and <code>rev2-procedures</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Feature: <b>r3rs</b><var><a name="index-r3rs-1598"></a></var><br>
<blockquote><p><a name="index-r3rs-1599"></a>Requires features implementing procedures and optional procedures
specified by <cite>Revised^3 Report on the Algorithmic Language Scheme</cite>;
namely <code>rev3-procedures</code>.

       <p><em>Note:</em> SLIB already mandates the <code>r3rs</code> procedures which can
be portably implemented in <code>r4rs</code> implementations. 
</p></blockquote></div>

<div class="defun">
&mdash; Feature: <b>r4rs</b><var><a name="index-r4rs-1600"></a></var><br>
<blockquote><p><a name="index-r4rs-1601"></a>Requires features implementing procedures and optional procedures
specified by <cite>Revised^4 Report on the Algorithmic Language Scheme</cite>;
namely <code>rev4-optional-procedures</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Feature: <b>r5rs</b><var><a name="index-r5rs-1602"></a></var><br>
<blockquote><p><a name="index-r5rs-1603"></a>Requires features implementing procedures and optional procedures
specified by <cite>Revised^5 Report on the Algorithmic Language Scheme</cite>;
namely <code>values</code>, <code>macro</code>, and <code>eval</code>. 
</p></blockquote></div>

<div class="node">
<a name="With-File"></a>
<a name="With_002dFile"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Transcripts">Transcripts</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#RnRS">RnRS</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.2 With-File</h4>

<p><code>(require 'with-file)</code>
<a name="index-with_002dfile-1604"></a>

<div class="defun">
&mdash; Function: <b>with-input-from-file</b><var> file thunk<a name="index-with_002dinput_002dfrom_002dfile-1605"></a></var><br>
&mdash; Function: <b>with-output-to-file</b><var> file thunk<a name="index-with_002doutput_002dto_002dfile-1606"></a></var><br>
<blockquote><p>Description found in R4RS. 
</p></blockquote></div>

<div class="node">
<a name="Transcripts"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Rev2-Procedures">Rev2 Procedures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#With_002dFile">With-File</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.3 Transcripts</h4>

<p><code>(require 'transcript)</code>
<a name="index-transcript-1607"></a>

<div class="defun">
&mdash; Function: <b>transcript-on</b><var> filename<a name="index-transcript_002don-1608"></a></var><br>
&mdash; Function: <b>transcript-off</b><var> filename<a name="index-transcript_002doff-1609"></a></var><br>
<blockquote><p>Redefines <code>read-char</code>, <code>read</code>, <code>write-char</code>,
<code>write</code>, <code>display</code>, and <code>newline</code>. 
</p></blockquote></div>

<div class="node">
<a name="Rev2-Procedures"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Transcripts">Transcripts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.4 Rev2 Procedures</h4>

<p><code>(require 'rev2-procedures)</code>
<a name="index-rev2_002dprocedures-1610"></a>
The procedures below were specified in the <cite>Revised^2 Report on
Scheme</cite>.  <strong>N.B.</strong>: The symbols <code>1+</code> and <code>-1+</code> are not
<cite>R4RS</cite> syntax.  Scheme-&gt;C, for instance, chokes on this
module.

<div class="defun">
&mdash; Procedure: <b>substring-move-left!</b><var> string1 start1 end1 string2 start2<a name="index-substring_002dmove_002dleft_0021-1611"></a></var><br>
&mdash; Procedure: <b>substring-move-right!</b><var> string1 start1 end1 string2 start2<a name="index-substring_002dmove_002dright_0021-1612"></a></var><br>
<blockquote><p><var>string1</var> and <var>string2</var> must be a strings, and <var>start1</var>,
<var>start2</var> and <var>end1</var> must be exact integers satisfying

     <pre class="display">          0 &lt;= <var>start1</var> &lt;= <var>end1</var> &lt;= (string-length <var>string1</var>)
          0 &lt;= <var>start2</var> &lt;= <var>end1</var> - <var>start1</var> + <var>start2</var> &lt;= (string-length <var>string2</var>)
</pre>
       <p><code>substring-move-left!</code> and <code>substring-move-right!</code> store
characters of <var>string1</var> beginning with index <var>start1</var>
(inclusive) and ending with index <var>end1</var> (exclusive) into
<var>string2</var> beginning with index <var>start2</var> (inclusive).

       <p><code>substring-move-left!</code> stores characters in time order of
increasing indices.  <code>substring-move-right!</code> stores characters in
time order of increasing indeces. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>substring-fill!</b><var> string start end char<a name="index-substring_002dfill_0021-1613"></a></var><br>
<blockquote><p>Fills the elements <var>start</var>&ndash;<var>end</var> of <var>string</var> with the
character <var>char</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-null?</b><var> str<a name="index-string_002dnull_003f-1614"></a></var><br>
<blockquote><p>== <code>(= 0 (string-length </code><var>str</var><code>))</code>
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>append!</b><var> pair1 <small class="dots">...</small><a name="index-append_0021-1615"></a></var><br>
<blockquote><p>Destructively appends its arguments.  Equivalent to <code>nconc</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>1+</b><var> n<a name="index-g_t1_002b-1616"></a></var><br>
<blockquote><p>Adds 1 to <var>n</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>-1+</b><var> n<a name="index-g_t_002d1_002b-1617"></a></var><br>
<blockquote><p>Subtracts 1 from <var>n</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>&lt;?</b><var><a name="index-g_t_003c_003f-1618"></a></var><br>
&mdash; Function: <b>&lt;=?</b><var><a name="index-g_t_003c_003d_003f-1619"></a></var><br>
&mdash; Function: <b>=?</b><var><a name="index-g_t_003d_003f-1620"></a></var><br>
&mdash; Function: <b>&gt;?</b><var><a name="index-g_t_003e_003f-1621"></a></var><br>
&mdash; Function: <b>&gt;=?</b><var><a name="index-g_t_003e_003d_003f-1622"></a></var><br>
<blockquote><p>These are equivalent to the procedures of the same name but without the
trailing &lsquo;<samp><span class="samp">?</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="node">
<a name="Rev4-Optional-Procedures"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multi_002dargument-_002f-and-_002d">Multi-argument / and -</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rev2-Procedures">Rev2 Procedures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.5 Rev4 Optional Procedures</h4>

<p><code>(require 'rev4-optional-procedures)</code>
<a name="index-rev4_002doptional_002dprocedures-1623"></a>
For the specification of these optional procedures,
See <a href="r4rs.html#Standard-procedures">Standard procedures</a>.

<div class="defun">
&mdash; Function: <b>list-tail</b><var> l p<a name="index-list_002dtail-1624"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>string-copy</b><var><a name="index-string_002dcopy-1625"></a></var><br>
       </div>

<div class="defun">
&mdash; Procedure: <b>string-fill!</b><var> s obj<a name="index-string_002dfill_0021-1626"></a></var><br>
       </div>

<div class="defun">
&mdash; Procedure: <b>vector-fill!</b><var> s obj<a name="index-vector_002dfill_0021-1627"></a></var><br>
       </div>

<div class="node">
<a name="Multi-argument-%2f-and--"></a>
<a name="Multi_002dargument-_002f-and-_002d"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multi_002dargument-Apply">Multi-argument Apply</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.6 Multi-argument / and -</h4>

<p><code>(require 'multiarg/and-)</code>
<a name="index-multiarg-1628"></a>
For the specification of these optional forms,
See <a href="r4rs.html#Numerical-operations">Numerical operations</a>.

<div class="defun">
&mdash; Function: <b>/</b><var> dividend divisor1 <small class="dots">...</small><a name="index-g_t_002f-1629"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>-</b><var> minuend subtrahend1 <small class="dots">...</small><a name="index-g_t_002d-1630"></a></var><br>
       </div>

<div class="node">
<a name="Multi-argument-Apply"></a>
<a name="Multi_002dargument-Apply"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Rationalize">Rationalize</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multi_002dargument-_002f-and-_002d">Multi-argument / and -</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.7 Multi-argument Apply</h4>

<p><code>(require 'multiarg-apply)</code>
<a name="index-multiarg_002dapply-1631"></a>
For the specification of this optional form,
See <a href="r4rs.html#Control-features">Control features</a>.

<div class="defun">
&mdash; Function: <b>apply</b><var> proc arg1 <small class="dots">...</small><a name="index-apply-1632"></a></var><br>
       </div>

<div class="node">
<a name="Rationalize"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Promises">Promises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multi_002dargument-Apply">Multi-argument Apply</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.8 Rationalize</h4>

<p><code>(require 'rationalize)</code>
<a name="index-rationalize-1633"></a>

<div class="defun">
&mdash; Function: <b>rationalize</b><var> x e<a name="index-rationalize-1634"></a></var><br>
<blockquote>
       <p>Computes the correct result for exact arguments (provided the
implementation supports exact rational numbers of unlimited precision);
and produces a reasonable answer for inexact arguments when inexact
arithmetic is implemented using floating-point.

       </blockquote></div>

  <p><code>Rationalize</code> has limited use in implementations lacking exact
(non-integer) rational numbers.  The following procedures return a list
of the numerator and denominator.

<div class="defun">
&mdash; Function: <b>find-ratio</b><var> x e<a name="index-find_002dratio-1635"></a></var><br>
<blockquote>
       <p><code>find-ratio</code> returns the list of the <em>simplest</em>
numerator and denominator whose quotient differs from <var>x</var> by no more
than <var>e</var>.

     <pre class="format"><tt>(find-ratio 3/97 .0001)             &rArr; (3 97)
     (find-ratio 3/97 .001)              &rArr; (1 32)
     </tt>
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>find-ratio-between</b><var> x y<a name="index-find_002dratio_002dbetween-1636"></a></var><br>
<blockquote>
       <p><code>find-ratio-between</code> returns the list of the <em>simplest</em>
numerator and denominator between <var>x</var> and <var>y</var>.

     <pre class="format"><tt>(find-ratio-between 2/7 3/5)        &rArr; (1 2)
     (find-ratio-between -3/5 -2/7)      &rArr; (-1 2)
     </tt>
</pre>
       </blockquote></div>

<div class="node">
<a name="Promises"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Dynamic_002dWind">Dynamic-Wind</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rationalize">Rationalize</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.9 Promises</h4>

<p><code>(require 'promise)</code>
<a name="index-promise-1637"></a>

<div class="defun">
&mdash; Function: <b>make-promise</b><var> proc<a name="index-make_002dpromise-1638"></a></var><br>
       </div>

<div class="defun">
&mdash; Function: <b>force</b><var> promise<a name="index-force-1639"></a></var><br>
       </div>

  <p><code>(require 'delay)</code> provides <code>force</code> and <code>delay</code>:

<div class="defun">
&mdash; Macro: <b>delay</b><var> obj<a name="index-delay-1640"></a></var><br>
<blockquote><p>Change occurrences of <code>(delay </code><var>expression</var><code>)</code> to

     <pre class="example">          (make-promise (lambda () <var>expression</var>))
</pre>
       </blockquote></div>

  <p>(see <a href="r4rs.html#Control-features">Control features</a>).

<div class="node">
<a name="Dynamic-Wind"></a>
<a name="Dynamic_002dWind"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Eval">Eval</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Promises">Promises</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.10 Dynamic-Wind</h4>

<p><code>(require 'dynamic-wind)</code>
<a name="index-dynamic_002dwind-1641"></a>
This facility is a generalization of Common LISP <code>unwind-protect</code>,
designed to take into account the fact that continuations produced by
<code>call-with-current-continuation</code> may be reentered.

<div class="defun">
&mdash; Procedure: <b>dynamic-wind</b><var> thunk1 thunk2 thunk3<a name="index-dynamic_002dwind-1642"></a></var><br>
<blockquote><p>The arguments <var>thunk1</var>, <var>thunk2</var>, and <var>thunk3</var> must all be
procedures of no arguments (thunks).

       <p><code>dynamic-wind</code> calls <var>thunk1</var>, <var>thunk2</var>, and then
<var>thunk3</var>.  The value returned by <var>thunk2</var> is returned as the
result of <code>dynamic-wind</code>.  <var>thunk3</var> is also called just before
control leaves the dynamic context of <var>thunk2</var> by calling a
continuation created outside that context.  Furthermore, <var>thunk1</var> is
called before reentering the dynamic context of <var>thunk2</var> by calling
a continuation created inside that context.  (Control is inside the
context of <var>thunk2</var> if <var>thunk2</var> is on the current return stack).

       <p><strong>Warning:</strong> There is no provision for dealing with errors or
interrupts.  If an error or interrupt occurs while using
<code>dynamic-wind</code>, the dynamic environment will be that in effect at
the time of the error or interrupt. 
</p></blockquote></div>

<div class="node">
<a name="Eval"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Values">Values</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Dynamic_002dWind">Dynamic-Wind</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.11 Eval</h4>

<p><code>(require 'eval)</code>
<a name="index-eval-1643"></a>

<div class="defun">
&mdash; Function: <b>eval</b><var> expression environment-specifier<a name="index-eval-1644"></a></var><br>
<blockquote>
       <p>Evaluates <var>expression</var> in the specified environment and returns its
value.  <var>Expression</var> must be a valid Scheme expression represented
as data, and <var>environment-specifier</var> must be a value returned by one
of the three procedures described below.  Implementations may extend
<code>eval</code> to allow non-expression programs (definitions) as the first
argument and to allow other values as environments, with the restriction
that <code>eval</code> is not allowed to create new bindings in the
environments associated with <code>null-environment</code> or
<code>scheme-report-environment</code>.

     <pre class="lisp">          (eval '(* 7 3) (scheme-report-environment 5))
                                                             &rArr;  21
          
          (let ((f (eval '(lambda (f x) (f x x))
                         (null-environment))))
            (f + 10))
                                                             &rArr;  20
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>scheme-report-environment</b><var> version<a name="index-scheme_002dreport_002denvironment-1645"></a></var><br>
&mdash; Function: <b>null-environment</b><var> version<a name="index-null_002denvironment-1646"></a></var><br>
&mdash; Function: <b>null-environment</b><var><a name="index-null_002denvironment-1647"></a></var><br>
<blockquote>
       <p><var>Version</var> must be an exact non-negative integer <var>n</var>
corresponding to a version of one of the Revised^<var>n</var> Reports on
Scheme.  <code>Scheme-report-environment</code> returns a specifier for an
environment that contains the set of bindings specified in the
corresponding report that the implementation supports. 
<code>Null-environment</code> returns a specifier for an environment that
contains only the (syntactic) bindings for all the syntactic keywords
defined in the given version of the report.

       <p>Not all versions may be available in all implementations at all times. 
However, an implementation that conforms to version <var>n</var> of the
Revised^<var>n</var> Reports on Scheme must accept version <var>n</var>.  An error
is signalled if the specified version is not available.

       <p>The effect of assigning (through the use of <code>eval</code>) a variable
bound in a <code>scheme-report-environment</code> (for example <code>car</code>) is
unspecified. Thus the environments specified by
<code>scheme-report-environment</code> may be immutable.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>interaction-environment</b><var><a name="index-interaction_002denvironment-1648"></a></var><br>
<blockquote>
       <p>This optional procedure returns a specifier for the environment that
contains implementation-defined bindings, typically a superset of those
listed in the report.  The intent is that this procedure will return the
environment in which the implementation would evaluate expressions
dynamically typed by the user. 
</p></blockquote></div>

<p class="noindent">Here are some more <code>eval</code> examples:

<pre class="example">     (require 'eval)
     &rArr; #&lt;unspecified&gt;
     (define car 'volvo)
     &rArr; #&lt;unspecified&gt;
     car
     &rArr; volvo
     (eval 'car (interaction-environment))
     &rArr; volvo
     (eval 'car (scheme-report-environment 5))
     &rArr; #&lt;primitive-procedure car&gt;
     (eval '(eval 'car (interaction-environment))
           (scheme-report-environment 5))
     &rArr; volvo
     (eval '(eval '(set! car 'buick) (interaction-environment))
           (scheme-report-environment 5))
     &rArr; #&lt;unspecified&gt;
     car
     &rArr; buick
     (eval 'car (scheme-report-environment 5))
     &rArr; #&lt;primitive-procedure car&gt;
     (eval '(eval 'car (interaction-environment))
           (scheme-report-environment 5))
     &rArr; buick
</pre>
  <div class="node">
<a name="Values"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#SRFI">SRFI</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Eval">Eval</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.12 Values</h4>

<p><code>(require 'values)</code>
<a name="index-values-1649"></a>

<div class="defun">
&mdash; Function: <b>values</b><var> obj <small class="dots">...</small><a name="index-values-1650"></a></var><br>
<blockquote><p><code>values</code> takes any number of arguments, and passes (returns) them
to its continuation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>call-with-values</b><var> thunk proc<a name="index-call_002dwith_002dvalues-1651"></a></var><br>
<blockquote><p><var>thunk</var> must be a procedure of no arguments, and <var>proc</var> must be
a procedure.  <code>call-with-values</code> calls <var>thunk</var> with a
continuation that, when passed some values, calls <var>proc</var> with those
values as arguments.

       <p>Except for continuations created by the <code>call-with-values</code>
procedure, all continuations take exactly one value, as now; the effect
of passing no value or more than one value to continuations that were
not created by the <code>call-with-values</code> procedure is
unspecified. 
</p></blockquote></div>

<div class="node">
<a name="SRFI"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Values">Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Standards-Support">Standards Support</a>

</div>

<h4 class="subsection">7.4.13 SRFI</h4>

<p><code>(require 'srfi)</code>
<a name="index-srfi-1652"></a>
Implements <dfn>Scheme Request For Implementation</dfn> (SRFI) as
<a name="index-Scheme-Request-For-Implementation-1653"></a>described at <a href="http://srfi.schemers.org/">http://srfi.schemers.org/</a>

<div class="defun">
&mdash; Macro: <b>cond-expand</b><var> &lt;clause1&gt; &lt;clause2&gt; <small class="dots">...</small><a name="index-cond_002dexpand-1654"></a></var><br>
<blockquote>
       <p><em>Syntax:</em>
Each <span class="roman">&lt;clause&gt;</span> should be of the form

     <pre class="format"><tt>(</tt><span class="roman">&lt;feature&gt;</span> <span class="roman">&lt;expression1&gt;</span><tt> <small class="dots">...</small>)</tt>
</pre>
       <p>where <span class="roman">&lt;feature&gt;</span> is a boolean expression composed of symbols and
`and', `or', and `not' of boolean expressions.  The last <span class="roman">&lt;clause&gt;</span>
may be an &ldquo;else clause,&rdquo; which has the form

     <pre class="format"><tt>(else </tt><span class="roman">&lt;expression1&gt;</span> <span class="roman">&lt;expression2&gt;</span><tt> <small class="dots">...</small>)</tt><span class="roman">.</span>
</pre>
       <p>The first clause whose feature expression is satisfied is expanded. 
If no feature expression is satisfied and there is no else clause, an
error is signaled.

       <p>SLIB <code>cond-expand</code> is an extension of SRFI-0,
<a href="http://srfi.schemers.org/srfi-0/srfi-0.html">http://srfi.schemers.org/srfi-0/srfi-0.html</a>. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#SRFI_002d1">SRFI-1</a>:                       list-processing
</ul>

     
<a name="index-srfi_002d2-1655"></a>
<ul><li>SRFI-2 <a href="#Guarded-LET_002a-special-form">Guarded LET* special form</a>
<a name="index-srfi_002d8-1656"></a><li>SRFI-8 <a href="#Binding-to-multiple-values">Binding to multiple values</a>
<a name="index-srfi_002d9-1657"></a><li>SRFI-9 <a href="#Define_002dRecord_002dType">Define-Record-Type</a>
<a name="index-srfi_002d11-1658"></a><li>SRFI-11 <a href="#Binding-to-multiple-values">Binding to multiple values</a>
<a name="index-srfi_002d23-1659"></a><li>SRFI-23 <code>(define error slib:error)</code>
<a name="index-srfi_002d28-1660"></a><li>SRFI-28 <a href="#Format">Format</a>
<a name="index-srfi_002d39-1661"></a><li>SRFI-39 <a href="#Parameter-Objects">Parameter Objects</a>
<a name="index-srfi_002d47-1662"></a><li>SRFI-47 <a href="#Arrays">Arrays</a>
<a name="index-srfi_002d59-1663"></a><li>SRFI-59 <a href="#Vicinity">Vicinity</a>
<a name="index-srfi_002d60-1664"></a><li>SRFI-60 <a href="#Bit_002dTwiddling">Bit-Twiddling</a>
<a name="index-srfi_002d61-1665"></a><li>SRFI-61 <a href="#Guarded-COND-Clause">Guarded COND Clause</a>
<a name="index-srfi_002d63-1666"></a><li>SRFI-63 <a href="#Arrays">Arrays</a>
<a name="index-srfi_002d94-1667"></a><li>SRFI-94 <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a> and <a href="#Irrational-Real-Functions">Irrational Real Functions</a>
<a name="index-srfi_002d95-1668"></a><li>SRFI-95 <a href="#Sorting">Sorting</a>
<a name="index-srfi_002d96-1669"></a><li>SRFI-96 <a href="#Universal-SLIB-Procedures">Universal SLIB Procedures</a>
</ul>

<div class="node">
<a name="SRFI-1"></a>
<a name="SRFI_002d1"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#SRFI">SRFI</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#SRFI">SRFI</a>

</div>

<h5 class="subsubsection">7.4.13.1 SRFI-1</h5>

<p><code>(require 'srfi-1)</code>
<a name="index-srfi_002d1-1670"></a>
Implements the <dfn>SRFI-1</dfn> <dfn>list-processing library</dfn> as described
<a name="index-SRFI_002d1-1671"></a><a name="index-list_002dprocessing-library-1672"></a>at <a href="http://srfi.schemers.org/srfi-1/srfi-1.html">http://srfi.schemers.org/srfi-1/srfi-1.html</a>

<h4 class="subheading">Constructors</h4>

<div class="defun">
&mdash; Function: <b>xcons</b><var> d a<a name="index-xcons-1673"></a></var><br>
<blockquote>
       <p><code>(define (xcons d a) (cons a d))</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>list-tabulate</b><var> len proc<a name="index-list_002dtabulate-1674"></a></var><br>
<blockquote>
       <p>Returns a list of length <var>len</var>.  Element <var>i</var> is
<code>(</code><var>proc</var> <var>i</var><code>)</code> for 0 &lt;= <var>i</var> &lt; <var>len</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cons*</b><var> obj1 obj2<a name="index-cons_002a-1675"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>list-copy</b><var> flist<a name="index-list_002dcopy-1676"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>iota</b><var> count start step<a name="index-iota-1677"></a></var><br>

  &mdash; Function: <b>iota</b><var> count start<a name="index-iota-1678"></a></var><br>

  &mdash; Function: <b>iota</b><var> count<a name="index-iota-1679"></a></var><br>
<blockquote><p>Returns a list of <var>count</var> numbers: (<var>start</var>, <var>start</var>+<var>step</var>, <small class="dots">...</small>,  <var>start</var>+(<var>count</var>-1)*<var>step</var>). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>circular-list</b><var> obj1 obj2 <small class="dots">...</small><a name="index-circular_002dlist-1680"></a></var><br>
<blockquote>
       <p>Returns a circular list of <var>obj1</var>, <var>obj2</var>, <small class="dots">...</small>. 
</p></blockquote></div>

<h4 class="subheading">Predicates</h4>

<div class="defun">
&mdash; Function: <b>proper-list?</b><var> obj<a name="index-proper_002dlist_003f-1681"></a></var><br>

     </div>

<div class="defun">
&mdash; Function: <b>circular-list?</b><var> x<a name="index-circular_002dlist_003f-1682"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>dotted-list?</b><var> obj<a name="index-dotted_002dlist_003f-1683"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>null-list?</b><var> obj<a name="index-null_002dlist_003f-1684"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>not-pair?</b><var> obj<a name="index-not_002dpair_003f-1685"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>list=</b><var> =pred list <small class="dots">...</small><a name="index-list_003d-1686"></a></var><br>

       </div>

<h4 class="subheading">Selectors</h4>

<div class="defun">
&mdash; Function: <b>first</b><var> pair<a name="index-first-1687"></a></var><br>

     </div>

<div class="defun">
&mdash; Function: <b>second</b><var> pair<a name="index-second-1688"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>third</b><var> pair<a name="index-third-1689"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>fourth</b><var> pair<a name="index-fourth-1690"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>fifth</b><var> pair<a name="index-fifth-1691"></a></var><br>
&mdash; Function: <b>sixth</b><var> pair<a name="index-sixth-1692"></a></var><br>
&mdash; Function: <b>seventh</b><var> pair<a name="index-seventh-1693"></a></var><br>
&mdash; Function: <b>eighth</b><var> pair<a name="index-eighth-1694"></a></var><br>
&mdash; Function: <b>ninth</b><var> pair<a name="index-ninth-1695"></a></var><br>
&mdash; Function: <b>tenth</b><var> pair<a name="index-tenth-1696"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>car+cdr</b><var> pair<a name="index-car_002bcdr-1697"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>drop</b><var> lst k<a name="index-drop-1698"></a></var><br>
&mdash; Function: <b>take</b><var> lst k<a name="index-take-1699"></a></var><br>
&mdash; Function: <b>take!</b><var> lst k<a name="index-take_0021-1700"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>take-right</b><var> lst k<a name="index-take_002dright-1701"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>drop-right</b><var> lst k<a name="index-drop_002dright-1702"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>drop-right!</b><var> lst k<a name="index-drop_002dright_0021-1703"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>split-at</b><var> lst k<a name="index-split_002dat-1704"></a></var><br>
&mdash; Function: <b>split-at!</b><var> lst k<a name="index-split_002dat_0021-1705"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>last</b><var> lst k <small class="dots">...</small><a name="index-last-1706"></a></var><br>

       </div>

<h4 class="subheading">Miscellaneous</h4>

<div class="defun">
&mdash; Function: <b>length+</b><var> clist<a name="index-length_002b-1707"></a></var><br>

     </div>

<div class="defun">
&mdash; Function: <b>concatenate</b><var> lists<a name="index-concatenate-1708"></a></var><br>
&mdash; Function: <b>concatenate!</b><var> lists<a name="index-concatenate_0021-1709"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>reverse!</b><var> lst<a name="index-reverse_0021-1710"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>append-reverse</b><var> rev-head tail<a name="index-append_002dreverse-1711"></a></var><br>
&mdash; Function: <b>append-reverse!</b><var> rev-head tail<a name="index-append_002dreverse_0021-1712"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>zip</b><var> list1 list2 <small class="dots">...</small><a name="index-zip-1713"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>unzip1</b><var> lst<a name="index-unzip1-1714"></a></var><br>
&mdash; Function: <b>unzip2</b><var> lst<a name="index-unzip2-1715"></a></var><br>
&mdash; Function: <b>unzip3</b><var> lst<a name="index-unzip3-1716"></a></var><br>
&mdash; Function: <b>unzip4</b><var> lst<a name="index-unzip4-1717"></a></var><br>
&mdash; Function: <b>unzip5</b><var> lst<a name="index-unzip5-1718"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>count</b><var> pred list1 list2 <small class="dots">...</small><a name="index-count-1719"></a></var><br>

       </div>

<h4 class="subheading">Fold and Unfold</h4>

<div class="defun">
&mdash; Function: <b>fold</b><var> kons knil clist1 clist2 <small class="dots">...</small><a name="index-fold-1720"></a></var><br>

     </div>

<div class="defun">
&mdash; Function: <b>fold-right</b><var> kons knil clist1 clist2 <small class="dots">...</small><a name="index-fold_002dright-1721"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>pair-fold</b><var> kons knil clist1 clist2 <small class="dots">...</small><a name="index-pair_002dfold-1722"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>pair-fold-right</b><var> kons knil clist1 clist2 <small class="dots">...</small><a name="index-pair_002dfold_002dright-1723"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>reduce</b><var> arg <small class="dots">...</small><a name="index-reduce-1724"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>map!</b><var> f clist1 clist2 <small class="dots">...</small><a name="index-map_0021-1725"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>pair-for-each</b><var> f clist1 clist2 <small class="dots">...</small><a name="index-pair_002dfor_002deach-1726"></a></var><br>

       </div>

<h4 class="subheading">Filtering and Partitioning</h4>

<div class="defun">
&mdash; Function: <b>filter</b><var> pred list<a name="index-filter-1727"></a></var><br>

     </div>

<div class="defun">
&mdash; Procedure: <b>filter!</b><var> pred list<a name="index-filter_0021-1728"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>partition</b><var> pred list<a name="index-partition-1729"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>remove</b><var> pred list<a name="index-remove-1730"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>partition!</b><var> pred list<a name="index-partition_0021-1731"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>remove!</b><var> pred list<a name="index-remove_0021-1732"></a></var><br>

       </div>

<h4 class="subheading">Searching</h4>

<div class="defun">
&mdash; Function: <b>find</b><var> pred clist<a name="index-find-1733"></a></var><br>

     </div>

<div class="defun">
&mdash; Function: <b>find-tail</b><var> pred clist<a name="index-find_002dtail-1734"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>span</b><var> pred list<a name="index-span-1735"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>span!</b><var> pred list<a name="index-span_0021-1736"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>break</b><var> pred list<a name="index-break-1737"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>break!</b><var> pred list<a name="index-break_0021-1738"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>any</b><var> pred clist1 clist2 <small class="dots">...</small><a name="index-any-1739"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>list-index</b><var> pred clist1 clist2 <small class="dots">...</small><a name="index-list_002dindex-1740"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>member</b><var> obj list =<a name="index-member-1741"></a></var><br>

  &mdash; Function: <b>member</b><var> obj list<a name="index-member-1742"></a></var><br>
       </div>

<h4 class="subheading">Deleting</h4>

<div class="defun">
&mdash; Function: <b>delete-duplicates</b><var> x list =<a name="index-delete_002dduplicates-1743"></a></var><br>

  &mdash; Function: <b>delete-duplicates</b><var> x list<a name="index-delete_002dduplicates-1744"></a></var><br>
     </div>

<div class="defun">
&mdash; Procedure: <b>delete-duplicates!</b><var> x list =<a name="index-delete_002dduplicates_0021-1745"></a></var><br>

  &mdash; Procedure: <b>delete-duplicates!</b><var> x list<a name="index-delete_002dduplicates_0021-1746"></a></var><br>
       </div>

<h4 class="subheading">Association lists</h4>

<div class="defun">
&mdash; Function: <b>assoc</b><var> obj alist pred<a name="index-assoc-1747"></a></var><br>

  &mdash; Function: <b>assoc</b><var> obj alist<a name="index-assoc-1748"></a></var><br>
     </div>

<div class="defun">
&mdash; Function: <b>alist-cons</b><var> key datum alist<a name="index-alist_002dcons-1749"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>alist-copy</b><var> alist<a name="index-alist_002dcopy-1750"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>alist-delete</b><var> key alist =<a name="index-alist_002ddelete-1751"></a></var><br>

  &mdash; Function: <b>alist-delete</b><var> key alist<a name="index-alist_002ddelete-1752"></a></var><br>
       </div>

<div class="defun">
&mdash; Procedure: <b>alist-delete!</b><var> key alist =<a name="index-alist_002ddelete_0021-1753"></a></var><br>

  &mdash; Procedure: <b>alist-delete!</b><var> key alist<a name="index-alist_002ddelete_0021-1754"></a></var><br>
       </div>

<h4 class="subheading">Set operations</h4>

<div class="defun">
&mdash; Function: <b>lset&lt;=</b><var> = list1 <small class="dots">...</small><a name="index-lset_003c_003d-1755"></a></var><br>
<blockquote>
       <p>Determine if a  transitive subset relation exists between the lists <var>list1</var>
<small class="dots">...</small>, using <var>=</var> to determine equality of list members. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lset=</b><var> = list1 list2 <small class="dots">...</small><a name="index-lset_003d-1756"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>lset-adjoin</b><var> list elt1 <small class="dots">...</small><a name="index-lset_002dadjoin-1757"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>lset-union</b><var> = list1 <small class="dots">...</small><a name="index-lset_002dunion-1758"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>lset-intersection</b><var> = list1 list2 <small class="dots">...</small><a name="index-lset_002dintersection-1759"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>lset-difference</b><var> = list1 list2 <small class="dots">...</small><a name="index-lset_002ddifference-1760"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>lset-xor</b><var> = list1 <small class="dots">...</small><a name="index-lset_002dxor-1761"></a></var><br>

       </div>

<div class="defun">
&mdash; Function: <b>lset-diff+intersection</b><var> = list1 list2 <small class="dots">...</small><a name="index-lset_002ddiff_002bintersection-1762"></a></var><br>

       </div>

<p class="noindent">These are linear-update variants.  They are allowed, but not
required, to use the cons cells in their first list parameter to
construct their answer.  <code>lset-union!</code> is permitted to recycle
cons cells from any of its list arguments.

<div class="defun">
&mdash; Procedure: <b>lset-intersection!</b><var> = list1 list2 <small class="dots">...</small><a name="index-lset_002dintersection_0021-1763"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>lset-difference!</b><var> = list1 list2 <small class="dots">...</small><a name="index-lset_002ddifference_0021-1764"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>lset-union!</b><var> = list1 <small class="dots">...</small><a name="index-lset_002dunion_0021-1765"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>lset-xor!</b><var> = list1 <small class="dots">...</small><a name="index-lset_002dxor_0021-1766"></a></var><br>

       </div>

<div class="defun">
&mdash; Procedure: <b>lset-diff+intersection!</b><var> = list1 list2 <small class="dots">...</small><a name="index-lset_002ddiff_002bintersection_0021-1767"></a></var><br>

       </div>

<div class="node">
<a name="Session-Support"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#System-Interface">System Interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Standards-Support">Standards Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Packages">Other Packages</a>

</div>

<h3 class="section">7.5 Session Support</h3>

<p class="noindent">If <code>(provided? 'abort)</code>:

<div class="defun">
&mdash; Function: <b>abort</b><var><a name="index-abort-1768"></a></var><br>
<blockquote><p>Resumes the top level Read-Eval-Print loop.  If provided, <code>abort</code>
is used by the <code>break</code> and <code>debug</code> packages. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#Repl">Repl</a>:                         Macros at top-level
<li><a accesskey="2" href="#Quick-Print">Quick Print</a>:                  Loop-safe Output
<li><a accesskey="3" href="#Debug">Debug</a>:                        To err is human ... 
<li><a accesskey="4" href="#Breakpoints">Breakpoints</a>:                  Pause execution
<li><a accesskey="5" href="#Trace">Trace</a>:                        'trace
</ul>

<div class="node">
<a name="Repl"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Quick-Print">Quick Print</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Session-Support">Session Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Session-Support">Session Support</a>

</div>

<h4 class="subsection">7.5.1 Repl</h4>

<p><code>(require 'repl)</code>
<a name="index-repl-1769"></a>
Here is a read-eval-print-loop which, given an eval, evaluates forms.

<div class="defun">
&mdash; Procedure: <b>repl:top-level</b><var> repl:eval<a name="index-repl_003atop_002dlevel-1770"></a></var><br>
<blockquote><p><code>read</code>s, <code>repl:eval</code>s and <code>write</code>s expressions from
<code>(current-input-port)</code> to <code>(current-output-port)</code> until an
end-of-file is encountered.  <code>load</code>, <code>slib:eval</code>,
<code>slib:error</code>, and <code>repl:quit</code> dynamically bound during
<code>repl:top-level</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>repl:quit</b><var><a name="index-repl_003aquit-1771"></a></var><br>
<blockquote><p>Exits from the invocation of <code>repl:top-level</code>. 
</p></blockquote></div>

  <p>The <code>repl:</code> procedures establish, as much as is possible to do
portably, a top level environment supporting macros. 
<code>repl:top-level</code> uses <code>dynamic-wind</code> to catch error conditions
and interrupts.  If your implementation supports this you are all set.

  <p>Otherwise, if there is some way your implementation can catch error
conditions and interrupts, then have them call <code>slib:error</code>.  It
will display its arguments and reenter <code>repl:top-level</code>. 
<code>slib:error</code> dynamically bound by <code>repl:top-level</code>.

  <p>To have your top level loop always use macros, add any interrupt
catching lines and the following lines to your Scheme init file:
<pre class="lisp">     (require 'macro)
     <a name="index-macro-1772"></a>(require 'repl)
     <a name="index-repl-1773"></a>(repl:top-level macro:eval)
</pre>
  <div class="node">
<a name="Quick-Print"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Debug">Debug</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Repl">Repl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Session-Support">Session Support</a>

</div>

<h4 class="subsection">7.5.2 Quick Print</h4>

<p><code>(require 'qp)</code>
<a name="index-qp-1774"></a>
When displaying error messages and warnings, it is paramount that the
output generated for circular lists and large data structures be
limited.  This section supplies a procedure to do this.  It could be
much improved.

  <blockquote>
Notice that the neccessity for truncating output eliminates
Common-Lisp's <a href="#Format">Format</a> from consideration; even when variables
<code>*print-level*</code> and <code>*print-level*</code> are set, huge strings and
bit-vectors are <em>not</em> limited. 
</blockquote>

<div class="defun">
&mdash; Procedure: <b>qp</b><var> arg1 <small class="dots">...</small><a name="index-qp-1775"></a></var><br>
&mdash; Procedure: <b>qpn</b><var> arg1 <small class="dots">...</small><a name="index-qpn-1776"></a></var><br>
&mdash; Procedure: <b>qpr</b><var> arg1 <small class="dots">...</small><a name="index-qpr-1777"></a></var><br>
<blockquote><p><code>qp</code> writes its arguments, separated by spaces, to
<code>(current-output-port)</code>.  <code>qp</code> compresses printing by
substituting &lsquo;<samp><span class="samp">...</span></samp>&rsquo; for substructure it does not have sufficient
room to print.  <code>qpn</code> is like <code>qp</code> but outputs a newline
before returning.  <code>qpr</code> is like <code>qpn</code> except that it returns
its last argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>*qp-width*</b><var><a name="index-g_t_002aqp_002dwidth_002a-1778"></a></var><br>
<blockquote><p><var>*qp-width*</var> is the largest number of characters that <code>qp</code>
should use.  If <var>*qp-width*</var> is #f, then all items will be
<code>write</code>n.  If <var>*qp-width*</var> is 0, then all items except
procedures will be <code>write</code>n; procedures will be indicated by
&lsquo;<samp><span class="samp">#[proc]</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="node">
<a name="Debug"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Breakpoints">Breakpoints</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Quick-Print">Quick Print</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Session-Support">Session Support</a>

</div>

<h4 class="subsection">7.5.3 Debug</h4>

<p><code>(require 'debug)</code>
<a name="index-debug-1779"></a>
Requiring <code>debug</code> automatically requires <code>trace</code> and
<code>break</code>.

<p class="noindent">An application with its own datatypes may want to substitute its own
printer for <code>qp</code>.  This example shows how to do this:

<pre class="example">     (define qpn (lambda args) ...)
     (provide 'qp)
     (require 'debug)
     <a name="index-debug-1780"></a></pre>
  <div class="defun">
&mdash; Procedure: <b>trace-all</b><var> file <small class="dots">...</small><a name="index-trace_002dall-1781"></a></var><br>
<blockquote><p>Traces (see <a href="#Trace">Trace</a>) all procedures <code>define</code>d at top-level in
<samp><span class="file">file</span></samp> <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>track-all</b><var> file <small class="dots">...</small><a name="index-track_002dall-1782"></a></var><br>
<blockquote><p>Tracks (see <a href="#Trace">Trace</a>) all procedures <code>define</code>d at top-level in
<samp><span class="file">file</span></samp> <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>stack-all</b><var> file <small class="dots">...</small><a name="index-stack_002dall-1783"></a></var><br>
<blockquote><p>Stacks (see <a href="#Trace">Trace</a>) all procedures <code>define</code>d at top-level in
<samp><span class="file">file</span></samp> <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>break-all</b><var> file <small class="dots">...</small><a name="index-break_002dall-1784"></a></var><br>
<blockquote><p>Breakpoints (see <a href="#Breakpoints">Breakpoints</a>) all procedures <code>define</code>d at
top-level in <samp><span class="file">file</span></samp> <small class="dots">...</small>. 
</p></blockquote></div>

<div class="node">
<a name="Breakpoints"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Trace">Trace</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Debug">Debug</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Session-Support">Session Support</a>

</div>

<h4 class="subsection">7.5.4 Breakpoints</h4>

<p><code>(require 'break)</code>
<a name="index-break-1785"></a>

<div class="defun">
&mdash; Function: <b>init-debug</b><var><a name="index-init_002ddebug-1786"></a></var><br>
<blockquote><p>If your Scheme implementation does not support <code>break</code> or
<code>abort</code>, a message will appear when you <code>(require 'break)</code> or
<a name="index-break-1787"></a><code>(require 'debug)</code> telling you to type <code>(init-debug)</code>.  This
<a name="index-debug-1788"></a>is in order to establish a top-level continuation.  Typing
<code>(init-debug)</code> at top level sets up a continuation for
<code>break</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>breakpoint</b><var> arg1 <small class="dots">...</small><a name="index-breakpoint-1789"></a></var><br>
<blockquote><p>Returns from the top level continuation and pushes the continuation from
which it was called on a continuation stack. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>continue</b><var><a name="index-continue-1790"></a></var><br>
<blockquote><p>Pops the topmost continuation off of the continuation stack and returns
an unspecified value to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>continue</b><var> arg1 <small class="dots">...</small><a name="index-continue-1791"></a></var><br>
<blockquote><p>Pops the topmost continuation off of the continuation stack and returns
<var>arg1</var> <small class="dots">...</small> to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>break</b><var> proc1 <small class="dots">...</small><a name="index-break-1792"></a></var><br>
<blockquote><p>Redefines the top-level named procedures given as arguments so that
<code>breakpoint</code> is called before calling <var>proc1</var> <small class="dots">...</small>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>break</b><var><a name="index-break-1793"></a></var><br>
<blockquote><p>With no arguments, makes sure that all the currently broken identifiers
are broken (even if those identifiers have been redefined) and returns a
list of the broken identifiers. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>unbreak</b><var> proc1 <small class="dots">...</small><a name="index-unbreak-1794"></a></var><br>
<blockquote><p>Turns breakpoints off for its arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>unbreak</b><var><a name="index-unbreak-1795"></a></var><br>
<blockquote><p>With no arguments, unbreaks all currently broken identifiers and returns
a list of these formerly broken identifiers. 
</p></blockquote></div>

  <p>These are <em>procedures</em> for breaking.  If defmacros are not natively
supported by your implementation, these might be more convenient to use.

<div class="defun">
&mdash; Function: <b>breakf</b><var> proc<a name="index-breakf-1796"></a></var><br>
&mdash; Function: <b>breakf</b><var> proc name<a name="index-breakf-1797"></a></var><br>
<blockquote><p>To break, type
     <pre class="lisp">          (set! <var>symbol</var> (breakf <var>symbol</var>))
</pre>
       <p class="noindent">or
     <pre class="lisp">          (set! <var>symbol</var> (breakf <var>symbol</var> '<var>symbol</var>))
</pre>
       <p class="noindent">or
     <pre class="lisp">          (define <var>symbol</var> (breakf <var>function</var>))
</pre>
       <p class="noindent">or
     <pre class="lisp">          (define <var>symbol</var> (breakf <var>function</var> '<var>symbol</var>))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>unbreakf</b><var> proc<a name="index-unbreakf-1798"></a></var><br>
<blockquote><p>To unbreak, type
     <pre class="lisp">          (set! <var>symbol</var> (unbreakf <var>symbol</var>))
</pre>
       </blockquote></div>

<div class="node">
<a name="Trace"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Breakpoints">Breakpoints</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Session-Support">Session Support</a>

</div>

<h4 class="subsection">7.5.5 Tracing</h4>

<p><code>(require 'trace)</code>
<a name="index-trace-1799"></a>
This feature provides three ways to monitor procedure invocations:

     <dl>
<dt>stack<dd>Pushes the procedure-name when the procedure is called; pops when it
returns. 
<br><dt>track<dd>Pushes the procedure-name and arguments when the procedure is called;
pops when it returns. 
<br><dt>trace<dd>Pushes the procedure-name and prints &lsquo;<samp><span class="samp">CALL </span><var>procedure-name</var>
<var>arg1</var><span class="samp"> ...</span></samp>&rsquo; when the procdure is called; pops and prints
&lsquo;<samp><span class="samp">RETN </span><var>procedure-name</var> <var>value</var></samp>&rsquo; when the procedure returns. 
</dl>

<div class="defun">
&mdash; Variable: <b>debug:max-count</b><var><a name="index-debug_003amax_002dcount-1800"></a></var><br>
<blockquote><p>If a traced procedure calls itself or untraced procedures which call it,
stack, track, and trace will limit the number of stack pushes to
<var>debug:max-count</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>print-call-stack</b><var><a name="index-print_002dcall_002dstack-1801"></a></var><br>
&mdash; Function: <b>print-call-stack</b><var> port<a name="index-print_002dcall_002dstack-1802"></a></var><br>
<blockquote><p>Prints the call-stack to <var>port</var> or the current-error-port. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>trace</b><var> proc1 <small class="dots">...</small><a name="index-trace-1803"></a></var><br>
<blockquote><p>Traces the top-level named procedures given as arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>trace</b><var><a name="index-trace-1804"></a></var><br>
<blockquote><p>With no arguments, makes sure that all the currently traced identifiers
are traced (even if those identifiers have been redefined) and returns a
list of the traced identifiers. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>track</b><var> proc1 <small class="dots">...</small><a name="index-track-1805"></a></var><br>
<blockquote><p>Traces the top-level named procedures given as arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>track</b><var><a name="index-track-1806"></a></var><br>
<blockquote><p>With no arguments, makes sure that all the currently tracked identifiers
are tracked (even if those identifiers have been redefined) and returns
a list of the tracked identifiers. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>stack</b><var> proc1 <small class="dots">...</small><a name="index-stack-1807"></a></var><br>
<blockquote><p>Traces the top-level named procedures given as arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>stack</b><var><a name="index-stack-1808"></a></var><br>
<blockquote><p>With no arguments, makes sure that all the currently stacked identifiers
are stacked (even if those identifiers have been redefined) and returns
a list of the stacked identifiers. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>untrace</b><var> proc1 <small class="dots">...</small><a name="index-untrace-1809"></a></var><br>
<blockquote><p>Turns tracing, tracking, and  off for its arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>untrace</b><var><a name="index-untrace-1810"></a></var><br>
<blockquote><p>With no arguments, untraces all currently traced identifiers and returns
a list of these formerly traced identifiers. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>untrack</b><var> proc1 <small class="dots">...</small><a name="index-untrack-1811"></a></var><br>
<blockquote><p>Turns tracing, tracking, and  off for its arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>untrack</b><var><a name="index-untrack-1812"></a></var><br>
<blockquote><p>With no arguments, untracks all currently tracked identifiers and returns
a list of these formerly tracked identifiers. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>unstack</b><var> proc1 <small class="dots">...</small><a name="index-unstack-1813"></a></var><br>
<blockquote><p>Turns tracing, stacking, and  off for its arguments. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>unstack</b><var><a name="index-unstack-1814"></a></var><br>
<blockquote><p>With no arguments, unstacks all currently stacked identifiers and returns
a list of these formerly stacked identifiers. 
</p></blockquote></div>

  <p>These are <em>procedures</em> for tracing.  If defmacros are not natively
supported by your implementation, these might be more convenient to use.

<div class="defun">
&mdash; Function: <b>tracef</b><var> proc<a name="index-tracef-1815"></a></var><br>
&mdash; Function: <b>tracef</b><var> proc name<a name="index-tracef-1816"></a></var><br>
&mdash; Function: <b>trackf</b><var> proc<a name="index-trackf-1817"></a></var><br>
&mdash; Function: <b>trackf</b><var> proc name<a name="index-trackf-1818"></a></var><br>
&mdash; Function: <b>stackf</b><var> proc<a name="index-stackf-1819"></a></var><br>
&mdash; Function: <b>stackf</b><var> proc name<a name="index-stackf-1820"></a></var><br>
<blockquote><p>To trace, type
     <pre class="lisp">          (set! <var>symbol</var> (tracef <var>symbol</var>))
</pre>
       <p class="noindent">or
     <pre class="lisp">          (set! <var>symbol</var> (tracef <var>symbol</var> '<var>symbol</var>))
</pre>
       <p class="noindent">or
     <pre class="lisp">          (define <var>symbol</var> (tracef <var>function</var>))
</pre>
       <p class="noindent">or
     <pre class="lisp">          (define <var>symbol</var> (tracef <var>function</var> '<var>symbol</var>))
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>untracef</b><var> proc<a name="index-untracef-1821"></a></var><br>
<blockquote><p>Removes tracing, tracking, or stacking for <var>proc</var>. 
To untrace, type
     <pre class="lisp">          (set! <var>symbol</var> (untracef <var>symbol</var>))
</pre>
       </blockquote></div>

<div class="node">
<a name="System-Interface"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Session-Support">Session Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Packages">Other Packages</a>

</div>

<h3 class="section">7.6 System Interface</h3>

<p class="noindent">If <code>(provided? 'getenv)</code>:
<a name="index-getenv-1822"></a>

<div class="defun">
&mdash; Function: <b>getenv</b><var> name<a name="index-getenv-1823"></a></var><br>
<blockquote><p>Looks up <var>name</var>, a string, in the program environment.  If <var>name</var> is
found a string of its value is returned.  Otherwise, <code>#f</code> is returned. 
</p></blockquote></div>

<p class="noindent">If <code>(provided? 'system)</code>:
<a name="index-system-1824"></a>

<div class="defun">
&mdash; Function: <b>system</b><var> command-string<a name="index-system-1825"></a></var><br>
<blockquote><p>Executes the <var>command-string</var> on the computer and returns the
integer status code.  This behaves the same as the POSIX <code>system</code>
call. 
</p></blockquote></div>

<p class="noindent">If <code>(provided? 'program-arguments)</code>:
<a name="index-program_002darguments-1826"></a>

<div class="defun">
&mdash; Function: <b>program-arguments</b><var><a name="index-program_002darguments-1827"></a></var><br>
<blockquote><p>Returns a list of strings, the first of which is the program name
followed by the command-line arguments. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#Directories">Directories</a>
<li><a accesskey="2" href="#Transactions">Transactions</a>
<li><a accesskey="3" href="#CVS">CVS</a>
</ul>

<div class="node">
<a name="Directories"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Transactions">Transactions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#System-Interface">System Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#System-Interface">System Interface</a>

</div>

<h4 class="subsection">7.6.1 Directories</h4>

<p><code>(require 'directory)</code>
<a name="index-directory-1828"></a>

<div class="defun">
&mdash; Function: <b>current-directory</b><var><a name="index-current_002ddirectory-1829"></a></var><br>
<blockquote>
       <p><code>current-directory</code> returns a string containing the absolute file
name representing the current working directory.  If this string
cannot be obtained, #f is returned.

       <p>If <code>current-directory</code> cannot be supported by the platform, then #f is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-directory</b><var> name<a name="index-make_002ddirectory-1830"></a></var><br>
<blockquote>
       <p>Creates a sub-directory <var>name</var> of the current-directory.  If
successful, <code>make-directory</code> returns #t; otherwise #f. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>directory-for-each</b><var> proc directory<a name="index-directory_002dfor_002deach-1831"></a></var><br>
<blockquote>
       <p><var>proc</var> must be a procedure taking one argument. 
&lsquo;<samp><span class="samp">Directory-For-Each</span></samp>&rsquo; applies <var>proc</var> to the (string) name of
each file in <var>directory</var>.  The dynamic order in which <var>proc</var> is
applied to the filenames is unspecified.  The value returned by
&lsquo;<samp><span class="samp">directory-for-each</span></samp>&rsquo; is unspecified.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>directory-for-each</b><var> proc directory pred<a name="index-directory_002dfor_002deach-1832"></a></var><br>
<blockquote><p>Applies <var>proc</var> only to those filenames for which the procedure
<var>pred</var> returns a non-false value.

       </blockquote></div>

<div class="defun">
&mdash; Function: <b>directory-for-each</b><var> proc directory match<a name="index-directory_002dfor_002deach-1833"></a></var><br>
<blockquote><p>Applies <var>proc</var> only to those filenames for which
<code>(filename:match?? </code><var>match</var><code>)</code> would return a non-false value
(see <a href="slib.html#Filenames">Filenames</a>).

     <pre class="example">          (require 'directory)
          (directory-for-each print "." "[A-Z]*.scm")
          -|
          "Bev2slib.scm"
          "Template.scm"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Function: <b>directory*-for-each</b><var> proc path-glob<a name="index-directory_002a_002dfor_002deach-1834"></a></var><br>
<blockquote>
       <p><var>path-glob</var> is a pathname whose last component is a (wildcard) pattern
(see <a href="slib.html#Filenames">Filenames</a>). 
<var>proc</var> must be a procedure taking one argument. 
&lsquo;<samp><span class="samp">directory*-for-each</span></samp>&rsquo; applies <var>proc</var> to the (string) name of
each file in the current directory.  The dynamic order in which <var>proc</var> is
applied to the filenames is unspecified.  The value returned by
&lsquo;<samp><span class="samp">directory*-for-each</span></samp>&rsquo; is unspecified. 
</p></blockquote></div>

<div class="node">
<a name="Transactions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#CVS">CVS</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Directories">Directories</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#System-Interface">System Interface</a>

</div>

<h4 class="subsection">7.6.2 Transactions</h4>

<p class="noindent">If <code>system</code> is provided by the Scheme implementation, the
<dfn>transact</dfn> package provides functions for file-locking and
file-replacement transactions.

  <p><code>(require 'transact)</code>
<a name="index-transact-1835"></a>

<h5 class="subsubheading">File Locking</h5>

<p class="noindent">Unix file-locking is focussed on write permissions for segments of a
existing file.  While this might be employed for (binary) database
access, it is not used for everyday contention (between users) for
text files.

<p class="noindent">Microsoft has several file-locking protocols.  Their model denies
write access to a file if any reader has it open.  This is too
restrictive.  Write access is denied even when the reader has
reached end-of-file.  And tracking read access (which is much more
common than write access) causes havoc when remote hosts crash or
disconnect.

<p class="noindent">It is bizarre that the concept of multi-user contention for
modifying files has not been adequately addressed by either of the
large operating system development efforts.  There is further irony
that both camps support contention detection and resolution only
through weak conventions of some their document editing programs.

<p class="noindent"><a name="index-file_002dlock-1836"></a>The <dfn>file-lock</dfn> procedures implement a transaction method for file
<a name="index-file_002dlock-1837"></a>replacement compatible with the methods used by the GNU <dfn>emacs</dfn>
<a name="index-emacs-1838"></a>text editor on Unix systems and the Microsoft <dfn>Word</dfn> editor. 
<a name="index-Word-1839"></a><a name="index-emacs-1840"></a>
<a name="index-certificate-1841"></a>Both protocols employ what I term a <dfn>certificate</dfn> containing the
<a name="index-certificate-1842"></a>user, hostname, time, and (on Unix) process-id. 
Intent to replace <var>file</var> is indicated by adding to <var>file</var>'s
directory a certificate object whose name is derived from
<var>file</var>.

<p class="noindent">The Microsoft Word certificate is contained in a 162 byte file named
for the visited <var>file</var> with a &lsquo;<samp><span class="samp">~$</span></samp>&rsquo; prefix. 
Emacs/Unix creates a symbolic link to a certificate named for the
visited <var>file</var> prefixed with &lsquo;<samp><span class="samp">.#</span></samp>&rsquo;. 
Because Unix systems can import Microsoft file systems, these
routines maintain and check both Emacs and Word certificates.

<div class="defun">
&mdash; Function: <b>file-lock-owner</b><var> path<a name="index-file_002dlock_002downer-1843"></a></var><br>
<blockquote>
       <p>Returns the string &lsquo;<samp><var>user</var><span class="samp">@</span><var>hostname</var></samp>&rsquo; associated with
the lock owner of file <var>path</var> if locked; and #f otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>file-lock!</b><var> path email<a name="index-file_002dlock_0021-1844"></a></var><br>

  &mdash; Procedure: <b>file-lock!</b><var> path<a name="index-file_002dlock_0021-1845"></a></var><br>
<blockquote>
       <p><var>path</var> must be a string naming the file to be locked.  If supplied, <var>email</var>
must be a string formatted as &lsquo;<samp><var>user</var><span class="samp">@</span><var>hostname</var></samp>&rsquo;.  If
absent, <var>email</var> defaults to the value returned by <code>user-email-address</code>.

       <p>If <var>path</var> is already locked, then <code>file-lock!</code> returns &lsquo;<samp><span class="samp">#f</span></samp>&rsquo;.  If <var>path</var> is
unlocked, then <code>file-lock!</code> returns the certificate string associated with the
new lock for file <var>path</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>file-unlock!</b><var> path certificate<a name="index-file_002dunlock_0021-1846"></a></var><br>
<blockquote>
       <p><var>path</var> must be a string naming the file to be unlocked.  <var>certificate</var> must be the
string returned by <code>file-lock!</code> for <var>path</var>.

       <p>If <var>path</var> is locked with <var>certificate</var>, then <code>file-unlock!</code> removes the locks and returns
&lsquo;<samp><span class="samp">#t</span></samp>&rsquo;.  Otherwise, <code>file-unlock!</code> leaves the file system unaltered and returns
&lsquo;<samp><span class="samp">#f</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>describe-file-lock</b><var> path prefix<a name="index-describe_002dfile_002dlock-1847"></a></var><br>

  &mdash; Function: <b>describe-file-lock</b><var> path<a name="index-describe_002dfile_002dlock-1848"></a></var><br>
<blockquote><p><var>path</var> must be a string naming a file.  Optional argument <var>prefix</var> is a string
printed before each line of the message.  <code>describe-file-lock</code> prints to
<code>(current-error-port)</code> that <var>path</var> is locked for writing and lists
its lock-files.

     <pre class="example">          (describe-file-lock "my.txt" "&gt;&gt; ")
          -|
          &gt;&gt; "my.txt" is locked for writing by 'luser@no.com.4829:1200536423'
          &gt;&gt; (lock files are "~$my.txt" and ".#my.txt")
</pre>
       </blockquote></div>

<h5 class="subsubheading">File Transactions</h5>

<div class="defun">
&mdash; Function: <b>emacs:backup-name</b><var> path backup-style<a name="index-emacs_003abackup_002dname-1849"></a></var><br>
<blockquote>
       <p><var>path</var> must be a string.  <var>backup-style</var> must be a symbol.  Depending on <var>backup-style</var>, <code>emacs:backup-name</code>
returns:
          <dl>
<dt><span class="roman">none</span><dd>#f
<br><dt><span class="roman">simple</span><dd>the string "<var>path</var>~"
<br><dt><span class="roman">numbered</span><dd>the string "<var>path</var>.~<var>n</var>~", where <var>n</var> is one greater than the
highest number appearing in a filename matching "<var>path</var>.~*~".  <var>n</var>
defauls to 1 when no filename matches. 
<br><dt><span class="roman">existing</span><dd>the string "<var>path</var>.~<var>n</var>~" if a numbered backup already exists in
this directory; otherwise. "<var>path</var>~"
<br><dt><span class="roman">orig</span><dd>the string "<var>path</var>.orig"
<br><dt><span class="roman">bak</span><dd>the string "<var>path</var>.bak"
</dl>
       </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>transact-file-replacement</b><var> proc path backup-style certificate<a name="index-transact_002dfile_002dreplacement-1850"></a></var><br>

  &mdash; Function: <b>transact-file-replacement</b><var> proc path backup-style<a name="index-transact_002dfile_002dreplacement-1851"></a></var><br>

  &mdash; Function: <b>transact-file-replacement</b><var> proc path<a name="index-transact_002dfile_002dreplacement-1852"></a></var><br>
<blockquote>
       <p><var>path</var> must be a string naming an existing file.  <var>backup-style</var> is one of the
symbols <span class="roman">none</span>, <span class="roman">simple</span>, <span class="roman">numbered</span>, <span class="roman">existing</span>, <span class="roman">orig</span>,
<span class="roman">bak</span> or <span class="roman">#f</span>; with meanings described above; or a string naming
the location of a backup file.  <var>backup-style</var> defaults to <span class="roman">#f</span>.  If supplied,
<var>certificate</var> is the certificate with which <var>path</var> is locked.

       <p><var>proc</var> must be a procedure taking two string arguments:
          <ul>
<li><var>path</var>, the original filename (to be read); and
<li>a temporary file-name. 
</ul>

       <p>If <var>path</var> is locked by other than <var>certificate</var>, or if <var>certificate</var> is supplied and <var>path</var> is not
locked, then <code>transact-file-replacement</code> returns #f.  If <var>certificate</var> is not supplied, then, <code>transact-file-replacement</code> creates
temporary (Emacs and Word) locks for <var>path</var> during the transaction.  The
lock status of <var>path</var> will be restored before <code>transact-file-replacement</code> returns.

       <p><code>transact-file-replacement</code> calls <var>proc</var> with <var>path</var> (which should not be modified) and a temporary
file path to be written. 
If <var>proc</var> returns any value other than <span class="roman">#t</span>, then the file named by <var>path</var>
is not altered and <code>transact-file-replacement</code> returns <span class="roman">#f</span>. 
Otherwise, <code>emacs:backup-name</code> is called with <var>path</var> and <var>backup-style</var>.  If it
returns a string, then <var>path</var> is renamed to it.

       <p>Finally, the temporary file is renamed <var>path</var>. 
<code>transact-file-replacement</code> returns #t if <var>path</var> was successfully replaced; and #f otherwise. 
</p></blockquote></div>

<h5 class="subsubheading">Identification</h5>

<div class="defun">
&mdash; Function: <b>user-email-address</b><var><a name="index-user_002demail_002daddress-1853"></a></var><br>
<blockquote>
       <p><code>user-email-address</code> returns a string of the form &lsquo;<samp><span class="samp">username@hostname</span></samp>&rsquo;.  If
this e-mail address cannot be obtained, #f is returned. 
</p></blockquote></div>

<div class="node">
<a name="CVS"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Transactions">Transactions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#System-Interface">System Interface</a>

</div>

<h4 class="subsection">7.6.3 CVS</h4>

<p><code>(require 'cvs)</code>
<a name="index-cvs-1854"></a>

<div class="defun">
&mdash; Function: <b>cvs-files</b><var> directory/<a name="index-cvs_002dfiles-1855"></a></var><br>
<blockquote><p>Returns a list of the local pathnames (with prefix <var>directory/</var>) of all
CVS controlled files in <var>directory/</var> and in <var>directory/</var>'s subdirectories. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cvs-directories</b><var> directory/<a name="index-cvs_002ddirectories-1856"></a></var><br>
<blockquote><p>Returns a list of all of <var>directory/</var> and all <var>directory/</var>'s CVS controlled
subdirectories. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cvs-root</b><var> path/<a name="index-cvs_002droot-1857"></a></var><br>
<blockquote><p>Returns the (string) contents of <var>path/</var>CVS/Root;
or <code>(getenv "CVSROOT")</code> if Root doesn't exist. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cvs-repository</b><var> directory/<a name="index-cvs_002drepository-1858"></a></var><br>
<blockquote><p>Returns the (string) contents of <var>directory/</var>CVS/Root appended
with <var>directory/</var>CVS/Repository; or #f if <var>directory/</var>CVS/Repository
doesn't exist. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>cvs-set-root!</b><var> new-root directory/<a name="index-cvs_002dset_002droot_0021-1859"></a></var><br>
<blockquote>
       <p>Writes <var>new-root</var> to file CVS/Root of <var>directory/</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>cvs-set-roots!</b><var> new-root directory/<a name="index-cvs_002dset_002droots_0021-1860"></a></var><br>
<blockquote>
       <p>Writes <var>new-root</var> to file CVS/Root of <var>directory/</var> and all its CVS subdirectories. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cvs-vet</b><var> directory/<a name="index-cvs_002dvet-1861"></a></var><br>
<blockquote>
       <p>Signals an error if CVS/Repository or CVS/Root files in <var>directory/</var> or any
subdirectory do not match. 
</p></blockquote></div>

<div class="node">
<a name="Extra-SLIB-Packages"></a>
<a name="Extra_002dSLIB-Packages"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#System-Interface">System Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Packages">Other Packages</a>

</div>

<h3 class="section">7.7 Extra-SLIB Packages</h3>

<p>Several Scheme packages have been written using SLIB.  There are several
reasons why a package might not be included in the SLIB distribution:
     <ul>
<li>Because it requires special hardware or software which is not universal. 
<li>Because it is large and of limited interest to most Scheme users. 
<li>Because it has copying terms different enough from the other SLIB
packages that its inclusion would cause confusion. 
<li>Because it is an application program, rather than a library module. 
<li>Because I have been too busy to integrate it. 
</ul>

  <p>Once an optional package is installed (and an entry added to
<code>*catalog*</code>), the <code>require</code> mechanism allows it to be called
up and used as easily as any other SLIB package.  Some optional
packages (for which <code>*catalog*</code> already has entries) available
from SLIB sites are:

     <dl>
<dt>SLIB-PSD<dd><a name="index-PSD-1862"></a>is a portable debugger for Scheme (requires emacs editor).<br>
<a href="http://groups.csail.mit.edu/mac/ftpdir/scm/slib-psd1-3.tar.gz">http://groups.csail.mit.edu/mac/ftpdir/scm/slib-psd1-3.tar.gz</a><br>
<a href="ftp://ftp.cs.indiana.edu/pub/scheme-repository/utl/slib-psd1-3.tar.gz">ftp://ftp.cs.indiana.edu/pub/scheme-repository/utl/slib-psd1-3.tar.gz</a><br>

     <p>With PSD, you can run a Scheme program in an Emacs buffer, set
breakpoints, single step evaluation and access and modify the
program's variables.  It works by instrumenting the original source
code, so it should run with any R4RS compliant Scheme.  It has been
tested with SCM, Elk 1.5, and the sci interpreter in the Scheme-&gt;C
system, but should work with other Schemes with a minimal amount of
porting, if at all.  Includes documentation and user's manual. 
Written by Pertti Kellom&auml;ki,
the Lisp Pointers article describing
PSD (Lisp Pointers VI(1):15-23, January-March 1993) is available at<br>
<a href="http://www.cs.tut.fi/staff/pk/scheme/psd/article/article.html">http://www.cs.tut.fi/staff/pk/scheme/psd/article/article.html</a>
     <pre class="sp">
     
     </pre>
     
<br><dt>SCHELOG<dd><a name="index-SCHELOG-1863"></a><a name="index-Prolog-1864"></a>is an embedding of Prolog in Scheme.<br>
<a href="http://www.ccs.neu.edu/~dorai/schelog/schelog.html">http://www.ccs.neu.edu/~dorai/schelog/schelog.html</a>
     <pre class="sp">
     
     </pre>
     
<br><dt>JFILTER<dd><a name="index-JFILTER-1865"></a><a name="index-Japanese-1866"></a><a name="index-JIS-1867"></a><a name="index-EUC-1868"></a>is a Scheme program which converts text among the JIS, EUC, and
Shift-JIS Japanese character sets.<br>
<a href="http://www.math.u-toyama.ac.jp/~iwao/Scheme/Jfilter">http://www.math.u-toyama.ac.jp/~iwao/Scheme/Jfilter</a>
</dl>

<div class="node">
<a name="About-SLIB"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Index">Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-Packages">Other Packages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">8 About SLIB</h2>

<p class="noindent">More people than I can name have contributed to SLIB.  Thanks to all of
you!

  <blockquote>
SLIB 3b5, released January 2015.<br>
Aubrey Jaffer &lt;agj@alum.mit.edu&gt;<br>
<!-- @i{Hyperactive Software} - The Maniac Inside!@* -->
</blockquote>

  <p>Current information about SLIB can be found on SLIB's <dfn>WWW</dfn> home
page:

<div align="center"><a href="http://people.csail.mit.edu/jaffer/SLIB">http://people.csail.mit.edu/jaffer/SLIB</a></div>

  <p>SLIB is part of the GNU project.

<ul class="menu">
<li><a accesskey="1" href="#Installation">Installation</a>:                 How to install SLIB on your system. 
<li><a accesskey="2" href="#The-SLIB-script">The SLIB script</a>:              Run interactive SLIB sessions. 
<li><a accesskey="3" href="#Porting">Porting</a>:                      SLIB to new platforms. 
<li><a accesskey="4" href="#Compiled-and-Implementation_002dSpecific-Features">Compiled and Implementation-Specific Features</a>
<li><a accesskey="5" href="#Coding-Guidelines">Coding Guidelines</a>:            How to write modules for SLIB. 
<li><a accesskey="6" href="#Copyrights">Copyrights</a>:                   Intellectual propery issues. 
<li><a accesskey="7" href="#About-this-manual">About this manual</a>
</ul>

<div class="node">
<a name="Installation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-SLIB-script">The SLIB script</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#About-SLIB">About SLIB</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-SLIB">About SLIB</a>

</div>

<h3 class="section">8.1 Installation</h3>

<p><a name="index-install-1869"></a><a name="index-installation-1870"></a>There are five parts to installation:

     <ul>
<li>Unpack the SLIB distribution. 
<li>Install documentation and <code>slib</code> script. 
<li>Configure the Scheme implementation(s) to locate the SLIB directory
and implementation directories. 
<li>Arrange for each Scheme implementation to load its SLIB initialization
file. 
<li>Build the SLIB catalog for each Scheme implementation. 
</ul>

<h4 class="subsection">8.1.1 Unpacking the SLIB Distribution</h4>

<p>If the SLIB distribution is a GNU/Linux RPM, it will create the SLIB
directory <samp><span class="file">/usr/share/slib</span></samp>.

  <p>If the SLIB distribution is a ZIP file, unzip the distribution to create
the SLIB directory.  Locate this <samp><span class="file">slib</span></samp> directory either in your
home directory (if only you will use this SLIB installation); or put it
in a location where libraries reside on your system.  On unix systems
this might be <samp><span class="file">/usr/share/slib</span></samp>, <samp><span class="file">/usr/local/lib/slib</span></samp>, or
<samp><span class="file">/usr/lib/slib</span></samp>.  If you know where SLIB should go on other
platforms, please inform agj@alum.mit.edu.

<h4 class="subsection">8.1.2 Install documentation and slib script</h4>

<p><a name="index-slib-1871"></a><a name="index-script-1872"></a>
<pre class="example">     make infoz
     make install
</pre>
  <h4 class="subsection">8.1.3 Configure Scheme Implementation to Locate SLIB</h4>

<p>If the Scheme implementation supports <code>getenv</code>, then the value of
the shell environment variable <var>SCHEME_LIBRARY_PATH</var> will be used
for <code>(library-vicinity)</code> if it is defined.  Currently, Bigloo,
Chez, Elk, Gambit, Gauche, Guile, Jscheme, Larceny, MITScheme,
MzScheme, RScheme, S7, STk, VSCM, and SCM support <code>getenv</code>. 
Scheme48 supports <code>getenv</code> but does not use it for determining
<code>library-vicinity</code>.  (That is done from the Makefile.)

  <p>The <code>(library-vicinity)</code> can also be set from the SLIB
initialization file or by implementation-specific means.

<h4 class="subsection">8.1.4 Configure Scheme Implementation to Locate and Implementation Directory</h4>

<p>Support for locating an implementation's auxiliary directory is uneven
among implementations.  Also, the person installing SLIB may not have
write permission to some of these directories (necessary for writing
slibcat).  Therefore, those implementations supporting <code>getenv</code>
(except SCM and Scheme48) provide a means for specifying the
<code>implementation-vicinity</code> through environment variables.  Define
the indicated environment variable to the pathname (with trailing
slash or backslash) of the desired directory.  Do not use <samp><span class="file">slib/</span></samp>
as an implementation-vicinity!

  <p><table summary=""><tr align="left"><td valign="top" width="30%">Bigloo     </td><td valign="top" width="70%">BIGLOO_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">Chez       </td><td valign="top" width="70%">CHEZ_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">ELK        </td><td valign="top" width="70%">ELK_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">Gambit     </td><td valign="top" width="70%">GAMBIT_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">Guile      </td><td valign="top" width="70%">GUILE_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">Jscheme    </td><td valign="top" width="70%">JSCHEME_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">MIT-Scheme </td><td valign="top" width="70%">MITSCHEME_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">MzScheme   </td><td valign="top" width="70%">MZSCHEME_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">RScheme    </td><td valign="top" width="70%">RSCHEME_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">S7         </td><td valign="top" width="70%">S7_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">STk        </td><td valign="top" width="70%">STK_IMPLEMENTATION_PATH
<br></td></tr><tr align="left"><td valign="top" width="30%">Vscm       </td><td valign="top" width="70%">VSCM_IMPLEMENTATION_PATH
  <br></td></tr></table>

<h4 class="subsection">8.1.5 Loading SLIB Initialization File</h4>

<p>If you use the <code>slib</code> script to start your SLIB session, then
this step is unnecessary.

  <p>Check the manifest in <samp><span class="file">README</span></samp> to find a configuration file for
your Scheme implementation.  Initialization files for most IEEE P1178
compliant Scheme Implementations are included with this distribution.

  <p>You should check the definitions of <code>software-type</code>,
<code>scheme-implementation-version</code>,
<code>implementation-vicinity</code>,
and <code>library-vicinity</code> in the initialization file.  There are
comments in the file for how to configure it.

  <p>Once this is done, modify the startup file for your Scheme
implementation to <code>load</code> this initialization file.

<h4 class="subsection">8.1.6 Build New SLIB Catalog for the Implementation</h4>

<p>When SLIB is first used from an implementation, a file named
<samp><span class="file">slibcat</span></samp> is written to the <code>implementation-vicinity</code> for that
implementation.  Because users may lack permission to write in
<code>implementation-vicinity</code>, it is good practice to build the new
catalog when installing SLIB.

  <p>To build (or rebuild) the catalog, start the Scheme implementation (with
SLIB), then:

<pre class="example">     (require 'new-catalog)
</pre>
  <p>The catalog also supports color-name dictionaries.  With an
SLIB-installed scheme implementation, type:
<pre class="example">     (require 'color-names)
     (make-slib-color-name-db)
     (require 'new-catalog)
     (slib:exit)
</pre>
  <h4 class="subsection">8.1.7 Implementation-specific Instructions</h4>

<p>Multiple implementations of Scheme can all use the same SLIB directory. 
Simply configure each implementation's initialization file as outlined
above.

<div class="defun">
&mdash; Implementation: <b>SCM</b><var><a name="index-SCM-1873"></a></var><br>
<blockquote><p>The SCM implementation does not require any initialization file as SLIB
support is already built into SCM.  See the documentation with SCM for
installation instructions. 
</p></blockquote></div>

<div class="defun">
&mdash; Implementation: <b>Larceny</b><var><a name="index-Larceny-1874"></a></var><br>
<blockquote><p>Starting with version 0.96, Larceny contains its own SLIB
initialization file, loaded by <code>(require 'srfi-96)</code>.  If
SCHEME_LIBRARY_PATH is not set, then Larceny looks for an <samp><span class="file">slib</span></samp>
subdirectory of a directory in the list returned by
<code>(current-require-path)</code>

     <pre class="example">          larceny -- -e "(require 'srfi-96)"
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>Gauche-0.9</b><var><a name="index-Gauche_002d0_002e9-1875"></a></var><br>
<blockquote><p>Gauche also supports SLIB.  It finds SLIB at installation time;
<code>(use slib)</code> to enable.

     <pre class="example">          gosh -u slib
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>ELK</b><var><a name="index-ELK-1876"></a></var><br>
<blockquote><pre class="example">          elk -i -l ${SCHEME_LIBRARY_PATH}elk.init
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>PLT Scheme</b><var><a name="index-PLT-Scheme-1877"></a></var><br>
&mdash; Implementation: <b>DrScheme</b><var><a name="index-DrScheme-1878"></a></var><br>
&mdash; Implementation: <b>MzScheme</b><var><a name="index-MzScheme-1879"></a></var><br>
<blockquote>
       <p>The <samp><span class="file">init.ss</span></samp> file in the _slibinit_ collection is an SLIB
initialization file.  To run SLIB in MzScheme:

     <pre class="example">          mzscheme -f ${SCHEME_LIBRARY_PATH}mzscheme.init
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>MIT Scheme</b><var><a name="index-MIT-Scheme-1880"></a></var><br>
<blockquote><pre class="example">          scheme -load ${SCHEME_LIBRARY_PATH}mitscheme.init
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>Gambit-C 3.0</b><var><a name="index-Gambit_002dC-3_002e0-1881"></a></var><br>
<blockquote><pre class="example">          gsi -:s ${SCHEME_LIBRARY_PATH}gambit.init -
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>SISC</b><var><a name="index-SISC-1882"></a></var><br>
<blockquote><pre class="example">          sisc -e "(load \"${SCHEME_LIBRARY_PATH}sisc.init\")" --
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>Kawa</b><var><a name="index-Kawa-1883"></a></var><br>
<blockquote><pre class="example">          kawa -f ${SCHEME_LIBRARY_PATH}kawa.init --
</pre>
       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>Guile</b><var><a name="index-Guile-1884"></a></var><br>
<blockquote><p>Guile versions 1.6 and earlier link to an archaic SLIB version.  In
RedHat or Fedora installations:

     <pre class="example">          rm /usr/share/guile/slib
          ln -s ${SCHEME_LIBRARY_PATH} /usr/share/guile/slib
</pre>
       <p>In Debian installations:

     <pre class="example">          rm /usr/share/guile/1.6/slib
          ln -s ${SCHEME_LIBRARY_PATH} /usr/share/guile/1.6/slib
</pre>
       <p><code>${SCHEME_LIBRARY_PATH}</code> is where SLIB gets installed.

       <p>Guile before version 1.8 with SLIB can then be started thus:

     <pre class="example">          guile -l ${SCHEME_LIBRARY_PATH}guile.init
</pre>
       <p>Guile version 1.8 and after with SLIB can then be started thus:

     <pre class="example">          guile -l ${SCHEME_LIBRARY_PATH}guile.init \
                -l ${SCHEME_LIBRARY_PATH}guile.use
</pre>
       <p>The Guile manual has a different way of installing SLIB:

  <p><br><a href="http://www.gnu.org/software/guile/manual/html_node/SLIB-installation.html">http://www.gnu.org/software/guile/manual/html_node/SLIB-installation.html</a><br>


       </blockquote></div>

<div class="defun">
&mdash; Implementation: <b>Scheme48</b><var><a name="index-Scheme48-1885"></a></var><br>
<blockquote><p>To make a Scheme48 image for an installation under <code>&lt;prefix&gt;</code>,

          <ol type=1 start=1>
<li><code>cd</code> to the SLIB directory
<li>type <code>make prefix=&lt;prefix&gt; slib48</code>. 
<li>To install the image, type <code>make prefix=&lt;prefix&gt; install48</code>.  This
will also create a shell script with the name <code>slib48</code> which will
invoke the saved image.
            </ol>
</p></blockquote></div>

<div class="defun">
&mdash; Implementation: <b>VSCM</b><var><a name="index-VSCM-1886"></a></var><br>
<blockquote><pre class="format">From: Matthias Blume &lt;blume @ cs.Princeton.EDU&gt;
     Date: Tue, 1 Mar 1994 11:42:31 -0500
</pre>
       <p>Disclaimer: The code below is only a quick hack.  If I find some time
to spare I might get around to make some more things work.

       <p>You have to provide <samp><span class="file">vscm.init</span></samp> as an explicit command line
argument.  Since this is not very nice I would recommend the following
installation procedure:

          <ol type=1 start=1>
<li>run scheme
<li><code>(load "vscm.init")</code>
<li><code>(slib:dump "dumpfile")</code>
<li>mv dumpfile place-where-vscm-standard-bootfile-resides.  For example:

          <p><code>mv dumpfile /usr/local/vscm/lib/scheme-boot</code>

          <p>In this case vscm should have been compiled with flag:

          <p>-DDEFAULT_BOOTFILE='"/usr/local/vscm/lib/scheme-boot"'

          <p>See Makefile (definition of DDP) for details.
            </ol>
</p></blockquote></div>

<div class="defun">
&mdash; Implementation: <b>S7</b><var><a name="index-S7-1887"></a></var><br>
<blockquote>
       <p>S7 is not a standalone implementation, but runs as the extension
language for the Snd sound editor. 
<samp><span class="file">${</span><var>SCHEME_LIBRARY_PATH</var><span class="file">}s7.init</span></samp> can be loaded from the
Snd init file or on the Snd command line thus:

     <pre class="example">          snd -l ${<var>SCHEME_LIBRARY_PATH</var>}s7.init
</pre>
       </blockquote></div>

<div class="node">
<a name="The-SLIB-script"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Porting">Porting</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installation">Installation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-SLIB">About SLIB</a>

</div>

<h3 class="section">8.2 The SLIB script</h3>

<p>SLIB comes with shell script for Unix platforms.

<pre class="example">     <b> slib </b> [ scheme | scm | gsi | mzscheme | guile
            | scheme48 | scmlit | elk | sisc | kawa ]
</pre>
  <p class="noindent">Starts an interactive Scheme-with-SLIB session.

<p class="noindent">The optional argument to the <code>slib</code> script is the Scheme
implementation to run.  Absent the argument, it searches for
implementations in the above order.

<div class="node">
<a name="Porting"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Compiled-and-Implementation_002dSpecific-Features">Compiled and Implementation-Specific Features</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-SLIB-script">The SLIB script</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-SLIB">About SLIB</a>

</div>

<h3 class="section">8.3 Porting</h3>

<p>If there is no initialization file for your Scheme implementation, you
will have to create one.  Your Scheme implementation must be largely
compliant with
<pre class="lisp">     <cite>IEEE Std 1178-1990</cite>,
     <cite>Revised^4 Report on the Algorithmic Language Scheme</cite>, or
     <cite>Revised^5 Report on the Algorithmic Language Scheme</cite>
</pre>
  <p class="noindent">in order to support SLIB.  <a rel="footnote" href="#fn-8" name="fnd-8"><sup>8</sup></a>

<p class="noindent"><a href="http://cvs.savannah.gnu.org/viewcvs/*checkout*/scm/scm/r4rstest.scm">http://cvs.savannah.gnu.org/viewcvs/*checkout*/scm/scm/r4rstest.scm</a>
is a file which checks compliance with much of R4RS.

  <p><samp><span class="file">Template.scm</span></samp> is an example configuration file.  The comments
inside will direct you on how to customize it to reflect your system. 
Give your new initialization file the implementation's name with
<samp><span class="file">.init</span></samp> appended.  For instance, if you were porting
<code>foo-scheme</code> then the initialization file might be called
<samp><span class="file">foo.init</span></samp>.

  <p>Your customized version should then be loaded as part of your scheme
implementation's initialization.  It will load <samp><span class="file">require.scm</span></samp> from
the library; this will allow the use of <code>provide</code>,
<code>provided?</code>, and <code>require</code> along with the <dfn>vicinity</dfn>
functions (these functions are documented in the sections
<a href="#Feature">Feature</a> and <a href="#Require">Require</a>).  The rest of the library will then
be accessible in a system independent fashion.

  <p>Please mail new working configuration files to <code>agj@alum.mit.edu</code>
so that they can be included in the SLIB distribution.

<div class="node">
<a name="Compiled-and-Implementation-Specific-Features"></a>
<a name="Compiled-and-Implementation_002dSpecific-Features"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Coding-Guidelines">Coding Guidelines</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Porting">Porting</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-SLIB">About SLIB</a>

</div>

<h3 class="section">8.4 Compiled and Implementation-Specific Features</h3>

<p>Often an implementation can implement an SLIB feature more efficiently
than the R4RS-compliant source code in SLIB.  Alternatively,
implementations with compilers can compile SLIB source code into
binary files which run faster than loading source code.

  <p>Additionally, the SLIB catalog can be augmented with extra-SLIB
features which can be loaded by the implementation. 
The catalog format is described in See <a href="#Library-Catalogs">Library Catalogs</a>.

  <p>These implementation-specific modifications are made when a new
catalog is created (see <a href="#Catalog-Creation">Catalog Creation</a>).  If <samp><span class="file">mkimpcat.scm</span></samp>
in <code>implementation-invicinity</code> exists, it is loaded.  That should
produce the file <samp><span class="file">implcat</span></samp> in <code>implementation-invicinity</code>,
whose associations will override those of SLIB.  <samp><span class="file">implcat</span></samp> is
copied into <samp><span class="file">slibcat</span></samp> in <code>implementation-vicinity</code> as part
of the catalog creation process; modifications to <samp><span class="file">implcat</span></samp> after
that will have no effect.

<div class="node">
<a name="Coding-Guidelines"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Copyrights">Copyrights</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Compiled-and-Implementation_002dSpecific-Features">Compiled and Implementation-Specific Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-SLIB">About SLIB</a>

</div>

<h3 class="section">8.5 Coding Guidelines</h3>

<p>All library packages are written in IEEE P1178 Scheme and assume that a
configuration file and <samp><span class="file">require.scm</span></samp> package have already been
loaded.  Other versions of Scheme can be supported in library packages
as well by using, for example, <code>(provided? 'r3rs)</code> or
<code>(require 'r3rs)</code> (see <a href="#Require">Require</a>). 
<a name="index-r3rs-1888"></a>
If a procedure defined in a module is called by other procedures in
that module, then those procedures should instead call an alias
defined in that module:

<pre class="lisp">     (define module-name:foo foo)
</pre>
  <p>The module name and &lsquo;<samp><span class="samp">:</span></samp>&rsquo; should prefix that symbol for the
internal name.  Do not export internal aliases.

  <p>A procedure is exported from a module by putting Schmooz-style
comments (see <a href="#Schmooz">Schmooz</a>) or &lsquo;<samp><span class="samp">;@</span></samp>&rsquo; at the beginning of the line
immediately preceding the definition (<code>define</code>,
<code>define-syntax</code>, or <code>defmacro</code>).  Modules, exports and other
relevant issues are discussed in <a href="#Compiling-Scheme">Compiling Scheme</a>.

  <p>Code submitted for inclusion in SLIB should not duplicate (more than
one) routines already in SLIB files.  Use <code>require</code> to force
those library routines to be used by your package.

  <p>Documentation should be provided in Emacs Texinfo format if possible,
but documentation must be provided.

  <p>Your package will be released sooner with SLIB if you send me a file
which tests your code.  Please run this test <em>before</em> you send me
the code!

<h4 class="subsection">8.5.1 Modifications</h4>

<p>Please document your changes.  A line or two for <samp><span class="file">ChangeLog</span></samp> is
sufficient for simple fixes or extensions.  Look at the format of
<samp><span class="file">ChangeLog</span></samp> to see what information is desired.  Please send me
<code>diff</code> files from the latest SLIB distribution (remember to send
<code>diff</code>s of <samp><span class="file">slib.texi</span></samp> and <samp><span class="file">ChangeLog</span></samp>).  This makes for
less email traffic and makes it easier for me to integrate when more
than one person is changing a file (this happens a lot with
<samp><span class="file">slib.texi</span></samp> and &lsquo;<samp><span class="samp">*.init</span></samp>&rsquo; files).

  <p>If someone else wrote a package you want to significantly modify, please
try to contact the author, who may be working on a new version.  This
will insure against wasting effort on obsolete versions.

  <p>Please <em>do not</em> reformat the source code with your favorite
beautifier, make 10 fixes, and send me the resulting source code.  I do
not have the time to fish through 10000 diffs to find your 10 real fixes.

<div class="node">
<a name="Copyrights"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#About-this-manual">About this manual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Coding-Guidelines">Coding Guidelines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-SLIB">About SLIB</a>

</div>

<h3 class="section">8.6 Copyrights</h3>

<p>This section has instructions for SLIB authors regarding copyrights. 
<a name="index-copyright-1889"></a>
Each package in SLIB must either be in the public domain, or come with a
statement of terms permitting users to copy, redistribute and modify it. 
The comments at the beginning of <samp><span class="file">require.scm</span></samp> and
<samp><span class="file">macwork.scm</span></samp> illustrate copyright and appropriate terms.

  <p>If your code or changes amount to less than about 10 lines, you do not
need to add your copyright or send a disclaimer.

<h4 class="subsection">8.6.1 Putting code into the Public Domain</h4>

<p>In order to put code in the public domain you should sign a copyright
disclaimer and send it to the SLIB maintainer.  Contact
agj@alum.mit.edu for the address to mail the disclaimer to.

  <blockquote>
I, <var>&lt;my-name&gt;</var>, hereby affirm that I have placed the software
package <var>&lt;name&gt;</var> in the public domain.

  <p>I affirm that I am the sole author and sole copyright holder for the
software package, that I have the right to place this software package
in the public domain, and that I will do nothing to undermine this
status in the future.
<div align="right">                                        <var>signature and date</var>
  </div>
</blockquote>

  <p>This wording assumes that you are the sole author.  If you are not the
sole author, the wording needs to be different.  If you don't want to
be bothered with sending a letter every time you release or modify a
module, make your letter say that it also applies to your future
revisions of that module.

  <p>Make sure no employer has any claim to the copyright on the work you
are submitting.  If there is any doubt, create a copyright disclaimer
and have your employer sign it.  Mail the signed disclaimer to the
SLIB maintainer.  Contact agj@alum.mit.edu for the address to mail
the disclaimer to.  An example disclaimer follows.

<h4 class="subsection">8.6.2 Explicit copying terms</h4>

<p class="noindent">If you submit more than about 10 lines of code which you are not
placing into the Public Domain (by sending me a disclaimer) you need
to:

     <ul>
<li>Arrange that your name appears in a copyright line for the appropriate
year.  Multiple copyright lines are acceptable. 
<li>With your copyright line, specify any terms you require to be
different from those already in the file. 
<li>Make sure no employer has any claim to the copyright on the work you
are submitting.  If there is any doubt, create a copyright disclaimer
and have your employer sign it.  Mail the signed disclaim to the SLIB
maintainer.  Contact agj@alum.mit.edu for the address to mail the
disclaimer to. 
</ul>

<h4 class="subsection">8.6.3 Example: Company Copyright Disclaimer</h4>

<p>This disclaimer should be signed by a vice president or general
manager of the company.  If you can't get at them, anyone else
authorized to license out software produced there will do.  Here is a
sample wording:

  <blockquote>
<var>&lt;employer&gt;</var> Corporation hereby disclaims all copyright
interest in the program <var>&lt;program&gt;</var> written by <var>&lt;name&gt;</var>.

  <p><var>&lt;employer&gt;</var> Corporation affirms that it has no other intellectual
property interest that would undermine this release, and will do
nothing to undermine it in the future.

<div align="left"><var>&lt;signature and date&gt;</var>,
<var>&lt;name&gt;</var>, <var>&lt;title&gt;</var>, <var>&lt;employer&gt;</var> Corporation
</div>
</blockquote>

<div class="node">
<a name="About-this-manual"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copyrights">Copyrights</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-SLIB">About SLIB</a>

</div>

<h3 class="section">8.7 About this manual</h3>

     <ul>
<li>Entries that are labeled as Functions are called for their return
values.  Entries that are labeled as Procedures are called primarily for
their side effects.

     <li>Examples in this text were produced using the <code>scm</code> Scheme
implementation.

     <li>At the beginning of each section, there is a line that looks like:
<a name="index-feature-1890"></a>
     <pre class="example">          (require 'feature)
</pre>
     <p>Include this line in your code prior to using the package. 
</ul>

<ul class="menu">
<li><a accesskey="1" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>
</ul>

<div class="node">
<a name="GNU-Free-Documentation-License"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#About-this-manual">About this manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#About-this-manual">About this manual</a>

</div>

<h4 class="subsection">8.7.1 GNU Free Documentation License</h4>

<!-- The GNU Free Documentation License. -->
<div align="center">Version 1.3, 3 November 2008</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.
     <a href="http://fsf.org/">http://fsf.org/</a>
     
     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.
</pre>
     <ol type=1 start=0>
<li>PREAMBLE

     <p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <dfn>free</dfn> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially. 
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.

     <p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.

     <p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.

     <li>APPLICABILITY AND DEFINITIONS

     <p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.

     <p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.

     <p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document's overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.

     <p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.

     <p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.

     <p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent. 
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.

     <p>Examples of suitable formats for Transparent copies include plain
<span class="sc">ascii</span> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.

     <p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text.

     <p>The &ldquo;publisher&rdquo; means any person or entity that distributes copies
of the Document to the public.

     <p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.

     <p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.

     <li>VERBATIM COPYING

     <p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.

     <p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.

     <li>COPYING IN QUANTITY

     <p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document's license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition. 
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.

     <p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.

     <p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material. 
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.

     <p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.

     <li>MODIFICATIONS

     <p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:

          <ol type=A start=1>
<li>Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

          <li>List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

          <li>State on the Title page the name of the publisher of the
Modified Version, as the publisher.

          <li>Preserve all the copyright notices of the Document.

          <li>Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

          <li>Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

          <li>Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document's license notice.

          <li>Include an unaltered copy of this License.

          <li>Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

          <li>Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section. 
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

          <li>For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

          <li>Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

          <li>Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

          <li>Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

          <li>Preserve any Warranty Disclaimers.
          </ol>

     <p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice. 
These titles must be distinct from any other section titles.

     <p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.

     <p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.

     <p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.

     <li>COMBINING DOCUMENTS

     <p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.

     <p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number. 
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.

     <p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;

     <li>COLLECTIONS OF DOCUMENTS

     <p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.

     <p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.

     <li>AGGREGATION WITH INDEPENDENT WORKS

     <p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation's users beyond what the individual works permit. 
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.

     <p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document's Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form. 
Otherwise they must appear on printed covers that bracket the whole
aggregate.

     <li>TRANSLATION

     <p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4. 
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.

     <p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.

     <li>TERMINATION

     <p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense, or distribute it is void, and
will automatically terminate your rights under this License.

     <p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.

     <p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

     <p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, receipt of a copy of some or all of the same material does
not give you any rights to use it.

     <li>FUTURE REVISIONS OF THIS LICENSE

     <p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.

     <p>Each version of the License is given a distinguishing version number. 
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.  If the Document
specifies that a proxy can decide which future versions of this
License can be used, that proxy's public statement of acceptance of a
version permanently authorizes you to choose that version for the
Document.

     <li>RELICENSING

     <p>&ldquo;Massive Multiauthor Collaboration Site&rdquo; (or &ldquo;MMC Site&rdquo;) means any
World Wide Web server that publishes copyrightable works and also
provides prominent facilities for anybody to edit those works.  A
public wiki that anybody can edit is an example of such a server.  A
&ldquo;Massive Multiauthor Collaboration&rdquo; (or &ldquo;MMC&rdquo;) contained in the
site means any set of copyrightable works thus published on the MMC
site.

     <p>&ldquo;CC-BY-SA&rdquo; means the Creative Commons Attribution-Share Alike 3.0
license published by Creative Commons Corporation, a not-for-profit
corporation with a principal place of business in San Francisco,
California, as well as future copyleft versions of that license
published by that same organization.

     <p>&ldquo;Incorporate&rdquo; means to publish or republish a Document, in whole or
in part, as part of another Document.

     <p>An MMC is &ldquo;eligible for relicensing&rdquo; if it is licensed under this
License, and if all works that were first published under this License
somewhere other than this MMC, and subsequently incorporated in whole
or in part into the MMC, (1) had no cover texts or invariant sections,
and (2) were thus incorporated prior to November 1, 2008.

     <p>The operator of an MMC Site may republish an MMC contained in the site
under CC-BY-SA on the same site at any time before August 1, 2009,
provided the MMC is eligible for relicensing.

       </ol>

<h3 class="heading">ADDENDUM: How to use this License for your documents</h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:

<pre class="smallexample">       Copyright (C)  <var>year</var>  <var>your name</var>.
       Permission is granted to copy, distribute and/or modify this document
       under the terms of the GNU Free Documentation License, Version 1.3
       or any later version published by the Free Software Foundation;
       with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
       Texts.  A copy of the license is included in the section entitled ``GNU
       Free Documentation License''.
</pre>
  <p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with<small class="dots">...</small>Texts.&rdquo; line with this:

<pre class="smallexample">         with the Invariant Sections being <var>list their titles</var>, with
         the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
         being <var>list</var>.
</pre>
  <p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.

  <p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.

<!-- Local Variables: -->
<!-- ispell-local-pdict: "ispell-dict" -->
<!-- End: -->
<div class="node">
<a name="Index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Procedure-and-Macro-Index">Procedure and Macro Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#About-SLIB">About SLIB</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="unnumbered">Index</h2>

<ul class="menu">
<li><a accesskey="1" href="#Procedure-and-Macro-Index">Procedure and Macro Index</a>
<li><a accesskey="2" href="#Variable-Index">Variable Index</a>
<li><a accesskey="3" href="#Concept-and-Feature-Index">Concept and Feature Index</a>
</ul>

<div class="node">
<a name="Procedure-and-Macro-Index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Variable-Index">Variable Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Index">Index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Index">Index</a>

</div>

<h2 class="unnumbered">Procedure and Macro Index</h2>

<!-- This is an alphabetical list of all the procedures and macros in SLIB. -->
<ul class="index-fn" compact>
<li><a href="#index-g_t_002d-1630"><code>-</code></a>: <a href="#Multi_002dargument-_002f-and-_002d">Multi-argument / and -</a></li>
<li><a href="#index-g_t_002d1_002b-1617"><code>-1+</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-g_t_002f-1629"><code>/</code></a>: <a href="#Multi_002dargument-_002f-and-_002d">Multi-argument / and -</a></li>
<li><a href="#index-g_t1_002b-1616"><code>1+</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-g_t_003c_003d_003f-1619"><code>&lt;=?</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-g_t_003c_003f-1618"><code>&lt;?</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-g_t_003d-1523"><code>=</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-g_t_003d_003f-1620"><code>=?</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-g_t_003e_003d_003f-1622"><code>&gt;=?</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-g_t_003e_003f-1621"><code>&gt;?</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-A_003abool-1272"><code>A:bool</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixN16b-1268"><code>A:fixN16b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixN32b-1266"><code>A:fixN32b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixN64b-1264"><code>A:fixN64b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixN8b-1270"><code>A:fixN8b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixZ16b-1260"><code>A:fixZ16b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixZ32b-1258"><code>A:fixZ32b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixZ64b-1256"><code>A:fixZ64b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afixZ8b-1262"><code>A:fixZ8b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloC128b-1234"><code>A:floC128b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloC16b-1240"><code>A:floC16b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloC32b-1238"><code>A:floC32b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloC64b-1236"><code>A:floC64b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloR128b-1242"><code>A:floR128b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloR128d-1250"><code>A:floR128d</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloR16b-1248"><code>A:floR16b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloR32b-1246"><code>A:floR32b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloR32d-1254"><code>A:floR32d</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloR64b-1244"><code>A:floR64b</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-A_003afloR64d-1252"><code>A:floR64d</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-abort-1768"><code>abort</code></a>: <a href="#Session-Support">Session Support</a></li>
<li><a href="#index-abs-618"><code>abs</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-absolute_002dpath_003f-430"><code>absolute-path?</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-absolute_002duri_003f-428"><code>absolute-uri?</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-add_002dcommand_002dtables-1085"><code>add-command-tables</code></a>: <a href="#Database-Extension">Database Extension</a></li>
<li><a href="#index-add_002ddomain-1054"><code>add-domain</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-add_002ddomain-on-relational_002ddatabase-1093"><code>add-domain on relational-database</code></a>: <a href="#Command-Intrinsics">Command Intrinsics</a></li>
<li><a href="#index-add_002dmacro_002dsupport-1108"><code>add-macro-support</code></a>: <a href="#Within_002ddatabase">Within-database</a></li>
<li><a href="#index-add_002dprocess_0021-1591"><code>add-process!</code></a>: <a href="#Multi_002dProcessing">Multi-Processing</a></li>
<li><a href="#index-add_002dsetter-196"><code>add-setter</code></a>: <a href="#Setters">Setters</a></li>
<li><a href="#index-adjoin-1436"><code>adjoin</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-adjoin_002dparameters_0021-281"><code>adjoin-parameters!</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-alist_002d_003ewt_002dtree-1191"><code>alist-&gt;wt-tree</code></a>: <a href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a></li>
<li><a href="#index-alist_002dassociator-1291"><code>alist-associator</code></a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-alist_002dcons-1749"><code>alist-cons</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-alist_002dcopy-1750"><code>alist-copy</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-alist_002ddelete-1751"><code>alist-delete</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-alist_002ddelete_0021-1753"><code>alist-delete!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-alist_002dfor_002deach-1294"><code>alist-for-each</code></a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-alist_002dinquirer-1290"><code>alist-inquirer</code></a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-alist_002dmap-1293"><code>alist-map</code></a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-alist_002dremover-1292"><code>alist-remover</code></a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-alist_002dtable-1127"><code>alist-table</code></a>: <a href="#The-Base">The Base</a></li>
<li><a href="#index-and_002dlet_002a-180"><code>and-let*</code></a>: <a href="#Guarded-LET_002a-special-form">Guarded LET* special form</a></li>
<li><a href="#index-and_003f-1467"><code>and?</code></a>: <a href="#Non_002dList-functions">Non-List functions</a></li>
<li><a href="#index-any-1739"><code>any</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-any_002dbits_002dset_003f-561"><code>any-bits-set?</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-any_003f-1375"><code>any?</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-append_0021-1615"><code>append!</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-append_002dreverse-1711"><code>append-reverse</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-append_002dreverse_0021-1712"><code>append-reverse!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-apply-1632"><code>apply</code></a>: <a href="#Multi_002dargument-Apply">Multi-argument Apply</a></li>
<li><a href="#index-arithmetic_002dshift-573"><code>arithmetic-shift</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-array_002d_003elist-1228"><code>array-&gt;list</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002d_003evector-1230"><code>array-&gt;vector</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002ddimensions-1223"><code>array-dimensions</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002dfor_002deach-1280"><code>array-for-each</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-array_002din_002dbounds_003f-1231"><code>array-in-bounds?</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002dindex_002dfor_002deach-1282"><code>array-index-for-each</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-array_002dindex_002dmap_0021-1283"><code>array-index-map!</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-array_002dindexes-1281"><code>array-indexes</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-array_002dmap-1279"><code>array-map</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-array_002dmap_0021-1278"><code>array-map!</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-array_002drank-1222"><code>array-rank</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002dref-1232"><code>array-ref</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002dset_0021-1233"><code>array-set!</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002dtrim-1276"><code>array-trim</code></a>: <a href="#Subarrays">Subarrays</a></li>
<li><a href="#index-array_003acopy_0021-1284"><code>array:copy!</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-array_003f-1220"><code>array?</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-asctime-519"><code>asctime</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-ash-572"><code>ash</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-assoc-1747"><code>assoc</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-atan-611"><code>atan</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-atom_003f-1469"><code>atom?</code></a>: <a href="#Non_002dList-functions">Non-List functions</a></li>
<li><a href="#index-attlist_002dadd-458"><code>attlist-add</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-attlist_002dremove_002dtop-459"><code>attlist-remove-top</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-batch_003acall_002dwith_002doutput_002dscript-305"><code>batch:call-with-output-script</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003acommand-306"><code>batch:command</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003acomment-310"><code>batch:comment</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003adelete_002dfile-312"><code>batch:delete-file</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003ainitialize_0021-303"><code>batch:initialize!</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003alines_002d_003efile-311"><code>batch:lines-&gt;file</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003arename_002dfile-313"><code>batch:rename-file</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003arun_002dscript-309"><code>batch:run-script</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003atry_002dchopped_002dcommand-308"><code>batch:try-chopped-command</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-batch_003atry_002dcommand-307"><code>batch:try-command</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-bit_002dfield-570"><code>bit-field</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bit_002dset_003f-568"><code>bit-set?</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bitwise_002dand-551"><code>bitwise-and</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bitwise_002dbit_002dcount-563"><code>bitwise-bit-count</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bitwise_002dif-558"><code>bitwise-if</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bitwise_002dior-553"><code>bitwise-ior</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bitwise_002dmerge-559"><code>bitwise-merge</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bitwise_002dnot-557"><code>bitwise-not</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-bitwise_002dxor-555"><code>bitwise-xor</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-blackbody_002dspectrum-907"><code>blackbody-spectrum</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-booleans_002d_003einteger-579"><code>booleans-&gt;integer</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-break-1792"><code>break</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-break-1737"><code>break</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-break_0021-1738"><code>break!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-break_002dall-1784"><code>break-all</code></a>: <a href="#Debug">Debug</a></li>
<li><a href="#index-breakf-1796"><code>breakf</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-breakpoint-1789"><code>breakpoint</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-browse-1111"><code>browse</code></a>: <a href="#Database-Browser">Database Browser</a></li>
<li><a href="#index-browse_002durl-111"><code>browse-url</code></a>: <a href="#System">System</a></li>
<li><a href="#index-butlast-1459"><code>butlast</code></a>: <a href="#Lists-as-sequences">Lists as sequences</a></li>
<li><a href="#index-butnthcdr-1461"><code>butnthcdr</code></a>: <a href="#Lists-as-sequences">Lists as sequences</a></li>
<li><a href="#index-byte_002dref-1298"><code>byte-ref</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-byte_002dset_0021-1299"><code>byte-set!</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-bytes-1303"><code>bytes</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-bytes_002d_003eieee_002ddouble-1334"><code>bytes-&gt;ieee-double</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-bytes_002d_003eieee_002dfloat-1333"><code>bytes-&gt;ieee-float</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-bytes_002d_003einteger-1331"><code>bytes-&gt;integer</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-bytes_002d_003elist-1305"><code>bytes-&gt;list</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-bytes_002d_003estring-1307"><code>bytes-&gt;string</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-bytes_002dcopy-1309"><code>bytes-copy</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-bytes_002dlength-1302"><code>bytes-length</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-bytes_002dreverse-1312"><code>bytes-reverse</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-bytes_002dreverse_0021-1311"><code>bytes-reverse!</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-call_002dwith_002ddynamic_002dbinding-1385"><code>call-with-dynamic-binding</code></a>: <a href="#Dynamic-Data-Type">Dynamic Data Type</a></li>
<li><a href="#index-call_002dwith_002dinput_002dstring-1578"><code>call-with-input-string</code></a>: <a href="#String-Ports">String Ports</a></li>
<li><a href="#index-call_002dwith_002dopen_002dports-89"><code>call-with-open-ports</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-call_002dwith_002doutput_002dstring-1577"><code>call-with-output-string</code></a>: <a href="#String-Ports">String Ports</a></li>
<li><a href="#index-call_002dwith_002dtmpnam-299"><code>call-with-tmpnam</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-call_002dwith_002dvalues-1651"><code>call-with-values</code></a>: <a href="#Values">Values</a></li>
<li><a href="#index-capture_002dsyntactic_002denvironment-150"><code>capture-syntactic-environment</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-car_002bcdr-1697"><code>car+cdr</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-cart_002dprod_002dtables-on-relational_002ddatabase-1173"><code>cart-prod-tables on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-catalog_002d_003ehtml-369"><code>catalog-&gt;html</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-catalog_002did-on-base_002dtable-1136"><code>catalog-id on base-table</code></a>: <a href="#Base-Tables">Base Tables</a></li>
<li><a href="#index-catalog_003aread-40"><code>catalog:read</code></a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-cdna_003abase_002dcount-539"><code>cdna:base-count</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-cdna_003areport_002dbase_002dcount-540"><code>cdna:report-base-count</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-cgi_003aserve_002dquery-392"><code>cgi:serve-query</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-chap_003anext_002dstring-1481"><code>chap:next-string</code></a>: <a href="#Chapter-Ordering">Chapter Ordering</a></li>
<li><a href="#index-chap_003astring_003c_003d_003f-1479"><code>chap:string&lt;=?</code></a>: <a href="#Chapter-Ordering">Chapter Ordering</a></li>
<li><a href="#index-chap_003astring_003c_003f-1477"><code>chap:string&lt;?</code></a>: <a href="#Chapter-Ordering">Chapter Ordering</a></li>
<li><a href="#index-chap_003astring_003e_003d_003f-1480"><code>chap:string&gt;=?</code></a>: <a href="#Chapter-Ordering">Chapter Ordering</a></li>
<li><a href="#index-chap_003astring_003e_003f-1478"><code>chap:string&gt;?</code></a>: <a href="#Chapter-Ordering">Chapter Ordering</a></li>
<li><a href="#index-check_002dparameters-284"><code>check-parameters</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-chromaticity_002d_003eCIEXYZ-912"><code>chromaticity-&gt;CIEXYZ</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-chromaticity_002d_003ewhitepoint-913"><code>chromaticity-&gt;whitepoint</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-CIE_003aDE_002a-920"><code>CIE:DE*</code></a>: <a href="#Color-Difference-Metrics">Color Difference Metrics</a></li>
<li><a href="#index-CIE_003aDE_002a94-924"><code>CIE:DE*94</code></a>: <a href="#Color-Difference-Metrics">Color Difference Metrics</a></li>
<li><a href="#index-ciexyz_002d_003ecolor-846"><code>ciexyz-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-CIEXYZ_002d_003ee_002dsRGB-957"><code>CIEXYZ-&gt;e-sRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_002d_003eL_002aa_002ab_002a-945"><code>CIEXYZ-&gt;L*a*b*</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_002d_003eL_002au_002av_002a-941"><code>CIEXYZ-&gt;L*u*v*</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_002d_003eRGB709-939"><code>CIEXYZ-&gt;RGB709</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_002d_003esRGB-951"><code>CIEXYZ-&gt;sRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_002d_003exRGB-953"><code>CIEXYZ-&gt;xRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-circular_002dlist-1680"><code>circular-list</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-circular_002dlist_003f-1682"><code>circular-list?</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-cksum-679"><code>cksum</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-clear_002dsky_002dcolor_002dxyy-997"><code>clear-sky-color-xyy</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-clip_002dto_002drect-723"><code>clip-to-rect</code></a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-close_002dbase-on-base_002dtable-1132"><code>close-base on base-table</code></a>: <a href="#The-Base">The Base</a></li>
<li><a href="#index-close_002ddatabase-1049"><code>close-database</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-close_002ddatabase-on-relational_002ddatabase-1161"><code>close-database on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-close_002dport-88"><code>close-port</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-close_002dtable-on-relational_002dtable-1082"><code>close-table on relational-table</code></a>: <a href="#Table-Administration">Table Administration</a></li>
<li><a href="#index-CMC_002dDE-926"><code>CMC-DE</code></a>: <a href="#Color-Difference-Metrics">Color Difference Metrics</a></li>
<li><a href="#index-CMC_003aDE_002a-930"><code>CMC:DE*</code></a>: <a href="#Color-Difference-Metrics">Color Difference Metrics</a></li>
<li><a href="#index-codons_003c_002dcdna-536"><code>codons&lt;-cdna</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-coerce-1564"><code>coerce</code></a>: <a href="#Type-Coercion">Type Coercion</a></li>
<li><a href="#index-collection_003f-1366"><code>collection?</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-color_002d_003eciexyz-848"><code>color-&gt;ciexyz</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002d_003ee_002dsrgb-888"><code>color-&gt;e-srgb</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002d_003el_002aa_002ab_002a-858"><code>color-&gt;l*a*b*</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002d_003el_002ac_002ah-873"><code>color-&gt;l*c*h</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002d_003el_002au_002av_002a-864"><code>color-&gt;l*u*v*</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002d_003ergb709-852"><code>color-&gt;rgb709</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002d_003esrgb-880"><code>color-&gt;srgb</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002d_003estring-836"><code>color-&gt;string</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-color_002d_003exrgb-881"><code>color-&gt;xrgb</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_002ddictionaries_002d_003elookup-967"><code>color-dictionaries-&gt;lookup</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-color_002ddictionary-968"><code>color-dictionary</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-color_002dname_002d_003ecolor-966"><code>color-name-&gt;color</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-color_002dname_003acanonicalize-965"><code>color-name:canonicalize</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-color_002dprecision-831"><code>color-precision</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-color_002dspace-830"><code>color-space</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-color_002dwhite_002dpoint-832"><code>color-white-point</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-color_003aciexyz-847"><code>color:ciexyz</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_003ae_002dsrgb-885"><code>color:e-srgb</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_003al_002aa_002ab_002a-856"><code>color:l*a*b*</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_003al_002ac_002ah-871"><code>color:l*c*h</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_003al_002au_002av_002a-862"><code>color:l*u*v*</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_003alinear_002dtransform-938"><code>color:linear-transform</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-color_003argb709-851"><code>color:rgb709</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_003asrgb-878"><code>color:srgb</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-color_003f-827"><code>color?</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-column_002ddomains-on-relational_002dtable-1079"><code>column-domains on relational-table</code></a>: <a href="#Table-Administration">Table Administration</a></li>
<li><a href="#index-column_002dforeigns-on-relational_002dtable-1078"><code>column-foreigns on relational-table</code></a>: <a href="#Table-Administration">Table Administration</a></li>
<li><a href="#index-column_002dnames-on-relational_002dtable-1077"><code>column-names on relational-table</code></a>: <a href="#Table-Administration">Table Administration</a></li>
<li><a href="#index-column_002drange-699"><code>column-range</code></a>: <a href="#Column-Ranges">Column Ranges</a></li>
<li><a href="#index-column_002dtypes-on-relational_002dtable-1080"><code>column-types on relational-table</code></a>: <a href="#Table-Administration">Table Administration</a></li>
<li><a href="#index-combine_002dranges-702"><code>combine-ranges</code></a>: <a href="#Column-Ranges">Column Ranges</a></li>
<li><a href="#index-combined_002drulesets-1021"><code>combined-rulesets</code></a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-command_002d_003ep_002dspecs-358"><code>command-&gt;p-specs</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-command_003amake_002deditable_002dtable-375"><code>command:make-editable-table</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-command_003amodify_002dtable-370"><code>command:modify-table</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-concatenate-1708"><code>concatenate</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-concatenate_0021-1709"><code>concatenate!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-cond-183"><code>cond</code></a>: <a href="#Guarded-COND-Clause">Guarded COND Clause</a></li>
<li><a href="#index-cond_002dexpand-1654"><code>cond-expand</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-cons_002a-1675"><code>cons*</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-continue-1790"><code>continue</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-convert_002dcolor-833"><code>convert-color</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-coordinates_002d_003einteger-1510"><code>coordinates-&gt;integer</code></a>: <a href="#Multidimensional-Space_002dFilling-Curves">Multidimensional Space-Filling Curves</a></li>
<li><a href="#index-copy_002dbit-569"><code>copy-bit</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-copy_002dbit_002dfield-571"><code>copy-bit-field</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-copy_002dlist-1435"><code>copy-list</code></a>: <a href="#List-construction">List construction</a></li>
<li><a href="#index-copy_002drandom_002dstate-636"><code>copy-random-state</code></a>: <a href="#Exact-Random-Numbers">Exact Random Numbers</a></li>
<li><a href="#index-copy_002dtree-1475"><code>copy-tree</code></a>: <a href="#Tree-Operations">Tree Operations</a></li>
<li><a href="#index-count-1719"><code>count</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-count_002dnewlines-1551"><code>count-newlines</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-crc16-683"><code>crc16</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-crc5-685"><code>crc5</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-crc_003amake_002dtable-678"><code>crc:make-table</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-create_002darray-1225"><code>create-array</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-create_002ddatabase-1041"><code>create-database</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-create_002ddatabase-on-relational_002dsystem-1159"><code>create-database on relational-system</code></a>: <a href="#Relational-Database-Objects">Relational Database Objects</a></li>
<li><a href="#index-create_002dpostscript_002dgraph-694"><code>create-postscript-graph</code></a>: <a href="#PostScript-Graphing">PostScript Graphing</a></li>
<li><a href="#index-create_002dtable-on-relational_002ddatabase-1168"><code>create-table on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-create_002dview-on-relational_002ddatabase-1170"><code>create-view on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-cring_003adefine_002drule-1025"><code>cring:define-rule</code></a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-ctime-521"><code>ctime</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-current_002ddirectory-1829"><code>current-directory</code></a>: <a href="#Directories">Directories</a></li>
<li><a href="#index-current_002derror_002dport-92"><code>current-error-port</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-current_002dinput_002dport-1321"><code>current-input-port</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-current_002dinput_002dport-218"><code>current-input-port</code></a>: <a href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a></li>
<li><a href="#index-current_002doutput_002dport-1318"><code>current-output-port</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-current_002dtime-492"><code>current-time</code></a>: <a href="#Time-and-Date">Time and Date</a></li>
<li><a href="#index-cvs_002ddirectories-1856"><code>cvs-directories</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-cvs_002dfiles-1855"><code>cvs-files</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-cvs_002drepository-1858"><code>cvs-repository</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-cvs_002droot-1857"><code>cvs-root</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-cvs_002dset_002droot_0021-1859"><code>cvs-set-root!</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-cvs_002dset_002droots_0021-1860"><code>cvs-set-roots!</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-cvs_002dvet-1861"><code>cvs-vet</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-db_002d_003ehtml_002ddirectory-378"><code>db-&gt;html-directory</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-db_002d_003ehtml_002dfiles-377"><code>db-&gt;html-files</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-db_002d_003enetscape-380"><code>db-&gt;netscape</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-decode_002duniversal_002dtime-525"><code>decode-universal-time</code></a>: <a href="#Common_002dLisp-Time">Common-Lisp Time</a></li>
<li><a href="#index-define_002d_002acommands_002a-1086"><code>define-*commands*</code></a>: <a href="#Database-Extension">Database Extension</a></li>
<li><a href="#index-define_002daccess_002doperation-198"><code>define-access-operation</code></a>: <a href="#Setters">Setters</a></li>
<li><a href="#index-define_002dcommand-1104"><code>define-command</code></a>: <a href="#Within_002ddatabase">Within-database</a></li>
<li><a href="#index-define_002ddomains-1053"><code>define-domains</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-define_002dmacro-1109"><code>define-macro</code></a>: <a href="#Within_002ddatabase">Within-database</a></li>
<li><a href="#index-define_002doperation-187"><code>define-operation</code></a>: <a href="#Yasos-interface">Yasos interface</a></li>
<li><a href="#index-define_002dpredicate-188"><code>define-predicate</code></a>: <a href="#Yasos-interface">Yasos interface</a></li>
<li><a href="#index-define_002drecord_002dtype-167"><code>define-record-type</code></a>: <a href="#Define_002dRecord_002dType">Define-Record-Type</a></li>
<li><a href="#index-define_002dstructure-164"><code>define-structure</code></a>: <a href="#Define_002dStructure">Define-Structure</a></li>
<li><a href="#index-define_002dsyntax-132"><code>define-syntax</code></a>: <a href="#Macro-by-Example">Macro by Example</a></li>
<li><a href="#index-define_002dtable-1106"><code>define-table</code></a>: <a href="#Within_002ddatabase">Within-database</a></li>
<li><a href="#index-define_002dtables-1055"><code>define-tables</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-defmacro-124"><code>defmacro</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-defmacro_003aeval-119"><code>defmacro:eval</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-defmacro_003aexpand_002a-126"><code>defmacro:expand*</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-defmacro_003aload-120"><code>defmacro:load</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-defmacro_003f-121"><code>defmacro?</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-delaminate_002dlist-1529"><code>delaminate-list</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-delay-1640"><code>delay</code></a>: <a href="#Promises">Promises</a></li>
<li><a href="#index-delete-1464"><code>delete</code></a>: <a href="#Destructive-list-operations">Destructive list operations</a></li>
<li><a href="#index-delete-on-base_002dtable-1147"><code>delete on base-table</code></a>: <a href="#Base-Record-Operations">Base Record Operations</a></li>
<li><a href="#index-delete_002a-on-base_002dtable-1151"><code>delete* on base-table</code></a>: <a href="#Aggregate-Base-Operations">Aggregate Base Operations</a></li>
<li><a href="#index-delete_002ddomain-on-relational_002ddatabase-1094"><code>delete-domain on relational-database</code></a>: <a href="#Command-Intrinsics">Command Intrinsics</a></li>
<li><a href="#index-delete_002dduplicates-1743"><code>delete-duplicates</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-delete_002dduplicates_0021-1745"><code>delete-duplicates!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-delete_002dfile-85"><code>delete-file</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-delete_002dif-1465"><code>delete-if</code></a>: <a href="#Destructive-list-operations">Destructive list operations</a></li>
<li><a href="#index-delete_002dif_002dnot-1466"><code>delete-if-not</code></a>: <a href="#Destructive-list-operations">Destructive list operations</a></li>
<li><a href="#index-delete_002dtable-on-relational_002ddatabase-1167"><code>delete-table on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-dequeue_0021-1420"><code>dequeue!</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-dequeue_002dall_0021-1422"><code>dequeue-all!</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-describe_002dfile_002dlock-1847"><code>describe-file-lock</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-determinant-1030"><code>determinant</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-dft-664"><code>dft</code></a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-dft_002d1-666"><code>dft-1</code></a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-diff_003aedit_002dlength-1560"><code>diff:edit-length</code></a>: <a href="#Sequence-Comparison">Sequence Comparison</a></li>
<li><a href="#index-diff_003aedits-1558"><code>diff:edits</code></a>: <a href="#Sequence-Comparison">Sequence Comparison</a></li>
<li><a href="#index-diff_003alongest_002dcommon_002dsubsequence-1556"><code>diff:longest-common-subsequence</code></a>: <a href="#Sequence-Comparison">Sequence Comparison</a></li>
<li><a href="#index-difftime-493"><code>difftime</code></a>: <a href="#Time-and-Date">Time and Date</a></li>
<li><a href="#index-directory_002a_002dfor_002deach-1834"><code>directory*-for-each</code></a>: <a href="#Directories">Directories</a></li>
<li><a href="#index-directory_002dfor_002deach-1831"><code>directory-for-each</code></a>: <a href="#Directories">Directories</a></li>
<li><a href="#index-do_002delts-1368"><code>do-elts</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-do_002dkeys-1370"><code>do-keys</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-domain_002dchecker-on-relational_002ddatabase-1095"><code>domain-checker on relational-database</code></a>: <a href="#Command-Intrinsics">Command Intrinsics</a></li>
<li><a href="#index-dotted_002dlist_003f-1683"><code>dotted-list?</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-drop-1698"><code>drop</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-drop_002dright-1702"><code>drop-right</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-drop_002dright_0021-1703"><code>drop-right!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-dynamic_002dref-1383"><code>dynamic-ref</code></a>: <a href="#Dynamic-Data-Type">Dynamic Data Type</a></li>
<li><a href="#index-dynamic_002dset_0021-1384"><code>dynamic-set!</code></a>: <a href="#Dynamic-Data-Type">Dynamic Data Type</a></li>
<li><a href="#index-dynamic_002dwind-1642"><code>dynamic-wind</code></a>: <a href="#Dynamic_002dWind">Dynamic-Wind</a></li>
<li><a href="#index-dynamic_003f-1382"><code>dynamic?</code></a>: <a href="#Dynamic-Data-Type">Dynamic Data Type</a></li>
<li><a href="#index-e_002dsRGB_002d_003eCIEXYZ-958"><code>e-sRGB-&gt;CIEXYZ</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-e_002dsrgb_002d_003ecolor-884"><code>e-srgb-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-e_002dsRGB_002d_003ee_002dsRGB-961"><code>e-sRGB-&gt;e-sRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-e_002dsRGB_002d_003esRGB-960"><code>e-sRGB-&gt;sRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-eighth-1694"><code>eighth</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-emacs_003abackup_002dname-1849"><code>emacs:backup-name</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-empty_003f-1377"><code>empty?</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-encode_002duniversal_002dtime-526"><code>encode-universal-time</code></a>: <a href="#Common_002dLisp-Time">Common-Lisp Time</a></li>
<li><a href="#index-enqueue_0021-1419"><code>enqueue!</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-equal_003f-1306"><code>equal?</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-equal_003f-1221"><code>equal?</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-eval-1644"><code>eval</code></a>: <a href="#Eval">Eval</a></li>
<li><a href="#index-every-1443"><code>every</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-every_003f-1376"><code>every?</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-exports_003c_002dinfo_002dindex-60"><code>exports&lt;-info-index</code></a>: <a href="#Top_002dlevel-Variable-References">Top-level Variable References</a></li>
<li><a href="#index-extended_002deuclid-581"><code>extended-euclid</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-factor-629"><code>factor</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-feature_002d_003eexport_002dalist-51"><code>feature-&gt;export-alist</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-feature_002d_003eexports-52"><code>feature-&gt;exports</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-feature_002d_003erequires-44"><code>feature-&gt;requires</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-feature_002d_003erequires_002a-45"><code>feature-&gt;requires*</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-feature_002deval-10"><code>feature-eval</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-fft-660"><code>fft</code></a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-fft_002d1-662"><code>fft-1</code></a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-fifth-1691"><code>fifth</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-file_002d_003ecolor_002ddictionary-973"><code>file-&gt;color-dictionary</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-file_002d_003edefinitions-49"><code>file-&gt;definitions</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-file_002d_003eexports-50"><code>file-&gt;exports</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-file_002d_003eloads-47"><code>file-&gt;loads</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-file_002d_003erequires-43"><code>file-&gt;requires</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-file_002d_003erequires_002a-46"><code>file-&gt;requires*</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-file_002dexists_003f-84"><code>file-exists?</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-file_002dlock_0021-1844"><code>file-lock!</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-file_002dlock_002downer-1843"><code>file-lock-owner</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-file_002dposition-95"><code>file-position</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-file_002dunlock_0021-1846"><code>file-unlock!</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-filename_003amatch_002dci_003f_003f-293"><code>filename:match-ci??</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-filename_003amatch_003f_003f-292"><code>filename:match??</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-filename_003asubstitute_002dci_003f_003f-297"><code>filename:substitute-ci??</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-filename_003asubstitute_003f_003f-296"><code>filename:substitute??</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-fill_002dempty_002dparameters-283"><code>fill-empty-parameters</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-fill_002drect-721"><code>fill-rect</code></a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-filter-1727"><code>filter</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-filter_0021-1728"><code>filter!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-find-1733"><code>find</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-find_002dif-1449"><code>find-if</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-find_002dratio-1635"><code>find-ratio</code></a>: <a href="#Rationalize">Rationalize</a></li>
<li><a href="#index-find_002dratio_002dbetween-1636"><code>find-ratio-between</code></a>: <a href="#Rationalize">Rationalize</a></li>
<li><a href="#index-find_002dstring_002dfrom_002dport_003f-1546"><code>find-string-from-port?</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-find_002dtail-1734"><code>find-tail</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-first-1687"><code>first</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-first_002dset_002dbit-566"><code>first-set-bit</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-fluid_002dlet-169"><code>fluid-let</code></a>: <a href="#Fluid_002dLet">Fluid-Let</a></li>
<li><a href="#index-fold-1720"><code>fold</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-fold_002dright-1721"><code>fold-right</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-for_002deach_002delt-1372"><code>for-each-elt</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-for_002deach_002dkey-1371"><code>for-each-key</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-for_002deach_002dkey-on-base_002dtable-1152"><code>for-each-key on base-table</code></a>: <a href="#Aggregate-Base-Operations">Aggregate Base Operations</a></li>
<li><a href="#index-for_002deach_002drow-on-relational_002dtable-1068"><code>for-each-row on relational-table</code></a>: <a href="#Multi_002dRow-Operations">Multi-Row Operations</a></li>
<li><a href="#index-for_002deach_002drow_002din_002dorder-on-relational_002dtable-1072"><code>for-each-row-in-order on relational-table</code></a>: <a href="#Sequential-Index-Operations">Sequential Index Operations</a></li>
<li><a href="#index-force-1639"><code>force</code></a>: <a href="#Promises">Promises</a></li>
<li><a href="#index-force_002doutput-93"><code>force-output</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-form_003adelimited-355"><code>form:delimited</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-form_003aelement-354"><code>form:element</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-form_003aimage-351"><code>form:image</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-form_003areset-352"><code>form:reset</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-form_003asubmit-349"><code>form:submit</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-format-239"><code>format</code></a>: <a href="#Format-Interface">Format Interface</a></li>
<li><a href="#index-fourth-1690"><code>fourth</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-fprintf-246"><code>fprintf</code></a>: <a href="#Standard-Formatted-Output">Standard Formatted Output</a></li>
<li><a href="#index-fscanf-257"><code>fscanf</code></a>: <a href="#Standard-Formatted-Input">Standard Formatted Input</a></li>
<li><a href="#index-gen_002delts-1364"><code>gen-elts</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-gen_002dkeys-1365"><code>gen-keys</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-generic_002dwrite-474"><code>generic-write</code></a>: <a href="#Generic_002dWrite">Generic-Write</a></li>
<li><a href="#index-gentemp-118"><code>gentemp</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-get-on-relational_002dtable-1057"><code>get on relational-table</code></a>: <a href="#Table-Operations">Table Operations</a></li>
<li><a href="#index-get_002a-on-relational_002dtable-1064"><code>get* on relational-table</code></a>: <a href="#Match_002dKeys">Match-Keys</a></li>
<li><a href="#index-get_002ddecoded_002dtime-523"><code>get-decoded-time</code></a>: <a href="#Common_002dLisp-Time">Common-Lisp Time</a></li>
<li><a href="#index-get_002dforeign_002dchoices-357"><code>get-foreign-choices</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-get_002dmethod-1404"><code>get-method</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-get_002duniversal_002dtime-524"><code>get-universal-time</code></a>: <a href="#Common_002dLisp-Time">Common-Lisp Time</a></li>
<li><a href="#index-getenv-1823"><code>getenv</code></a>: <a href="#System-Interface">System Interface</a></li>
<li><a href="#index-getopt-263"><code>getopt</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-g_t_0040code_007bgetopt_002d_002d_007d-266"><code>getopt--</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-getopt_002d_003earglist-288"><code>getopt-&gt;arglist</code></a>: <a href="#Getopt-Parameter-lists">Getopt Parameter lists</a></li>
<li><a href="#index-getopt_002d_003eparameter_002dlist-287"><code>getopt-&gt;parameter-list</code></a>: <a href="#Getopt-Parameter-lists">Getopt Parameter lists</a></li>
<li><a href="#index-glob_002dpattern_003f-432"><code>glob-pattern?</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-gmktime-516"><code>gmktime</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-gmtime-513"><code>gmtime</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-golden_002dsection_002dsearch-1008"><code>golden-section-search</code></a>: <a href="#Minimizing">Minimizing</a></li>
<li><a href="#index-gray_002dcode_002d_003einteger-1522"><code>gray-code-&gt;integer</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-gray_002dcode_003c_003d_003f-1526"><code>gray-code&lt;=?</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-gray_002dcode_003c_003f-1524"><code>gray-code&lt;?</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-gray_002dcode_003e_003d_003f-1527"><code>gray-code&gt;=?</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-gray_002dcode_003e_003f-1525"><code>gray-code&gt;?</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-grey-963"><code>grey</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-grid_002dhorizontals-738"><code>grid-horizontals</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-grid_002dverticals-737"><code>grid-verticals</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-gtime-520"><code>gtime</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-has_002dduplicates_003f-1453"><code>has-duplicates?</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-hash-1502"><code>hash</code></a>: <a href="#Hashing">Hashing</a></li>
<li><a href="#index-hash_002dassociator-1391"><code>hash-associator</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-hash_002dfor_002deach-1394"><code>hash-for-each</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-hash_002dinquirer-1390"><code>hash-inquirer</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-hash_002dmap-1393"><code>hash-map</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-hash_002drehasher-1395"><code>hash-rehasher</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-hash_002dremover-1392"><code>hash-remover</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-hashq-1500"><code>hashq</code></a>: <a href="#Hashing">Hashing</a></li>
<li><a href="#index-hashv-1501"><code>hashv</code></a>: <a href="#Hashing">Hashing</a></li>
<li><a href="#index-heap_002dextract_002dmax_0021-1411"><code>heap-extract-max!</code></a>: <a href="#Priority-Queues">Priority Queues</a></li>
<li><a href="#index-heap_002dinsert_0021-1410"><code>heap-insert!</code></a>: <a href="#Priority-Queues">Priority Queues</a></li>
<li><a href="#index-heap_002dlength-1409"><code>heap-length</code></a>: <a href="#Priority-Queues">Priority Queues</a></li>
<li><a href="#index-hilbert_002dcoordinates_002d_003einteger-1517"><code>hilbert-coordinates-&gt;integer</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-histograph-693"><code>histograph</code></a>: <a href="#Character-Plotting">Character Plotting</a></li>
<li><a href="#index-home_002dvicinity-69"><code>home-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-htm_002dfields-401"><code>htm-fields</code></a>: <a href="#Parsing-HTML">Parsing HTML</a></li>
<li><a href="#index-html_002dfor_002deach-398"><code>html-for-each</code></a>: <a href="#Parsing-HTML">Parsing HTML</a></li>
<li><a href="#index-html_003aanchor-411"><code>html:anchor</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-html_003aatval-326"><code>html:atval</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003abase-413"><code>html:base</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-html_003abody-337"><code>html:body</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003abuttons-348"><code>html:buttons</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003acaption-361"><code>html:caption</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-html_003acheckbox-344"><code>html:checkbox</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003acomment-340"><code>html:comment</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003adelimited_002dlist-356"><code>html:delimited-list</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003aeditable_002drow_002dconverter-376"><code>html:editable-row-converter</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-html_003aform-341"><code>html:form</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003ahead-334"><code>html:head</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003aheading-363"><code>html:heading</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-html_003ahidden-343"><code>html:hidden</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003ahref_002dheading-364"><code>html:href-heading</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-html_003ahttp_002dequiv-331"><code>html:http-equiv</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003aisindex-415"><code>html:isindex</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-html_003alink-412"><code>html:link</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-html_003alinked_002drow_002dconverter-365"><code>html:linked-row-converter</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-html_003ameta-330"><code>html:meta</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003ameta_002drefresh-332"><code>html:meta-refresh</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003aplain-328"><code>html:plain</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003apre-338"><code>html:pre</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003aread_002dtitle-399"><code>html:read-title</code></a>: <a href="#Parsing-HTML">Parsing HTML</a></li>
<li><a href="#index-html_003aselect-347"><code>html:select</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003atable-360"><code>html:table</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-html_003atext-345"><code>html:text</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-html_003atext_002darea-346"><code>html:text-area</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-http_003acontent-385"><code>http:content</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-http_003aerror_002dpage-387"><code>http:error-page</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-http_003aforwarding_002dpage-388"><code>http:forwarding-page</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-http_003aheader-384"><code>http:header</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-http_003aserve_002dquery-389"><code>http:serve-query</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-identifier_003d_003f-152"><code>identifier=?</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-identifier_003f-151"><code>identifier?</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-identity-112"><code>identity</code></a>: <a href="#Miscellany">Miscellany</a></li>
<li><a href="#index-ieee_002dbyte_002dcollate-1342"><code>ieee-byte-collate</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-ieee_002dbyte_002dcollate_0021-1340"><code>ieee-byte-collate!</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-ieee_002dbyte_002ddecollate-1343"><code>ieee-byte-decollate</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-ieee_002dbyte_002ddecollate_0021-1341"><code>ieee-byte-decollate!</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-ieee_002ddouble_002d_003ebytes-1336"><code>ieee-double-&gt;bytes</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-ieee_002dfloat_002d_003ebytes-1335"><code>ieee-float-&gt;bytes</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-illuminant_002dmap-899"><code>illuminant-map</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-illuminant_002dmap_002d_003eXYZ-900"><code>illuminant-map-&gt;XYZ</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-implementation_002dvicinity-67"><code>implementation-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-in_002dgraphic_002dcontext-707"><code>in-graphic-context</code></a>: <a href="#Graphics-Context">Graphics Context</a></li>
<li><a href="#index-in_002dvicinity-72"><code>in-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-init_002ddebug-1786"><code>init-debug</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-integer_002d_003ebytes-1332"><code>integer-&gt;bytes</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-integer_002d_003ecoordinates-1509"><code>integer-&gt;coordinates</code></a>: <a href="#Multidimensional-Space_002dFilling-Curves">Multidimensional Space-Filling Curves</a></li>
<li><a href="#index-integer_002d_003egray_002dcode-1521"><code>integer-&gt;gray-code</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-integer_002d_003ehilbert_002dcoordinates-1515"><code>integer-&gt;hilbert-coordinates</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-integer_002d_003elist-576"><code>integer-&gt;list</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-integer_002d_003epeano_002dcoordinates-1533"><code>integer-&gt;peano-coordinates</code></a>: <a href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a></li>
<li><a href="#index-integer_002dbyte_002dcollate-1339"><code>integer-byte-collate</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-integer_002dbyte_002dcollate_0021-1338"><code>integer-byte-collate!</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-integer_002dexpt-594"><code>integer-expt</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-integer_002dlength-564"><code>integer-length</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-integer_002dlog-595"><code>integer-log</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-integer_002dsqrt-596"><code>integer-sqrt</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-interaction_002denvironment-1648"><code>interaction-environment</code></a>: <a href="#Eval">Eval</a></li>
<li><a href="#index-interpolate_002darray_002dref-1285"><code>interpolate-array-ref</code></a>: <a href="#Array-Interpolation">Array Interpolation</a></li>
<li><a href="#index-interpolate_002dfrom_002dtable-1083"><code>interpolate-from-table</code></a>: <a href="#Database-Interpolation">Database Interpolation</a></li>
<li><a href="#index-intersection-1438"><code>intersection</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-iota-1677"><code>iota</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-isam_002dnext-on-relational_002dtable-1073"><code>isam-next on relational-table</code></a>: <a href="#Sequential-Index-Operations">Sequential Index Operations</a></li>
<li><a href="#index-isam_002dprev-on-relational_002dtable-1075"><code>isam-prev on relational-table</code></a>: <a href="#Sequential-Index-Operations">Sequential Index Operations</a></li>
<li><a href="#index-jacobi_002dsymbol-624"><code>jacobi-symbol</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-kill_002dprocess_0021-1593"><code>kill-process!</code></a>: <a href="#Multi_002dProcessing">Multi-Processing</a></li>
<li><a href="#index-kill_002dtable-on-base_002dtable-1135"><code>kill-table on base-table</code></a>: <a href="#Base-Tables">Base Tables</a></li>
<li><a href="#index-L_002aa_002ab_002a_002d_003eCIEXYZ-947"><code>L*a*b*-&gt;CIEXYZ</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-l_002aa_002ab_002a_002d_003ecolor-855"><code>l*a*b*-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-L_002aa_002ab_002a_002d_003eL_002aC_002ah-949"><code>L*a*b*-&gt;L*C*h</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-L_002aa_002ab_002a_003aDE_002a-919"><code>L*a*b*:DE*</code></a>: <a href="#Color-Difference-Metrics">Color Difference Metrics</a></li>
<li><a href="#index-L_002aa_002ab_002a_003aDE_002a94-922"><code>L*a*b*:DE*94</code></a>: <a href="#Color-Difference-Metrics">Color Difference Metrics</a></li>
<li><a href="#index-l_002ac_002ah_002d_003ecolor-870"><code>l*c*h-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-L_002aC_002ah_002d_003eL_002aa_002ab_002a-950"><code>L*C*h-&gt;L*a*b*</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-L_002au_002av_002a_002d_003eCIEXYZ-943"><code>L*u*v*-&gt;CIEXYZ</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-l_002au_002av_002a_002d_003ecolor-861"><code>l*u*v*-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-laguerre_003afind_002dpolynomial_002droot-1003"><code>laguerre:find-polynomial-root</code></a>: <a href="#Root-Finding">Root Finding</a></li>
<li><a href="#index-laguerre_003afind_002droot-1002"><code>laguerre:find-root</code></a>: <a href="#Root-Finding">Root Finding</a></li>
<li><a href="#index-last-1706"><code>last</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-last-1458"><code>last</code></a>: <a href="#Lists-as-sequences">Lists as sequences</a></li>
<li><a href="#index-last_002dpair-117"><code>last-pair</code></a>: <a href="#Miscellany">Miscellany</a></li>
<li><a href="#index-length_002b-1707"><code>length+</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-let_002dvalues-176"><code>let-values</code></a>: <a href="#Binding-to-multiple-values">Binding to multiple values</a></li>
<li><a href="#index-let_002dvalues_002a-177"><code>let-values*</code></a>: <a href="#Binding-to-multiple-values">Binding to multiple values</a></li>
<li><a href="#index-library_002dvicinity-66"><code>library-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-light_003aambient-762"><code>light:ambient</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-light_003abeam-767"><code>light:beam</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-light_003adirectional-764"><code>light:directional</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-light_003apoint-771"><code>light:point</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-light_003aspot-775"><code>light:spot</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-limit-1009"><code>limit</code></a>: <a href="#The-Limit">The Limit</a></li>
<li><a href="#index-list_002a-1434"><code>list*</code></a>: <a href="#List-construction">List construction</a></li>
<li><a href="#index-list_002d_003earray-1227"><code>list-&gt;array</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-list_002d_003ebytes-1304"><code>list-&gt;bytes</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-list_002d_003einteger-578"><code>list-&gt;integer</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-list_002dcopy-1676"><code>list-copy</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-list_002dindex-1740"><code>list-index</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-list_002dof_003f_003f-1446"><code>list-of??</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-list_002dtable_002ddefinition-1056"><code>list-table-definition</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-list_002dtabulate-1674"><code>list-tabulate</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-list_002dtail-1624"><code>list-tail</code></a>: <a href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a></li>
<li><a href="#index-list_003d-1686"><code>list=</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-ln-617"><code>ln</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-load_002d_003epath-48"><code>load-&gt;path</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-load_002dciexyz-896"><code>load-ciexyz</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-load_002dcolor_002ddictionary-970"><code>load-color-dictionary</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-localtime-514"><code>localtime</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-log2_002dbinary_002dfactors-565"><code>log2-binary-factors</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-logand-550"><code>logand</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-logbit_003f-567"><code>logbit?</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-logcount-562"><code>logcount</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-logior-552"><code>logior</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-lognot-556"><code>lognot</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-logtest-560"><code>logtest</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-logxor-554"><code>logxor</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-lset_002dadjoin-1757"><code>lset-adjoin</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002ddiff_002bintersection-1762"><code>lset-diff+intersection</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002ddiff_002bintersection_0021-1767"><code>lset-diff+intersection!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002ddifference-1760"><code>lset-difference</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002ddifference_0021-1764"><code>lset-difference!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002dintersection-1759"><code>lset-intersection</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002dintersection_0021-1763"><code>lset-intersection!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002dunion-1758"><code>lset-union</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002dunion_0021-1765"><code>lset-union!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002dxor-1761"><code>lset-xor</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_002dxor_0021-1766"><code>lset-xor!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_003c_003d-1755"><code>lset&lt;=</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-lset_003d-1756"><code>lset=</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-macro_003aeval-156"><code>macro:eval</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-macro_003aeval-144"><code>macro:eval</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-macro_003aeval-137"><code>macro:eval</code></a>: <a href="#Macros-That-Work">Macros That Work</a></li>
<li><a href="#index-macro_003aeval-129"><code>macro:eval</code></a>: <a href="#R4RS-Macros">R4RS Macros</a></li>
<li><a href="#index-macro_003aexpand-154"><code>macro:expand</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-macro_003aexpand-142"><code>macro:expand</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-macro_003aexpand-135"><code>macro:expand</code></a>: <a href="#Macros-That-Work">Macros That Work</a></li>
<li><a href="#index-macro_003aexpand-128"><code>macro:expand</code></a>: <a href="#R4RS-Macros">R4RS Macros</a></li>
<li><a href="#index-macro_003aload-158"><code>macro:load</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-macro_003aload-146"><code>macro:load</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-macro_003aload-139"><code>macro:load</code></a>: <a href="#Macros-That-Work">Macros That Work</a></li>
<li><a href="#index-macro_003aload-130"><code>macro:load</code></a>: <a href="#R4RS-Macros">R4RS Macros</a></li>
<li><a href="#index-macroexpand-123"><code>macroexpand</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-macroexpand_002d1-122"><code>macroexpand-1</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-macwork_003aeval-138"><code>macwork:eval</code></a>: <a href="#Macros-That-Work">Macros That Work</a></li>
<li><a href="#index-macwork_003aexpand-136"><code>macwork:expand</code></a>: <a href="#Macros-That-Work">Macros That Work</a></li>
<li><a href="#index-macwork_003aload-140"><code>macwork:load</code></a>: <a href="#Macros-That-Work">Macros That Work</a></li>
<li><a href="#index-make_002darray-1224"><code>make-array</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-make_002dbase-on-base_002dtable-1128"><code>make-base on base-table</code></a>: <a href="#The-Base">The Base</a></li>
<li><a href="#index-make_002dbytes-1300"><code>make-bytes</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-make_002dcell-1504"><code>make-cell</code></a>: <a href="#Multidimensional-Space_002dFilling-Curves">Multidimensional Space-Filling Curves</a></li>
<li><a href="#index-make_002dcolor-829"><code>make-color</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-make_002dcommand_002dserver-1097"><code>make-command-server</code></a>: <a href="#Command-Service">Command Service</a></li>
<li><a href="#index-make_002ddirectory-1830"><code>make-directory</code></a>: <a href="#Directories">Directories</a></li>
<li><a href="#index-make_002ddynamic-1381"><code>make-dynamic</code></a>: <a href="#Dynamic-Data-Type">Dynamic Data Type</a></li>
<li><a href="#index-make_002dexchanger-114"><code>make-exchanger</code></a>: <a href="#Miscellany">Miscellany</a></li>
<li><a href="#index-make_002dgeneric_002dmethod-1399"><code>make-generic-method</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-make_002dgeneric_002dpredicate-1400"><code>make-generic-predicate</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-make_002dgetter-on-base_002dtable-1144"><code>make-getter on base-table</code></a>: <a href="#Base-Record-Operations">Base Record Operations</a></li>
<li><a href="#index-make_002dgetter_002d1-on-base_002dtable-1145"><code>make-getter-1 on base-table</code></a>: <a href="#Base-Record-Operations">Base Record Operations</a></li>
<li><a href="#index-make_002dhash_002dtable-1388"><code>make-hash-table</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-make_002dheap-1408"><code>make-heap</code></a>: <a href="#Priority-Queues">Priority Queues</a></li>
<li><a href="#index-make_002dkey_002d_003elist-on-base_002dtable-1142"><code>make-key-&gt;list on base-table</code></a>: <a href="#Composite-Keys">Composite Keys</a></li>
<li><a href="#index-make_002dkey_002dextractor-on-base_002dtable-1141"><code>make-key-extractor on base-table</code></a>: <a href="#Composite-Keys">Composite Keys</a></li>
<li><a href="#index-make_002dkeyifier_002d1-on-base_002dtable-1139"><code>make-keyifier-1 on base-table</code></a>: <a href="#Composite-Keys">Composite Keys</a></li>
<li><a href="#index-make_002dlist-1432"><code>make-list</code></a>: <a href="#List-construction">List construction</a></li>
<li><a href="#index-make_002dlist_002dkeyifier-on-base_002dtable-1140"><code>make-list-keyifier on base-table</code></a>: <a href="#Composite-Keys">Composite Keys</a></li>
<li><a href="#index-make_002dmethod_0021-1401"><code>make-method!</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-make_002dnexter-on-base_002dtable-1155"><code>make-nexter on base-table</code></a>: <a href="#Base-ISAM-Operations">Base ISAM Operations</a></li>
<li><a href="#index-make_002dobject-1397"><code>make-object</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-make_002dparameter_002dlist-278"><code>make-parameter-list</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-make_002dpolar-620"><code>make-polar</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-make_002dpredicate_0021-1402"><code>make-predicate!</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-make_002dprever-on-base_002dtable-1156"><code>make-prever on base-table</code></a>: <a href="#Base-ISAM-Operations">Base ISAM Operations</a></li>
<li><a href="#index-make_002dpromise-1638"><code>make-promise</code></a>: <a href="#Promises">Promises</a></li>
<li><a href="#index-make_002dputter-on-base_002dtable-1146"><code>make-putter on base-table</code></a>: <a href="#Base-Record-Operations">Base Record Operations</a></li>
<li><a href="#index-make_002dquery_002dalist_002dcommand_002dserver-395"><code>make-query-alist-command-server</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-make_002dqueue-1415"><code>make-queue</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-make_002drandom_002dstate-639"><code>make-random-state</code></a>: <a href="#Exact-Random-Numbers">Exact Random Numbers</a></li>
<li><a href="#index-make_002drecord_002dtype-1426"><code>make-record-type</code></a>: <a href="#Records">Records</a></li>
<li><a href="#index-make_002drectangular-619"><code>make-rectangular</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-make_002drelational_002dsystem-1157"><code>make-relational-system</code></a>: <a href="#Relational-Database-Objects">Relational Database Objects</a></li>
<li><a href="#index-make_002druleset-1019"><code>make-ruleset</code></a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-make_002dshared_002darray-1226"><code>make-shared-array</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-make_002dsierpinski_002dindexer-1536"><code>make-sierpinski-indexer</code></a>: <a href="#Sierpinski-Curve">Sierpinski Curve</a></li>
<li><a href="#index-make_002dslib_002dcolor_002dname_002ddb-978"><code>make-slib-color-name-db</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-make_002dsyntactic_002dclosure-149"><code>make-syntactic-closure</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-make_002dtable-on-base_002dtable-1133"><code>make-table on base-table</code></a>: <a href="#Base-Tables">Base Tables</a></li>
<li><a href="#index-make_002duri-404"><code>make-uri</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-make_002dvicinity-63"><code>make-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-make_002dwt_002dtree-1189"><code>make-wt-tree</code></a>: <a href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a></li>
<li><a href="#index-make_002dwt_002dtree_002dtype-1186"><code>make-wt-tree-type</code></a>: <a href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a></li>
<li><a href="#index-map_0021-1725"><code>map!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-map_002delts-1367"><code>map-elts</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-map_002dkey-on-base_002dtable-1153"><code>map-key on base-table</code></a>: <a href="#Aggregate-Base-Operations">Aggregate Base Operations</a></li>
<li><a href="#index-map_002dkeys-1369"><code>map-keys</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-matfile_003aload-1348"><code>matfile:load</code></a>: <a href="#MAT_002dFile-Format">MAT-File Format</a></li>
<li><a href="#index-matfile_003aread-1347"><code>matfile:read</code></a>: <a href="#MAT_002dFile-Format">MAT-File Format</a></li>
<li><a href="#index-matrix_002d_003earray-1029"><code>matrix-&gt;array</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-matrix_002d_003elists-1028"><code>matrix-&gt;lists</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-matrix_003adifference-1033"><code>matrix:difference</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-matrix_003ainverse-1037"><code>matrix:inverse</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-matrix_003aproduct-1034"><code>matrix:product</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-matrix_003asum-1032"><code>matrix:sum</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-mdbm_003areport-1050"><code>mdbm:report</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-member-1741"><code>member</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-member_002dif-1441"><code>member-if</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-merge-1486"><code>merge</code></a>: <a href="#Sorting">Sorting</a></li>
<li><a href="#index-merge_0021-1488"><code>merge!</code></a>: <a href="#Sorting">Sorting</a></li>
<li><a href="#index-mktime-517"><code>mktime</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-mod-616"><code>mod</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-modular_003a_002a-591"><code>modular:*</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003a_002b-589"><code>modular:+</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003a_002d-590"><code>modular:-</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003acharacteristic-583"><code>modular:characteristic</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003aexpt-592"><code>modular:expt</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003ainvert-587"><code>modular:invert</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003ainvertable_003f-586"><code>modular:invertable?</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003anegate-588"><code>modular:negate</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modular_003anormalize-584"><code>modular:normalize</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-modulo-599"><code>modulo</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-mrna_003c_002dcdna-535"><code>mrna&lt;-cdna</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-must_002dbe_002dfirst-318"><code>must-be-first</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-must_002dbe_002dlast-319"><code>must-be-last</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-natural_002d_003epeano_002dcoordinates-1531"><code>natural-&gt;peano-coordinates</code></a>: <a href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a></li>
<li><a href="#index-ncbi_003aread_002ddna_002dsequence-533"><code>ncbi:read-dna-sequence</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-ncbi_003aread_002dfile-534"><code>ncbi:read-file</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-nconc-1462"><code>nconc</code></a>: <a href="#Destructive-list-operations">Destructive list operations</a></li>
<li><a href="#index-newton_003afind_002dinteger_002droot-1000"><code>newton:find-integer-root</code></a>: <a href="#Root-Finding">Root Finding</a></li>
<li><a href="#index-newton_003afind_002droot-1001"><code>newton:find-root</code></a>: <a href="#Root-Finding">Root Finding</a></li>
<li><a href="#index-ninth-1695"><code>ninth</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-not_002dpair_003f-1685"><code>not-pair?</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-notany-1444"><code>notany</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-notevery-1445"><code>notevery</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-nreverse-1463"><code>nreverse</code></a>: <a href="#Destructive-list-operations">Destructive list operations</a></li>
<li><a href="#index-nthcdr-1460"><code>nthcdr</code></a>: <a href="#Lists-as-sequences">Lists as sequences</a></li>
<li><a href="#index-null_002ddirectory_003f-431"><code>null-directory?</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-null_002denvironment-1646"><code>null-environment</code></a>: <a href="#Eval">Eval</a></li>
<li><a href="#index-null_002dlist_003f-1684"><code>null-list?</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-object-189"><code>object</code></a>: <a href="#Yasos-interface">Yasos interface</a></li>
<li><a href="#index-object_002d_003elimited_002dstring-477"><code>object-&gt;limited-string</code></a>: <a href="#Object_002dTo_002dString">Object-To-String</a></li>
<li><a href="#index-object_002d_003estring-476"><code>object-&gt;string</code></a>: <a href="#Object_002dTo_002dString">Object-To-String</a></li>
<li><a href="#index-object_002dwith_002dancestors-190"><code>object-with-ancestors</code></a>: <a href="#Yasos-interface">Yasos interface</a></li>
<li><a href="#index-object_003f-1398"><code>object?</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-offset_002dtime-494"><code>offset-time</code></a>: <a href="#Time-and-Date">Time and Date</a></li>
<li><a href="#index-open_002dbase-on-base_002dtable-1129"><code>open-base on base-table</code></a>: <a href="#The-Base">The Base</a></li>
<li><a href="#index-open_002dcommand_002ddatabase-1087"><code>open-command-database</code></a>: <a href="#Database-Extension">Database Extension</a></li>
<li><a href="#index-open_002dcommand_002ddatabase_0021-1089"><code>open-command-database!</code></a>: <a href="#Database-Extension">Database Extension</a></li>
<li><a href="#index-open_002ddatabase-1044"><code>open-database</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-open_002ddatabase-on-relational_002dsystem-1160"><code>open-database on relational-system</code></a>: <a href="#Relational-Database-Objects">Relational Database Objects</a></li>
<li><a href="#index-open_002ddatabase_0021-1043"><code>open-database!</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-open_002dfile-1315"><code>open-file</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-open_002dfile-86"><code>open-file</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-open_002dtable-1051"><code>open-table</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-open_002dtable-on-base_002dtable-1134"><code>open-table on base-table</code></a>: <a href="#Base-Tables">Base Tables</a></li>
<li><a href="#index-open_002dtable-on-relational_002ddatabase-1166"><code>open-table on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-open_002dtable_0021-1052"><code>open-table!</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-operate_002das-191"><code>operate-as</code></a>: <a href="#Yasos-interface">Yasos interface</a></li>
<li><a href="#index-or_003f-1468"><code>or?</code></a>: <a href="#Non_002dList-functions">Non-List functions</a></li>
<li><a href="#index-ordered_002dfor_002deach_002dkey-on-base_002dtable-1154"><code>ordered-for-each-key on base-table</code></a>: <a href="#Base-ISAM-Operations">Base ISAM Operations</a></li>
<li><a href="#index-os_002d_003ebatch_002ddialect-320"><code>os-&gt;batch-dialect</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-outline_002drect-722"><code>outline-rect</code></a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-output_002dport_002dheight-100"><code>output-port-height</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-output_002dport_002dwidth-98"><code>output-port-width</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-overcast_002dsky_002dcolor_002dxyy-996"><code>overcast-sky-color-xyy</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-p_003c_002dcdna-538"><code>p&lt;-cdna</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-pad_002drange-700"><code>pad-range</code></a>: <a href="#Column-Ranges">Column Ranges</a></li>
<li><a href="#index-pair_002dfold-1722"><code>pair-fold</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-pair_002dfold_002dright-1723"><code>pair-fold-right</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-pair_002dfor_002deach-1726"><code>pair-for-each</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-parameter_002dlist_002d_003earglist-285"><code>parameter-list-&gt;arglist</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-parameter_002dlist_002dexpand-282"><code>parameter-list-expand</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-parameter_002dlist_002dref-279"><code>parameter-list-ref</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-parse_002dftp_002daddress-434"><code>parse-ftp-address</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-partition-1729"><code>partition</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-partition_0021-1731"><code>partition!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-partition_002dpage-718"><code>partition-page</code></a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-path_002d_003euri-427"><code>path-&gt;uri</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-pathname_002d_003evicinity-64"><code>pathname-&gt;vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-peano_002dcoordinates_002d_003einteger-1534"><code>peano-coordinates-&gt;integer</code></a>: <a href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a></li>
<li><a href="#index-peano_002dcoordinates_002d_003enatural-1532"><code>peano-coordinates-&gt;natural</code></a>: <a href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a></li>
<li><a href="#index-plot-740"><code>plot</code></a>: <a href="#Legacy-Plotting">Legacy Plotting</a></li>
<li><a href="#index-plot-689"><code>plot</code></a>: <a href="#Character-Plotting">Character Plotting</a></li>
<li><a href="#index-plot_002dcolumn-705"><code>plot-column</code></a>: <a href="#Drawing-the-Graph">Drawing the Graph</a></li>
<li><a href="#index-plot_002dtext_002dcolumn-706"><code>plot-text-column</code></a>: <a href="#Drawing-the-Graph">Drawing the Graph</a></li>
<li><a href="#index-pnm_003aarray_002dwrite-1362"><code>pnm:array-write</code></a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-pnm_003aimage_002dfile_002d_003earray-1358"><code>pnm:image-file-&gt;array</code></a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-pnm_003atype_002ddimensions-1350"><code>pnm:type-dimensions</code></a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-port_003f-87"><code>port?</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-position-1455"><code>position</code></a>: <a href="#Lists-as-sequences">Lists as sequences</a></li>
<li><a href="#index-pprint_002dfile-484"><code>pprint-file</code></a>: <a href="#Pretty_002dPrint">Pretty-Print</a></li>
<li><a href="#index-pprint_002dfilter_002dfile-486"><code>pprint-filter-file</code></a>: <a href="#Pretty_002dPrint">Pretty-Print</a></li>
<li><a href="#index-prec_003acommentfix-235"><code>prec:commentfix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003adefine_002dgrammar-215"><code>prec:define-grammar</code></a>: <a href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a></li>
<li><a href="#index-prec_003adelim-228"><code>prec:delim</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003ainfix-231"><code>prec:infix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003ainmatchfix-237"><code>prec:inmatchfix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003amake_002dled-227"><code>prec:make-led</code></a>: <a href="#Nud-and-Led-Definition">Nud and Led Definition</a></li>
<li><a href="#index-prec_003amake_002dnud-226"><code>prec:make-nud</code></a>: <a href="#Nud-and-Led-Definition">Nud and Led Definition</a></li>
<li><a href="#index-prec_003amatchfix-236"><code>prec:matchfix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003anary-232"><code>prec:nary</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003anofix-229"><code>prec:nofix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003aparse-216"><code>prec:parse</code></a>: <a href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a></li>
<li><a href="#index-prec_003apostfix-233"><code>prec:postfix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003aprefix-230"><code>prec:prefix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-prec_003aprestfix-234"><code>prec:prestfix</code></a>: <a href="#Grammar-Rule-Definition">Grammar Rule Definition</a></li>
<li><a href="#index-predicate_002d_003easso-1288"><code>predicate-&gt;asso</code></a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-predicate_002d_003ehash-1387"><code>predicate-&gt;hash</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-predicate_002d_003ehash_002dasso-1389"><code>predicate-&gt;hash-asso</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-present_003f-on-base_002dtable-1143"><code>present? on base-table</code></a>: <a href="#Base-Record-Operations">Base Record Operations</a></li>
<li><a href="#index-pretty_002dprint-479"><code>pretty-print</code></a>: <a href="#Pretty_002dPrint">Pretty-Print</a></li>
<li><a href="#index-pretty_002dprint_002d_003estring-481"><code>pretty-print-&gt;string</code></a>: <a href="#Pretty_002dPrint">Pretty-Print</a></li>
<li><a href="#index-primary_002dlimit-on-relational_002dtable-1081"><code>primary-limit on relational-table</code></a>: <a href="#Table-Administration">Table Administration</a></li>
<li><a href="#index-prime_003f-626"><code>prime?</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-primes_003c-627"><code>primes&lt;</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-primes_003e-628"><code>primes&gt;</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-print-192"><code>print</code></a>: <a href="#Yasos-interface">Yasos interface</a></li>
<li><a href="#index-print_002dcall_002dstack-1801"><code>print-call-stack</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-printf-245"><code>printf</code></a>: <a href="#Standard-Formatted-Output">Standard Formatted Output</a></li>
<li><a href="#index-process_003aschedule_0021-1592"><code>process:schedule!</code></a>: <a href="#Multi_002dProcessing">Multi-Processing</a></li>
<li><a href="#index-program_002darguments-1827"><code>program-arguments</code></a>: <a href="#System-Interface">System Interface</a></li>
<li><a href="#index-program_002dvicinity-65"><code>program-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-project_002dtable-on-relational_002ddatabase-1171"><code>project-table on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-proper_002dlist_003f-1681"><code>proper-list?</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-protein_003c_002dcdna-537"><code>protein&lt;-cdna</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-provide-11"><code>provide</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-provided_003f-9"><code>provided?</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-qp-1775"><code>qp</code></a>: <a href="#Quick-Print">Quick Print</a></li>
<li><a href="#index-qpn-1776"><code>qpn</code></a>: <a href="#Quick-Print">Quick Print</a></li>
<li><a href="#index-qpr-1777"><code>qpr</code></a>: <a href="#Quick-Print">Quick Print</a></li>
<li><a href="#index-queue_002dempty_003f-1417"><code>queue-empty?</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-queue_002dfront-1423"><code>queue-front</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-queue_002dpop_0021-1421"><code>queue-pop!</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-queue_002dpush_0021-1418"><code>queue-push!</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-queue_002drear-1424"><code>queue-rear</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-queue_003f-1416"><code>queue?</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-quo-614"><code>quo</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-quotient-597"><code>quotient</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-random-633"><code>random</code></a>: <a href="#Exact-Random-Numbers">Exact Random Numbers</a></li>
<li><a href="#index-random_003aexp-644"><code>random:exp</code></a>: <a href="#Inexact-Random-Numbers">Inexact Random Numbers</a></li>
<li><a href="#index-random_003ahollow_002dsphere_0021-650"><code>random:hollow-sphere!</code></a>: <a href="#Inexact-Random-Numbers">Inexact Random Numbers</a></li>
<li><a href="#index-random_003anormal-646"><code>random:normal</code></a>: <a href="#Inexact-Random-Numbers">Inexact Random Numbers</a></li>
<li><a href="#index-random_003anormal_002dvector_0021-648"><code>random:normal-vector!</code></a>: <a href="#Inexact-Random-Numbers">Inexact Random Numbers</a></li>
<li><a href="#index-random_003asolid_002dsphere_0021-652"><code>random:solid-sphere!</code></a>: <a href="#Inexact-Random-Numbers">Inexact Random Numbers</a></li>
<li><a href="#index-random_003auniform-642"><code>random:uniform</code></a>: <a href="#Inexact-Random-Numbers">Inexact Random Numbers</a></li>
<li><a href="#index-rationalize-1634"><code>rationalize</code></a>: <a href="#Rationalize">Rationalize</a></li>
<li><a href="#index-read_002dbyte-1319"><code>read-byte</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-read_002dbytes-1322"><code>read-bytes</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-read_002dcie_002dilluminant-897"><code>read-cie-illuminant</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-read_002dcommand-269"><code>read-command</code></a>: <a href="#Command-Line">Command Line</a></li>
<li><a href="#index-read_002dline-1580"><code>read-line</code></a>: <a href="#Line-I_002fO">Line I/O</a></li>
<li><a href="#index-read_002dline_0021-1582"><code>read-line!</code></a>: <a href="#Line-I_002fO">Line I/O</a></li>
<li><a href="#index-read_002dnormalized_002dilluminant-898"><code>read-normalized-illuminant</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-read_002doptions_002dfile-274"><code>read-options-file</code></a>: <a href="#Command-Line">Command Line</a></li>
<li><a href="#index-real_002dacos-609"><code>real-acos</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dasin-608"><code>real-asin</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002datan-610"><code>real-atan</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dcos-606"><code>real-cos</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dexp-602"><code>real-exp</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dexpt-613"><code>real-expt</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dln-603"><code>real-ln</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dlog-604"><code>real-log</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dsin-605"><code>real-sin</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dsqrt-612"><code>real-sqrt</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-real_002dtan-607"><code>real-tan</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-receive-173"><code>receive</code></a>: <a href="#Binding-to-multiple-values">Binding to multiple values</a></li>
<li><a href="#index-record_002daccessor-1429"><code>record-accessor</code></a>: <a href="#Records">Records</a></li>
<li><a href="#index-record_002dconstructor-1427"><code>record-constructor</code></a>: <a href="#Records">Records</a></li>
<li><a href="#index-record_002dmodifier-1430"><code>record-modifier</code></a>: <a href="#Records">Records</a></li>
<li><a href="#index-record_002dpredicate-1428"><code>record-predicate</code></a>: <a href="#Records">Records</a></li>
<li><a href="#index-reduce-1724"><code>reduce</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-reduce-1456"><code>reduce</code></a>: <a href="#Lists-as-sequences">Lists as sequences</a></li>
<li><a href="#index-reduce-1373"><code>reduce</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-reduce_002dinit-1457"><code>reduce-init</code></a>: <a href="#Lists-as-sequences">Lists as sequences</a></li>
<li><a href="#index-rem-615"><code>rem</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-remainder-598"><code>remainder</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-remove-1730"><code>remove</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-remove-1450"><code>remove</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-remove_0021-1732"><code>remove!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-remove_002dduplicates-1454"><code>remove-duplicates</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-remove_002dif-1451"><code>remove-if</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-remove_002dif_002dnot-1452"><code>remove-if-not</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-remove_002dparameter-280"><code>remove-parameter</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-remove_002dsetter_002dfor-197"><code>remove-setter-for</code></a>: <a href="#Setters">Setters</a></li>
<li><a href="#index-repl_003aquit-1771"><code>repl:quit</code></a>: <a href="#Repl">Repl</a></li>
<li><a href="#index-repl_003atop_002dlevel-1770"><code>repl:top-level</code></a>: <a href="#Repl">Repl</a></li>
<li><a href="#index-replace_002dsuffix-298"><code>replace-suffix</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-require-29"><code>require</code></a>: <a href="#Catalog-Creation">Catalog Creation</a></li>
<li><a href="#index-require-15"><code>require</code></a>: <a href="#Require">Require</a></li>
<li><a href="#index-require_002dif-16"><code>require-if</code></a>: <a href="#Require">Require</a></li>
<li><a href="#index-resample_002darray_0021-1286"><code>resample-array!</code></a>: <a href="#Array-Interpolation">Array Interpolation</a></li>
<li><a href="#index-resene-984"><code>resene</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-restrict_002dtable-on-relational_002ddatabase-1172"><code>restrict-table on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-reverse_0021-1710"><code>reverse!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-reverse_002dbit_002dfield-575"><code>reverse-bit-field</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-RGB709_002d_003eCIEXYZ-940"><code>RGB709-&gt;CIEXYZ</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-rgb709_002d_003ecolor-850"><code>rgb709-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-rotate_002dbit_002dfield-574"><code>rotate-bit-field</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-round_002dquotient-600"><code>round-quotient</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-row_003adelete-on-relational_002dtable-1062"><code>row:delete on relational-table</code></a>: <a href="#Single-Row-Operations">Single Row Operations</a></li>
<li><a href="#index-row_003adelete_002a-on-relational_002dtable-1067"><code>row:delete* on relational-table</code></a>: <a href="#Multi_002dRow-Operations">Multi-Row Operations</a></li>
<li><a href="#index-row_003ainsert-on-relational_002dtable-1058"><code>row:insert on relational-table</code></a>: <a href="#Single-Row-Operations">Single Row Operations</a></li>
<li><a href="#index-row_003ainsert_002a-on-relational_002dtable-1069"><code>row:insert* on relational-table</code></a>: <a href="#Multi_002dRow-Operations">Multi-Row Operations</a></li>
<li><a href="#index-row_003aremove-on-relational_002dtable-1061"><code>row:remove on relational-table</code></a>: <a href="#Single-Row-Operations">Single Row Operations</a></li>
<li><a href="#index-row_003aremove_002a-on-relational_002dtable-1066"><code>row:remove* on relational-table</code></a>: <a href="#Multi_002dRow-Operations">Multi-Row Operations</a></li>
<li><a href="#index-row_003aretrieve-on-relational_002dtable-1060"><code>row:retrieve on relational-table</code></a>: <a href="#Single-Row-Operations">Single Row Operations</a></li>
<li><a href="#index-row_003aretrieve_002a-on-relational_002dtable-1065"><code>row:retrieve* on relational-table</code></a>: <a href="#Multi_002dRow-Operations">Multi-Row Operations</a></li>
<li><a href="#index-row_003aupdate-on-relational_002dtable-1059"><code>row:update on relational-table</code></a>: <a href="#Single-Row-Operations">Single Row Operations</a></li>
<li><a href="#index-row_003aupdate_002a-on-relational_002dtable-1070"><code>row:update* on relational-table</code></a>: <a href="#Multi_002dRow-Operations">Multi-Row Operations</a></li>
<li><a href="#index-rule_002dhorizontal-734"><code>rule-horizontal</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-rule_002dvertical-733"><code>rule-vertical</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-saturate-982"><code>saturate</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-scanf-256"><code>scanf</code></a>: <a href="#Standard-Formatted-Input">Standard Formatted Input</a></li>
<li><a href="#index-scanf_002dread_002dlist-253"><code>scanf-read-list</code></a>: <a href="#Standard-Formatted-Input">Standard Formatted Input</a></li>
<li><a href="#index-scene_003aovercast-757"><code>scene:overcast</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scene_003apanorama-751"><code>scene:panorama</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scene_003asky_002dand_002ddirt-753"><code>scene:sky-and-dirt</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scene_003asky_002dand_002dgrass-754"><code>scene:sky-and-grass</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scene_003asphere-752"><code>scene:sphere</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scene_003asun-755"><code>scene:sun</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scene_003aviewpoint-759"><code>scene:viewpoint</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scene_003aviewpoints-761"><code>scene:viewpoints</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-scheme_002dreport_002denvironment-1645"><code>scheme-report-environment</code></a>: <a href="#Eval">Eval</a></li>
<li><a href="#index-schmooz-543"><code>schmooz</code></a>: <a href="#Schmooz">Schmooz</a></li>
<li><a href="#index-secant_003afind_002dbracketed_002droot-1005"><code>secant:find-bracketed-root</code></a>: <a href="#Root-Finding">Root Finding</a></li>
<li><a href="#index-secant_003afind_002droot-1004"><code>secant:find-root</code></a>: <a href="#Root-Finding">Root Finding</a></li>
<li><a href="#index-second-1688"><code>second</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-seed_002d_003erandom_002dstate-638"><code>seed-&gt;random-state</code></a>: <a href="#Exact-Random-Numbers">Exact Random Numbers</a></li>
<li><a href="#index-set-195"><code>set</code></a>: <a href="#Setters">Setters</a></li>
<li><a href="#index-set_002dcolor-708"><code>set-color</code></a>: <a href="#Graphics-Context">Graphics Context</a></li>
<li><a href="#index-set_002ddifference-1439"><code>set-difference</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-set_002dfont-709"><code>set-font</code></a>: <a href="#Graphics-Context">Graphics Context</a></li>
<li><a href="#index-set_002dglyphsize-715"><code>set-glyphsize</code></a>: <a href="#Graphics-Context">Graphics Context</a></li>
<li><a href="#index-set_002dlinedash-712"><code>set-linedash</code></a>: <a href="#Graphics-Context">Graphics Context</a></li>
<li><a href="#index-set_002dlinewidth-711"><code>set-linewidth</code></a>: <a href="#Graphics-Context">Graphics Context</a></li>
<li><a href="#index-set_002dmargin_002dtemplates-732"><code>set-margin-templates</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-Setter-1379"><code>Setter</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-setter-194"><code>setter</code></a>: <a href="#Setters">Setters</a></li>
<li><a href="#index-setup_002dplot-703"><code>setup-plot</code></a>: <a href="#Column-Ranges">Column Ranges</a></li>
<li><a href="#index-seventh-1693"><code>seventh</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-sft-655"><code>sft</code></a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-sft_002d1-658"><code>sft-1</code></a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-si_003aconversion_002dfactor-1595"><code>si:conversion-factor</code></a>: <a href="#Metric-Units">Metric Units</a></li>
<li><a href="#index-singleton_002dwt_002dtree-1190"><code>singleton-wt-tree</code></a>: <a href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a></li>
<li><a href="#index-sixth-1692"><code>sixth</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-size-1378"><code>size</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-size-193"><code>size</code></a>: <a href="#Yasos-interface">Yasos interface</a></li>
<li><a href="#index-sky_002dcolor_002dxyy-998"><code>sky-color-xyy</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-slib_003aerror-108"><code>slib:error</code></a>: <a href="#System">System</a></li>
<li><a href="#index-slib_003aeval-105"><code>slib:eval</code></a>: <a href="#System">System</a></li>
<li><a href="#index-slib_003aeval_002dload-106"><code>slib:eval-load</code></a>: <a href="#System">System</a></li>
<li><a href="#index-slib_003aexit-109"><code>slib:exit</code></a>: <a href="#System">System</a></li>
<li><a href="#index-slib_003ain_002dcatalog_003f-17"><code>slib:in-catalog?</code></a>: <a href="#Require">Require</a></li>
<li><a href="#index-slib_003aload-104"><code>slib:load</code></a>: <a href="#System">System</a></li>
<li><a href="#index-slib_003aload_002dcompiled-103"><code>slib:load-compiled</code></a>: <a href="#System">System</a></li>
<li><a href="#index-slib_003aload_002dsource-102"><code>slib:load-source</code></a>: <a href="#System">System</a></li>
<li><a href="#index-slib_003areport-81"><code>slib:report</code></a>: <a href="#Configuration">Configuration</a></li>
<li><a href="#index-slib_003areport_002dversion-80"><code>slib:report-version</code></a>: <a href="#Configuration">Configuration</a></li>
<li><a href="#index-slib_003awarn-107"><code>slib:warn</code></a>: <a href="#System">System</a></li>
<li><a href="#index-snap_002drange-701"><code>snap-range</code></a>: <a href="#Column-Ranges">Column Ranges</a></li>
<li><a href="#index-software_002dtype-79"><code>software-type</code></a>: <a href="#Configuration">Configuration</a></li>
<li><a href="#index-solar_002ddeclination-990"><code>solar-declination</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-solar_002dhour-989"><code>solar-hour</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-solar_002dpolar-991"><code>solar-polar</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-solid_003aarrow-822"><code>solid:arrow</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003abasrelief-799"><code>solid:basrelief</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003abox-780"><code>solid:box</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003acenter_002darray_002dof-820"><code>solid:center-array-of</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003acenter_002dpile_002dof-821"><code>solid:center-pile-of</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003acenter_002drow_002dof-819"><code>solid:center-row-of</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003acolor-804"><code>solid:color</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003acone-787"><code>solid:cone</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003acylinder-783"><code>solid:cylinder</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003adisk-785"><code>solid:disk</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003aellipsoid-793"><code>solid:ellipsoid</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003afont-818"><code>solid:font</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003alumber-782"><code>solid:lumber</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003apolyline-795"><code>solid:polyline</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003aprism-797"><code>solid:prism</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003apyramid-789"><code>solid:pyramid</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003arotation-826"><code>solid:rotation</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003ascale-825"><code>solid:scale</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003asphere-791"><code>solid:sphere</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003atext-802"><code>solid:text</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003atexture-811"><code>solid:texture</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_003atranslation-824"><code>solid:translation</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solidify_002ddatabase-1048"><code>solidify-database</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-solidify_002ddatabase-on-relational_002ddatabase-1164"><code>solidify-database on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-some-1442"><code>some</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-sort-1490"><code>sort</code></a>: <a href="#Sorting">Sorting</a></li>
<li><a href="#index-sort_0021-1492"><code>sort!</code></a>: <a href="#Sorting">Sorting</a></li>
<li><a href="#index-sorted_003f-1484"><code>sorted?</code></a>: <a href="#Sorting">Sorting</a></li>
<li><a href="#index-soundex-1538"><code>soundex</code></a>: <a href="#Soundex">Soundex</a></li>
<li><a href="#index-span-1735"><code>span</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-span_0021-1736"><code>span!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-spectrum_002d_003echromaticity-903"><code>spectrum-&gt;chromaticity</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-spectrum_002d_003eXYZ-901"><code>spectrum-&gt;XYZ</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-split_002dat-1704"><code>split-at</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-split_002dat_0021-1705"><code>split-at!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-sprintf-247"><code>sprintf</code></a>: <a href="#Standard-Formatted-Output">Standard Formatted Output</a></li>
<li><a href="#index-sRGB_002d_003eCIEXYZ-952"><code>sRGB-&gt;CIEXYZ</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-srgb_002d_003ecolor-877"><code>srgb-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-sRGB_002d_003ee_002dsRGB-959"><code>sRGB-&gt;e-sRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-sRGB_002d_003exRGB-955"><code>sRGB-&gt;xRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-ssax_003aassert_002dcurrent_002dchar-440"><code>ssax:assert-current-char</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aassert_002dtoken-468"><code>ssax:assert-token</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003acomplete_002dstart_002dtag-464"><code>ssax:complete-start-tag</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003ahandle_002dparsed_002dentity-457"><code>ssax:handle-parsed-entity</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003ainit_002dbuffer-442"><code>ssax:init-buffer</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003amake_002delem_002dparser-470"><code>ssax:make-elem-parser</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003amake_002dparser-471"><code>ssax:make-parser</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003amake_002dpi_002dparser-469"><code>ssax:make-pi-parser</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003anext_002dtoken-443"><code>ssax:next-token</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003anext_002dtoken_002dof-444"><code>ssax:next-token-of</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dattributes-460"><code>ssax:read-attributes</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dcdata_002dbody-454"><code>ssax:read-cdata-body</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dchar_002ddata-467"><code>ssax:read-char-data</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dchar_002dref-456"><code>ssax:read-char-ref</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dexternal_002did-465"><code>ssax:read-external-id</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dmarkup_002dtoken-450"><code>ssax:read-markup-token</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dncname-448"><code>ssax:read-ncname</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dpi_002dbody_002das_002dstring-452"><code>ssax:read-pi-body-as-string</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dqname-449"><code>ssax:read-qname</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aread_002dstring-446"><code>ssax:read-string</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003aresolve_002dname-463"><code>ssax:resolve-name</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003areverse_002dcollect_002dstr-438"><code>ssax:reverse-collect-str</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003areverse_002dcollect_002dstr_002ddrop_002dws-439"><code>ssax:reverse-collect-str-drop-ws</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003ascan_002dmisc-466"><code>ssax:scan-misc</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003askip_002dinternal_002ddtd-453"><code>ssax:skip-internal-dtd</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003askip_002dpi-451"><code>ssax:skip-pi</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003askip_002ds-447"><code>ssax:skip-s</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003askip_002dwhile-441"><code>ssax:skip-while</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-ssax_003axml_002d_003esxml-472"><code>ssax:xml-&gt;sxml</code></a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-sscanf-258"><code>sscanf</code></a>: <a href="#Standard-Formatted-Input">Standard Formatted Input</a></li>
<li><a href="#index-stack-1807"><code>stack</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-stack_002dall-1783"><code>stack-all</code></a>: <a href="#Debug">Debug</a></li>
<li><a href="#index-stackf-1819"><code>stackf</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-string_002d_003ebytes-1308"><code>string-&gt;bytes</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-string_002d_003ecolor-837"><code>string-&gt;color</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-string_002dcapitalize-1568"><code>string-capitalize</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-string_002dcapitalize_0021-1571"><code>string-capitalize!</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-string_002dci_002d_003esymbol-1572"><code>string-ci-&gt;symbol</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-string_002dcopy-1625"><code>string-copy</code></a>: <a href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a></li>
<li><a href="#index-string_002ddowncase-1567"><code>string-downcase</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-string_002ddowncase_0021-1570"><code>string-downcase!</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-string_002dfill_0021-1626"><code>string-fill!</code></a>: <a href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a></li>
<li><a href="#index-string_002dindex-1540"><code>string-index</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-string_002dindex_002dci-1541"><code>string-index-ci</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-string_002djoin-317"><code>string-join</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-string_002dnull_003f-1614"><code>string-null?</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-string_002dreverse_002dindex-1542"><code>string-reverse-index</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-string_002dreverse_002dindex_002dci-1543"><code>string-reverse-index-ci</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-string_002dsubst-1550"><code>string-subst</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-string_002dupcase-1566"><code>string-upcase</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-string_002dupcase_0021-1569"><code>string-upcase!</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-StudlyCapsExpand-1574"><code>StudlyCapsExpand</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-sub_002dvicinity-73"><code>sub-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-subarray-1275"><code>subarray</code></a>: <a href="#Subarrays">Subarrays</a></li>
<li><a href="#index-subbytes-1310"><code>subbytes</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-subbytes_002dread_0021-1326"><code>subbytes-read!</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-subbytes_002dwrite-1328"><code>subbytes-write</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-subset_003f-1440"><code>subset?</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-subst-1471"><code>subst</code></a>: <a href="#Tree-Operations">Tree Operations</a></li>
<li><a href="#index-substq-1472"><code>substq</code></a>: <a href="#Tree-Operations">Tree Operations</a></li>
<li><a href="#index-substring_002dci_003f-1545"><code>substring-ci?</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-substring_002dfill_0021-1613"><code>substring-fill!</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-substring_002dmove_002dleft_0021-1611"><code>substring-move-left!</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-substring_002dmove_002dright_0021-1612"><code>substring-move-right!</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-substring_003f-1544"><code>substring?</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-substv-1473"><code>substv</code></a>: <a href="#Tree-Operations">Tree Operations</a></li>
<li><a href="#index-sunlight_002dchromaticity-994"><code>sunlight-chromaticity</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-sunlight_002dspectrum-993"><code>sunlight-spectrum</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-supported_002dkey_002dtype_003f-on-base_002dtable-1138"><code>supported-key-type? on base-table</code></a>: <a href="#Base-Field-Types">Base Field Types</a></li>
<li><a href="#index-supported_002dtype_003f-on-base_002dtable-1137"><code>supported-type? on base-table</code></a>: <a href="#Base-Field-Types">Base Field Types</a></li>
<li><a href="#index-symbol_002dappend-1573"><code>symbol-append</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-symmetric_003amodulus-582"><code>symmetric:modulus</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-sync_002dbase-on-base_002dtable-1131"><code>sync-base on base-table</code></a>: <a href="#The-Base">The Base</a></li>
<li><a href="#index-sync_002ddatabase-1047"><code>sync-database</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-sync_002ddatabase-on-relational_002ddatabase-1163"><code>sync-database on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-syncase_003aeval-157"><code>syncase:eval</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-syncase_003aexpand-155"><code>syncase:expand</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-syncase_003aload-159"><code>syncase:load</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-syncase_003asanity_002dcheck-163"><code>syncase:sanity-check</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-synclo_003aeval-145"><code>synclo:eval</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-synclo_003aexpand-143"><code>synclo:expand</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-synclo_003aload-147"><code>synclo:load</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-syntax_002drules-133"><code>syntax-rules</code></a>: <a href="#Macro-by-Example">Macro by Example</a></li>
<li><a href="#index-system-1825"><code>system</code></a>: <a href="#System-Interface">System Interface</a></li>
<li><a href="#index-system_002d_003eline-1586"><code>system-&gt;line</code></a>: <a href="#Line-I_002fO">Line I/O</a></li>
<li><a href="#index-table_002d_003elinked_002dhtml-367"><code>table-&gt;linked-html</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-table_002d_003elinked_002dpage-368"><code>table-&gt;linked-page</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-table_002dexists_003f-on-relational_002ddatabase-1165"><code>table-exists? on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-table_002dname_002d_003efilename-366"><code>table-name-&gt;filename</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-take-1699"><code>take</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-take_0021-1700"><code>take!</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-take_002dright-1701"><code>take-right</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-temperature_002d_003echromaticity-910"><code>temperature-&gt;chromaticity</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-temperature_002d_003eXYZ-909"><code>temperature-&gt;XYZ</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-tenth-1696"><code>tenth</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-third-1689"><code>third</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-time_002dzone-497"><code>time-zone</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-time_003agmtime-528"><code>time:gmtime</code></a>: <a href="#Time-Infrastructure">Time Infrastructure</a></li>
<li><a href="#index-time_003ainvert-529"><code>time:invert</code></a>: <a href="#Time-Infrastructure">Time Infrastructure</a></li>
<li><a href="#index-time_003asplit-530"><code>time:split</code></a>: <a href="#Time-Infrastructure">Time Infrastructure</a></li>
<li><a href="#index-title_002dbottom-726"><code>title-bottom</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-title_002dtop-724"><code>title-top</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-tmpnam-91"><code>tmpnam</code></a>: <a href="#Input_002fOutput">Input/Output</a></li>
<li><a href="#index-tok_003achar_002dgroup-219"><code>tok:char-group</code></a>: <a href="#Token-definition">Token definition</a></li>
<li><a href="#index-top_002drefs-57"><code>top-refs</code></a>: <a href="#Top_002dlevel-Variable-References">Top-level Variable References</a></li>
<li><a href="#index-top_002drefs_003c_002dfile-58"><code>top-refs&lt;-file</code></a>: <a href="#Top_002dlevel-Variable-References">Top-level Variable References</a></li>
<li><a href="#index-topological_002dsort-1497"><code>topological-sort</code></a>: <a href="#Topological-Sort">Topological Sort</a></li>
<li><a href="#index-trace-1803"><code>trace</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-trace_002dall-1781"><code>trace-all</code></a>: <a href="#Debug">Debug</a></li>
<li><a href="#index-tracef-1815"><code>tracef</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-track-1805"><code>track</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-track_002dall-1782"><code>track-all</code></a>: <a href="#Debug">Debug</a></li>
<li><a href="#index-trackf-1817"><code>trackf</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-transact_002dfile_002dreplacement-1850"><code>transact-file-replacement</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-transcript_002doff-1609"><code>transcript-off</code></a>: <a href="#Transcripts">Transcripts</a></li>
<li><a href="#index-transcript_002don-1608"><code>transcript-on</code></a>: <a href="#Transcripts">Transcripts</a></li>
<li><a href="#index-transformer-148"><code>transformer</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-transpose-1031"><code>transpose</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-truncate_002dup_002dto-314"><code>truncate-up-to</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-tsort-1496"><code>tsort</code></a>: <a href="#Topological-Sort">Topological Sort</a></li>
<li><a href="#index-type_002dof-1563"><code>type-of</code></a>: <a href="#Type-Coercion">Type Coercion</a></li>
<li><a href="#index-tz_003aparams-498"><code>tz:params</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-tz_003astd_002doffset-499"><code>tz:std-offset</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-tzfile_003aread-531"><code>tzfile:read</code></a>: <a href="#Time-Infrastructure">Time Infrastructure</a></li>
<li><a href="#index-tzset-500"><code>tzset</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-unbreak-1794"><code>unbreak</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-unbreakf-1798"><code>unbreakf</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-union-1437"><code>union</code></a>: <a href="#Lists-as-sets">Lists as sets</a></li>
<li><a href="#index-unmake_002dmethod_0021-1403"><code>unmake-method!</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-unstack-1813"><code>unstack</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-untrace-1809"><code>untrace</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-untracef-1821"><code>untracef</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-untrack-1811"><code>untrack</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-unzip1-1714"><code>unzip1</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-unzip2-1715"><code>unzip2</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-unzip3-1716"><code>unzip3</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-unzip4-1717"><code>unzip4</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-unzip5-1718"><code>unzip5</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-uri_002d_003etree-416"><code>uri-&gt;tree</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-uri_003adecode_002dquery-420"><code>uri:decode-query</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-uri_003amake_002dpath-410"><code>uri:make-path</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-uri_003apath_002d_003ekeys-426"><code>uri:path-&gt;keys</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-uri_003asplit_002dfields-419"><code>uri:split-fields</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-uric_003adecode-425"><code>uric:decode</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-uric_003aencode-422"><code>uric:encode</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-url_002d_003ecolor_002ddictionary-975"><code>url-&gt;color-dictionary</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-user_002demail_002daddress-1853"><code>user-email-address</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-user_002dvicinity-68"><code>user-vicinity</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-values-1650"><code>values</code></a>: <a href="#Values">Values</a></li>
<li><a href="#index-vector_002d_003earray-1229"><code>vector-&gt;array</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-vector_002dfill_0021-1627"><code>vector-fill!</code></a>: <a href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a></li>
<li><a href="#index-vet_002dslib-62"><code>vet-slib</code></a>: <a href="#Module-Analysis">Module Analysis</a></li>
<li><a href="#index-vicinity_003asuffix_003f-71"><code>vicinity:suffix?</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-vrml-747"><code>vrml</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-vrml_002dappend-748"><code>vrml-append</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-vrml_002dto_002dfile-749"><code>vrml-to-file</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-wavelength_002d_003echromaticity-906"><code>wavelength-&gt;chromaticity</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-wavelength_002d_003eXYZ-905"><code>wavelength-&gt;XYZ</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-whole_002dpage-717"><code>whole-page</code></a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-whole_002dpage-696"><code>whole-page</code></a>: <a href="#PostScript-Graphing">PostScript Graphing</a></li>
<li><a href="#index-with_002dinput_002dfrom_002dfile-1605"><code>with-input-from-file</code></a>: <a href="#With_002dFile">With-File</a></li>
<li><a href="#index-with_002dload_002dpathname-74"><code>with-load-pathname</code></a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-with_002doutput_002dto_002dfile-1606"><code>with-output-to-file</code></a>: <a href="#With_002dFile">With-File</a></li>
<li><a href="#index-within_002ddatabase-1103"><code>within-database</code></a>: <a href="#Within_002ddatabase">Within-database</a></li>
<li><a href="#index-world_003ainfo-750"><code>world:info</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-wrap_002dcommand_002dinterface-1084"><code>wrap-command-interface</code></a>: <a href="#Database-Extension">Database Extension</a></li>
<li><a href="#index-write_002dbase-on-base_002dtable-1130"><code>write-base on base-table</code></a>: <a href="#The-Base">The Base</a></li>
<li><a href="#index-write_002dbyte-1316"><code>write-byte</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-write_002dbytes-1324"><code>write-bytes</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-write_002ddatabase-1046"><code>write-database</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-write_002ddatabase-on-relational_002ddatabase-1162"><code>write-database on relational-database</code></a>: <a href="#Database-Operations">Database Operations</a></li>
<li><a href="#index-write_002dline-1584"><code>write-line</code></a>: <a href="#Line-I_002fO">Line I/O</a></li>
<li><a href="#index-wt_002dtree_002fadd-1194"><code>wt-tree/add</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fadd_0021-1195"><code>wt-tree/add!</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fdelete-1198"><code>wt-tree/delete</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fdelete_0021-1199"><code>wt-tree/delete!</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fdelete_002dmin-1217"><code>wt-tree/delete-min</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fdelete_002dmin_0021-1218"><code>wt-tree/delete-min!</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fdifference-1204"><code>wt-tree/difference</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fempty_003f-1192"><code>wt-tree/empty?</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002ffold-1207"><code>wt-tree/fold</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002ffor_002deach-1208"><code>wt-tree/for-each</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002findex-1210"><code>wt-tree/index</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002findex_002ddatum-1211"><code>wt-tree/index-datum</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002findex_002dpair-1212"><code>wt-tree/index-pair</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fintersection-1203"><code>wt-tree/intersection</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002flookup-1197"><code>wt-tree/lookup</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fmember_003f-1196"><code>wt-tree/member?</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fmin-1214"><code>wt-tree/min</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fmin_002ddatum-1215"><code>wt-tree/min-datum</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fmin_002dpair-1216"><code>wt-tree/min-pair</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002frank-1213"><code>wt-tree/rank</code></a>: <a href="#Indexing-Operations-on-Weight_002dBalanced-Trees">Indexing Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fset_002dequal_003f-1206"><code>wt-tree/set-equal?</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fsize-1193"><code>wt-tree/size</code></a>: <a href="#Basic-Operations-on-Weight_002dBalanced-Trees">Basic Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fsplit_003c-1200"><code>wt-tree/split&lt;</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fsplit_003e-1201"><code>wt-tree/split&gt;</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002fsubset_003f-1205"><code>wt-tree/subset?</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002funion-1202"><code>wt-tree/union</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-wt_002dtree_002funion_002dmerge-1209"><code>wt-tree/union-merge</code></a>: <a href="#Advanced-Operations-on-Weight_002dBalanced-Trees">Advanced Operations on Weight-Balanced Trees</a></li>
<li><a href="#index-x_002daxis-736"><code>x-axis</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-xcons-1673"><code>xcons</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-xRGB_002d_003eCIEXYZ-954"><code>xRGB-&gt;CIEXYZ</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-xrgb_002d_003ecolor-882"><code>xrgb-&gt;color</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-xRGB_002d_003esRGB-956"><code>xRGB-&gt;sRGB</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-xyY_002d_003eXYZ-916"><code>xyY-&gt;XYZ</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-xyY_003anormalize_002dcolors-917"><code>xyY:normalize-colors</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-XYZ_002d_003echromaticity-911"><code>XYZ-&gt;chromaticity</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-XYZ_002d_003exyY-915"><code>XYZ-&gt;xyY</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-y_002daxis-735"><code>y-axis</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-zenith_002dxyy-995"><code>zenith-xyy</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-zip-1713"><code>zip</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
  </ul><div class="node">
<a name="Variable-Index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Concept-and-Feature-Index">Concept and Feature Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Procedure-and-Macro-Index">Procedure and Macro Index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Index">Index</a>

</div>

<h2 class="unnumbered">Variable Index</h2>

<!-- This is an alphabetical list of all the global variables in SLIB. -->


<ul class="index-vr" compact>
<li><a href="#index-g_t_002aargv_002a-260"><code>*argv*</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-g_t_002abase_002dtable_002dimplementations_002a-1125"><code>*base-table-implementations*</code></a>: <a href="#Base-Table">Base Table</a></li>
<li><a href="#index-g_t_002acatalog_002a-13"><code>*catalog*</code></a>: <a href="#Require">Require</a></li>
<li><a href="#index-g_t_002ahttp_003abyline_002a-386"><code>*http:byline*</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-g_t_002aoperating_002dsystem_002a-304"><code>*operating-system*</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-g_t_002aoptarg_002a-262"><code>*optarg*</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-g_t_002aoptind_002a-261"><code>*optind*</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-g_t_002aqp_002dwidth_002a-1778"><code>*qp-width*</code></a>: <a href="#Quick-Print">Quick Print</a></li>
<li><a href="#index-g_t_002arandom_002dstate_002a-635"><code>*random-state*</code></a>: <a href="#Exact-Random-Numbers">Exact Random Numbers</a></li>
<li><a href="#index-g_t_002aruleset_002a-1018"><code>*ruleset*</code></a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-g_t_002asyn_002ddefs_002a-213"><code>*syn-defs*</code></a>: <a href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a></li>
<li><a href="#index-g_t_002asyn_002dignore_002dwhitespace_002a-214"><code>*syn-ignore-whitespace*</code></a>: <a href="#Ruleset-Definition-and-Use">Ruleset Definition and Use</a></li>
<li><a href="#index-g_t_002atimezone_002a-503"><code>*timezone*</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-atm_002dhec_002dpolynomial-675"><code>atm-hec-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-bottomedge-729"><code>bottomedge</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-char_002dcode_002dlimit-75"><code>char-code-limit</code></a>: <a href="#Configuration">Configuration</a></li>
<li><a href="#index-charplot_003adimensions-688"><code>charplot:dimensions</code></a>: <a href="#Character-Plotting">Character Plotting</a></li>
<li><a href="#index-CIEXYZ_003aA-934"><code>CIEXYZ:A</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_003aB-935"><code>CIEXYZ:B</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_003aC-936"><code>CIEXYZ:C</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_003aD50-933"><code>CIEXYZ:D50</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_003aD65-932"><code>CIEXYZ:D65</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-CIEXYZ_003aE-937"><code>CIEXYZ:E</code></a>: <a href="#Color-Conversions">Color Conversions</a></li>
<li><a href="#index-crc_002d08_002dpolynomial-674"><code>crc-08-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-crc_002d10_002dpolynomial-673"><code>crc-10-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-crc_002d12_002dpolynomial-672"><code>crc-12-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-crc_002d16_002dpolynomial-671"><code>crc-16-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-crc_002d32_002dpolynomial-669"><code>crc-32-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-crc_002dccitt_002dpolynomial-670"><code>crc-ccitt-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-D50-841"><code>D50</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-D65-840"><code>D65</code></a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-daylight_003f-504"><code>daylight?</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-debug_003amax_002dcount-1800"><code>debug:max-count</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-distribute_002a-1023"><code>distribute*</code></a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-distribute_002f-1024"><code>distribute/</code></a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-dowcrc_002dpolynomial-676"><code>dowcrc-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-graph_003adimensions-739"><code>graph:dimensions</code></a>: <a href="#Legacy-Plotting">Legacy Plotting</a></li>
<li><a href="#index-graphrect-720"><code>graphrect</code></a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-leftedge-730"><code>leftedge</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-most_002dpositive_002dfixnum-76"><code>most-positive-fixnum</code></a>: <a href="#Configuration">Configuration</a></li>
<li><a href="#index-nil-116"><code>nil</code></a>: <a href="#Miscellany">Miscellany</a></li>
<li><a href="#index-number_002dwt_002dtype-1187"><code>number-wt-type</code></a>: <a href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a></li>
<li><a href="#index-plotrect-719"><code>plotrect</code></a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-prime_003aprngs-623"><code>prime:prngs</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-prime_003atrials-625"><code>prime:trials</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-rightedge-731"><code>rightedge</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-slib_003aform_002dfeed-78"><code>slib:form-feed</code></a>: <a href="#Configuration">Configuration</a></li>
<li><a href="#index-slib_003atab-77"><code>slib:tab</code></a>: <a href="#Configuration">Configuration</a></li>
<li><a href="#index-stderr-243"><code>stderr</code></a>: <a href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a></li>
<li><a href="#index-stdin-241"><code>stdin</code></a>: <a href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a></li>
<li><a href="#index-stdout-242"><code>stdout</code></a>: <a href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a></li>
<li><a href="#index-string_002dwt_002dtype-1188"><code>string-wt-type</code></a>: <a href="#Construction-of-Weight_002dBalanced-Trees">Construction of Weight-Balanced Trees</a></li>
<li><a href="#index-t-115"><code>t</code></a>: <a href="#Miscellany">Miscellany</a></li>
<li><a href="#index-tok_003adecimal_002ddigits-220"><code>tok:decimal-digits</code></a>: <a href="#Token-definition">Token definition</a></li>
<li><a href="#index-tok_003alower_002dcase-222"><code>tok:lower-case</code></a>: <a href="#Token-definition">Token definition</a></li>
<li><a href="#index-tok_003aupper_002dcase-221"><code>tok:upper-case</code></a>: <a href="#Token-definition">Token definition</a></li>
<li><a href="#index-tok_003awhitespaces-223"><code>tok:whitespaces</code></a>: <a href="#Token-definition">Token definition</a></li>
<li><a href="#index-topedge-728"><code>topedge</code></a>: <a href="#Legending">Legending</a></li>
<li><a href="#index-tzname-505"><code>tzname</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-usb_002dtoken_002dpolynomial-677"><code>usb-token-polynomial</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
  </ul><div class="node">
<a name="Concept-and-Feature-Index"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Variable-Index">Variable Index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Index">Index</a>

</div>

<h2 class="unnumbered">Concept and Feature Index</h2>



<ul class="index-cp" compact>
<li><a href="#index-g_t_0040w_007b_003d_003e_007d-184">=&gt;<!-- /@w --></a>: <a href="#Guarded-COND-Clause">Guarded COND Clause</a></li>
<li><a href="#index-aggregate-53">aggregate</a>: <a href="#Module-Semantics">Module Semantics</a></li>
<li><a href="#index-aggregate-21">aggregate</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-alarm-1589">alarm</a>: <a href="#Multi_002dProcessing">Multi-Processing</a></li>
<li><a href="#index-alarm_002dinterrupt-1590">alarm-interrupt</a>: <a href="#Multi_002dProcessing">Multi-Processing</a></li>
<li><a href="#index-alist-1287"><code>alist</code></a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-alist_002dtable-1158"><code>alist-table</code></a>: <a href="#Relational-Database-Objects">Relational Database Objects</a></li>
<li><a href="#index-alist_002dtable-1126"><code>alist-table</code></a>: <a href="#The-Base">The Base</a></li>
<li><a href="#index-alist_002dtable-1118"><code>alist-table</code></a>: <a href="#Base-Table">Base Table</a></li>
<li><a href="#index-and_002dlet_002a-179"><code>and-let*</code></a>: <a href="#Guarded-LET_002a-special-form">Guarded LET* special form</a></li>
<li><a href="#index-ange_002dftp-436">ange-ftp</a>: <a href="#URI">URI</a></li>
<li><a href="#index-appearance-810">appearance</a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-array-1219"><code>array</code></a>: <a href="#Arrays">Arrays</a></li>
<li><a href="#index-array_002dfor_002deach-1277"><code>array-for-each</code></a>: <a href="#Array-Mapping">Array Mapping</a></li>
<li><a href="#index-association-function-1289">association function</a>: <a href="#Association-Lists">Association Lists</a></li>
<li><a href="#index-Attribute-461">Attribute</a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-attribute_002dvalue-327">attribute-value</a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-AttValue-462">AttValue</a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-Auto_002dsharing-1040">Auto-sharing</a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-balanced-binary-trees-1176">balanced binary trees</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-base-414">base</a>: <a href="#URI">URI</a></li>
<li><a href="#index-base_002dtable-1117">base-table</a>: <a href="#Base-Table">Base Table</a></li>
<li><a href="#index-batch-302"><code>batch</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-bignum-8"><code>bignum</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-binary-1313">binary</a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-binary-trees-1177">binary trees</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-binary-trees_002c-as-discrete-maps-1180">binary trees, as discrete maps</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-binary-trees_002c-as-sets-1179">binary trees, as sets</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-binding-power-201">binding power</a>: <a href="#Precedence-Parsing-Overview">Precedence Parsing Overview</a></li>
<li><a href="#index-break-1785"><code>break</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-byte-1295"><code>byte</code></a>: <a href="#Byte">Byte</a></li>
<li><a href="#index-byte_002dnumber-1330"><code>byte-number</code></a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-calendar-time-508">calendar time</a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-calendar-time-491">calendar time</a>: <a href="#Time-and-Date">Time and Date</a></li>
<li><a href="#index-Calendar_002dTime-507"><code>Calendar-Time</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-caltime-509">caltime</a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-canonical-964">canonical</a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-careful-1013">careful</a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-catalog-12">catalog</a>: <a href="#Require">Require</a></li>
<li><a href="#index-Catalog-File-18">Catalog File</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-certificate-1841">certificate</a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-cgi-383"><code>cgi</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-chapter_002dorder-1476"><code>chapter-order</code></a>: <a href="#Chapter-Ordering">Chapter Ordering</a></li>
<li><a href="#index-charplot-687"><code>charplot</code></a>: <a href="#Character-Plotting">Character Plotting</a></li>
<li><a href="#index-Chroma-868">Chroma</a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-cie1931-892"><code>cie1931</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-cie1964-890"><code>cie1964</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-ciexyz-894"><code>ciexyz</code></a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-CIEXYZ-844"><code>CIEXYZ</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-cksum_002dstring-682">cksum-string</a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-coerce-1562"><code>coerce</code></a>: <a href="#Type-Coercion">Type Coercion</a></li>
<li><a href="#index-collect-1363"><code>collect</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-color_002ddatabase-972"><code>color-database</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-color_002dnames-962"><code>color-names</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-command-line-271">command line</a>: <a href="#Command-Line">Command Line</a></li>
<li><a href="#index-commentfix-209"><code>commentfix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-common_002dlist_002dfunctions-1431"><code>common-list-functions</code></a>: <a href="#Common-List-Functions">Common List Functions</a></li>
<li><a href="#index-common_002dlist_002dfunctions-1374"><code>common-list-functions</code></a>: <a href="#Collections">Collections</a></li>
<li><a href="#index-commutative_002dring-1011"><code>commutative-ring</code></a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-compiled-20">compiled</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-compiling-41">compiling</a>: <a href="#Module-Conventions">Module Conventions</a></li>
<li><a href="#index-complex-7"><code>complex</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-Coordinated-Universal-Time-510"><code>Coordinated Universal Time</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-copyright-1889">copyright</a>: <a href="#Copyrights">Copyrights</a></li>
<li><a href="#index-crc-668"><code>crc</code></a>: <a href="#Cyclic-Checksum">Cyclic Checksum</a></li>
<li><a href="#index-cvs-1854"><code>cvs</code></a>: <a href="#CVS">CVS</a></li>
<li><a href="#index-database_002dcommands-1098"><code>database-commands</code></a>: <a href="#Command-Example">Command Example</a></li>
<li><a href="#index-databases-1099"><code>databases</code></a>: <a href="#Command-Example">Command Example</a></li>
<li><a href="#index-databases-1096"><code>databases</code></a>: <a href="#Define_002dtables-Example">Define-tables Example</a></li>
<li><a href="#index-databases-1039"><code>databases</code></a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-databases-321"><code>databases</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-daylight-985"><code>daylight</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-db_002d_003ehtml-359"><code>db-&gt;html</code></a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-debug-1788"><code>debug</code></a>: <a href="#Breakpoints">Breakpoints</a></li>
<li><a href="#index-debug-1779"><code>debug</code></a>: <a href="#Debug">Debug</a></li>
<li><a href="#index-define_002drecord_002dtype-166"><code>define-record-type</code></a>: <a href="#Define_002dRecord_002dType">Define-Record-Type</a></li>
<li><a href="#index-defmacro-22">defmacro</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-defmacroexpand-489"><code>defmacroexpand</code></a>: <a href="#Pretty_002dPrint">Pretty-Print</a></li>
<li><a href="#index-defmacroexpand-125"><code>defmacroexpand</code></a>: <a href="#Defmacro">Defmacro</a></li>
<li><a href="#index-delim-212"><code>delim</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-dequeues-1414">dequeues</a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-determinant-1027"><code>determinant</code></a>: <a href="#Matrix-Algebra">Matrix Algebra</a></li>
<li><a href="#index-dft_002c-Fourier_002dtransform-654"><code>dft, Fourier-transform</code></a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-diff-1552"><code>diff</code></a>: <a href="#Sequence-Comparison">Sequence Comparison</a></li>
<li><a href="#index-directory-1828"><code>directory</code></a>: <a href="#Directories">Directories</a></li>
<li><a href="#index-Discrete-Fourier-Transform-657">Discrete Fourier Transform</a>: <a href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a></li>
<li><a href="#index-discrete-maps_002c-using-binary-trees-1182">discrete maps, using binary trees</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-DrScheme-1878"><code>DrScheme</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-dynamic-1380"><code>dynamic</code></a>: <a href="#Dynamic-Data-Type">Dynamic Data Type</a></li>
<li><a href="#index-dynamic_002dwind-1641"><code>dynamic-wind</code></a>: <a href="#Dynamic_002dWind">Dynamic-Wind</a></li>
<li><a href="#index-e_002dsRGB-883"><code>e-sRGB</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-ELK-1876"><code>ELK</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-emacs-1838">emacs</a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-Encapsulated_002dPostScript-695">Encapsulated-PostScript</a>: <a href="#PostScript-Graphing">PostScript Graphing</a></li>
<li><a href="#index-escaped-424">escaped</a>: <a href="#URI">URI</a></li>
<li><a href="#index-EUC-1868">EUC</a>: <a href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a></li>
<li><a href="#index-Euclidean-Domain-1017">Euclidean Domain</a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-eval-1643"><code>eval</code></a>: <a href="#Eval">Eval</a></li>
<li><a href="#index-exchanger-113">exchanger</a>: <a href="#Miscellany">Miscellany</a></li>
<li><a href="#index-factor-621"><code>factor</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-feature-1890"><code>feature</code></a>: <a href="#About-this-manual">About this manual</a></li>
<li><a href="#index-feature-14"><code>feature</code></a>: <a href="#Require">Require</a></li>
<li><a href="#index-feature-1">feature</a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-File-Transfer-Protocol-433">File Transfer Protocol</a>: <a href="#URI">URI</a></li>
<li><a href="#index-file_002dlock-1836">file-lock</a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-filename-324"><code>filename</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-filename-290"><code>filename</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-fluid_002dlet-168"><code>fluid-let</code></a>: <a href="#Fluid_002dLet">Fluid-Let</a></li>
<li><a href="#index-fold-455">fold</a>: <a href="#Parsing-XML">Parsing XML</a></li>
<li><a href="#index-form-342">form</a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-format-238"><code>format</code></a>: <a href="#Format">Format</a></li>
<li><a href="#index-Gambit_002dC-3_002e0-1881"><code>Gambit-C 3.0</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-gamut-845">gamut</a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-Gauche_002d0_002e9-1875"><code>Gauche-0.9</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-generic_002dwrite-473"><code>generic-write</code></a>: <a href="#Generic_002dWrite">Generic-Write</a></li>
<li><a href="#index-getenv-1822"><code>getenv</code></a>: <a href="#System-Interface">System Interface</a></li>
<li><a href="#index-getit-437">getit</a>: <a href="#URI">URI</a></li>
<li><a href="#index-getopt-1102"><code>getopt</code></a>: <a href="#Command-Example">Command Example</a></li>
<li><a href="#index-getopt-259"><code>getopt</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-getopt_002dparameters-1100"><code>getopt-parameters</code></a>: <a href="#Command-Example">Command Example</a></li>
<li><a href="#index-getopt_002dparameters-286"><code>getopt-parameters</code></a>: <a href="#Getopt-Parameter-lists">Getopt Parameter lists</a></li>
<li><a href="#index-glob-289"><code>glob</code></a>: <a href="#Filenames">Filenames</a></li>
<li><a href="#index-Gray-code-1519">Gray code</a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-guarded_002dcond_002dclause-182"><code>guarded-cond-clause</code></a>: <a href="#Guarded-COND-Clause">Guarded COND Clause</a></li>
<li><a href="#index-Guile-1884"><code>Guile</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-hash-1499"><code>hash</code></a>: <a href="#Hashing">Hashing</a></li>
<li><a href="#index-hash_002dtable-1386"><code>hash-table</code></a>: <a href="#Hash-Tables">Hash Tables</a></li>
<li><a href="#index-Hilbert-1512">Hilbert</a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-Hilbert-Space_002dFilling-Curve-1514">Hilbert Space-Filling Curve</a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-hilbert_002dfill-1511"><code>hilbert-fill</code></a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-HOME-70">HOME</a>: <a href="#Vicinity">Vicinity</a></li>
<li><a href="#index-HOME-28">HOME</a>: <a href="#Catalog-Creation">Catalog Creation</a></li>
<li><a href="#index-homecat-38">homecat</a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-html_002dfor_002deach-397"><code>html-for-each</code></a>: <a href="#Parsing-HTML">Parsing HTML</a></li>
<li><a href="#index-html_002dform-325"><code>html-form</code></a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-http-382"><code>http</code></a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-Hue-869">Hue</a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-ICC-Profile-876"><code>ICC Profile</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-implcat-35">implcat</a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-indexed_002dsequential_002daccess_002dmethod-1337">indexed-sequential-access-method</a>: <a href="#Byte_002fNumber-Conversions">Byte/Number Conversions</a></li>
<li><a href="#index-inexact-4"><code>inexact</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-infix-205"><code>infix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-Info-59">Info</a>: <a href="#Top_002dlevel-Variable-References">Top-level Variable References</a></li>
<li><a href="#index-inmatchfix-211"><code>inmatchfix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-install-1869">install</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-installation-1870">installation</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-intrinsic-feature-3">intrinsic feature</a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-ISAM-1071">ISAM</a>: <a href="#Indexed-Sequential-Access-Methods">Indexed Sequential Access Methods</a></li>
<li><a href="#index-Japanese-1866">Japanese</a>: <a href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a></li>
<li><a href="#index-JFILTER-1865">JFILTER</a>: <a href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a></li>
<li><a href="#index-JIS-1867">JIS</a>: <a href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a></li>
<li><a href="#index-Kawa-1883"><code>Kawa</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-L_002aa_002ab_002a-853"><code>L*a*b*</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-L_002aC_002ah-866"><code>L*C*h</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-L_002au_002av_002a-860"><code>L*u*v*</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-lamination-1528">lamination</a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-Larceny-1874"><code>Larceny</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-Left-Denotation_002c-led-225">Left Denotation, led</a>: <a href="#Nud-and-Led-Definition">Nud and Led Definition</a></li>
<li><a href="#index-let_002dvalues-175"><code>let-values</code></a>: <a href="#Binding-to-multiple-values">Binding to multiple values</a></li>
<li><a href="#index-Lightness-854">Lightness</a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-line_002di-1579"><code>line-i</code></a>: <a href="#Line-I_002fO">Line I/O</a></li>
<li><a href="#index-list_002dprocessing-library-1672">list-processing library</a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-load_002doption-1185"><code>load-option</code></a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-logical-547"><code>logical</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-macro-1772"><code>macro</code></a>: <a href="#Repl">Repl</a></li>
<li><a href="#index-macro-127"><code>macro</code></a>: <a href="#R4RS-Macros">R4RS Macros</a></li>
<li><a href="#index-macro-24">macro</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-macro_002dby_002dexample-131"><code>macro-by-example</code></a>: <a href="#Macro-by-Example">Macro by Example</a></li>
<li><a href="#index-macro_002dby_002dexample-23">macro-by-example</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-macros_002dthat_002dwork-134"><code>macros-that-work</code></a>: <a href="#Macros-That-Work">Macros That Work</a></li>
<li><a href="#index-macros_002dthat_002dwork-25">macros-that-work</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-manifest-42"><code>manifest</code></a>: <a href="#Module-Manifests">Module Manifests</a></li>
<li><a href="#index-match-1149">match</a>: <a href="#Match-Keys">Match Keys</a></li>
<li><a href="#index-match_002dkeys-1148">match-keys</a>: <a href="#Match-Keys">Match Keys</a></li>
<li><a href="#index-match_002dkeys-1063">match-keys</a>: <a href="#Match_002dKeys">Match-Keys</a></li>
<li><a href="#index-matchfix-210"><code>matchfix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-matfile-1344"><code>matfile</code></a>: <a href="#MAT_002dFile-Format">MAT-File Format</a></li>
<li><a href="#index-math_002dinteger-593"><code>math-integer</code></a>: <a href="#Irrational-Integer-Functions">Irrational Integer Functions</a></li>
<li><a href="#index-math_002dreal-601"><code>math-real</code></a>: <a href="#Irrational-Real-Functions">Irrational Real Functions</a></li>
<li><a href="#index-matlab-1345"><code>matlab</code></a>: <a href="#MAT_002dFile-Format">MAT-File Format</a></li>
<li><a href="#index-metric_002dunits-1594"><code>metric-units</code></a>: <a href="#Metric-Units">Metric Units</a></li>
<li><a href="#index-minimize-1006"><code>minimize</code></a>: <a href="#Minimizing">Minimizing</a></li>
<li><a href="#index-minimum-field-width-_0028_0040code_007bprintf_007d_0029-250">minimum field width (<code>printf</code>)</a>: <a href="#Standard-Formatted-Output">Standard Formatted Output</a></li>
<li><a href="#index-MIT-Scheme-1880"><code>MIT Scheme</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-mkimpcat_002escm-36">mkimpcat.scm</a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-mklibcat_002escm-33">mklibcat.scm</a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-modular-580"><code>modular</code></a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-multiarg-1628"><code>multiarg</code></a>: <a href="#Multi_002dargument-_002f-and-_002d">Multi-argument / and -</a></li>
<li><a href="#index-multiarg_002dapply-1631"><code>multiarg-apply</code></a>: <a href="#Multi_002dargument-Apply">Multi-argument Apply</a></li>
<li><a href="#index-MzScheme-1879"><code>MzScheme</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-nary-206"><code>nary</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-ncbi_002ddma-532"><code>ncbi-dma</code></a>: <a href="#NCBI_002dDNA">NCBI-DNA</a></li>
<li><a href="#index-new_002dcatalog-30">new-catalog</a>: <a href="#Catalog-Creation">Catalog Creation</a></li>
<li><a href="#index-nofix-203"><code>nofix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-null-374">null</a>: <a href="#HTML-Tables">HTML Tables</a></li>
<li><a href="#index-Null-Denotation_002c-nud-224">Null Denotation, nud</a>: <a href="#Nud-and-Led-Definition">Nud and Led Definition</a></li>
<li><a href="#index-object-1396"><code>object</code></a>: <a href="#Object">Object</a></li>
<li><a href="#index-object_002d_003estring-475"><code>object-&gt;string</code></a>: <a href="#Object_002dTo_002dString">Object-To-String</a></li>
<li><a href="#index-oop-185"><code>oop</code></a>: <a href="#Yasos">Yasos</a></li>
<li><a href="#index-option_002c-run_002dtime_002dloadable-1184">option, run-time-loadable</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-options-file-275">options file</a>: <a href="#Command-Line">Command Line</a></li>
<li><a href="#index-parameters-1101"><code>parameters</code></a>: <a href="#Command-Example">Command Example</a></li>
<li><a href="#index-parameters-322"><code>parameters</code></a>: <a href="#Batch">Batch</a></li>
<li><a href="#index-parameters-277"><code>parameters</code></a>: <a href="#Parameter-lists">Parameter lists</a></li>
<li><a href="#index-parse-199"><code>parse</code></a>: <a href="#Precedence-Parsing">Precedence Parsing</a></li>
<li><a href="#index-pbm-1352">pbm</a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-pbm_002draw-1353">pbm-raw</a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-peano_002dfill-1530"><code>peano-fill</code></a>: <a href="#Peano-Space_002dFilling-Curve">Peano Space-Filling Curve</a></li>
<li><a href="#index-pgm-1354">pgm</a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-pgm_002draw-1355">pgm-raw</a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-plain_002dtext-329">plain-text</a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-PLT-Scheme-1877"><code>PLT Scheme</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-pnm-1349"><code>pnm</code></a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-portable-bitmap-graphics-1351">portable bitmap graphics</a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-posix_002dtime-506"><code>posix-time</code></a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-postfix-207"><code>postfix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-ppm-1356">ppm</a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-ppm_002draw-1357">ppm-raw</a>: <a href="#Portable-Image-Files">Portable Image Files</a></li>
<li><a href="#index-pprint_002dfile-483"><code>pprint-file</code></a>: <a href="#Pretty_002dPrint">Pretty-Print</a></li>
<li><a href="#index-PRE-339">PRE</a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-precedence-200"><code>precedence</code></a>: <a href="#Precedence-Parsing">Precedence Parsing</a></li>
<li><a href="#index-precision-_0028_0040code_007bprintf_007d_0029-251">precision (<code>printf</code>)</a>: <a href="#Standard-Formatted-Output">Standard Formatted Output</a></li>
<li><a href="#index-prefix-204"><code>prefix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-prestfix-208"><code>prestfix</code></a>: <a href="#Rule-Types">Rule Types</a></li>
<li><a href="#index-pretty_002dprint-478"><code>pretty-print</code></a>: <a href="#Pretty_002dPrint">Pretty-Print</a></li>
<li><a href="#index-primes-622"><code>primes</code></a>: <a href="#Prime-Numbers">Prime Numbers</a></li>
<li><a href="#index-printf-244"><code>printf</code></a>: <a href="#Standard-Formatted-Output">Standard Formatted Output</a></li>
<li><a href="#index-priority_002dqueue-1407"><code>priority-queue</code></a>: <a href="#Priority-Queues">Priority Queues</a></li>
<li><a href="#index-PRNG-631">PRNG</a>: <a href="#Random-Numbers">Random Numbers</a></li>
<li><a href="#index-process-1588"><code>process</code></a>: <a href="#Multi_002dProcessing">Multi-Processing</a></li>
<li><a href="#index-program_002darguments-1826"><code>program-arguments</code></a>: <a href="#System-Interface">System Interface</a></li>
<li><a href="#index-program_002darguments-265"><code>program-arguments</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-Prolog-1864">Prolog</a>: <a href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a></li>
<li><a href="#index-promise-1637"><code>promise</code></a>: <a href="#Promises">Promises</a></li>
<li><a href="#index-PSD-1862">PSD</a>: <a href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a></li>
<li><a href="#index-qp-1774"><code>qp</code></a>: <a href="#Quick-Print">Quick Print</a></li>
<li><a href="#index-qp-267"><code>qp</code></a>: <a href="#Getopt">Getopt</a></li>
<li><a href="#index-query_002dstring-391">query-string</a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-queue-1412"><code>queue</code></a>: <a href="#Queues">Queues</a></li>
<li><a href="#index-r2rs-1596"><code>r2rs</code></a>: <a href="#RnRS">RnRS</a></li>
<li><a href="#index-r3rs-1888"><code>r3rs</code></a>: <a href="#Coding-Guidelines">Coding Guidelines</a></li>
<li><a href="#index-r3rs-1598"><code>r3rs</code></a>: <a href="#RnRS">RnRS</a></li>
<li><a href="#index-r4rs-1600"><code>r4rs</code></a>: <a href="#RnRS">RnRS</a></li>
<li><a href="#index-r5rs-1602"><code>r5rs</code></a>: <a href="#RnRS">RnRS</a></li>
<li><a href="#index-random-632"><code>random</code></a>: <a href="#Exact-Random-Numbers">Exact Random Numbers</a></li>
<li><a href="#index-random_002dinexact-641"><code>random-inexact</code></a>: <a href="#Inexact-Random-Numbers">Inexact Random Numbers</a></li>
<li><a href="#index-range-697">range</a>: <a href="#Column-Ranges">Column Ranges</a></li>
<li><a href="#index-rational-5"><code>rational</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-rationalize-1633"><code>rationalize</code></a>: <a href="#Rationalize">Rationalize</a></li>
<li><a href="#index-read_002dcommand-268"><code>read-command</code></a>: <a href="#Command-Line">Command Line</a></li>
<li><a href="#index-real-6"><code>real</code></a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-receive-172"><code>receive</code></a>: <a href="#Binding-to-multiple-values">Binding to multiple values</a></li>
<li><a href="#index-record-1425"><code>record</code></a>: <a href="#Records">Records</a></li>
<li><a href="#index-rectangle-716">rectangle</a>: <a href="#Rectangles">Rectangles</a></li>
<li><a href="#index-relational_002ddatabase-1038"><code>relational-database</code></a>: <a href="#Relational-Database">Relational Database</a></li>
<li><a href="#index-relational_002dsystem-1042">relational-system</a>: <a href="#Using-Databases">Using Databases</a></li>
<li><a href="#index-repl-1769"><code>repl</code></a>: <a href="#Repl">Repl</a></li>
<li><a href="#index-repl-161"><code>repl</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-resene-983"><code>resene</code></a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-Resene-979">Resene</a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-reset-353">reset</a>: <a href="#HTML">HTML</a></li>
<li><a href="#index-rev2_002dprocedures-1610"><code>rev2-procedures</code></a>: <a href="#Rev2-Procedures">Rev2 Procedures</a></li>
<li><a href="#index-rev4_002doptional_002dprocedures-1623"><code>rev4-optional-procedures</code></a>: <a href="#Rev4-Optional-Procedures">Rev4 Optional Procedures</a></li>
<li><a href="#index-RGB709-849"><code>RGB709</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-ring_002c-commutative-1012">ring, commutative</a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-RNG-630">RNG</a>: <a href="#Random-Numbers">Random Numbers</a></li>
<li><a href="#index-root-999"><code>root</code></a>: <a href="#Root-Finding">Root Finding</a></li>
<li><a href="#index-run_002dtime_002dloadable-option-1183">run-time-loadable option</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-rwb_002disam-1123"><code>rwb-isam</code></a>: <a href="#Base-Table">Base Table</a></li>
<li><a href="#index-S7-1887"><code>S7</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-saturate-980">saturate</a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-scanf-252"><code>scanf</code></a>: <a href="#Standard-Formatted-Input">Standard Formatted Input</a></li>
<li><a href="#index-SCHELOG-1863">SCHELOG</a>: <a href="#Extra_002dSLIB-Packages">Extra-SLIB Packages</a></li>
<li><a href="#index-scheme-429">scheme</a>: <a href="#URI">URI</a></li>
<li><a href="#index-Scheme-Request-For-Implementation-1653">Scheme Request For Implementation</a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-Scheme48-1885"><code>Scheme48</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-schmooz-541">schmooz</a>: <a href="#Schmooz">Schmooz</a></li>
<li><a href="#index-SCM-1873"><code>SCM</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-script-1872">script</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-self_002dset-1014">self-set</a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-Sequence-Comparison-1553">Sequence Comparison</a>: <a href="#Sequence-Comparison">Sequence Comparison</a></li>
<li><a href="#index-Server_002dbased-Naming-Authority-418">Server-based Naming Authority</a>: <a href="#URI">URI</a></li>
<li><a href="#index-session-2">session</a>: <a href="#Feature">Feature</a></li>
<li><a href="#index-sets_002c-using-binary-trees-1181">sets, using binary trees</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-shell-273">shell</a>: <a href="#Command-Line">Command Line</a></li>
<li><a href="#index-sierpinski-1535"><code>sierpinski</code></a>: <a href="#Sierpinski-Curve">Sierpinski Curve</a></li>
<li><a href="#index-SISC-1882"><code>SISC</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-sitecat-34">sitecat</a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-sky-988"><code>sky</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-slib-1871">slib</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-slibcat-32">slibcat</a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-solid-745"><code>solid</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solid_002dmodeling-746"><code>solid-modeling</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-solids-744"><code>solids</code></a>: <a href="#Solid-Modeling">Solid Modeling</a></li>
<li><a href="#index-sort-1482"><code>sort</code></a>: <a href="#Sorting">Sorting</a></li>
<li><a href="#index-soundex-1537"><code>soundex</code></a>: <a href="#Soundex">Soundex</a></li>
<li><a href="#index-source-19">source</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-Space_002dFilling-1513">Space-Filling</a>: <a href="#Hilbert-Space_002dFilling-Curve">Hilbert Space-Filling Curve</a></li>
<li><a href="#index-space_002dfilling-1503"><code>space-filling</code></a>: <a href="#Multidimensional-Space_002dFilling-Curves">Multidimensional Space-Filling Curves</a></li>
<li><a href="#index-sparse-1346">sparse</a>: <a href="#MAT_002dFile-Format">MAT-File Format</a></li>
<li><a href="#index-Spectral-Tristimulus-Values-889">Spectral Tristimulus Values</a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-spiff-1555">spiff</a>: <a href="#Sequence-Comparison">Sequence Comparison</a></li>
<li><a href="#index-srfi-1652"><code>srfi</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-SRFI_002d1-1671">SRFI-1</a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-srfi_002d1-1670"><code>srfi-1</code></a>: <a href="#SRFI_002d1">SRFI-1</a></li>
<li><a href="#index-srfi_002d11-1658"><code>srfi-11</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d11-174"><code>srfi-11</code></a>: <a href="#Binding-to-multiple-values">Binding to multiple values</a></li>
<li><a href="#index-srfi_002d2-1655"><code>srfi-2</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d2-178"><code>srfi-2</code></a>: <a href="#Guarded-LET_002a-special-form">Guarded LET* special form</a></li>
<li><a href="#index-srfi_002d23-1659"><code>srfi-23</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d28-1660"><code>srfi-28</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d39-1661"><code>srfi-39</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d39-170"><code>srfi-39</code></a>: <a href="#Parameter-Objects">Parameter Objects</a></li>
<li><a href="#index-srfi_002d47-1662"><code>srfi-47</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d59-1663"><code>srfi-59</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d60-1664"><code>srfi-60</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d60-548"><code>srfi-60</code></a>: <a href="#Bit_002dTwiddling">Bit-Twiddling</a></li>
<li><a href="#index-srfi_002d61-1665"><code>srfi-61</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d61-181"><code>srfi-61</code></a>: <a href="#Guarded-COND-Clause">Guarded COND Clause</a></li>
<li><a href="#index-srfi_002d63-1666"><code>srfi-63</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d8-1656"><code>srfi-8</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d8-171"><code>srfi-8</code></a>: <a href="#Binding-to-multiple-values">Binding to multiple values</a></li>
<li><a href="#index-srfi_002d9-1657"><code>srfi-9</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d9-165"><code>srfi-9</code></a>: <a href="#Define_002dRecord_002dType">Define-Record-Type</a></li>
<li><a href="#index-srfi_002d94-1667"><code>srfi-94</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d95-1668"><code>srfi-95</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-srfi_002d95-1483"><code>srfi-95</code></a>: <a href="#Sorting">Sorting</a></li>
<li><a href="#index-srfi_002d96-1669"><code>srfi-96</code></a>: <a href="#SRFI">SRFI</a></li>
<li><a href="#index-sRGB-875"><code>sRGB</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-stdio-240"><code>stdio</code></a>: <a href="#Standard-Formatted-I_002fO">Standard Formatted I/O</a></li>
<li><a href="#index-string_002dcase-1565"><code>string-case</code></a>: <a href="#String_002dCase">String-Case</a></li>
<li><a href="#index-string_002dport-1576"><code>string-port</code></a>: <a href="#String-Ports">String Ports</a></li>
<li><a href="#index-string_002dsearch-1539"><code>string-search</code></a>: <a href="#String-Search">String Search</a></li>
<li><a href="#index-subarray-1274"><code>subarray</code></a>: <a href="#Subarrays">Subarrays</a></li>
<li><a href="#index-sun-987"><code>sun</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-sunlight-986"><code>sunlight</code></a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-symmetric-585">symmetric</a>: <a href="#Modular-Arithmetic">Modular Arithmetic</a></li>
<li><a href="#index-syntactic_002dclosures-141"><code>syntactic-closures</code></a>: <a href="#Syntactic-Closures">Syntactic Closures</a></li>
<li><a href="#index-syntactic_002dclosures-27">syntactic-closures</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-syntax-tree-202">syntax tree</a>: <a href="#Precedence-Parsing-Overview">Precedence Parsing Overview</a></li>
<li><a href="#index-syntax_002dcase-153"><code>syntax-case</code></a>: <a href="#Syntax_002dCase-Macros">Syntax-Case Macros</a></li>
<li><a href="#index-syntax_002dcase-26">syntax-case</a>: <a href="#Library-Catalogs">Library Catalogs</a></li>
<li><a href="#index-system-1824"><code>system</code></a>: <a href="#System-Interface">System Interface</a></li>
<li><a href="#index-time-490">time</a>: <a href="#Time-and-Date">Time and Date</a></li>
<li><a href="#index-time_002dzone-496"><code>time-zone</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-top_002dlevel-variable-references-55">top-level variable references</a>: <a href="#Top_002dlevel-Variable-References">Top-level Variable References</a></li>
<li><a href="#index-top_002drefs-54"><code>top-refs</code></a>: <a href="#Top_002dlevel-Variable-References">Top-level Variable References</a></li>
<li><a href="#index-topological_002dsort-1494"><code>topological-sort</code></a>: <a href="#Topological-Sort">Topological Sort</a></li>
<li><a href="#index-trace-1799"><code>trace</code></a>: <a href="#Trace">Trace</a></li>
<li><a href="#index-transact-1835"><code>transact</code></a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-transcript-1607"><code>transcript</code></a>: <a href="#Transcripts">Transcripts</a></li>
<li><a href="#index-tree-1470"><code>tree</code></a>: <a href="#Tree-Operations">Tree Operations</a></li>
<li><a href="#index-trees_002c-balanced-binary-1175">trees, balanced binary</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-tristimulus-842">tristimulus</a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-tsort-1495"><code>tsort</code></a>: <a href="#Topological-Sort">Topological Sort</a></li>
<li><a href="#index-turbidity-992">turbidity</a>: <a href="#Daylight">Daylight</a></li>
<li><a href="#index-TZ_002dstring-495"><code>TZ-string</code></a>: <a href="#Time-Zone">Time Zone</a></li>
<li><a href="#index-Uniform-Resource-Identifiers-403">Uniform Resource Identifiers</a>: <a href="#URI">URI</a></li>
<li><a href="#index-Uniform-Resource-Locator-435">Uniform Resource Locator</a>: <a href="#URI">URI</a></li>
<li><a href="#index-Unique-Factorization-1016">Unique Factorization</a>: <a href="#Commutative-Rings">Commutative Rings</a></li>
<li><a href="#index-unsafe-423">unsafe</a>: <a href="#URI">URI</a></li>
<li><a href="#index-URI-421">URI</a>: <a href="#URI">URI</a></li>
<li><a href="#index-uri-402"><code>uri</code></a>: <a href="#URI">URI</a></li>
<li><a href="#index-URI-390">URI</a>: <a href="#HTTP-and-CGI">HTTP and CGI</a></li>
<li><a href="#index-usercat-39">usercat</a>: <a href="#Catalog-Vicinities">Catalog Vicinities</a></li>
<li><a href="#index-UTC-512">UTC</a>: <a href="#Posix-Time">Posix Time</a></li>
<li><a href="#index-values-1649"><code>values</code></a>: <a href="#Values">Values</a></li>
<li><a href="#index-variable-references-56">variable references</a>: <a href="#Top_002dlevel-Variable-References">Top-level Variable References</a></li>
<li><a href="#index-vet-61"><code>vet</code></a>: <a href="#Module-Analysis">Module Analysis</a></li>
<li><a href="#index-VSCM-1886"><code>VSCM</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-WB-1122">WB</a>: <a href="#Base-Table">Base Table</a></li>
<li><a href="#index-wb_002dtable-1120"><code>wb-table</code></a>: <a href="#Base-Table">Base Table</a></li>
<li><a href="#index-weight_002dbalanced-binary-trees-1178">weight-balanced binary trees</a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-wget-977">wget</a>: <a href="#Color-Names">Color Names</a></li>
<li><a href="#index-white-point-838">white point</a>: <a href="#Color-Data_002dType">Color Data-Type</a></li>
<li><a href="#index-wild_002dcard-1150">wild-card</a>: <a href="#Match-Keys">Match Keys</a></li>
<li><a href="#index-with_002dfile-1604"><code>with-file</code></a>: <a href="#With_002dFile">With-File</a></li>
<li><a href="#index-Word-1839">Word</a>: <a href="#Transactions">Transactions</a></li>
<li><a href="#index-wt_002dtree-1174"><code>wt-tree</code></a>: <a href="#Weight_002dBalanced-Trees">Weight-Balanced Trees</a></li>
<li><a href="#index-xRGB-879"><code>xRGB</code></a>: <a href="#Color-Spaces">Color Spaces</a></li>
<li><a href="#index-xyY-914">xyY</a>: <a href="#Spectra">Spectra</a></li>
<li><a href="#index-yasos-186"><code>yasos</code></a>: <a href="#Yasos">Yasos</a></li>
  </ul><div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> scheme-implementation-type is the name symbol of the running
Scheme implementation (RScheme, |STk|, Bigloo, chez, Elk, gambit,
gauche, guile, JScheme, kawa, MacScheme, MITScheme, Pocket-Scheme, S7,
Scheme48, Scheme-&gt;C, Scheme48, Scsh, SISC, T, umb-scheme, or Vscm). 
Dependence on scheme-implementation-type is almost always the wrong
way to do things.</p>

  <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> There are some functions with internal <code>require</code> calls
to delay loading modules until they are needed.  While this reduces
startup latency for interpreters, it can produce headaches for
compilers.</p>

  <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> Although it will
work on large info files, feeding it an excerpt is much faster; and
has less chance of being confused by unusual text in the info file. 
This command excerpts the SLIB index into <samp><span class="file">slib-index.info</span></samp>:

<pre class="example">     info -f slib2d6.info -n "Index" -o slib-index.info
</pre>
  <p></p>

  <p class="footnote"><small>[<a name="fn-4" href="#fnd-4">4</a>]</small> How do I know this? 
I parsed 250kbyte of random input (an e-mail file) with a non-trivial
grammar utilizing all constructs.</p>

  <p class="footnote"><small>[<a name="fn-5" href="#fnd-5">5</a>]</small> Readers may recognize these color string formats from Xlib. 
X11's color management system was doomed by its fiction that CRT
monitors' (and X11 default) color-spaces were linear RGBi.  Unable to
shed this legacy, the only practical way to view pictures on X is to
ignore its color management system and use an sRGB monitor.  In this
implementation the device-independent RGB709 and sRGB spaces replace the
device-dependent RGBi and RGB spaces of Xlib.</p>

  <p class="footnote"><small>[<a name="fn-6" href="#fnd-6">6</a>]</small> 
A comprehensive encoding of transforms between CIEXYZ and device color
spaces is the International Color Consortium profile format,
ICC.1:1998-09:

  <blockquote>
The intent of this format is to provide a cross-platform device profile
format.  Such device profiles can be used to translate color data
created on one device into another device's native color space. 
</blockquote>
  </p>

  <p class="footnote"><small>[<a name="fn-7" href="#fnd-7">7</a>]</small> David Kahaner, Cleve Moler, and Stephen Nash
<cite>Numerical Methods and Software</cite>
Prentice-Hall, 1989, ISBN 0-13-627258-4</p>

  <p class="footnote"><small>[<a name="fn-8" href="#fnd-8">8</a>]</small> If you are porting a
<cite>Revised^3 Report on the Algorithmic Language Scheme</cite>
implementation, then you will need to finish writing <samp><span class="file">sc4sc3.scm</span></samp>
and <code>load</code> it from your initialization file.</p>

  <hr></div>

</body></html>

